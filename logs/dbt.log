[0m20:48:41.612297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78595844c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785959352ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7859577a3470>]}


============================== 20:48:41.615110 | 92f1fe2c-81cc-42c4-a7df-f0b3436d59cb ==============================
[0m20:48:41.615110 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:48:41.616484 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/home/robgriffin247/.dbt', 'invocation_command': 'dbt init fpl_analytics', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'write_json': 'True', 'empty': 'None', 'target_path': 'None', 'log_path': 'logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False'}
[0m20:48:41.635522 [debug] [MainThread]: Starter project path: /home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/include/starter_project
[0m20:48:41.641664 [info ] [MainThread]: 
Your new dbt project "fpl_analytics" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m20:48:41.642303 [info ] [MainThread]: Setting up your profile.
[0m20:48:43.324391 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 1.7763171, "process_in_blocks": "168", "process_kernel_time": 0.252507, "process_mem_max_rss": "128932", "process_out_blocks": "72", "process_user_time": 1.813086}
[0m20:48:43.324943 [debug] [MainThread]: Command `dbt init` succeeded at 20:48:43.324833 after 1.78 seconds
[0m20:48:43.325262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78595738fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78595738dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7859572aa7e0>]}
[0m20:48:43.325593 [debug] [MainThread]: Flushing usage events
[0m20:48:43.786132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:34.647495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713247d3c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71324711dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713247d10f50>]}


============================== 20:49:34.650486 | 7b0355f0-bdc0-4724-ae68-3f312542bba3 ==============================
[0m20:49:34.650486 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:49:34.651176 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': 'logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt build', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/robgriffin247/.dbt', 'target_path': 'None', 'log_format': 'default'}
[0m20:49:34.652176 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /home/robgriffin247/fpl/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m20:49:34.653138 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.07373421, "process_in_blocks": "0", "process_kernel_time": 0.273177, "process_mem_max_rss": "100248", "process_out_blocks": "16", "process_user_time": 1.727444}
[0m20:49:34.653630 [debug] [MainThread]: Command `dbt build` failed at 20:49:34.653539 after 0.07 seconds
[0m20:49:34.653997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71324708a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71324b1ffe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71324756c2c0>]}
[0m20:49:34.654295 [debug] [MainThread]: Flushing usage events
[0m20:49:35.110852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:47.932332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e9362d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e955f5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e954323c0>]}


============================== 20:49:47.935359 | a2909ffa-7ce6-4027-bd99-73c28d3e8860 ==============================
[0m20:49:47.935359 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:49:47.936007 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'profiles_dir': '/home/robgriffin247/.dbt', 'fail_fast': 'False', 'invocation_command': 'dbt build', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'cache_selected_only': 'False', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False'}
[0m20:49:48.196718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2909ffa-7ce6-4027-bd99-73c28d3e8860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e928bd1c0>]}
[0m20:49:48.274866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2909ffa-7ce6-4027-bd99-73c28d3e8860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e927995e0>]}
[0m20:49:48.276290 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:49:48.352277 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:49:48.352784 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:49:48.353134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2909ffa-7ce6-4027-bd99-73c28d3e8860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e88d7f770>]}
[0m20:49:49.041002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fpl_analytics.example
[0m20:49:49.045634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2909ffa-7ce6-4027-bd99-73c28d3e8860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e88ab9f10>]}
[0m20:49:49.074696 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:49:49.076236 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:49:49.097357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2909ffa-7ce6-4027-bd99-73c28d3e8860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e88abaa20>]}
[0m20:49:49.097828 [info ] [MainThread]: Found 444 macros
[0m20:49:49.100647 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:49:49.101403 [debug] [MainThread]: Command end result
[0m20:49:49.114343 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:49:49.118215 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:49:49.121520 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m20:49:49.122394 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2544782, "process_in_blocks": "0", "process_kernel_time": 0.290293, "process_mem_max_rss": "138784", "process_out_blocks": "2664", "process_user_time": 3.054394}
[0m20:49:49.122790 [debug] [MainThread]: Command `dbt build` succeeded at 20:49:49.122704 after 1.26 seconds
[0m20:49:49.123144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e9377c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e88aac2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712e88969700>]}
[0m20:49:49.123544 [debug] [MainThread]: Flushing usage events
[0m20:49:49.704323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:17.333402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92def506b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92de9dc2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92ded8fef0>]}


============================== 20:50:17.336194 | 511d6c0f-0d66-4b2a-bca9-a35c6f74ac1f ==============================
[0m20:50:17.336194 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:50:17.337413 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/robgriffin247/.dbt', 'invocation_command': 'dbt build', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'version_check': 'True', 'empty': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:50:17.592094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '511d6c0f-0d66-4b2a-bca9-a35c6f74ac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92dde360f0>]}
[0m20:50:17.729710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '511d6c0f-0d66-4b2a-bca9-a35c6f74ac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92de2e3920>]}
[0m20:50:17.731185 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:50:17.812299 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:50:17.847557 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:50:17.848229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '511d6c0f-0d66-4b2a-bca9-a35c6f74ac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92de650350>]}
[0m20:50:19.022925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '511d6c0f-0d66-4b2a-bca9-a35c6f74ac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92d424ede0>]}
[0m20:50:19.092203 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:50:19.093520 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:50:19.114128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '511d6c0f-0d66-4b2a-bca9-a35c6f74ac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92d0c612e0>]}
[0m20:50:19.114755 [info ] [MainThread]: Found 2 models, 4 data tests, 444 macros
[0m20:50:19.117593 [info ] [MainThread]: 
[0m20:50:19.118172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:19.118622 [info ] [MainThread]: 
[0m20:50:19.119267 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:50:19.124321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:50:19.155861 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:50:19.156275 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:50:19.156526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:19.173799 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:50:19.175369 [debug] [ThreadPool]: On list_dev: Close
[0m20:50:19.176213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:50:19.176634 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:50:19.182746 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:50:19.183049 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:50:19.183271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:19.184604 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:50:19.185631 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:50:19.185912 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:50:19.186473 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:50:19.186716 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:50:19.186914 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:50:19.187521 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:50:19.188333 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:50:19.188601 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:50:19.188818 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:50:19.189484 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:50:19.189741 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:50:19.191160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:50:19.195854 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:50:19.196221 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:50:19.196447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:19.197402 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:50:19.197650 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:50:19.197856 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:50:19.207591 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:50:19.208710 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:50:19.209592 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:50:19.209947 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:50:19.210811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '511d6c0f-0d66-4b2a-bca9-a35c6f74ac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92d4352ab0>]}
[0m20:50:19.211225 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:19.211465 [debug] [MainThread]: On master: BEGIN
[0m20:50:19.211671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:19.212484 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:50:19.212774 [debug] [MainThread]: On master: COMMIT
[0m20:50:19.213010 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:19.213220 [debug] [MainThread]: On master: COMMIT
[0m20:50:19.213763 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:50:19.214045 [debug] [MainThread]: On master: Close
[0m20:50:19.216329 [debug] [Thread-1 (]: Began running node model.fpl_analytics.my_first_dbt_model
[0m20:50:19.216789 [info ] [Thread-1 (]: 1 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m20:50:19.217304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.fpl_analytics.my_first_dbt_model)
[0m20:50:19.217810 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.my_first_dbt_model
[0m20:50:19.223838 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.my_first_dbt_model"
[0m20:50:19.225141 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.my_first_dbt_model
[0m20:50:19.253674 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.my_first_dbt_model"
[0m20:50:19.255984 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.my_first_dbt_model"
[0m20:50:19.256574 [debug] [Thread-1 (]: On model.fpl_analytics.my_first_dbt_model: BEGIN
[0m20:50:19.256962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:19.258363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:50:19.258918 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.my_first_dbt_model"
[0m20:50:19.259293 [debug] [Thread-1 (]: On model.fpl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m20:50:19.263463 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:50:19.270095 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.my_first_dbt_model"
[0m20:50:19.270433 [debug] [Thread-1 (]: On model.fpl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:50:19.271453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:50:19.283014 [debug] [Thread-1 (]: On model.fpl_analytics.my_first_dbt_model: COMMIT
[0m20:50:19.283563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.my_first_dbt_model"
[0m20:50:19.283975 [debug] [Thread-1 (]: On model.fpl_analytics.my_first_dbt_model: COMMIT
[0m20:50:19.291436 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:50:19.298445 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.my_first_dbt_model"
[0m20:50:19.298942 [debug] [Thread-1 (]: On model.fpl_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.my_first_dbt_model"} */

      drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m20:50:19.300030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:50:19.302942 [debug] [Thread-1 (]: On model.fpl_analytics.my_first_dbt_model: Close
[0m20:50:19.304694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '511d6c0f-0d66-4b2a-bca9-a35c6f74ac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92d43aa7b0>]}
[0m20:50:19.305274 [info ] [Thread-1 (]: 1 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m20:50:19.305907 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.my_first_dbt_model
[0m20:50:19.307196 [debug] [Thread-1 (]: Began running node test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:19.307684 [info ] [Thread-1 (]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:50:19.308668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.my_first_dbt_model, now test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:50:19.309000 [debug] [Thread-1 (]: Began compiling node test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:19.320388 [debug] [Thread-1 (]: Writing injected SQL for node "test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:19.321132 [debug] [Thread-1 (]: Began executing node test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:19.336484 [debug] [Thread-1 (]: Writing runtime sql for node "test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:19.337482 [debug] [Thread-1 (]: Using duckdb connection "test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:19.337796 [debug] [Thread-1 (]: On test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:50:19.338030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:19.338901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:50:19.339362 [debug] [Thread-1 (]: Using duckdb connection "test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:50:19.339940 [debug] [Thread-1 (]: On test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dev"."main"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m20:50:19.343982 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:50:19.348055 [debug] [Thread-1 (]: On test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:50:19.348899 [debug] [Thread-1 (]: Failed to rollback 'test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:50:19.349192 [debug] [Thread-1 (]: On test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:50:19.349846 [error] [Thread-1 (]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.04s]
[0m20:50:19.351029 [debug] [Thread-1 (]: Finished running node test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:50:19.351547 [debug] [Thread-1 (]: Began running node test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321
[0m20:50:19.352114 [debug] [Thread-4 (]: Marking all children of 'test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m20:50:19.352491 [info ] [Thread-1 (]: 3 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:50:19.353560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fpl_analytics.not_null_my_first_dbt_model_id.5fb22c2710, now test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321)
[0m20:50:19.353881 [debug] [Thread-1 (]: Began compiling node test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321
[0m20:50:19.360501 [debug] [Thread-1 (]: Writing injected SQL for node "test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:19.361155 [debug] [Thread-1 (]: Began executing node test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321
[0m20:50:19.363004 [debug] [Thread-1 (]: Writing runtime sql for node "test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:19.363469 [debug] [Thread-1 (]: Using duckdb connection "test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:19.363748 [debug] [Thread-1 (]: On test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:50:19.364086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:19.365057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:50:19.365371 [debug] [Thread-1 (]: Using duckdb connection "test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321"
[0m20:50:19.365640 [debug] [Thread-1 (]: On test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:50:19.370712 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:50:19.372825 [debug] [Thread-1 (]: On test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:50:19.373712 [debug] [Thread-1 (]: Failed to rollback 'test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321'
[0m20:50:19.374037 [debug] [Thread-1 (]: On test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:50:19.374852 [info ] [Thread-1 (]: 3 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.02s]
[0m20:50:19.375594 [debug] [Thread-1 (]: Finished running node test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321
[0m20:50:19.376887 [debug] [Thread-1 (]: Began running node model.fpl_analytics.my_second_dbt_model
[0m20:50:19.377503 [info ] [Thread-1 (]: 4 of 6 SKIP relation main.my_second_dbt_model .................................. [[33mSKIP[0m]
[0m20:50:19.378116 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.my_second_dbt_model
[0m20:50:19.378490 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m20:50:19.379272 [debug] [Thread-1 (]: Began running node test.fpl_analytics.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:19.379821 [info ] [Thread-1 (]: 5 of 6 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m20:50:19.380384 [debug] [Thread-1 (]: Finished running node test.fpl_analytics.not_null_my_second_dbt_model_id.151b76d778
[0m20:50:19.380756 [debug] [Thread-1 (]: Began running node test.fpl_analytics.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:19.381086 [debug] [Thread-4 (]: Marking all children of 'test.fpl_analytics.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m20:50:19.381457 [info ] [Thread-1 (]: 6 of 6 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m20:50:19.382456 [debug] [Thread-1 (]: Finished running node test.fpl_analytics.unique_my_second_dbt_model_id.57a0f8c493
[0m20:50:19.382831 [debug] [Thread-4 (]: Marking all children of 'test.fpl_analytics.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m20:50:19.384140 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:19.384431 [debug] [MainThread]: On master: BEGIN
[0m20:50:19.384656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:19.385424 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:50:19.385706 [debug] [MainThread]: On master: COMMIT
[0m20:50:19.385938 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:19.386147 [debug] [MainThread]: On master: COMMIT
[0m20:50:19.386725 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:50:19.387001 [debug] [MainThread]: On master: Close
[0m20:50:19.387418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:19.387745 [debug] [MainThread]: Connection 'test.fpl_analytics.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:50:19.388183 [info ] [MainThread]: 
[0m20:50:19.388681 [info ] [MainThread]: Finished running 2 table models, 4 data tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m20:50:19.390143 [debug] [MainThread]: Command end result
[0m20:50:19.406938 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:50:19.408855 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:50:19.413935 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m20:50:19.414315 [info ] [MainThread]: 
[0m20:50:19.414863 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:19.415372 [info ] [MainThread]: 
[0m20:50:19.415932 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (fpl_analytics/models/example/schema.yml)[0m
[0m20:50:19.416489 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:50:19.416937 [info ] [MainThread]: 
[0m20:50:19.417432 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m20:50:19.417899 [info ] [MainThread]: 
[0m20:50:19.418403 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m20:50:19.419399 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.1517143, "process_in_blocks": "2392", "process_kernel_time": 0.314619, "process_mem_max_rss": "161612", "process_out_blocks": "2872", "process_user_time": 3.943518}
[0m20:50:19.421366 [debug] [MainThread]: Command `dbt build` failed at 20:50:19.421218 after 2.15 seconds
[0m20:50:19.421744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92de2e3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92d27d42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92de340ef0>]}
[0m20:50:19.422151 [debug] [MainThread]: Flushing usage events
[0m20:50:20.041323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:48.853853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee906aa0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee9088539b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee906f6bbc0>]}


============================== 20:52:48.857873 | bb50c0be-389c-4868-8b5c-86647969c7f2 ==============================
[0m20:52:48.857873 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:52:48.867354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'log_path': '/home/robgriffin247/fpl/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/home/robgriffin247/.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'False'}
[0m20:52:49.126024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb50c0be-389c-4868-8b5c-86647969c7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee906aa3f50>]}
[0m20:52:49.208357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb50c0be-389c-4868-8b5c-86647969c7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee907781370>]}
[0m20:52:49.209884 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:52:49.293983 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:52:49.389594 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 2 files added, 0 files changed.
[0m20:52:49.390115 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m20:52:49.390473 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m20:52:49.390868 [debug] [MainThread]: Partial parsing: deleted file: fpl_analytics://fpl_analytics/models/example/my_first_dbt_model.sql
[0m20:52:49.391158 [debug] [MainThread]: Partial parsing: deleted file: fpl_analytics://fpl_analytics/models/example/my_second_dbt_model.sql
[0m20:52:49.840610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fpl_analytics.example
[0m20:52:49.850106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb50c0be-389c-4868-8b5c-86647969c7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee8cf2c9250>]}
[0m20:52:49.901496 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:52:49.905036 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:52:49.986064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb50c0be-389c-4868-8b5c-86647969c7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee8cf283050>]}
[0m20:52:49.986538 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m20:52:49.989035 [info ] [MainThread]: 
[0m20:52:49.989603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:49.990067 [info ] [MainThread]: 
[0m20:52:49.990887 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:52:49.991925 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:52:50.023659 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:52:50.024241 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:52:50.024521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:50.040644 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:52:50.042364 [debug] [ThreadPool]: On list_dev: Close
[0m20:52:50.043334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:52:50.043804 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:52:50.049276 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:52:50.049571 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:52:50.049799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:50.051062 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:52:50.052126 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:52:50.052395 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:52:50.053188 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:52:50.053434 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:52:50.053647 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:52:50.054240 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:52:50.055909 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:52:50.056279 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:52:50.056518 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:52:50.057244 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:52:50.057629 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:52:50.058861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:52:50.063484 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:52:50.063761 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:52:50.063972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:50.064679 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:52:50.064944 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:52:50.065164 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:52:50.075724 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:52:50.076972 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:52:50.077864 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:52:50.078157 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:52:50.079131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb50c0be-389c-4868-8b5c-86647969c7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee8cd083b60>]}
[0m20:52:50.079533 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:50.079775 [debug] [MainThread]: On master: BEGIN
[0m20:52:50.079980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:50.080696 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:52:50.080973 [debug] [MainThread]: On master: COMMIT
[0m20:52:50.081201 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:50.081400 [debug] [MainThread]: On master: COMMIT
[0m20:52:50.082007 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:52:50.082287 [debug] [MainThread]: On master: Close
[0m20:52:50.084378 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m20:52:50.084872 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_players ................................... [RUN]
[0m20:52:50.085427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.fpl_analytics.stg_players)
[0m20:52:50.085837 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m20:52:50.092973 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m20:52:50.093763 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m20:52:50.124800 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m20:52:50.125691 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m20:52:50.126052 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m20:52:50.126310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:50.127340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:52:50.127656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m20:52:50.127931 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
  create view "dev"."main"."stg_players__dbt_tmp" as (
    select * from "dev"."fpl_raw"."elements"
  );

[0m20:52:50.128792 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
  create view "dev"."main"."stg_players__dbt_tmp" as (
    select * from "dev"."fpl_raw"."elements"
  );

[0m20:52:50.129103 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:52:50.129455 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: ROLLBACK
[0m20:52:50.138313 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.stg_players'
[0m20:52:50.138657 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m20:52:50.140771 [debug] [Thread-1 (]: Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Catalog Error: Table with name elements does not exist!
  Did you mean "information_schema.columns"?
  
  LINE 5:     select * from "dev"."fpl_raw"."elements"
                            ^
[0m20:52:50.142085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb50c0be-389c-4868-8b5c-86647969c7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee907944e60>]}
[0m20:52:50.142666 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_players .......................... [[31mERROR[0m in 0.06s]
[0m20:52:50.143356 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m20:52:50.144065 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.stg_players' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Catalog Error: Table with name elements does not exist!
  Did you mean "information_schema.columns"?
  
  LINE 5:     select * from "dev"."fpl_raw"."elements"
                            ^.
[0m20:52:50.145719 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:50.146036 [debug] [MainThread]: On master: BEGIN
[0m20:52:50.146352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:50.147452 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:52:50.147746 [debug] [MainThread]: On master: COMMIT
[0m20:52:50.147983 [debug] [MainThread]: Using duckdb connection "master"
[0m20:52:50.148191 [debug] [MainThread]: On master: COMMIT
[0m20:52:50.148841 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:52:50.149125 [debug] [MainThread]: On master: Close
[0m20:52:50.149507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:50.149740 [debug] [MainThread]: Connection 'model.fpl_analytics.stg_players' was properly closed.
[0m20:52:50.149971 [info ] [MainThread]: 
[0m20:52:50.150336 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m20:52:50.151298 [debug] [MainThread]: Command end result
[0m20:52:50.167767 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:52:50.169257 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:52:50.175813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m20:52:50.176235 [info ] [MainThread]: 
[0m20:52:50.177403 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:52:50.178329 [info ] [MainThread]: 
[0m20:52:50.178983 [error] [MainThread]: [31mFailure in model stg_players (fpl_analytics/models/staging/stg_players.sql)[0m
[0m20:52:50.179532 [error] [MainThread]:   Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Catalog Error: Table with name elements does not exist!
  Did you mean "information_schema.columns"?
  
  LINE 5:     select * from "dev"."fpl_raw"."elements"
                            ^
[0m20:52:50.179959 [info ] [MainThread]: 
[0m20:52:50.180402 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/staging/stg_players.sql
[0m20:52:50.180775 [info ] [MainThread]: 
[0m20:52:50.181108 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:52:50.182163 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4130322, "process_in_blocks": "704", "process_kernel_time": 0.268847, "process_mem_max_rss": "158780", "process_out_blocks": "2768", "process_user_time": 3.081402}
[0m20:52:50.182561 [debug] [MainThread]: Command `dbt build` failed at 20:52:50.182476 after 1.41 seconds
[0m20:52:50.182874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee908cd1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee9077990d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee909375f40>]}
[0m20:52:50.183255 [debug] [MainThread]: Flushing usage events
[0m20:52:50.633002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:47.812105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62cacfe570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62ccd424b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62ca9479b0>]}


============================== 20:53:47.815008 | 1bd48675-d991-4f1f-a95d-f298853cfbb8 ==============================
[0m20:53:47.815008 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:53:47.816450 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/robgriffin247/fpl/logs', 'profiles_dir': '/home/robgriffin247/.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'printer_width': '80'}
[0m20:53:48.086457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bd48675-d991-4f1f-a95d-f298853cfbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62cca379e0>]}
[0m20:53:48.169504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bd48675-d991-4f1f-a95d-f298853cfbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62ca0ab260>]}
[0m20:53:48.171059 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:53:48.256234 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:53:48.338479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:53:48.339188 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m20:53:48.339558 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m20:53:48.770282 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fpl_analytics.example
[0m20:53:48.778331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bd48675-d991-4f1f-a95d-f298853cfbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62b907e540>]}
[0m20:53:48.832320 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:53:48.833798 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:53:48.913865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bd48675-d991-4f1f-a95d-f298853cfbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62ba9d2b10>]}
[0m20:53:48.914346 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m20:53:48.915996 [info ] [MainThread]: 
[0m20:53:48.916418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:48.916701 [info ] [MainThread]: 
[0m20:53:48.917206 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:53:48.918331 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:53:48.951013 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:53:48.951805 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:53:48.952197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:48.969126 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:53:48.970927 [debug] [ThreadPool]: On list_dev: Close
[0m20:53:48.972013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:53:48.972627 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:53:48.978971 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:53:48.979335 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:53:48.979668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:48.981148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:53:48.982274 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:53:48.983974 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:53:48.985148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:53:48.985568 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:53:48.985915 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:53:48.986761 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:53:48.987835 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:53:48.988260 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:53:48.988614 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:53:48.989595 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:53:48.989883 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:53:48.991194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:53:48.997307 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:53:48.997625 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:53:48.997901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:48.998805 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:53:48.999151 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:53:48.999544 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:53:49.011082 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:53:49.013080 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:53:49.014892 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:53:49.015175 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:53:49.016349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd48675-d991-4f1f-a95d-f298853cfbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62b907e540>]}
[0m20:53:49.016763 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:49.017012 [debug] [MainThread]: On master: BEGIN
[0m20:53:49.017244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:49.018064 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:53:49.018403 [debug] [MainThread]: On master: COMMIT
[0m20:53:49.018676 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:49.018888 [debug] [MainThread]: On master: COMMIT
[0m20:53:49.019592 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:53:49.019948 [debug] [MainThread]: On master: Close
[0m20:53:49.022298 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m20:53:49.022766 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_players ................................... [RUN]
[0m20:53:49.023196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.fpl_analytics.stg_players)
[0m20:53:49.023809 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m20:53:49.030729 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m20:53:49.031634 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m20:53:49.068089 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m20:53:49.068840 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m20:53:49.069159 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m20:53:49.069402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:49.070881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:53:49.071271 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m20:53:49.071750 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
  create view "dev"."main"."stg_players__dbt_tmp" as (
    select * from "dev"."fpl_raw"."elements"
  );

[0m20:53:49.073015 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
  create view "dev"."main"."stg_players__dbt_tmp" as (
    select * from "dev"."fpl_raw"."elements"
  );

[0m20:53:49.073514 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:53:49.074098 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: ROLLBACK
[0m20:53:49.078203 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.stg_players'
[0m20:53:49.078562 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m20:53:49.080772 [debug] [Thread-1 (]: Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Catalog Error: Table with name elements does not exist!
  Did you mean "information_schema.columns"?
  
  LINE 5:     select * from "dev"."fpl_raw"."elements"
                            ^
[0m20:53:49.082200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bd48675-d991-4f1f-a95d-f298853cfbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62b900d070>]}
[0m20:53:49.082780 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg_players .......................... [[31mERROR[0m in 0.06s]
[0m20:53:49.084211 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m20:53:49.084833 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.stg_players' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Catalog Error: Table with name elements does not exist!
  Did you mean "information_schema.columns"?
  
  LINE 5:     select * from "dev"."fpl_raw"."elements"
                            ^.
[0m20:53:49.086922 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:49.087512 [debug] [MainThread]: On master: BEGIN
[0m20:53:49.087770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:49.088881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:53:49.089167 [debug] [MainThread]: On master: COMMIT
[0m20:53:49.089397 [debug] [MainThread]: Using duckdb connection "master"
[0m20:53:49.089616 [debug] [MainThread]: On master: COMMIT
[0m20:53:49.090224 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:53:49.090632 [debug] [MainThread]: On master: Close
[0m20:53:49.091505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:49.091840 [debug] [MainThread]: Connection 'model.fpl_analytics.stg_players' was properly closed.
[0m20:53:49.092134 [info ] [MainThread]: 
[0m20:53:49.092455 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m20:53:49.093051 [debug] [MainThread]: Command end result
[0m20:53:49.110743 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:53:49.112704 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:53:49.118595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m20:53:49.119260 [info ] [MainThread]: 
[0m20:53:49.119802 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:53:49.121219 [info ] [MainThread]: 
[0m20:53:49.121893 [error] [MainThread]: [31mFailure in model stg_players (fpl_analytics/models/staging/stg_players.sql)[0m
[0m20:53:49.122343 [error] [MainThread]:   Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Catalog Error: Table with name elements does not exist!
  Did you mean "information_schema.columns"?
  
  LINE 5:     select * from "dev"."fpl_raw"."elements"
                            ^
[0m20:53:49.122691 [info ] [MainThread]: 
[0m20:53:49.123215 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/staging/stg_players.sql
[0m20:53:49.123782 [info ] [MainThread]: 
[0m20:53:49.124347 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:53:49.125545 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.3835351, "process_in_blocks": "0", "process_kernel_time": 0.289688, "process_mem_max_rss": "158860", "process_out_blocks": "2768", "process_user_time": 3.041724}
[0m20:53:49.126041 [debug] [MainThread]: Command `dbt build` failed at 20:53:49.125942 after 1.38 seconds
[0m20:53:49.126371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62ca18ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62b905f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c62ca1b0c20>]}
[0m20:53:49.126712 [debug] [MainThread]: Flushing usage events
[0m20:53:49.594754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:45.570065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166b058b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166b03ddaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166b030e900>]}


============================== 20:55:45.573389 | b6dbcd2b-4702-4f35-939f-75b9a5d7fb8c ==============================
[0m20:55:45.573389 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:55:45.574103 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/robgriffin247/fpl/logs', 'log_format': 'default', 'printer_width': '80', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt build', 'write_json': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/robgriffin247/.dbt', 'debug': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True'}
[0m20:55:45.851158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6dbcd2b-4702-4f35-939f-75b9a5d7fb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166a5e2e1e0>]}
[0m20:55:45.930464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6dbcd2b-4702-4f35-939f-75b9a5d7fb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166b053b500>]}
[0m20:55:45.931868 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:55:46.014253 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:55:46.087738 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:55:46.088281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6dbcd2b-4702-4f35-939f-75b9a5d7fb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166b0144230>]}
[0m20:55:47.470907 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.fpl_analytics.core
- models.fpl_analytics.intermediate
[0m20:55:47.485275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6dbcd2b-4702-4f35-939f-75b9a5d7fb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166a5e4adb0>]}
[0m20:55:47.546841 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:55:47.548565 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:55:47.585142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6dbcd2b-4702-4f35-939f-75b9a5d7fb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71668e70c800>]}
[0m20:55:47.585783 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m20:55:47.588154 [info ] [MainThread]: 
[0m20:55:47.588701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:47.589190 [info ] [MainThread]: 
[0m20:55:47.590235 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:55:47.591660 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m20:55:47.632746 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m20:55:47.633260 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m20:55:47.633633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:47.651179 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:55:47.652974 [debug] [ThreadPool]: On list_analytics: Close
[0m20:55:47.654028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_main_staging)
[0m20:55:47.654487 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "main_staging"
"
[0m20:55:47.663217 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main_staging"
[0m20:55:47.663849 [debug] [ThreadPool]: On create_analytics_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m20:55:47.664162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:47.665627 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:55:47.667429 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main_staging"
[0m20:55:47.667802 [debug] [ThreadPool]: On create_analytics_main_staging: BEGIN
[0m20:55:47.668736 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:55:47.669141 [debug] [ThreadPool]: Using duckdb connection "create_analytics_main_staging"
[0m20:55:47.669495 [debug] [ThreadPool]: On create_analytics_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_main_staging"} */

    
    
        create schema if not exists "analytics"."main_staging"
    
[0m20:55:47.670681 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_main_staging"} */

    
    
        create schema if not exists "analytics"."main_staging"
    
[0m20:55:47.671087 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:55:47.671492 [debug] [ThreadPool]: On create_analytics_main_staging: ROLLBACK
[0m20:55:47.676072 [debug] [ThreadPool]: Failed to rollback 'create_analytics_main_staging'
[0m20:55:47.676448 [debug] [ThreadPool]: On create_analytics_main_staging: Close
[0m20:55:47.677543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:47.678067 [debug] [MainThread]: Connection 'create_analytics_main_staging' was properly closed.
[0m20:55:47.678483 [info ] [MainThread]: 
[0m20:55:47.678973 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m20:55:47.679722 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "analytics" does not exist!
[0m20:55:47.680945 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.1914322, "process_in_blocks": "88", "process_kernel_time": 0.460974, "process_mem_max_rss": "156920", "process_out_blocks": "1840", "process_user_time": 4.292563}
[0m20:55:47.681490 [debug] [MainThread]: Command `dbt build` failed at 20:55:47.681351 after 2.19 seconds
[0m20:55:47.682039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166b04b3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166a59c4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7166a59c6480>]}
[0m20:55:47.682380 [debug] [MainThread]: Flushing usage events
[0m20:55:48.252837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:07.363021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6f5924710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6f59c0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6f5925e50>]}


============================== 20:56:07.367216 | 501093dd-aa01-4dfe-8403-9e6e34ef2345 ==============================
[0m20:56:07.367216 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:56:07.368696 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_cache_events': 'False', 'empty': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt build', 'profiles_dir': '/home/robgriffin247/.dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:56:07.617200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '501093dd-aa01-4dfe-8403-9e6e34ef2345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6eb430980>]}
[0m20:56:07.699423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '501093dd-aa01-4dfe-8403-9e6e34ef2345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6f5fe4650>]}
[0m20:56:07.700798 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:56:07.780985 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:56:07.864143 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:56:07.864837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '501093dd-aa01-4dfe-8403-9e6e34ef2345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6eb1a6510>]}
[0m20:56:08.933066 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.fpl_analytics.intermediate
- models.fpl_analytics.core
[0m20:56:08.952690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '501093dd-aa01-4dfe-8403-9e6e34ef2345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6eaf22780>]}
[0m20:56:09.010400 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:56:09.011853 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:56:09.033359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '501093dd-aa01-4dfe-8403-9e6e34ef2345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6e81bcef0>]}
[0m20:56:09.033880 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m20:56:09.036451 [info ] [MainThread]: 
[0m20:56:09.037085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:09.037649 [info ] [MainThread]: 
[0m20:56:09.038327 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:56:09.039224 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_fpl_analytics'
[0m20:56:09.071464 [debug] [ThreadPool]: Using duckdb connection "list_fpl_analytics"
[0m20:56:09.071835 [debug] [ThreadPool]: On list_fpl_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_fpl_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"fpl_analytics"'
    
  
  
[0m20:56:09.072076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:09.086804 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:56:09.087992 [debug] [ThreadPool]: On list_fpl_analytics: Close
[0m20:56:09.088790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fpl_analytics, now create_fpl_analytics_main_staging)
[0m20:56:09.089308 [debug] [ThreadPool]: Creating schema "database: "fpl_analytics"
schema: "main_staging"
"
[0m20:56:09.096241 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_main_staging"
[0m20:56:09.096565 [debug] [ThreadPool]: On create_fpl_analytics_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='fpl_analytics'
        and type='sqlite'
    
  
[0m20:56:09.096806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:09.098361 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:09.099393 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_main_staging"
[0m20:56:09.099647 [debug] [ThreadPool]: On create_fpl_analytics_main_staging: BEGIN
[0m20:56:09.100420 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:09.100668 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_main_staging"
[0m20:56:09.100872 [debug] [ThreadPool]: On create_fpl_analytics_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_main_staging"} */

    
    
        create schema if not exists "fpl_analytics"."main_staging"
    
[0m20:56:09.101650 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_main_staging"} */

    
    
        create schema if not exists "fpl_analytics"."main_staging"
    
[0m20:56:09.102079 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:56:09.102379 [debug] [ThreadPool]: On create_fpl_analytics_main_staging: ROLLBACK
[0m20:56:09.106794 [debug] [ThreadPool]: Failed to rollback 'create_fpl_analytics_main_staging'
[0m20:56:09.107110 [debug] [ThreadPool]: On create_fpl_analytics_main_staging: Close
[0m20:56:09.108013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:09.108316 [debug] [MainThread]: Connection 'create_fpl_analytics_main_staging' was properly closed.
[0m20:56:09.108556 [info ] [MainThread]: 
[0m20:56:09.108951 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m20:56:09.109670 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "fpl_analytics" does not exist!
[0m20:56:09.110749 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.8159757, "process_in_blocks": "0", "process_kernel_time": 0.382161, "process_mem_max_rss": "157172", "process_out_blocks": "1832", "process_user_time": 3.565437}
[0m20:56:09.111137 [debug] [MainThread]: Command `dbt build` failed at 20:56:09.111053 after 1.82 seconds
[0m20:56:09.111473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6f4f6dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6e8182c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d6c3c0ccb0>]}
[0m20:56:09.111841 [debug] [MainThread]: Flushing usage events
[0m20:56:09.693331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:53.367777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7062ef1c0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7062efaf70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7062eefb36e0>]}


============================== 20:56:53.370900 | e7fb71e2-f275-4cc5-8941-1f0d76c38b3b ==============================
[0m20:56:53.370900 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:56:53.371509 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'invocation_command': 'dbt build', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/robgriffin247/fpl', 'target_path': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'debug': 'False'}
[0m20:56:53.374342 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'fpl_analytics'
[0m20:56:53.375547 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.07471283, "process_in_blocks": "0", "process_kernel_time": 0.219724, "process_mem_max_rss": "100360", "process_out_blocks": "24", "process_user_time": 1.687317}
[0m20:56:53.375947 [debug] [MainThread]: Command `dbt build` failed at 20:56:53.375861 after 0.08 seconds
[0m20:56:53.376220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7062ef354ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7062ef158b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7062ef0197c0>]}
[0m20:56:53.376509 [debug] [MainThread]: Flushing usage events
[0m20:56:54.135632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:06.543949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751be1f17fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751be1c0d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751be1d4ed50>]}


============================== 20:57:06.546776 | 7821c017-9a4b-46da-8c81-8290ec3dc982 ==============================
[0m20:57:06.546776 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:57:06.547431 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'debug': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m20:57:06.819685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7821c017-9a4b-46da-8c81-8290ec3dc982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751be332bb00>]}
[0m20:57:06.901426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7821c017-9a4b-46da-8c81-8290ec3dc982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751be1eddc40>]}
[0m20:57:06.902951 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:57:06.995660 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:57:07.066323 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:57:07.066869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7821c017-9a4b-46da-8c81-8290ec3dc982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751be1d4c7d0>]}
[0m20:57:08.143079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.fpl_analytics.core
- models.fpl_analytics.intermediate
[0m20:57:08.155416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7821c017-9a4b-46da-8c81-8290ec3dc982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751be1edd580>]}
[0m20:57:08.207394 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:57:08.209156 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:57:08.229996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7821c017-9a4b-46da-8c81-8290ec3dc982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751bd75e6420>]}
[0m20:57:08.230483 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m20:57:08.233012 [info ] [MainThread]: 
[0m20:57:08.233560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:57:08.233963 [info ] [MainThread]: 
[0m20:57:08.234599 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:57:08.235553 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_fpl_analytics'
[0m20:57:08.269968 [debug] [ThreadPool]: Using duckdb connection "list_fpl_analytics"
[0m20:57:08.270925 [debug] [ThreadPool]: On list_fpl_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_fpl_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"fpl_analytics"'
    
  
  
[0m20:57:08.272145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:08.318416 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m20:57:08.319846 [debug] [ThreadPool]: On list_fpl_analytics: Close
[0m20:57:08.320700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fpl_analytics, now create_fpl_analytics_staging_staging)
[0m20:57:08.321303 [debug] [ThreadPool]: Creating schema "database: "fpl_analytics"
schema: "staging_staging"
"
[0m20:57:08.327175 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:57:08.327461 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='fpl_analytics'
        and type='sqlite'
    
  
[0m20:57:08.327675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:08.329055 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:08.330076 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:57:08.330330 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: BEGIN
[0m20:57:08.331109 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:08.331455 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:57:08.331778 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:57:08.332616 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:57:08.332891 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:57:08.333155 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: ROLLBACK
[0m20:57:08.336388 [debug] [ThreadPool]: Failed to rollback 'create_fpl_analytics_staging_staging'
[0m20:57:08.336719 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: Close
[0m20:57:08.337644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:08.337916 [debug] [MainThread]: Connection 'create_fpl_analytics_staging_staging' was properly closed.
[0m20:57:08.338136 [info ] [MainThread]: 
[0m20:57:08.338470 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m20:57:08.339078 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "fpl_analytics" does not exist!
[0m20:57:08.340299 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.8646922, "process_in_blocks": "0", "process_kernel_time": 0.282056, "process_mem_max_rss": "159116", "process_out_blocks": "1856", "process_user_time": 3.519392}
[0m20:57:08.340676 [debug] [MainThread]: Command `dbt build` failed at 20:57:08.340594 after 1.87 seconds
[0m20:57:08.340956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751be16c1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751bd4151100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751bd7707e00>]}
[0m20:57:08.341274 [debug] [MainThread]: Flushing usage events
[0m20:57:08.797658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:04.232947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe5bb32e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe5be4df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe5be4c9b0>]}


============================== 20:58:04.235806 | e4660728-95ff-4528-9441-47cd71ff43ae ==============================
[0m20:58:04.235806 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:58:04.237080 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_path': '/home/robgriffin247/fpl/logs', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m20:58:04.485468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4660728-95ff-4528-9441-47cd71ff43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe5b6bc380>]}
[0m20:58:04.561368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4660728-95ff-4528-9441-47cd71ff43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe51a7eae0>]}
[0m20:58:04.562998 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:58:04.641748 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:58:04.721503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:58:04.722142 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m20:58:05.162141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.fpl_analytics.intermediate
- models.fpl_analytics.core
[0m20:58:05.171684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4660728-95ff-4528-9441-47cd71ff43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe515da9f0>]}
[0m20:58:05.228722 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:58:05.230203 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:58:05.305369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4660728-95ff-4528-9441-47cd71ff43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe516202c0>]}
[0m20:58:05.305841 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m20:58:05.307987 [info ] [MainThread]: 
[0m20:58:05.308453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:05.308849 [info ] [MainThread]: 
[0m20:58:05.309482 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:58:05.310641 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_fpl_analytics'
[0m20:58:05.344580 [debug] [ThreadPool]: Using duckdb connection "list_fpl_analytics"
[0m20:58:05.345003 [debug] [ThreadPool]: On list_fpl_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_fpl_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"fpl_analytics"'
    
  
  
[0m20:58:05.345388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:05.366643 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:58:05.367804 [debug] [ThreadPool]: On list_fpl_analytics: Close
[0m20:58:05.368635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fpl_analytics, now create_fpl_analytics_staging_staging)
[0m20:58:05.369037 [debug] [ThreadPool]: Creating schema "database: "fpl_analytics"
schema: "staging_staging"
"
[0m20:58:05.375245 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:58:05.375547 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='fpl_analytics'
        and type='sqlite'
    
  
[0m20:58:05.375772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:05.377175 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:58:05.378251 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:58:05.378631 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: BEGIN
[0m20:58:05.379297 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:58:05.379557 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:58:05.379777 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:58:05.380637 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:58:05.380924 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:58:05.381195 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: ROLLBACK
[0m20:58:05.384433 [debug] [ThreadPool]: Failed to rollback 'create_fpl_analytics_staging_staging'
[0m20:58:05.384761 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: Close
[0m20:58:05.385541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:05.385796 [debug] [MainThread]: Connection 'create_fpl_analytics_staging_staging' was properly closed.
[0m20:58:05.386019 [info ] [MainThread]: 
[0m20:58:05.386481 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m20:58:05.387128 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "fpl_analytics" does not exist!
[0m20:58:05.388288 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2204043, "process_in_blocks": "0", "process_kernel_time": 0.326232, "process_mem_max_rss": "156620", "process_out_blocks": "1840", "process_user_time": 2.721356}
[0m20:58:05.388677 [debug] [MainThread]: Command `dbt build` failed at 20:58:05.388589 after 1.22 seconds
[0m20:58:05.388973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe5b6bc9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe21a8b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fe21a8b4d0>]}
[0m20:58:05.389318 [debug] [MainThread]: Flushing usage events
[0m20:58:06.122363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:55.922259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7634231f2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76342336c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7634231f08c0>]}


============================== 20:58:55.925219 | da44736c-b5e3-4917-9fa0-e7fb58c3ebe0 ==============================
[0m20:58:55.925219 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:58:55.925896 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/robgriffin247/fpl', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'indirect_selection': 'eager', 'introspect': 'True'}
[0m20:58:56.192556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da44736c-b5e3-4917-9fa0-e7fb58c3ebe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7634227afef0>]}
[0m20:58:56.298882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da44736c-b5e3-4917-9fa0-e7fb58c3ebe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763418bfeea0>]}
[0m20:58:56.300427 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:58:56.386515 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:58:56.474300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:58:56.474994 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m20:58:56.475659 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m20:58:56.916450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.fpl_analytics.intermediate
- models.fpl_analytics.core
[0m20:58:56.925477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da44736c-b5e3-4917-9fa0-e7fb58c3ebe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7633ef14b890>]}
[0m20:58:56.977294 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:58:56.978819 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:58:57.054137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da44736c-b5e3-4917-9fa0-e7fb58c3ebe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763418986cc0>]}
[0m20:58:57.054581 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m20:58:57.057444 [info ] [MainThread]: 
[0m20:58:57.057945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:57.058424 [info ] [MainThread]: 
[0m20:58:57.059091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:58:57.060021 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_fpl_analytics'
[0m20:58:57.091230 [debug] [ThreadPool]: Using duckdb connection "list_fpl_analytics"
[0m20:58:57.091654 [debug] [ThreadPool]: On list_fpl_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_fpl_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"fpl_analytics"'
    
  
  
[0m20:58:57.091931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:57.112972 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:58:57.114624 [debug] [ThreadPool]: On list_fpl_analytics: Close
[0m20:58:57.115738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fpl_analytics, now create_fpl_analytics_staging_staging)
[0m20:58:57.116170 [debug] [ThreadPool]: Creating schema "database: "fpl_analytics"
schema: "staging_staging"
"
[0m20:58:57.122359 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:58:57.122659 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='fpl_analytics'
        and type='sqlite'
    
  
[0m20:58:57.122937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:57.124507 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:58:57.125537 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:58:57.125808 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: BEGIN
[0m20:58:57.126426 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:58:57.126693 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:58:57.126997 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:58:57.127935 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:58:57.128203 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:58:57.128478 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: ROLLBACK
[0m20:58:57.131954 [debug] [ThreadPool]: Failed to rollback 'create_fpl_analytics_staging_staging'
[0m20:58:57.132249 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: Close
[0m20:58:57.133181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:57.133569 [debug] [MainThread]: Connection 'create_fpl_analytics_staging_staging' was properly closed.
[0m20:58:57.133897 [info ] [MainThread]: 
[0m20:58:57.134334 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m20:58:57.134955 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "fpl_analytics" does not exist!
[0m20:58:57.136271 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2795479, "process_in_blocks": "0", "process_kernel_time": 0.282009, "process_mem_max_rss": "157160", "process_out_blocks": "1840", "process_user_time": 2.890593}
[0m20:58:57.136667 [debug] [MainThread]: Command `dbt build` failed at 20:58:57.136581 after 1.28 seconds
[0m20:58:57.136996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763422f3d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7633ed633d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7633ed767320>]}
[0m20:58:57.137303 [debug] [MainThread]: Flushing usage events
[0m20:58:57.580845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:46.133313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c413add1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c413b30e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c413a903aa0>]}


============================== 20:59:46.136087 | 34dbc562-6850-46d7-a668-d12e5341fd98 ==============================
[0m20:59:46.136087 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:59:46.137412 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'invocation_command': 'dbt build', 'profiles_dir': '/home/robgriffin247/fpl', 'no_print': 'None', 'version_check': 'True', 'warn_error': 'None', 'empty': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True'}
[0m20:59:46.421915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34dbc562-6850-46d7-a668-d12e5341fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c413a48aff0>]}
[0m20:59:46.500684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34dbc562-6850-46d7-a668-d12e5341fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c413b51c0e0>]}
[0m20:59:46.502096 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:59:46.582227 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:59:46.667159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:46.667554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:46.683347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.fpl_analytics.core
- models.fpl_analytics.intermediate
[0m20:59:46.710279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34dbc562-6850-46d7-a668-d12e5341fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41307ceb70>]}
[0m20:59:46.766128 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:59:46.768182 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:59:46.792057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34dbc562-6850-46d7-a668-d12e5341fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c411ac29f40>]}
[0m20:59:46.792575 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m20:59:46.794833 [info ] [MainThread]: 
[0m20:59:46.795290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:59:46.795713 [info ] [MainThread]: 
[0m20:59:46.796380 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:59:46.797560 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_fpl_analytics'
[0m20:59:46.828954 [debug] [ThreadPool]: Using duckdb connection "list_fpl_analytics"
[0m20:59:46.829349 [debug] [ThreadPool]: On list_fpl_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_fpl_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"fpl_analytics"'
    
  
  
[0m20:59:46.829598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:46.862125 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m20:59:46.863391 [debug] [ThreadPool]: On list_fpl_analytics: Close
[0m20:59:46.864358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fpl_analytics, now create_fpl_analytics_staging_staging)
[0m20:59:46.864800 [debug] [ThreadPool]: Creating schema "database: "fpl_analytics"
schema: "staging_staging"
"
[0m20:59:46.875415 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:59:46.875812 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='fpl_analytics'
        and type='sqlite'
    
  
[0m20:59:46.876051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:46.877869 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:59:46.878990 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:59:46.879257 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: BEGIN
[0m20:59:46.880052 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:59:46.880541 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:59:46.880781 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:59:46.881561 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:59:46.881862 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:59:46.882146 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: ROLLBACK
[0m20:59:46.886440 [debug] [ThreadPool]: Failed to rollback 'create_fpl_analytics_staging_staging'
[0m20:59:46.886819 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: Close
[0m20:59:46.887956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:46.888519 [debug] [MainThread]: Connection 'create_fpl_analytics_staging_staging' was properly closed.
[0m20:59:46.888974 [info ] [MainThread]: 
[0m20:59:46.889482 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m20:59:46.890143 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "fpl_analytics" does not exist!
[0m20:59:46.891307 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8236662, "process_in_blocks": "0", "process_kernel_time": 0.321951, "process_mem_max_rss": "154108", "process_out_blocks": "968", "process_user_time": 2.454355}
[0m20:59:46.891872 [debug] [MainThread]: Command `dbt build` failed at 20:59:46.891758 after 0.82 seconds
[0m20:59:46.892324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c413a4d5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41309cd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c411ad0fd70>]}
[0m20:59:46.892828 [debug] [MainThread]: Flushing usage events
[0m20:59:47.569745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:56.566405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90161a9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9016945fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90161a9b20>]}


============================== 20:59:56.574169 | bbe79348-123d-4f65-a95b-2c3787eadd9e ==============================
[0m20:59:56.574169 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:59:56.574983 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build', 'log_path': '/home/robgriffin247/fpl/logs', 'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'partial_parse': 'True', 'empty': 'False', 'write_json': 'True', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None'}
[0m20:59:56.872642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe79348-123d-4f65-a95b-2c3787eadd9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c900bc98410>]}
[0m20:59:56.955961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe79348-123d-4f65-a95b-2c3787eadd9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9015f3dc10>]}
[0m20:59:56.957403 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:59:57.057526 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:59:57.136521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:57.136940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:57.142227 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.fpl_analytics.intermediate
- models.fpl_analytics.core
[0m20:59:57.176555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe79348-123d-4f65-a95b-2c3787eadd9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c900bb39280>]}
[0m20:59:57.248974 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m20:59:57.251060 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m20:59:57.272641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe79348-123d-4f65-a95b-2c3787eadd9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9009f1da30>]}
[0m20:59:57.273152 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m20:59:57.275410 [info ] [MainThread]: 
[0m20:59:57.275854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:59:57.276317 [info ] [MainThread]: 
[0m20:59:57.276965 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:59:57.277926 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_fpl_analytics'
[0m20:59:57.317010 [debug] [ThreadPool]: Using duckdb connection "list_fpl_analytics"
[0m20:59:57.317470 [debug] [ThreadPool]: On list_fpl_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_fpl_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"fpl_analytics"'
    
  
  
[0m20:59:57.317762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:57.341538 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:59:57.342853 [debug] [ThreadPool]: On list_fpl_analytics: Close
[0m20:59:57.343645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fpl_analytics, now create_fpl_analytics_staging_staging)
[0m20:59:57.344067 [debug] [ThreadPool]: Creating schema "database: "fpl_analytics"
schema: "staging_staging"
"
[0m20:59:57.350981 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:59:57.351289 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='fpl_analytics'
        and type='sqlite'
    
  
[0m20:59:57.351520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:57.353049 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:59:57.354063 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:59:57.354317 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: BEGIN
[0m20:59:57.355122 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:59:57.355369 [debug] [ThreadPool]: Using duckdb connection "create_fpl_analytics_staging_staging"
[0m20:59:57.355570 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:59:57.356987 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_fpl_analytics_staging_staging"} */

    
    
        create schema if not exists "fpl_analytics"."staging_staging"
    
[0m20:59:57.357449 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:59:57.357780 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: ROLLBACK
[0m20:59:57.361582 [debug] [ThreadPool]: Failed to rollback 'create_fpl_analytics_staging_staging'
[0m20:59:57.361899 [debug] [ThreadPool]: On create_fpl_analytics_staging_staging: Close
[0m20:59:57.362742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:57.363004 [debug] [MainThread]: Connection 'create_fpl_analytics_staging_staging' was properly closed.
[0m20:59:57.363228 [info ] [MainThread]: 
[0m20:59:57.363617 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m20:59:57.364204 [error] [MainThread]: Encountered an error:
Runtime Error
  Binder Error: Catalog "fpl_analytics" does not exist!
[0m20:59:57.365130 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8709406, "process_in_blocks": "0", "process_kernel_time": 0.326498, "process_mem_max_rss": "154472", "process_out_blocks": "968", "process_user_time": 2.478038}
[0m20:59:57.365494 [debug] [MainThread]: Command `dbt build` failed at 20:59:57.365415 after 0.87 seconds
[0m20:59:57.365766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9015bbbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90157e6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9009f1e2d0>]}
[0m20:59:57.366043 [debug] [MainThread]: Flushing usage events
[0m20:59:57.842007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:42.781328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f05ab445f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f05a2408c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f05cad1220>]}


============================== 21:02:42.784448 | a88b54bb-9e97-46cf-a1b8-923f5aba86db ==============================
[0m21:02:42.784448 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:02:42.785153 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'invocation_command': 'dbt build', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'empty': 'False', 'static_parser': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'profiles_dir': '/home/robgriffin247/fpl', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'version_check': 'True'}
[0m21:02:43.087153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a88b54bb-9e97-46cf-a1b8-923f5aba86db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f059ab3950>]}
[0m21:02:43.168816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a88b54bb-9e97-46cf-a1b8-923f5aba86db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f05ab1aa80>]}
[0m21:02:43.170213 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:02:43.250638 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:02:43.330828 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:02:43.331334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a88b54bb-9e97-46cf-a1b8-923f5aba86db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f05a240380>]}
[0m21:02:44.456558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a88b54bb-9e97-46cf-a1b8-923f5aba86db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f04ca6db20>]}
[0m21:02:44.509156 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:02:44.510622 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:02:44.531073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a88b54bb-9e97-46cf-a1b8-923f5aba86db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f04c83c1d0>]}
[0m21:02:44.531523 [info ] [MainThread]: Found 1 model, 6 sources, 444 macros
[0m21:02:44.534219 [info ] [MainThread]: 
[0m21:02:44.534837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:44.535855 [info ] [MainThread]: 
[0m21:02:44.536962 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:02:44.539235 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m21:02:44.574801 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:02:44.575346 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:02:44.575763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:44.603378 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m21:02:44.604736 [debug] [ThreadPool]: On list_analytics: Close
[0m21:02:44.605547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging_staging)
[0m21:02:44.605955 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging_staging"
"
[0m21:02:44.611759 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging_staging"
[0m21:02:44.612186 [debug] [ThreadPool]: On create_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:02:44.612505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:44.613831 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:02:44.614828 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging_staging"
[0m21:02:44.615079 [debug] [ThreadPool]: On create_analytics_staging_staging: BEGIN
[0m21:02:44.615743 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:02:44.616170 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging_staging"
[0m21:02:44.616391 [debug] [ThreadPool]: On create_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging_staging"} */

    
    
        create schema if not exists "analytics"."staging_staging"
    
[0m21:02:44.616981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:02:44.617715 [debug] [ThreadPool]: On create_analytics_staging_staging: COMMIT
[0m21:02:44.618078 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging_staging"
[0m21:02:44.618328 [debug] [ThreadPool]: On create_analytics_staging_staging: COMMIT
[0m21:02:44.623560 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m21:02:44.624054 [debug] [ThreadPool]: On create_analytics_staging_staging: Close
[0m21:02:44.625232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging_staging, now list_analytics_staging_staging)
[0m21:02:44.629839 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging_staging"
[0m21:02:44.630130 [debug] [ThreadPool]: On list_analytics_staging_staging: BEGIN
[0m21:02:44.630339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:44.631027 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:02:44.631267 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging_staging"
[0m21:02:44.631470 [debug] [ThreadPool]: On list_analytics_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging_staging'
    and lower(table_catalog) = 'analytics'
  
[0m21:02:44.642055 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:02:44.643653 [debug] [ThreadPool]: On list_analytics_staging_staging: ROLLBACK
[0m21:02:44.644722 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging_staging'
[0m21:02:44.644984 [debug] [ThreadPool]: On list_analytics_staging_staging: Close
[0m21:02:44.645684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88b54bb-9e97-46cf-a1b8-923f5aba86db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f04c9ebf50>]}
[0m21:02:44.646096 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:44.646335 [debug] [MainThread]: On master: BEGIN
[0m21:02:44.646541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:44.647208 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:02:44.647485 [debug] [MainThread]: On master: COMMIT
[0m21:02:44.647718 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:44.648056 [debug] [MainThread]: On master: COMMIT
[0m21:02:44.648691 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:02:44.648969 [debug] [MainThread]: On master: Close
[0m21:02:44.651281 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m21:02:44.651721 [info ] [Thread-1 (]: 1 of 1 START sql table model staging_staging.stg_players ....................... [RUN]
[0m21:02:44.652281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging_staging, now model.fpl_analytics.stg_players)
[0m21:02:44.652702 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m21:02:44.658822 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m21:02:44.659375 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m21:02:44.690673 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m21:02:44.691334 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:02:44.691708 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m21:02:44.692012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:44.692967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:02:44.693291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:02:44.693540 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging_staging"."stg_players__dbt_tmp"
  
    as (
      select * from "rawdb"."fpl_raw"."elements"
    );
  
  
[0m21:02:44.720617 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m21:02:44.733013 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:02:44.733472 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging_staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m21:02:44.734569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:02:44.745520 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:02:44.745886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:02:44.746165 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:02:44.755080 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:02:44.759815 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:02:44.760166 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging_staging"."stg_players__dbt_backup" cascade
    
[0m21:02:44.760981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:02:44.763088 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m21:02:44.765614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88b54bb-9e97-46cf-a1b8-923f5aba86db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f05c50abd0>]}
[0m21:02:44.766415 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging_staging.stg_players .................. [[32mOK[0m in 0.11s]
[0m21:02:44.767385 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m21:02:44.769916 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:44.770247 [debug] [MainThread]: On master: BEGIN
[0m21:02:44.770563 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:44.771525 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:02:44.771902 [debug] [MainThread]: On master: COMMIT
[0m21:02:44.772329 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:44.772572 [debug] [MainThread]: On master: COMMIT
[0m21:02:44.773304 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:02:44.773718 [debug] [MainThread]: On master: Close
[0m21:02:44.774286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:44.774638 [debug] [MainThread]: Connection 'model.fpl_analytics.stg_players' was properly closed.
[0m21:02:44.775026 [info ] [MainThread]: 
[0m21:02:44.775531 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m21:02:44.776694 [debug] [MainThread]: Command end result
[0m21:02:44.793359 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:02:44.796876 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:02:44.804659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m21:02:44.805147 [info ] [MainThread]: 
[0m21:02:44.805696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:44.806112 [info ] [MainThread]: 
[0m21:02:44.806555 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:02:44.807715 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.0931478, "process_in_blocks": "0", "process_kernel_time": 0.295684, "process_mem_max_rss": "166936", "process_out_blocks": "3880", "process_user_time": 3.759415}
[0m21:02:44.808321 [debug] [MainThread]: Command `dbt build` succeeded at 21:02:44.808186 after 2.09 seconds
[0m21:02:44.808805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f05cad1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f04fb7c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f059bb0590>]}
[0m21:02:44.809279 [debug] [MainThread]: Flushing usage events
[0m21:02:45.266311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:56.161214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47e3a19280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47e27a1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47e27a16a0>]}


============================== 21:03:56.164456 | dfbc314d-168c-455b-a8f4-a086c2b10eed ==============================
[0m21:03:56.164456 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:03:56.165840 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt build', 'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False'}
[0m21:03:56.421167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfbc314d-168c-455b-a8f4-a086c2b10eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47d8216150>]}
[0m21:03:56.502498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfbc314d-168c-455b-a8f4-a086c2b10eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47e29d7110>]}
[0m21:03:56.503922 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:03:56.587027 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:03:56.668692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:03:56.669343 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/macros/schema_prefix.sql
[0m21:03:56.671389 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m21:03:57.771959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfbc314d-168c-455b-a8f4-a086c2b10eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47d80b52e0>]}
[0m21:03:57.822993 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:03:57.824418 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:03:57.844297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfbc314d-168c-455b-a8f4-a086c2b10eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47d4c7f0b0>]}
[0m21:03:57.844776 [info ] [MainThread]: Found 1 model, 6 sources, 445 macros
[0m21:03:57.847133 [info ] [MainThread]: 
[0m21:03:57.847594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:03:57.847981 [info ] [MainThread]: 
[0m21:03:57.848600 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:57.849542 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m21:03:57.886123 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:03:57.886611 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:03:57.887073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:57.913735 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m21:03:57.915012 [debug] [ThreadPool]: On list_analytics: Close
[0m21:03:57.915807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m21:03:57.916214 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m21:03:57.922439 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:03:57.922764 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:03:57.922996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:57.924213 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:03:57.925192 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:03:57.925509 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m21:03:57.926311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:03:57.926562 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:03:57.926766 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m21:03:57.927335 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:03:57.928049 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:03:57.928304 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:03:57.928515 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:03:57.934945 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m21:03:57.935273 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m21:03:57.936434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_staging)
[0m21:03:57.940834 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:03:57.941116 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m21:03:57.941329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:57.942107 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:03:57.942379 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:03:57.942601 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m21:03:57.953502 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:03:57.954553 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m21:03:57.955466 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m21:03:57.955732 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m21:03:57.956423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfbc314d-168c-455b-a8f4-a086c2b10eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47d7f87710>]}
[0m21:03:57.956831 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:57.957074 [debug] [MainThread]: On master: BEGIN
[0m21:03:57.957278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:57.958075 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:03:57.958360 [debug] [MainThread]: On master: COMMIT
[0m21:03:57.958591 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:57.958795 [debug] [MainThread]: On master: COMMIT
[0m21:03:57.959419 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:03:57.959695 [debug] [MainThread]: On master: Close
[0m21:03:57.961936 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m21:03:57.962392 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_players ............................... [RUN]
[0m21:03:57.963171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_players)
[0m21:03:57.964296 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m21:03:57.973903 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m21:03:57.974477 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m21:03:58.007286 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m21:03:58.007968 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:03:58.008487 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m21:03:58.008916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:58.010116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:03:58.010585 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:03:58.011044 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select * from "rawdb"."fpl_raw"."elements"
    );
  
  
[0m21:03:58.029366 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m21:03:58.036176 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:03:58.036584 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m21:03:58.037796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:03:58.049158 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:03:58.049521 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:03:58.049826 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:03:58.060036 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m21:03:58.064819 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:03:58.065205 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m21:03:58.066024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:03:58.067944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m21:03:58.070820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfbc314d-168c-455b-a8f4-a086c2b10eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47d42afd70>]}
[0m21:03:58.072431 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.11s]
[0m21:03:58.075203 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m21:03:58.077099 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.077568 [debug] [MainThread]: On master: BEGIN
[0m21:03:58.077985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:58.078972 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:03:58.079392 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.079789 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.080161 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.081045 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:03:58.081441 [debug] [MainThread]: On master: Close
[0m21:03:58.082115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:58.082473 [debug] [MainThread]: Connection 'model.fpl_analytics.stg_players' was properly closed.
[0m21:03:58.082859 [info ] [MainThread]: 
[0m21:03:58.083371 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m21:03:58.085867 [debug] [MainThread]: Command end result
[0m21:03:58.102781 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:03:58.104840 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:03:58.114254 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m21:03:58.114799 [info ] [MainThread]: 
[0m21:03:58.115395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:58.115840 [info ] [MainThread]: 
[0m21:03:58.116357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:03:58.117563 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.0233345, "process_in_blocks": "0", "process_kernel_time": 0.375412, "process_mem_max_rss": "167268", "process_out_blocks": "3880", "process_user_time": 3.654012}
[0m21:03:58.118134 [debug] [MainThread]: Command `dbt build` succeeded at 21:03:58.118016 after 2.02 seconds
[0m21:03:58.118581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47e2500a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47e24d0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a47e217f5f0>]}
[0m21:03:58.119017 [debug] [MainThread]: Flushing usage events
[0m21:03:58.597629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:06.177517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff6854dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff6805b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff67aa4b00>]}


============================== 21:14:06.183020 | a5c8dfc4-c87e-424c-92be-4fcdab7f75bc ==============================
[0m21:14:06.183020 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:14:06.183444 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'introspect': 'True', 'fail_fast': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m21:14:06.465521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5c8dfc4-c87e-424c-92be-4fcdab7f75bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff5db12060>]}
[0m21:14:06.523397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5c8dfc4-c87e-424c-92be-4fcdab7f75bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff680938f0>]}
[0m21:14:06.525756 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:14:06.582731 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:14:06.682827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:14:06.683459 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m21:14:07.003292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5c8dfc4-c87e-424c-92be-4fcdab7f75bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff2e59ca10>]}
[0m21:14:07.040437 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:14:07.042474 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:14:07.118827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5c8dfc4-c87e-424c-92be-4fcdab7f75bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff5d797020>]}
[0m21:14:07.119224 [info ] [MainThread]: Found 1 model, 6 sources, 445 macros
[0m21:14:07.120644 [info ] [MainThread]: 
[0m21:14:07.120976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:14:07.121244 [info ] [MainThread]: 
[0m21:14:07.121622 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:14:07.122488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m21:14:07.155238 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:14:07.155616 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:14:07.155834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:07.192316 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m21:14:07.193377 [debug] [ThreadPool]: On list_analytics: Close
[0m21:14:07.194084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m21:14:07.194408 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m21:14:07.198923 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:14:07.199170 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:14:07.199358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:07.200301 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:14:07.201151 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:14:07.201357 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m21:14:07.201798 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:14:07.201995 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:14:07.202172 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m21:14:07.202621 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:14:07.203137 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:14:07.203339 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:14:07.203515 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:14:07.208705 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m21:14:07.208995 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m21:14:07.210130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_staging)
[0m21:14:07.213750 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:14:07.214105 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m21:14:07.214328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:07.215423 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:14:07.215678 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:14:07.215943 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m21:14:07.226234 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:14:07.227402 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m21:14:07.228877 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m21:14:07.229127 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m21:14:07.229858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c8dfc4-c87e-424c-92be-4fcdab7f75bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff5d573a10>]}
[0m21:14:07.230193 [debug] [MainThread]: Using duckdb connection "master"
[0m21:14:07.230389 [debug] [MainThread]: On master: BEGIN
[0m21:14:07.230552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:07.231226 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:14:07.231566 [debug] [MainThread]: On master: COMMIT
[0m21:14:07.231853 [debug] [MainThread]: Using duckdb connection "master"
[0m21:14:07.232166 [debug] [MainThread]: On master: COMMIT
[0m21:14:07.232886 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:14:07.233130 [debug] [MainThread]: On master: Close
[0m21:14:07.235779 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m21:14:07.236149 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_players ............................... [RUN]
[0m21:14:07.236558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_players)
[0m21:14:07.236800 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m21:14:07.241804 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m21:14:07.242488 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m21:14:07.266701 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m21:14:07.267330 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:14:07.267601 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m21:14:07.267796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:07.268689 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:14:07.268942 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:14:07.269144 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select * from "rawdb"."fpl"."elements"
    );
  
  
[0m21:14:07.281661 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m21:14:07.286744 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:14:07.287004 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m21:14:07.287953 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:14:07.297561 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:14:07.297861 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:14:07.298062 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:14:07.306329 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:14:07.310153 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:14:07.310431 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m21:14:07.311006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:14:07.312600 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m21:14:07.314805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5c8dfc4-c87e-424c-92be-4fcdab7f75bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff2dae6210>]}
[0m21:14:07.315223 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.08s]
[0m21:14:07.315617 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m21:14:07.317584 [debug] [MainThread]: Using duckdb connection "master"
[0m21:14:07.317981 [debug] [MainThread]: On master: BEGIN
[0m21:14:07.318273 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:07.319502 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:14:07.319880 [debug] [MainThread]: On master: COMMIT
[0m21:14:07.320298 [debug] [MainThread]: Using duckdb connection "master"
[0m21:14:07.320635 [debug] [MainThread]: On master: COMMIT
[0m21:14:07.321150 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:14:07.321395 [debug] [MainThread]: On master: Close
[0m21:14:07.321799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:07.321966 [debug] [MainThread]: Connection 'model.fpl_analytics.stg_players' was properly closed.
[0m21:14:07.322139 [info ] [MainThread]: 
[0m21:14:07.322391 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m21:14:07.322865 [debug] [MainThread]: Command end result
[0m21:14:07.332161 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:14:07.333516 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:14:07.337382 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m21:14:07.337635 [info ] [MainThread]: 
[0m21:14:07.337922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:14:07.338206 [info ] [MainThread]: 
[0m21:14:07.338472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:14:07.340174 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2151238, "process_in_blocks": "167192", "process_kernel_time": 0.345792, "process_mem_max_rss": "164188", "process_out_blocks": "3872", "process_user_time": 2.23193}
[0m21:14:07.340580 [debug] [MainThread]: Command `dbt build` succeeded at 21:14:07.340501 after 1.22 seconds
[0m21:14:07.340817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff67aa4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff67acf200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ff5db12ba0>]}
[0m21:14:07.341047 [debug] [MainThread]: Flushing usage events
[0m21:14:07.820224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:20:46.337089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711df03697c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711df01ea540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ded79d220>]}


============================== 21:20:46.341798 | cc3698bf-3610-4693-8bb7-e9f28f02e126 ==============================
[0m21:20:46.341798 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:20:46.342244 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m21:20:46.629526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc3698bf-3610-4693-8bb7-e9f28f02e126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711de3b162a0>]}
[0m21:20:46.689788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc3698bf-3610-4693-8bb7-e9f28f02e126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711def629370>]}
[0m21:20:46.692352 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:20:46.753274 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:20:46.815488 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:20:46.815935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc3698bf-3610-4693-8bb7-e9f28f02e126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711de38b95e0>]}
[0m21:20:47.657835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc3698bf-3610-4693-8bb7-e9f28f02e126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dee65d100>]}
[0m21:20:47.696804 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:20:47.698714 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:20:47.729180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc3698bf-3610-4693-8bb7-e9f28f02e126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711de069b680>]}
[0m21:20:47.729579 [info ] [MainThread]: Found 2 models, 6 sources, 445 macros
[0m21:20:47.730962 [info ] [MainThread]: 
[0m21:20:47.731271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:20:47.731496 [info ] [MainThread]: 
[0m21:20:47.731834 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:20:47.735234 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m21:20:47.764585 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:20:47.764941 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:20:47.765176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:47.799312 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m21:20:47.800465 [debug] [ThreadPool]: On list_analytics: Close
[0m21:20:47.802181 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:20:47.802545 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:20:47.802759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:47.803802 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:20:47.804641 [debug] [ThreadPool]: On list_analytics: Close
[0m21:20:47.805325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m21:20:47.805685 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m21:20:47.810222 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:20:47.810528 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:20:47.810722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:47.812056 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:20:47.813128 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:20:47.813365 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m21:20:47.813874 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:20:47.814085 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:20:47.814249 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m21:20:47.814676 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:20:47.815212 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:20:47.815425 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:20:47.815624 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:20:47.821556 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m21:20:47.821898 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m21:20:47.822432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m21:20:47.822857 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m21:20:47.824045 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:20:47.824265 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:20:47.824467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:47.825436 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:20:47.826368 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:20:47.826574 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m21:20:47.826981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:20:47.827207 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:20:47.827378 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m21:20:47.827980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:20:47.828795 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:20:47.829248 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:20:47.829446 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:20:47.830284 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:20:47.830537 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m21:20:47.831719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m21:20:47.835794 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:20:47.836128 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m21:20:47.836314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:47.837201 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:20:47.837447 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:20:47.837650 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m21:20:47.847607 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:20:47.848909 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m21:20:47.850620 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m21:20:47.850846 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m21:20:47.851413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m21:20:47.852760 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:20:47.853009 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m21:20:47.853264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:47.853820 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:20:47.854012 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:20:47.854178 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m21:20:47.856697 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:20:47.857619 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m21:20:47.858228 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m21:20:47.858428 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m21:20:47.859187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc3698bf-3610-4693-8bb7-e9f28f02e126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711de1fe3c80>]}
[0m21:20:47.859496 [debug] [MainThread]: Using duckdb connection "master"
[0m21:20:47.859673 [debug] [MainThread]: On master: BEGIN
[0m21:20:47.859824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:47.860343 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:20:47.860549 [debug] [MainThread]: On master: COMMIT
[0m21:20:47.860723 [debug] [MainThread]: Using duckdb connection "master"
[0m21:20:47.860920 [debug] [MainThread]: On master: COMMIT
[0m21:20:47.861691 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:20:47.862069 [debug] [MainThread]: On master: Close
[0m21:20:47.867161 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m21:20:47.867652 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_players ............................... [RUN]
[0m21:20:47.868019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_players)
[0m21:20:47.868338 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m21:20:47.874315 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m21:20:47.874843 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m21:20:47.896474 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m21:20:47.897138 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:20:47.897417 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m21:20:47.897613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:47.898531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:47.898930 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:20:47.899368 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count,
    element_type,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
    
from "rawdb"."fpl"."elements"
    );
  
  
[0m21:20:47.915427 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m21:20:47.919588 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:20:47.919948 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:20:47.920920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:47.921907 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:20:47.922196 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:20:47.924447 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:20:47.929194 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:20:47.929571 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m21:20:47.930375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:47.932166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:20:47.932502 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m21:20:47.933931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:47.944473 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:20:47.944828 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:20:47.945110 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:20:47.954915 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:20:47.958753 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:20:47.959030 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m21:20:47.965648 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:20:47.967632 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m21:20:47.969769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc3698bf-3610-4693-8bb7-e9f28f02e126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dcc09be90>]}
[0m21:20:47.970269 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.10s]
[0m21:20:47.970708 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m21:20:47.971975 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m21:20:47.972400 [info ] [Thread-1 (]: 2 of 2 START sql table model intermediate.int_players .......................... [RUN]
[0m21:20:47.972772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.int_players)
[0m21:20:47.973013 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m21:20:47.975115 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m21:20:47.975847 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m21:20:47.977775 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m21:20:47.978499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:20:47.978758 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m21:20:47.978958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:47.979729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:47.979977 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:20:47.980229 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count,
    element_type,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
    
from "analytics"."staging"."stg_players"
    );
  
  
[0m21:20:47.987798 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:20:47.989960 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:20:47.990247 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m21:20:47.991150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:47.992150 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:20:47.992498 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:20:47.992710 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:20:48.002044 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:20:48.004863 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:20:48.005275 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m21:20:48.006332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:20:48.007484 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m21:20:48.008483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc3698bf-3610-4693-8bb7-e9f28f02e126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dcc0f4290>]}
[0m21:20:48.009199 [info ] [Thread-1 (]: 2 of 2 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.04s]
[0m21:20:48.009796 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m21:20:48.012324 [debug] [MainThread]: Using duckdb connection "master"
[0m21:20:48.012946 [debug] [MainThread]: On master: BEGIN
[0m21:20:48.013617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:48.015374 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m21:20:48.016042 [debug] [MainThread]: On master: COMMIT
[0m21:20:48.016340 [debug] [MainThread]: Using duckdb connection "master"
[0m21:20:48.016544 [debug] [MainThread]: On master: COMMIT
[0m21:20:48.017488 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:20:48.017837 [debug] [MainThread]: On master: Close
[0m21:20:48.018248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:48.018444 [debug] [MainThread]: Connection 'model.fpl_analytics.int_players' was properly closed.
[0m21:20:48.018678 [info ] [MainThread]: 
[0m21:20:48.018977 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m21:20:48.019549 [debug] [MainThread]: Command end result
[0m21:20:48.030956 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:20:48.032489 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:20:48.036561 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m21:20:48.036885 [info ] [MainThread]: 
[0m21:20:48.037301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:20:48.037536 [info ] [MainThread]: 
[0m21:20:48.037792 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:20:48.039359 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7553425, "process_in_blocks": "169016", "process_kernel_time": 0.40003, "process_mem_max_rss": "169348", "process_out_blocks": "5032", "process_user_time": 2.783543}
[0m21:20:48.039834 [debug] [MainThread]: Command `dbt build` succeeded at 21:20:48.039728 after 1.76 seconds
[0m21:20:48.040099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711defb255b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dedaea000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dedaeafc0>]}
[0m21:20:48.040357 [debug] [MainThread]: Flushing usage events
[0m21:20:48.480265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:08.810046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03f130ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03f0ab90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03f18532c0>]}


============================== 21:23:08.814638 | 4d611633-0b46-4303-a673-325df9ff1720 ==============================
[0m21:23:08.814638 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:23:08.815121 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'static_parser': 'True', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt build', 'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'profiles_dir': '/home/robgriffin247/fpl'}
[0m21:23:09.062892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d611633-0b46-4303-a673-325df9ff1720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03f0874470>]}
[0m21:23:09.136895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d611633-0b46-4303-a673-325df9ff1720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03f1709280>]}
[0m21:23:09.139343 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:23:09.198105 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:23:09.304050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:23:09.304584 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m21:23:09.581211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d611633-0b46-4303-a673-325df9ff1720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03e51a2780>]}
[0m21:23:09.636172 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:23:09.638611 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:23:09.673658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d611633-0b46-4303-a673-325df9ff1720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03e5168a70>]}
[0m21:23:09.674068 [info ] [MainThread]: Found 2 models, 6 sources, 445 macros
[0m21:23:09.675805 [info ] [MainThread]: 
[0m21:23:09.676253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:23:09.676503 [info ] [MainThread]: 
[0m21:23:09.676902 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:23:09.680586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m21:23:09.712354 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:23:09.712729 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:23:09.712942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:09.741871 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m21:23:09.743096 [debug] [ThreadPool]: On list_analytics: Close
[0m21:23:09.745863 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:23:09.746279 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:23:09.746515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:09.747756 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:09.748657 [debug] [ThreadPool]: On list_analytics: Close
[0m21:23:09.749318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m21:23:09.749684 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m21:23:09.813759 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:23:09.814180 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:23:09.814438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:09.815934 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:09.817102 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:23:09.817367 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m21:23:09.817995 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:09.818240 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:23:09.818440 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m21:23:09.818949 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:09.819642 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:23:09.819898 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:23:09.820121 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:23:09.821170 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:09.821458 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m21:23:09.822033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m21:23:09.822412 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m21:23:09.823708 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:23:09.824083 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:23:09.824315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:09.825577 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:09.826504 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:23:09.826731 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m21:23:09.827394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:09.827743 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:23:09.828008 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m21:23:09.828675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:09.829283 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:23:09.829513 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:23:09.829696 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:23:09.830126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:09.830356 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m21:23:09.832354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m21:23:09.836867 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:23:09.837579 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m21:23:09.837882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:09.838715 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:09.838968 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:23:09.839170 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m21:23:09.850705 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:23:09.851877 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m21:23:09.853360 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m21:23:09.853641 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m21:23:09.854248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m21:23:09.856079 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:23:09.856368 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m21:23:09.856559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:09.857570 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:09.857870 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:23:09.858066 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m21:23:09.861420 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:23:09.862691 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m21:23:09.863376 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m21:23:09.863592 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m21:23:09.864842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d611633-0b46-4303-a673-325df9ff1720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03bede3770>]}
[0m21:23:09.865256 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:09.865485 [debug] [MainThread]: On master: BEGIN
[0m21:23:09.865678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:09.866452 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:23:09.866717 [debug] [MainThread]: On master: COMMIT
[0m21:23:09.866917 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:09.867088 [debug] [MainThread]: On master: COMMIT
[0m21:23:09.867634 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:23:09.867893 [debug] [MainThread]: On master: Close
[0m21:23:09.871482 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m21:23:09.872034 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_players ............................... [RUN]
[0m21:23:09.872478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_players)
[0m21:23:09.872736 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m21:23:09.878316 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m21:23:09.878982 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m21:23:09.903587 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m21:23:09.904514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:23:09.904944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m21:23:09.905209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:09.906076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:09.906408 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:23:09.906685 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count,
    element_type,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
    
from "rawdb"."fpl"."elements"
    );
  
  
[0m21:23:09.918975 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m21:23:09.923205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:23:09.923701 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:23:09.924710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:09.925753 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:23:09.926021 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:23:09.928885 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:23:09.933752 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:23:09.934080 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m21:23:09.935585 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:09.937604 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:23:09.937933 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m21:23:09.938907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:09.951100 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:23:09.951494 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:23:09.951728 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:23:09.960112 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:23:09.964386 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:23:09.964725 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m21:23:09.969770 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:23:09.971978 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m21:23:09.974753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d611633-0b46-4303-a673-325df9ff1720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03e6a8e330>]}
[0m21:23:09.975346 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.10s]
[0m21:23:09.975872 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m21:23:09.976638 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m21:23:09.977052 [info ] [Thread-1 (]: 2 of 2 START sql table model intermediate.int_players .......................... [RUN]
[0m21:23:09.977758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.int_players)
[0m21:23:09.978046 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m21:23:09.980148 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m21:23:09.980596 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m21:23:09.982453 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m21:23:09.982902 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:23:09.983151 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m21:23:09.983393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:09.984127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:09.984382 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:23:09.984647 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select 
        can_transact,
        can_select,
        code,
        cost_change_event,
        cost_change_event_fall,
        cost_change_start,
        cost_change_start_fall,
        dreamteam_count,
        element_type,
        ep_next,
        ep_this,
        event_points,
        first_name,
        form,
        id,
        in_dreamteam,
        news,
        now_cost,
        photo,
        points_per_game,
        removed,
        second_name,
        selected_by_percent,
        special,
        status,
        team,
        team_code,
        total_points,
        transfers_in,
        transfers_in_event,
        transfers_out,
        transfers_out_event,
        value_form,
        value_season,
        web_name,
        region,
        team_join_date,
        birth_date,
        has_temporary_code,
        opta_code,
        minutes,
        goals_scored,
        assists,
        clean_sheets,
        goals_conceded,
        own_goals,
        penalties_saved,
        penalties_missed,
        yellow_cards,
        red_cards,
        saves,
        bonus,
        bps,
        influence,
        creativity,
        threat,
        ict_index,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        defensive_contribution,
        starts,
        expected_goals,
        expected_assists,
        expected_goal_involvements,
        expected_goals_conceded,
        influence_rank,
        influence_rank_type,
        creativity_rank,
        creativity_rank_type,
        threat_rank,
        threat_rank_type,
        ict_index_rank,
        ict_index_rank_type,
        corners_and_indirect_freekicks_text,
        direct_freekicks_text,
        penalties_text,
        expected_goals_per_90,
        saves_per_90,
        expected_assists_per_90,
        expected_goal_involvements_per_90,
        expected_goals_conceded_per_90,
        goals_conceded_per_90,
        now_cost_rank,
        now_cost_rank_type,
        form_rank,
        form_rank_type,
        points_per_game_rank,
        points_per_game_rank_type,
        selected_rank,
        selected_rank_type,
        starts_per_90,
        clean_sheets_per_90,
        defensive_contribution_per_90,
        _dlt_load_id,
        _dlt_id,
        chance_of_playing_next_round,
        chance_of_playing_this_round,
        news_added,
        corners_and_indirect_freekicks_order,
        direct_freekicks_order,
        penalties_order,
    from "analytics"."staging"."stg_players"
)

select * from source where can_select
    );
  
  
[0m21:23:09.998651 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m21:23:09.999596 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:23:09.999990 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m21:23:10.000878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:10.001884 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:23:10.002453 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m21:23:10.004374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:10.006810 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:23:10.007112 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m21:23:10.008568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:10.010592 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:23:10.010863 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m21:23:10.011563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:23:10.012599 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:23:10.012879 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:23:10.013103 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:23:10.021249 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:23:10.023978 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:23:10.024478 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m21:23:10.030105 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:23:10.031248 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m21:23:10.032105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d611633-0b46-4303-a673-325df9ff1720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03e69434d0>]}
[0m21:23:10.032599 [info ] [Thread-1 (]: 2 of 2 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.05s]
[0m21:23:10.033051 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m21:23:10.035417 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:10.035857 [debug] [MainThread]: On master: BEGIN
[0m21:23:10.036318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:23:10.037375 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:23:10.037739 [debug] [MainThread]: On master: COMMIT
[0m21:23:10.037978 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:10.038153 [debug] [MainThread]: On master: COMMIT
[0m21:23:10.038794 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:23:10.039198 [debug] [MainThread]: On master: Close
[0m21:23:10.039702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:10.040089 [debug] [MainThread]: Connection 'model.fpl_analytics.int_players' was properly closed.
[0m21:23:10.040449 [info ] [MainThread]: 
[0m21:23:10.040809 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:23:10.041658 [debug] [MainThread]: Command end result
[0m21:23:10.060082 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:23:10.061826 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:23:10.068819 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m21:23:10.069394 [info ] [MainThread]: 
[0m21:23:10.069938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:10.070409 [info ] [MainThread]: 
[0m21:23:10.070899 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:23:10.073546 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3245218, "process_in_blocks": "100128", "process_kernel_time": 0.448, "process_mem_max_rss": "168124", "process_out_blocks": "4816", "process_user_time": 2.708365}
[0m21:23:10.074220 [debug] [MainThread]: Command `dbt build` succeeded at 21:23:10.074080 after 1.33 seconds
[0m21:23:10.074724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03f111ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03f14d0b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a03e5140620>]}
[0m21:23:10.075206 [debug] [MainThread]: Flushing usage events
[0m21:23:10.633315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:46.517165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c63943df290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c63942f1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c63957f79b0>]}


============================== 21:41:46.520955 | 1faefdf6-da16-4678-9d80-4e2d4b630096 ==============================
[0m21:41:46.520955 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:41:46.522055 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'write_json': 'True', 'empty': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt build'}
[0m21:41:46.731423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1faefdf6-da16-4678-9d80-4e2d4b630096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6393a397c0>]}
[0m21:41:46.787929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1faefdf6-da16-4678-9d80-4e2d4b630096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6394959c10>]}
[0m21:41:46.789982 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:41:46.841890 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:41:46.935862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:41:46.936335 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m21:41:47.152110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1faefdf6-da16-4678-9d80-4e2d4b630096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6389a9b830>]}
[0m21:41:47.190527 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:41:47.192186 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:41:47.219013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1faefdf6-da16-4678-9d80-4e2d4b630096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c63899abaa0>]}
[0m21:41:47.219374 [info ] [MainThread]: Found 3 models, 6 sources, 445 macros
[0m21:41:47.220782 [info ] [MainThread]: 
[0m21:41:47.221095 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:41:47.221327 [info ] [MainThread]: 
[0m21:41:47.221676 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:41:47.225146 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m21:41:47.254460 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:41:47.254813 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:41:47.255015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:47.281646 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m21:41:47.282848 [debug] [ThreadPool]: On list_analytics: Close
[0m21:41:47.285396 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:41:47.285666 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:41:47.285880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:41:47.286849 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:41:47.287537 [debug] [ThreadPool]: On list_analytics: Close
[0m21:41:47.288242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m21:41:47.288620 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m21:41:47.339258 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:41:47.339580 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:41:47.339750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:41:47.341023 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:41:47.341851 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:41:47.342045 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m21:41:47.342443 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:41:47.342633 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:41:47.342775 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m21:41:47.343286 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:41:47.343798 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:41:47.343981 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:41:47.344164 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:41:47.346521 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:41:47.346766 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m21:41:47.347221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m21:41:47.347534 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m21:41:47.348674 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:41:47.348913 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:41:47.349121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:41:47.349968 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:41:47.350712 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:41:47.350899 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m21:41:47.351273 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:41:47.351457 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:41:47.351622 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m21:41:47.352020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:41:47.352522 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:41:47.352700 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:41:47.352848 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:41:47.353191 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:41:47.353378 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m21:41:47.354591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m21:41:47.357810 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:41:47.358077 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m21:41:47.358290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:41:47.358908 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:41:47.359116 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:41:47.359278 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m21:41:47.371002 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:41:47.372016 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m21:41:47.373753 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m21:41:47.373967 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m21:41:47.374930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m21:41:47.376080 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:41:47.376339 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m21:41:47.376548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:41:47.377531 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:41:47.377763 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:41:47.377924 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m21:41:47.380434 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:41:47.381645 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m21:41:47.382481 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m21:41:47.382779 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m21:41:47.383865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1faefdf6-da16-4678-9d80-4e2d4b630096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6388021160>]}
[0m21:41:47.384279 [debug] [MainThread]: Using duckdb connection "master"
[0m21:41:47.384470 [debug] [MainThread]: On master: BEGIN
[0m21:41:47.384623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:47.385103 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:41:47.385289 [debug] [MainThread]: On master: COMMIT
[0m21:41:47.385466 [debug] [MainThread]: Using duckdb connection "master"
[0m21:41:47.385616 [debug] [MainThread]: On master: COMMIT
[0m21:41:47.385970 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:41:47.386152 [debug] [MainThread]: On master: Close
[0m21:41:47.389639 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m21:41:47.390016 [info ] [Thread-1 (]: 1 of 3 START sql table model staging.stg_players ............................... [RUN]
[0m21:41:47.390407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_players)
[0m21:41:47.390631 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m21:41:47.395641 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m21:41:47.396824 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m21:41:47.417460 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m21:41:47.418089 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:41:47.418356 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m21:41:47.418548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:41:47.419292 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:41:47.419527 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:41:47.419759 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count,
    element_type,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
    
from "rawdb"."fpl"."elements"
    );
  
  
[0m21:41:47.431663 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m21:41:47.435673 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:41:47.436002 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:41:47.436926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:41:47.437698 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:41:47.437914 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:41:47.442739 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:41:47.446919 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:41:47.447165 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m21:41:47.448662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:41:47.450230 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:41:47.450464 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m21:41:47.451000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:41:47.461110 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:41:47.461434 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:41:47.461691 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:41:47.472019 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m21:41:47.475919 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:41:47.476242 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m21:41:47.482482 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:41:47.484771 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m21:41:47.486811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1faefdf6-da16-4678-9d80-4e2d4b630096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c639624a570>]}
[0m21:41:47.487274 [info ] [Thread-1 (]: 1 of 3 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.10s]
[0m21:41:47.487697 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m21:41:47.487976 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m21:41:47.488358 [info ] [Thread-1 (]: 2 of 3 START sql table model staging.stg_teams ................................. [RUN]
[0m21:41:47.489066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m21:41:47.489349 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m21:41:47.491496 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m21:41:47.492107 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m21:41:47.493989 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m21:41:47.494462 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:41:47.494690 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m21:41:47.494880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:41:47.495602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:41:47.495819 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:41:47.496019 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    *
    
from "rawdb"."fpl"."teams"
    );
  
  
[0m21:41:47.498319 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:41:47.500155 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:41:47.500406 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m21:41:47.500965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:41:47.501801 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m21:41:47.502069 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:41:47.502284 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m21:41:47.508226 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:41:47.510019 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:41:47.510317 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m21:41:47.511047 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:41:47.511989 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m21:41:47.512599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1faefdf6-da16-4678-9d80-4e2d4b630096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6389b8da30>]}
[0m21:41:47.513036 [info ] [Thread-1 (]: 2 of 3 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.02s]
[0m21:41:47.513449 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m21:41:47.513757 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m21:41:47.514094 [info ] [Thread-1 (]: 3 of 3 START sql table model intermediate.int_players .......................... [RUN]
[0m21:41:47.514574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m21:41:47.515020 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m21:41:47.517350 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m21:41:47.518015 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m21:41:47.519806 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m21:41:47.520301 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:41:47.520547 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m21:41:47.520742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:41:47.521601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:41:47.522097 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:41:47.522619 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select 
        can_transact,
        can_select,
        code,
        cost_change_event,
        cost_change_event_fall,
        cost_change_start,
        cost_change_start_fall,
        dreamteam_count,
        element_type,
        ep_next,
        ep_this,
        event_points,
        first_name,
        form,
        id,
        in_dreamteam,
        news,
        now_cost,
        photo,
        points_per_game,
        removed,
        second_name,
        selected_by_percent,
        special,
        status,
        team,
        team_code,
        total_points,
        transfers_in,
        transfers_in_event,
        transfers_out,
        transfers_out_event,
        value_form,
        value_season,
        web_name,
        region,
        team_join_date,
        birth_date,
        has_temporary_code,
        opta_code,
        minutes,
        goals_scored,
        assists,
        clean_sheets,
        goals_conceded,
        own_goals,
        penalties_saved,
        penalties_missed,
        yellow_cards,
        red_cards,
        saves,
        bonus,
        bps,
        influence,
        creativity,
        threat,
        ict_index,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        defensive_contribution,
        starts,
        expected_goals,
        expected_assists,
        expected_goal_involvements,
        expected_goals_conceded,
        influence_rank,
        influence_rank_type,
        creativity_rank,
        creativity_rank_type,
        threat_rank,
        threat_rank_type,
        ict_index_rank,
        ict_index_rank_type,
        corners_and_indirect_freekicks_text,
        direct_freekicks_text,
        penalties_text,
        expected_goals_per_90,
        saves_per_90,
        expected_assists_per_90,
        expected_goal_involvements_per_90,
        expected_goals_conceded_per_90,
        goals_conceded_per_90,
        now_cost_rank,
        now_cost_rank_type,
        form_rank,
        form_rank_type,
        points_per_game_rank,
        points_per_game_rank_type,
        selected_rank,
        selected_rank_type,
        starts_per_90,
        clean_sheets_per_90,
        defensive_contribution_per_90,
        _dlt_load_id,
        _dlt_id,
        chance_of_playing_next_round,
        chance_of_playing_this_round,
        news_added,
        corners_and_indirect_freekicks_order,
        direct_freekicks_order,
        penalties_order,
    from "analytics"."staging"."stg_players"
)

select * from source where can_select
    );
  
  
[0m21:41:47.530810 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:41:47.531816 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:41:47.532100 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m21:41:47.532997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:41:47.533783 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:41:47.533990 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m21:41:47.534869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:41:47.536988 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:41:47.537266 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m21:41:47.538100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:41:47.540330 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:41:47.540651 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m21:41:47.541395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:41:47.542249 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:41:47.542499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:41:47.542680 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:41:47.551153 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:41:47.552796 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:41:47.553055 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m21:41:47.558816 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:41:47.560554 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m21:41:47.561243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1faefdf6-da16-4678-9d80-4e2d4b630096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6389b8da30>]}
[0m21:41:47.561668 [info ] [Thread-1 (]: 3 of 3 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.05s]
[0m21:41:47.562072 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m21:41:47.563561 [debug] [MainThread]: Using duckdb connection "master"
[0m21:41:47.563811 [debug] [MainThread]: On master: BEGIN
[0m21:41:47.563997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:41:47.564950 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:41:47.565306 [debug] [MainThread]: On master: COMMIT
[0m21:41:47.565601 [debug] [MainThread]: Using duckdb connection "master"
[0m21:41:47.565871 [debug] [MainThread]: On master: COMMIT
[0m21:41:47.566793 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:41:47.567165 [debug] [MainThread]: On master: Close
[0m21:41:47.567650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:47.567869 [debug] [MainThread]: Connection 'model.fpl_analytics.int_players' was properly closed.
[0m21:41:47.568185 [info ] [MainThread]: 
[0m21:41:47.568458 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:41:47.569112 [debug] [MainThread]: Command end result
[0m21:41:47.581152 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:41:47.582407 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:41:47.586454 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m21:41:47.586770 [info ] [MainThread]: 
[0m21:41:47.587043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:41:47.587358 [info ] [MainThread]: 
[0m21:41:47.587601 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:41:47.589619 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.1230515, "process_in_blocks": "58040", "process_kernel_time": 0.247381, "process_mem_max_rss": "167268", "process_out_blocks": "4880", "process_user_time": 2.213856}
[0m21:41:47.589977 [debug] [MainThread]: Command `dbt build` succeeded at 21:41:47.589907 after 1.12 seconds
[0m21:41:47.590336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c639424ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6389caa960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6379dbc830>]}
[0m21:41:47.590583 [debug] [MainThread]: Flushing usage events
[0m21:41:48.102717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:30.130584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a46693cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a466436570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4663e62a0>]}


============================== 21:50:30.134808 | ecb22648-df98-443a-9745-a44c28b405a3 ==============================
[0m21:50:30.134808 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:50:30.135223 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'empty': 'False', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt build', 'log_format': 'default', 'no_print': 'None', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'printer_width': '80', 'log_path': '/home/robgriffin247/fpl/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None'}
[0m21:50:30.343822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb22648-df98-443a-9745-a44c28b405a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4659ca570>]}
[0m21:50:30.399872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb22648-df98-443a-9745-a44c28b405a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a465b49a00>]}
[0m21:50:30.402283 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:50:30.455641 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:50:30.541091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m21:50:30.541493 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.sql
[0m21:50:30.541759 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m21:50:30.542021 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m21:50:30.542253 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m21:50:30.753388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb22648-df98-443a-9745-a44c28b405a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a45baf3f80>]}
[0m21:50:30.791595 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:50:30.793274 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:50:30.819809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb22648-df98-443a-9745-a44c28b405a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a45b947320>]}
[0m21:50:30.820187 [info ] [MainThread]: Found 4 models, 6 sources, 445 macros
[0m21:50:30.821631 [info ] [MainThread]: 
[0m21:50:30.821944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:30.822181 [info ] [MainThread]: 
[0m21:50:30.822534 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:50:30.826209 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m21:50:30.855362 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:50:30.855709 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:50:30.855913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:30.890120 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m21:50:30.891390 [debug] [ThreadPool]: On list_analytics: Close
[0m21:50:30.893970 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:50:30.894295 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:50:30.894532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:30.895967 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:30.896789 [debug] [ThreadPool]: On list_analytics: Close
[0m21:50:30.897389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m21:50:30.897747 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m21:50:30.945400 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:50:30.945714 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:50:30.945956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:30.947082 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:30.947986 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:50:30.948199 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m21:50:30.948609 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:30.948791 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:50:30.948950 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m21:50:30.949336 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:30.949872 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:50:30.950055 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:50:30.950204 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:50:30.952678 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:50:30.953109 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m21:50:30.953840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m21:50:30.954357 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m21:50:30.955808 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:50:30.956076 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:50:30.956302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:30.957260 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:30.958016 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:50:30.958232 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m21:50:30.958630 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:30.958828 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:50:30.958982 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m21:50:30.959388 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:30.959896 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:50:30.960128 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:50:30.960287 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:50:30.960634 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:30.960841 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m21:50:30.962204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m21:50:30.965456 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:50:30.965727 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m21:50:30.966021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:30.966641 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:30.966833 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:50:30.966996 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m21:50:30.977588 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:50:30.978444 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m21:50:30.980097 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m21:50:30.980335 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m21:50:30.981305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m21:50:30.982361 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:50:30.982590 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m21:50:30.982793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:30.983633 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:30.983833 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:50:30.983995 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m21:50:30.986254 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:50:30.987031 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m21:50:30.987602 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m21:50:30.987777 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m21:50:30.988787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb22648-df98-443a-9745-a44c28b405a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a465b48ce0>]}
[0m21:50:30.989083 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:30.989251 [debug] [MainThread]: On master: BEGIN
[0m21:50:30.989396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:30.989824 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:30.990004 [debug] [MainThread]: On master: COMMIT
[0m21:50:30.990150 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:30.990282 [debug] [MainThread]: On master: COMMIT
[0m21:50:30.990664 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:30.990850 [debug] [MainThread]: On master: Close
[0m21:50:30.994359 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m21:50:30.994734 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_players ............................... [RUN]
[0m21:50:30.995069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_players)
[0m21:50:30.995345 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m21:50:31.000288 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m21:50:31.000744 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m21:50:31.021453 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m21:50:31.021988 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:31.022244 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m21:50:31.022432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:31.023138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.023378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:31.023586 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count,
    element_type,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team::int as team_id,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
    
from "rawdb"."fpl"."elements"
    );
  
  
[0m21:50:31.034556 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m21:50:31.038111 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:31.038381 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:50:31.039148 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.039955 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:31.040173 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:50:31.043872 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:31.048093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:31.048349 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m21:50:31.049828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.051514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:31.051741 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m21:50:31.052574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:31.062769 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:50:31.063105 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:31.063352 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:50:31.072606 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:50:31.076441 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:31.076719 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m21:50:31.082695 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:50:31.084630 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m21:50:31.086668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb22648-df98-443a-9745-a44c28b405a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a46690cd40>]}
[0m21:50:31.087124 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.09s]
[0m21:50:31.087578 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m21:50:31.087878 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m21:50:31.088206 [info ] [Thread-1 (]: 2 of 4 START sql table model staging.stg_teams ................................. [RUN]
[0m21:50:31.088970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m21:50:31.089223 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m21:50:31.091214 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m21:50:31.091748 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m21:50:31.093515 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m21:50:31.093920 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:31.094146 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m21:50:31.094370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:31.095072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.095325 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:31.095519 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    id::int as team_id,
    name::varchar as team_name,
    short_name::varchar as team_abbreviation,
    strength::int as team_strength_rating,
    strength_defence_home::int as strength_defence_home,
    strength_attack_home::int as strength_attack_home,
    strength_defence_away::int as strength_defence_away,
    strength_attack_away::int as strength_attack_away    
from "rawdb"."fpl"."teams"
    );
  
  
[0m21:50:31.098506 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:31.099799 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:31.100332 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m21:50:31.101144 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.101897 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:31.102110 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m21:50:31.103207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.105135 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:31.105360 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m21:50:31.106153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.108375 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:31.108622 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m21:50:31.109227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:31.110013 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m21:50:31.110227 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:31.110400 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m21:50:31.116126 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:50:31.118002 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:31.118307 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m21:50:31.123131 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:50:31.124651 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m21:50:31.125244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb22648-df98-443a-9745-a44c28b405a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a45bc16c00>]}
[0m21:50:31.125691 [info ] [Thread-1 (]: 2 of 4 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.04s]
[0m21:50:31.126154 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m21:50:31.126447 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m21:50:31.126810 [info ] [Thread-1 (]: 3 of 4 START sql table model intermediate.int_players .......................... [RUN]
[0m21:50:31.127607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m21:50:31.127845 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m21:50:31.129609 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m21:50:31.130018 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m21:50:31.132063 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m21:50:31.132762 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:31.133058 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m21:50:31.133356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:31.134530 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.134799 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:31.135010 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select 
        id,
        web_name,
        form,
        now_cost,
        team_id
    from "analytics"."staging"."stg_players"
),

teams as (
    select
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        strength_defence_home,
        strength_attack_home,
        strength_defence_away,
        strength_attack_away   
    from teams
),

join_teams as (
    select 
        players.*,
        teams.*
    from players left join teams using(team_id)
)

select * from join_teams
    );
  
  
[0m21:50:31.144401 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select 
        id,
        web_name,
        form,
        now_cost,
        team_id
    from "analytics"."staging"."stg_players"
),

teams as (
    select
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        strength_defence_home,
        strength_attack_home,
        strength_defence_away,
        strength_attack_away   
    from teams
),

join_teams as (
    select 
        players.*,
        teams.*
    from players left join teams using(team_id)
)

select * from join_teams
    );
  
  
[0m21:50:31.144768 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:50:31.145085 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m21:50:31.152350 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m21:50:31.152728 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m21:50:31.154441 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name teams does not exist!
  Did you mean "rawdb.fpl.teams"?
  
  LINE 32:     from teams
                    ^
[0m21:50:31.154917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb22648-df98-443a-9745-a44c28b405a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a403db9340>]}
[0m21:50:31.155463 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model intermediate.int_players ................. [[31mERROR[0m in 0.03s]
[0m21:50:31.155913 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m21:50:31.156197 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m21:50:31.156535 [info ] [Thread-1 (]: 4 of 4 START sql table model intermediate.int_teams ............................ [RUN]
[0m21:50:31.157245 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name teams does not exist!
  Did you mean "rawdb.fpl.teams"?
  
  LINE 32:     from teams
                    ^.
[0m21:50:31.158070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_teams)
[0m21:50:31.158840 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m21:50:31.160926 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m21:50:31.161416 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m21:50:31.163401 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m21:50:31.164195 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:31.164579 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m21:50:31.164843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:31.165936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.166334 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:31.166672 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select 
        *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m21:50:31.168644 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:50:31.172630 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:31.172907 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m21:50:31.173667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:31.174437 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m21:50:31.174663 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:31.174845 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m21:50:31.181306 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:50:31.183079 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:31.183411 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m21:50:31.184261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:31.185606 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m21:50:31.186583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb22648-df98-443a-9745-a44c28b405a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a403c9a1b0>]}
[0m21:50:31.187369 [info ] [Thread-1 (]: 4 of 4 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.03s]
[0m21:50:31.187830 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m21:50:31.189944 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:31.190209 [debug] [MainThread]: On master: BEGIN
[0m21:50:31.190384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:50:31.191019 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:50:31.191321 [debug] [MainThread]: On master: COMMIT
[0m21:50:31.191515 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:31.191674 [debug] [MainThread]: On master: COMMIT
[0m21:50:31.192110 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:31.192310 [debug] [MainThread]: On master: Close
[0m21:50:31.192616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:31.192792 [debug] [MainThread]: Connection 'model.fpl_analytics.int_teams' was properly closed.
[0m21:50:31.193000 [info ] [MainThread]: 
[0m21:50:31.193233 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:50:31.193900 [debug] [MainThread]: Command end result
[0m21:50:31.205080 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:50:31.206426 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:50:31.210423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m21:50:31.210709 [info ] [MainThread]: 
[0m21:50:31.210982 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:50:31.211254 [info ] [MainThread]: 
[0m21:50:31.211535 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m21:50:31.211803 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name teams does not exist!
  Did you mean "rawdb.fpl.teams"?
  
  LINE 32:     from teams
                    ^
[0m21:50:31.212037 [info ] [MainThread]: 
[0m21:50:31.212291 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m21:50:31.212523 [info ] [MainThread]: 
[0m21:50:31.212776 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m21:50:31.214262 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1329178, "process_in_blocks": "111176", "process_kernel_time": 0.298546, "process_mem_max_rss": "166124", "process_out_blocks": "4040", "process_user_time": 2.259828}
[0m21:50:31.214567 [debug] [MainThread]: Command `dbt build` failed at 21:50:31.214502 after 1.13 seconds
[0m21:50:31.214805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a466436570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a45ba19460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a45bb94e30>]}
[0m21:50:31.215031 [debug] [MainThread]: Flushing usage events
[0m21:50:31.665819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:53.069161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6bb9b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6beaaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6e145580>]}


============================== 21:50:53.071760 | 44f812cb-808d-489f-a781-07e86d5681a2 ==============================
[0m21:50:53.071760 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:50:53.072184 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'empty': 'False', 'write_json': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/robgriffin247/fpl', 'introspect': 'True', 'invocation_command': 'dbt build', 'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m21:50:53.254785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44f812cb-808d-489f-a781-07e86d5681a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff61956300>]}
[0m21:50:53.308062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44f812cb-808d-489f-a781-07e86d5681a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6bc488f0>]}
[0m21:50:53.309117 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:50:53.355856 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:50:53.413250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:50:53.413628 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m21:50:53.620240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44f812cb-808d-489f-a781-07e86d5681a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff613c6ed0>]}
[0m21:50:53.657965 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:50:53.659151 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:50:53.674118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44f812cb-808d-489f-a781-07e86d5681a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff61612ae0>]}
[0m21:50:53.674471 [info ] [MainThread]: Found 4 models, 6 sources, 445 macros
[0m21:50:53.675865 [info ] [MainThread]: 
[0m21:50:53.676150 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:53.676367 [info ] [MainThread]: 
[0m21:50:53.676707 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:50:53.680482 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m21:50:53.702211 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:50:53.702569 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:50:53.702761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:53.719708 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m21:50:53.720658 [debug] [ThreadPool]: On list_analytics: Close
[0m21:50:53.723033 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:50:53.723432 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:50:53.723764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:53.725180 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:53.726141 [debug] [ThreadPool]: On list_analytics: Close
[0m21:50:53.726919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m21:50:53.727268 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m21:50:53.779776 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:50:53.780130 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:50:53.780367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:53.781471 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:53.782429 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:50:53.782667 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m21:50:53.783118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:53.783362 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:50:53.783549 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m21:50:53.783980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:53.784606 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:50:53.784838 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:50:53.785023 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:50:53.785440 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:53.785647 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m21:50:53.786133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m21:50:53.786468 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m21:50:53.787646 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:50:53.787904 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:50:53.788131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:53.788965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:53.789874 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:50:53.790110 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m21:50:53.790507 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:53.790703 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:50:53.790871 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m21:50:53.791292 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:53.791884 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:50:53.792103 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:50:53.792356 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:50:53.792751 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:53.792967 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m21:50:53.794218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m21:50:53.797892 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:50:53.798179 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m21:50:53.798393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:53.799042 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:53.799274 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:50:53.799473 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m21:50:53.807412 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:50:53.808513 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m21:50:53.809295 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m21:50:53.809522 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m21:50:53.810633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m21:50:53.811871 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:50:53.812137 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m21:50:53.812358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:53.813422 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:53.813649 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:50:53.813832 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m21:50:53.817623 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:50:53.818718 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m21:50:53.819455 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m21:50:53.819693 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m21:50:53.820824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f812cb-808d-489f-a781-07e86d5681a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6dd520f0>]}
[0m21:50:53.821183 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:53.821385 [debug] [MainThread]: On master: BEGIN
[0m21:50:53.821553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:53.822127 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:50:53.822340 [debug] [MainThread]: On master: COMMIT
[0m21:50:53.822551 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:53.822714 [debug] [MainThread]: On master: COMMIT
[0m21:50:53.823137 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:53.823392 [debug] [MainThread]: On master: Close
[0m21:50:53.825720 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m21:50:53.826113 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_players ............................... [RUN]
[0m21:50:53.826478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_players)
[0m21:50:53.826727 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m21:50:53.832214 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m21:50:53.832900 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m21:50:53.856409 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m21:50:53.857009 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:53.857276 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m21:50:53.857467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:53.858141 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.858398 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:53.858665 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count,
    element_type,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team::int as team_id,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
    
from "rawdb"."fpl"."elements"
    );
  
  
[0m21:50:53.869389 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m21:50:53.873355 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:53.873659 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:50:53.874461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.875422 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:53.875666 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:50:53.876675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.881539 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:53.881912 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m21:50:53.882835 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.884883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:53.885230 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m21:50:53.886088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.898464 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:50:53.898813 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:53.899110 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:50:53.908122 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:50:53.912458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:50:53.912761 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m21:50:53.918081 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:50:53.920342 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m21:50:53.922293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f812cb-808d-489f-a781-07e86d5681a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6c3582c0>]}
[0m21:50:53.922789 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.10s]
[0m21:50:53.923283 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m21:50:53.923607 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m21:50:53.923956 [info ] [Thread-1 (]: 2 of 4 START sql table model staging.stg_teams ................................. [RUN]
[0m21:50:53.924325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m21:50:53.924585 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m21:50:53.926628 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m21:50:53.927419 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m21:50:53.929315 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m21:50:53.929780 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:53.930030 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m21:50:53.930230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:53.931286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.931574 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:53.931801 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    id::int as team_id,
    name::varchar as team_name,
    short_name::varchar as team_abbreviation,
    strength::int as team_strength_rating,
    strength_defence_home::int as strength_defence_home,
    strength_attack_home::int as strength_attack_home,
    strength_defence_away::int as strength_defence_away,
    strength_attack_away::int as strength_attack_away    
from "rawdb"."fpl"."teams"
    );
  
  
[0m21:50:53.934362 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:50:53.935291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:53.935581 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m21:50:53.936429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.937436 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:53.937688 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m21:50:53.938591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.940683 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:53.940974 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m21:50:53.941544 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:53.943339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:53.943602 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m21:50:53.944148 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:53.945074 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m21:50:53.945334 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:53.945537 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m21:50:53.951073 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:50:53.952936 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:50:53.953213 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m21:50:53.957905 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:50:53.959345 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m21:50:53.959919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f812cb-808d-489f-a781-07e86d5681a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6b3e7d70>]}
[0m21:50:53.960366 [info ] [Thread-1 (]: 2 of 4 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.04s]
[0m21:50:53.960799 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m21:50:53.961634 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m21:50:53.962030 [info ] [Thread-1 (]: 3 of 4 START sql table model intermediate.int_players .......................... [RUN]
[0m21:50:53.962392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m21:50:53.962654 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m21:50:53.964961 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m21:50:53.965521 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m21:50:53.967809 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m21:50:53.968271 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:53.968513 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m21:50:53.968719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:53.969433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.969660 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:53.969868 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select 
        id,
        web_name,
        form,
        now_cost,
        team_id
    from "analytics"."staging"."stg_players"
),

teams as (
    select
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        strength_defence_home,
        strength_attack_home,
        strength_defence_away,
        strength_attack_away   
    from "analytics"."staging"."stg_teams"
),

join_teams as (
    select 
        players.*,
        teams.*
    from players left join teams using(team_id)
)

select * from join_teams
    );
  
  
[0m21:50:53.976166 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:50:53.977016 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:53.977271 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m21:50:53.978031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.978871 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:53.979127 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m21:50:53.980416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:53.982548 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:53.982822 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m21:50:53.983544 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:53.985321 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:53.985615 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m21:50:53.986176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:53.987027 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:50:53.987338 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:53.987566 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:50:53.993617 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:50:53.996526 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:50:53.996860 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m21:50:54.002976 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:50:54.004625 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m21:50:54.005343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f812cb-808d-489f-a781-07e86d5681a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff41ae2240>]}
[0m21:50:54.005799 [info ] [Thread-1 (]: 3 of 4 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.04s]
[0m21:50:54.006208 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m21:50:54.006489 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m21:50:54.007094 [info ] [Thread-1 (]: 4 of 4 START sql table model intermediate.int_teams ............................ [RUN]
[0m21:50:54.007510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_teams)
[0m21:50:54.007743 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m21:50:54.009578 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m21:50:54.010014 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m21:50:54.011904 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m21:50:54.012497 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:54.012777 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m21:50:54.012982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:54.013710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.013964 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:54.014173 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select 
        *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m21:50:54.015738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.016575 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:54.016837 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m21:50:54.017621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.018568 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:54.018810 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m21:50:54.019890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.022736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:54.023129 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m21:50:54.024261 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:54.026978 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:54.027551 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m21:50:54.028684 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:54.029674 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m21:50:54.029927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:54.030125 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m21:50:54.037862 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:50:54.039912 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:50:54.040245 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m21:50:54.046490 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:50:54.048615 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m21:50:54.049903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f812cb-808d-489f-a781-07e86d5681a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff41a4db80>]}
[0m21:50:54.050594 [info ] [Thread-1 (]: 4 of 4 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.04s]
[0m21:50:54.051276 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m21:50:54.053651 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:54.054088 [debug] [MainThread]: On master: BEGIN
[0m21:50:54.054355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:50:54.055212 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:50:54.055612 [debug] [MainThread]: On master: COMMIT
[0m21:50:54.055891 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:54.056140 [debug] [MainThread]: On master: COMMIT
[0m21:50:54.056713 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:54.057017 [debug] [MainThread]: On master: Close
[0m21:50:54.057446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:54.057775 [debug] [MainThread]: Connection 'model.fpl_analytics.int_teams' was properly closed.
[0m21:50:54.058088 [info ] [MainThread]: 
[0m21:50:54.058398 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:50:54.059678 [debug] [MainThread]: Command end result
[0m21:50:54.073677 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:50:54.074954 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:50:54.079191 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m21:50:54.079471 [info ] [MainThread]: 
[0m21:50:54.079707 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:50:54.079933 [info ] [MainThread]: 
[0m21:50:54.080168 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:50:54.080840 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0612549, "process_in_blocks": "1944", "process_kernel_time": 0.208566, "process_mem_max_rss": "167544", "process_out_blocks": "4168", "process_user_time": 2.235834}
[0m21:50:54.081182 [debug] [MainThread]: Command `dbt build` succeeded at 21:50:54.081114 after 1.06 seconds
[0m21:50:54.081413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6d130080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6defddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ff6b3e4c50>]}
[0m21:50:54.081654 [debug] [MainThread]: Flushing usage events
[0m21:50:54.502199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:47.862295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743dfc3406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743dfc326330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743dfc325670>]}


============================== 21:51:47.865062 | 7c35c87e-479a-4306-ade6-7865619fe9c5 ==============================
[0m21:51:47.865062 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:51:47.865486 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'empty': 'False', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'profiles_dir': '/home/robgriffin247/fpl'}
[0m21:51:48.054199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c35c87e-479a-4306-ade6-7865619fe9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743df17d48f0>]}
[0m21:51:48.112909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c35c87e-479a-4306-ade6-7865619fe9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743dfb3b0560>]}
[0m21:51:48.114093 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:51:48.161445 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:51:48.222558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:51:48.223071 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m21:51:48.223371 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m21:51:48.441935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c35c87e-479a-4306-ade6-7865619fe9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743df15ce450>]}
[0m21:51:48.486113 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:51:48.487799 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:51:48.505965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c35c87e-479a-4306-ade6-7865619fe9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743df115e1b0>]}
[0m21:51:48.506373 [info ] [MainThread]: Found 4 models, 6 sources, 445 macros
[0m21:51:48.507948 [info ] [MainThread]: 
[0m21:51:48.508346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:48.508649 [info ] [MainThread]: 
[0m21:51:48.509079 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:51:48.512779 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m21:51:48.534131 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:51:48.534447 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:51:48.534627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:48.551054 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:51:48.552404 [debug] [ThreadPool]: On list_analytics: Close
[0m21:51:48.555442 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m21:51:48.556055 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m21:51:48.556427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:48.558285 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:51:48.559508 [debug] [ThreadPool]: On list_analytics: Close
[0m21:51:48.560252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m21:51:48.560546 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m21:51:48.611260 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:51:48.611619 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:51:48.611836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:48.612961 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:48.613893 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:51:48.614110 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m21:51:48.614514 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:48.614698 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:51:48.614843 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m21:51:48.615279 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:48.615897 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:51:48.616104 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m21:51:48.616266 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m21:51:48.616654 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:48.616859 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m21:51:48.617373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m21:51:48.617726 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m21:51:48.618937 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:51:48.619241 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m21:51:48.619468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:48.620422 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:48.621276 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:51:48.621511 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m21:51:48.622137 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:48.622467 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:51:48.622749 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m21:51:48.623630 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:48.624195 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:51:48.624384 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m21:51:48.624538 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m21:51:48.624905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:51:48.625110 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m21:51:48.626352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m21:51:48.629766 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:51:48.630024 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m21:51:48.630235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:48.630833 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:48.631051 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m21:51:48.631253 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m21:51:48.638836 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:51:48.639953 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m21:51:48.640720 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m21:51:48.640945 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m21:51:48.641957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m21:51:48.643098 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:51:48.643384 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m21:51:48.643589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:48.644444 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:51:48.644642 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m21:51:48.644802 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m21:51:48.647001 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:51:48.647854 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m21:51:48.648380 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m21:51:48.648580 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m21:51:48.649655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c35c87e-479a-4306-ade6-7865619fe9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743df123b9b0>]}
[0m21:51:48.649981 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:48.650202 [debug] [MainThread]: On master: BEGIN
[0m21:51:48.650350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:48.650961 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:51:48.651254 [debug] [MainThread]: On master: COMMIT
[0m21:51:48.651504 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:48.651681 [debug] [MainThread]: On master: COMMIT
[0m21:51:48.652118 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:48.652328 [debug] [MainThread]: On master: Close
[0m21:51:48.654424 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m21:51:48.654809 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_players ............................... [RUN]
[0m21:51:48.655190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_players)
[0m21:51:48.655438 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m21:51:48.660583 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m21:51:48.661175 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m21:51:48.682852 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m21:51:48.683747 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:51:48.684036 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m21:51:48.684250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:48.685016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.685300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:51:48.685523 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count,
    element_type,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team::int as team_id,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
    
from "rawdb"."fpl"."elements"
    );
  
  
[0m21:51:48.694294 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:51:48.698334 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:51:48.698728 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:51:48.699780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.700795 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:51:48.701053 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m21:51:48.702190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.706691 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:51:48.706965 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m21:51:48.707948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.709625 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:51:48.709880 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m21:51:48.710424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:48.721753 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:51:48.722155 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:51:48.722410 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m21:51:48.730746 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:51:48.734739 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m21:51:48.735031 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m21:51:48.740349 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:51:48.742767 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m21:51:48.744649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c35c87e-479a-4306-ade6-7865619fe9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743df137eff0>]}
[0m21:51:48.745195 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.09s]
[0m21:51:48.745672 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m21:51:48.745980 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m21:51:48.746323 [info ] [Thread-1 (]: 2 of 4 START sql table model staging.stg_teams ................................. [RUN]
[0m21:51:48.746728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m21:51:48.746986 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m21:51:48.748951 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m21:51:48.749608 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m21:51:48.751453 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m21:51:48.751886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:51:48.752115 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m21:51:48.752305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:48.752993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.753228 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:51:48.753427 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    id::int as team_id,
    name::varchar as team_name,
    short_name::varchar as team_abbreviation,
    strength::int as team_strength_rating,
    strength_defence_home::int as team_strength_defence_home,
    strength_attack_home::int as team_strength_attack_home,
    strength_defence_away::int as team_strength_defence_away,
    strength_attack_away::int as team_strength_attack_away    
from "rawdb"."fpl"."teams"
    );
  
  
[0m21:51:48.754948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.755699 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:51:48.755932 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m21:51:48.756584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:48.757419 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:51:48.757680 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m21:51:48.758732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.761321 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:51:48.761674 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m21:51:48.762473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.764267 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:51:48.764516 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m21:51:48.765065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:48.765938 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m21:51:48.766172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:51:48.766361 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m21:51:48.771804 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:51:48.773239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m21:51:48.773510 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m21:51:48.778663 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:51:48.779996 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m21:51:48.780620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c35c87e-479a-4306-ade6-7865619fe9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743df137d0d0>]}
[0m21:51:48.781082 [info ] [Thread-1 (]: 2 of 4 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.03s]
[0m21:51:48.781499 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m21:51:48.782797 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m21:51:48.783244 [info ] [Thread-1 (]: 3 of 4 START sql table model intermediate.int_players .......................... [RUN]
[0m21:51:48.783635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m21:51:48.783874 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m21:51:48.785915 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m21:51:48.786355 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m21:51:48.788270 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m21:51:48.788684 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:51:48.788909 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m21:51:48.789103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:48.789778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.789991 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:51:48.790207 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select 
        id,
        web_name,
        form,
        now_cost,
        team_id
    from "analytics"."staging"."stg_players"
),

teams as (
    select
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        team_strength_defence_home,
        team_strength_attack_home,
        team_strength_defence_away,
        team_strength_attack_away   
    from "analytics"."staging"."stg_teams"
),

join_teams as (
    select 
        players.*,
        teams.*
    from players left join teams using(team_id)
)

select * from join_teams
    );
  
  
[0m21:51:48.793996 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:51:48.794980 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:51:48.795354 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m21:51:48.796190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.797037 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:51:48.797271 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m21:51:48.798469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.800740 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:51:48.800998 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m21:51:48.801724 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:48.803980 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:51:48.804227 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m21:51:48.804781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:48.805765 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:51:48.805987 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:51:48.806161 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m21:51:48.812050 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:51:48.815152 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m21:51:48.815534 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m21:51:48.820010 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:51:48.821005 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m21:51:48.821587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c35c87e-479a-4306-ade6-7865619fe9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743de94067e0>]}
[0m21:51:48.822006 [info ] [Thread-1 (]: 3 of 4 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.04s]
[0m21:51:48.822464 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m21:51:48.822746 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m21:51:48.823365 [info ] [Thread-1 (]: 4 of 4 START sql table model intermediate.int_teams ............................ [RUN]
[0m21:51:48.823792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_teams)
[0m21:51:48.824057 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m21:51:48.826147 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m21:51:48.826752 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m21:51:48.828658 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m21:51:48.829187 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:51:48.829420 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m21:51:48.829612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:48.830562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.830842 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:51:48.831109 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select 
        *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m21:51:48.832367 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.833130 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:51:48.833354 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m21:51:48.834051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:51:48.834983 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:51:48.835305 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m21:51:48.836597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.838865 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:51:48.839228 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m21:51:48.840093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.842585 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:51:48.842918 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m21:51:48.843989 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:51:48.844976 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m21:51:48.845274 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:51:48.845480 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m21:51:48.851082 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:51:48.852863 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m21:51:48.853136 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m21:51:48.858782 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:51:48.860055 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m21:51:48.860899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c35c87e-479a-4306-ade6-7865619fe9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743df1385eb0>]}
[0m21:51:48.861363 [info ] [Thread-1 (]: 4 of 4 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.04s]
[0m21:51:48.861774 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m21:51:48.863343 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:48.863613 [debug] [MainThread]: On master: BEGIN
[0m21:51:48.863800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:48.864428 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:51:48.864659 [debug] [MainThread]: On master: COMMIT
[0m21:51:48.864841 [debug] [MainThread]: Using duckdb connection "master"
[0m21:51:48.864994 [debug] [MainThread]: On master: COMMIT
[0m21:51:48.865445 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:51:48.865669 [debug] [MainThread]: On master: Close
[0m21:51:48.865984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:48.866162 [debug] [MainThread]: Connection 'model.fpl_analytics.int_teams' was properly closed.
[0m21:51:48.866387 [info ] [MainThread]: 
[0m21:51:48.866631 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:51:48.867310 [debug] [MainThread]: Command end result
[0m21:51:48.878895 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m21:51:48.880604 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m21:51:48.884797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m21:51:48.885060 [info ] [MainThread]: 
[0m21:51:48.885351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:51:48.885625 [info ] [MainThread]: 
[0m21:51:48.885913 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:51:48.886694 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0782273, "process_in_blocks": "16", "process_kernel_time": 0.192832, "process_mem_max_rss": "165140", "process_out_blocks": "4176", "process_user_time": 2.263687}
[0m21:51:48.887034 [debug] [MainThread]: Command `dbt build` succeeded at 21:51:48.886962 after 1.08 seconds
[0m21:51:48.887291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743dfc2c2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743df119f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743de94c2e70>]}
[0m21:51:48.887586 [debug] [MainThread]: Flushing usage events
[0m21:51:49.390015 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:03:09.498063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51d4febb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51d4db0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51d572c830>]}


============================== 22:03:09.502270 | e684051b-76ad-4f4a-b4b1-316925d5d57a ==============================
[0m22:03:09.502270 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:03:09.502767 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/robgriffin247/fpl/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error': 'None', 'invocation_command': 'dbt build'}
[0m22:03:09.728971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e684051b-76ad-4f4a-b4b1-316925d5d57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51d56d0fe0>]}
[0m22:03:09.795905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e684051b-76ad-4f4a-b4b1-316925d5d57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51d46b8380>]}
[0m22:03:09.800227 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m22:03:09.855313 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:03:09.954372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:03:09.955057 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m22:03:09.955415 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m22:03:10.193365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e684051b-76ad-4f4a-b4b1-316925d5d57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51c8f213d0>]}
[0m22:03:10.238774 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m22:03:10.240450 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m22:03:10.274278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e684051b-76ad-4f4a-b4b1-316925d5d57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5187536b10>]}
[0m22:03:10.274698 [info ] [MainThread]: Found 4 models, 6 sources, 445 macros
[0m22:03:10.276557 [info ] [MainThread]: 
[0m22:03:10.276990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:03:10.277244 [info ] [MainThread]: 
[0m22:03:10.277699 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:03:10.281360 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m22:03:10.313694 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m22:03:10.314189 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m22:03:10.314416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:10.341371 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m22:03:10.342837 [debug] [ThreadPool]: On list_analytics: Close
[0m22:03:10.345690 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m22:03:10.346098 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m22:03:10.346316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:10.347453 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:03:10.348278 [debug] [ThreadPool]: On list_analytics: Close
[0m22:03:10.348918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m22:03:10.349276 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m22:03:10.410891 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m22:03:10.411245 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m22:03:10.411488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:10.412885 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:03:10.413884 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m22:03:10.414121 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m22:03:10.414581 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:03:10.414810 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m22:03:10.414983 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m22:03:10.415390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:03:10.415944 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m22:03:10.416163 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m22:03:10.416339 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m22:03:10.419250 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:03:10.419499 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m22:03:10.419973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m22:03:10.420291 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m22:03:10.421580 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m22:03:10.421859 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m22:03:10.422119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:10.423027 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:03:10.423872 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m22:03:10.424087 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m22:03:10.424563 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:03:10.424779 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m22:03:10.424954 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m22:03:10.425412 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:03:10.426013 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m22:03:10.426237 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m22:03:10.426409 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m22:03:10.426772 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:03:10.426977 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m22:03:10.428925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m22:03:10.432682 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m22:03:10.432952 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m22:03:10.433181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:10.434033 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:03:10.434255 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m22:03:10.434433 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m22:03:10.446398 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m22:03:10.447567 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m22:03:10.448757 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m22:03:10.448980 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m22:03:10.449474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m22:03:10.450730 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m22:03:10.450979 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m22:03:10.451610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:10.452327 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:03:10.452656 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m22:03:10.452939 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m22:03:10.456300 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:03:10.457181 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m22:03:10.457772 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m22:03:10.458024 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m22:03:10.458959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e684051b-76ad-4f4a-b4b1-316925d5d57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51874e8e60>]}
[0m22:03:10.459289 [debug] [MainThread]: Using duckdb connection "master"
[0m22:03:10.459483 [debug] [MainThread]: On master: BEGIN
[0m22:03:10.459647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:10.460107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:03:10.460307 [debug] [MainThread]: On master: COMMIT
[0m22:03:10.460491 [debug] [MainThread]: Using duckdb connection "master"
[0m22:03:10.460694 [debug] [MainThread]: On master: COMMIT
[0m22:03:10.461083 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:03:10.461285 [debug] [MainThread]: On master: Close
[0m22:03:10.465433 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m22:03:10.465849 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_players ............................... [RUN]
[0m22:03:10.466231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_players)
[0m22:03:10.466490 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m22:03:10.471694 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m22:03:10.472223 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m22:03:10.493801 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m22:03:10.494402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m22:03:10.494666 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m22:03:10.494866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:10.495594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.495865 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m22:03:10.496113 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count::int as dreamteam_appearances,
    element_type::int as position_id,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team::int as team_id,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
    
from "rawdb"."fpl"."elements"
    );
  
  
[0m22:03:10.509434 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m22:03:10.513523 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m22:03:10.513840 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m22:03:10.514690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.515581 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m22:03:10.515830 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m22:03:10.519862 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:03:10.525163 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m22:03:10.525520 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m22:03:10.527193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.529177 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m22:03:10.529449 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m22:03:10.530155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:03:10.541684 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m22:03:10.542126 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m22:03:10.542359 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m22:03:10.553192 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m22:03:10.557632 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m22:03:10.557954 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m22:03:10.563740 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:03:10.566162 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m22:03:10.568223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e684051b-76ad-4f4a-b4b1-316925d5d57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51d45e2750>]}
[0m22:03:10.568701 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.10s]
[0m22:03:10.569157 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m22:03:10.569579 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m22:03:10.570415 [info ] [Thread-1 (]: 2 of 4 START sql table model staging.stg_teams ................................. [RUN]
[0m22:03:10.571238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m22:03:10.571500 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m22:03:10.573577 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m22:03:10.574043 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m22:03:10.575944 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m22:03:10.576377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m22:03:10.576646 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m22:03:10.576851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:10.577565 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.577817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m22:03:10.578052 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    id::int as team_id,
    name::varchar as team_name,
    short_name::varchar as team_abbreviation,
    strength::int as team_strength_rating,
    strength_defence_home::int as team_strength_defence_home,
    strength_attack_home::int as team_strength_attack_home,
    strength_defence_away::int as team_strength_defence_away,
    strength_attack_away::int as team_strength_attack_away    
from "rawdb"."fpl"."teams"
    );
  
  
[0m22:03:10.580413 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:03:10.581277 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m22:03:10.581540 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m22:03:10.582379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.583295 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m22:03:10.583541 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m22:03:10.584484 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.586591 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m22:03:10.586852 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m22:03:10.587594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:03:10.590343 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m22:03:10.590617 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m22:03:10.591155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:03:10.592058 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m22:03:10.592312 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m22:03:10.592523 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m22:03:10.599071 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:03:10.601206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m22:03:10.601537 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m22:03:10.607848 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:03:10.610311 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m22:03:10.611160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e684051b-76ad-4f4a-b4b1-316925d5d57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51ca762240>]}
[0m22:03:10.611846 [info ] [Thread-1 (]: 2 of 4 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.04s]
[0m22:03:10.612432 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m22:03:10.613257 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m22:03:10.613757 [info ] [Thread-1 (]: 3 of 4 START sql table model intermediate.int_players .......................... [RUN]
[0m22:03:10.614517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m22:03:10.614865 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m22:03:10.617601 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m22:03:10.618157 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m22:03:10.620041 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m22:03:10.620449 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m22:03:10.620684 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m22:03:10.620883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:10.621590 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.621870 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m22:03:10.622116 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select 
        id,
        web_name,
        position_id,
        now_cost,
        form,
        dreamteam_appearances,
        team_id,
    from "analytics"."staging"."stg_players"
),

teams as (
    select
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        team_strength_defence_home,
        team_strength_attack_home,
        team_strength_defence_away,
        team_strength_attack_away   
    from "analytics"."staging"."stg_teams"
),

join_teams as (
    select 
        players.*,
        teams.* exclude(team_id)
    from players left join teams using(team_id)
)

select * from join_teams
    );
  
  
[0m22:03:10.629553 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m22:03:10.630551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m22:03:10.630844 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m22:03:10.631721 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.632594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m22:03:10.632846 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m22:03:10.633933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.635968 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m22:03:10.636247 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m22:03:10.636812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:03:10.638591 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m22:03:10.638844 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m22:03:10.639359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:03:10.640237 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m22:03:10.640517 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m22:03:10.640743 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m22:03:10.647352 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:03:10.650489 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m22:03:10.650812 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m22:03:10.656813 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:03:10.657809 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m22:03:10.658448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e684051b-76ad-4f4a-b4b1-316925d5d57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5186801970>]}
[0m22:03:10.658889 [info ] [Thread-1 (]: 3 of 4 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.04s]
[0m22:03:10.659291 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m22:03:10.659565 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m22:03:10.660041 [info ] [Thread-1 (]: 4 of 4 START sql table model intermediate.int_teams ............................ [RUN]
[0m22:03:10.660401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_teams)
[0m22:03:10.660662 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m22:03:10.662465 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m22:03:10.663003 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m22:03:10.664780 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m22:03:10.665196 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m22:03:10.665456 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m22:03:10.665657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:10.666701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.667107 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m22:03:10.667455 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select 
        *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m22:03:10.669255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.670352 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m22:03:10.670781 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m22:03:10.671871 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.672735 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m22:03:10.673037 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m22:03:10.674239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.677206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m22:03:10.677531 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m22:03:10.678361 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:03:10.680286 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m22:03:10.680534 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m22:03:10.681211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:03:10.682116 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m22:03:10.682384 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m22:03:10.682597 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m22:03:10.688689 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:03:10.690243 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m22:03:10.690517 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m22:03:10.696076 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:03:10.697122 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m22:03:10.697874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e684051b-76ad-4f4a-b4b1-316925d5d57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51869c44d0>]}
[0m22:03:10.698395 [info ] [Thread-1 (]: 4 of 4 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.04s]
[0m22:03:10.698797 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m22:03:10.700150 [debug] [MainThread]: Using duckdb connection "master"
[0m22:03:10.700429 [debug] [MainThread]: On master: BEGIN
[0m22:03:10.700621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:10.701227 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:03:10.701449 [debug] [MainThread]: On master: COMMIT
[0m22:03:10.701669 [debug] [MainThread]: Using duckdb connection "master"
[0m22:03:10.701980 [debug] [MainThread]: On master: COMMIT
[0m22:03:10.702395 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:03:10.702613 [debug] [MainThread]: On master: Close
[0m22:03:10.702938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:10.703124 [debug] [MainThread]: Connection 'model.fpl_analytics.int_teams' was properly closed.
[0m22:03:10.703350 [info ] [MainThread]: 
[0m22:03:10.703635 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m22:03:10.704310 [debug] [MainThread]: Command end result
[0m22:03:10.716757 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m22:03:10.718070 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m22:03:10.722183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m22:03:10.722464 [info ] [MainThread]: 
[0m22:03:10.722713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:03:10.722959 [info ] [MainThread]: 
[0m22:03:10.723205 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m22:03:10.724904 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2809772, "process_in_blocks": "104928", "process_kernel_time": 0.304679, "process_mem_max_rss": "166564", "process_out_blocks": "4184", "process_user_time": 2.52091}
[0m22:03:10.725284 [debug] [MainThread]: Command `dbt build` succeeded at 22:03:10.725209 after 1.28 seconds
[0m22:03:10.725543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51d4ab4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51c8f206b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b518744b2c0>]}
[0m22:03:10.725802 [debug] [MainThread]: Flushing usage events
[0m22:03:11.280378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:25:55.028925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea4f80dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea4f567da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea4ff219d0>]}


============================== 07:25:55.033582 | 6268a276-6e52-4f98-9f93-00a1af276516 ==============================
[0m07:25:55.033582 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:25:55.034012 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/robgriffin247/fpl', 'indirect_selection': 'eager', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt build', 'write_json': 'True', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/robgriffin247/fpl/logs', 'empty': 'False', 'log_format': 'default', 'use_colors': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m07:25:55.256017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea4538f860>]}
[0m07:25:55.315985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea4fde7860>]}
[0m07:25:55.319215 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m07:25:55.373058 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m07:25:55.428147 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:25:55.428540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea450ca930>]}
[0m07:25:56.226760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea177612b0>]}
[0m07:25:56.265359 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:25:56.267861 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:25:56.296713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea177635c0>]}
[0m07:25:56.297089 [info ] [MainThread]: Found 5 models, 6 sources, 445 macros
[0m07:25:56.298604 [info ] [MainThread]: 
[0m07:25:56.298939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:25:56.299325 [info ] [MainThread]: 
[0m07:25:56.299787 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:25:56.303664 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m07:25:56.333899 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:25:56.334231 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:25:56.334438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:56.360688 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m07:25:56.362290 [debug] [ThreadPool]: On list_analytics: Close
[0m07:25:56.364140 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:25:56.364502 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:25:56.364705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:56.365618 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:25:56.366386 [debug] [ThreadPool]: On list_analytics: Close
[0m07:25:56.367820 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:25:56.368108 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:25:56.368338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:56.369345 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:25:56.370141 [debug] [ThreadPool]: On list_analytics: Close
[0m07:25:56.370737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m07:25:56.371049 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m07:25:56.375413 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:25:56.375688 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:25:56.375895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:56.376845 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:25:56.377665 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:25:56.377873 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m07:25:56.378342 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:56.378547 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:25:56.378714 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m07:25:56.379170 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:56.379754 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:25:56.379994 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:25:56.380175 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:25:56.381064 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:25:56.381297 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m07:25:56.381768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m07:25:56.382087 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m07:25:56.383461 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:25:56.383736 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:25:56.383994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:56.384888 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:25:56.385688 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:25:56.385878 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m07:25:56.386400 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:56.386599 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:25:56.386756 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m07:25:56.387188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:56.387767 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:25:56.387979 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:25:56.388144 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:25:56.395246 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m07:25:56.395591 [debug] [ThreadPool]: On create_analytics_core: Close
[0m07:25:56.396168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m07:25:56.396568 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m07:25:56.398848 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:25:56.399098 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:25:56.399350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:56.400403 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:25:56.401297 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:25:56.401532 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m07:25:56.402201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:56.402538 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:25:56.402869 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m07:25:56.403686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:56.404290 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:25:56.404504 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:25:56.404674 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:25:56.405104 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:56.405330 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m07:25:56.406785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m07:25:56.410540 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:25:56.410781 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m07:25:56.410955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:56.411767 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:25:56.411982 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:25:56.412147 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m07:25:56.422502 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m07:25:56.423752 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m07:25:56.425323 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m07:25:56.425559 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m07:25:56.426036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m07:25:56.427212 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:25:56.427462 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m07:25:56.427701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:56.428677 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:25:56.429014 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:25:56.429297 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m07:25:56.432102 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m07:25:56.432892 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m07:25:56.433425 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m07:25:56.433645 [debug] [ThreadPool]: On list_analytics_core: Close
[0m07:25:56.434088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m07:25:56.435237 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:25:56.435574 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m07:25:56.435767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:56.436215 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:25:56.436400 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:25:56.436564 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m07:25:56.438995 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:25:56.439853 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m07:25:56.440380 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m07:25:56.440565 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m07:25:56.441487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea451d42f0>]}
[0m07:25:56.441863 [debug] [MainThread]: Using duckdb connection "master"
[0m07:25:56.442061 [debug] [MainThread]: On master: BEGIN
[0m07:25:56.442222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:25:56.442744 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:25:56.442980 [debug] [MainThread]: On master: COMMIT
[0m07:25:56.443187 [debug] [MainThread]: Using duckdb connection "master"
[0m07:25:56.443371 [debug] [MainThread]: On master: COMMIT
[0m07:25:56.443779 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:25:56.443979 [debug] [MainThread]: On master: Close
[0m07:25:56.446758 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m07:25:56.447137 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_players ............................... [RUN]
[0m07:25:56.447490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_players)
[0m07:25:56.447770 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m07:25:56.452849 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m07:25:56.453320 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m07:25:56.473743 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m07:25:56.474463 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:25:56.474715 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m07:25:56.474901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:56.475952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.476231 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:25:56.476496 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count::int as dreamteam_appearances,
    element_type::int as position_id,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team::int as team_id,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
from "rawdb"."fpl"."elements"
    );
  
  
[0m07:25:56.487429 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m07:25:56.491271 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:25:56.491623 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:25:56.492534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.493410 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:25:56.493639 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:25:56.496796 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:25:56.501593 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:25:56.501868 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m07:25:56.503229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.505158 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:25:56.505430 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m07:25:56.506023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:25:56.515878 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:25:56.516158 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:25:56.516361 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:25:56.524397 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:25:56.528270 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:25:56.528550 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m07:25:56.534398 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:25:56.536333 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m07:25:56.538183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea150699a0>]}
[0m07:25:56.538655 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.09s]
[0m07:25:56.539097 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m07:25:56.539383 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m07:25:56.539784 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.stg_teams ................................. [RUN]
[0m07:25:56.540365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m07:25:56.540629 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m07:25:56.543336 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m07:25:56.543801 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m07:25:56.545574 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m07:25:56.545989 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:25:56.546221 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m07:25:56.546412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:56.547125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.547386 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:25:56.547634 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    id::int as team_id,
    name::varchar as team_name,
    short_name::varchar as team_abbreviation,
    strength::int as team_strength_rating,
    strength_overall_home::int as team_strength_overall_home,
    strength_defence_home::int as team_strength_defence_home,
    strength_attack_home::int as team_strength_attack_home,
    strength_overall_away::int as team_strength_overall_away,
    strength_defence_away::int as team_strength_defence_away,
    strength_attack_away::int as team_strength_attack_away,
    *
from "rawdb"."fpl"."teams"
    );
  
  
[0m07:25:56.552461 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:25:56.553385 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:25:56.553650 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:25:56.554452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.555281 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:25:56.555567 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:25:56.556568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.558604 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:25:56.558907 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m07:25:56.559698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:25:56.561522 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:25:56.561802 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m07:25:56.562472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:25:56.563348 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:25:56.563633 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:25:56.563850 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:25:56.568807 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:25:56.570492 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:25:56.570751 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m07:25:56.575336 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:25:56.576325 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m07:25:56.577094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea15066150>]}
[0m07:25:56.577513 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.04s]
[0m07:25:56.577896 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m07:25:56.578151 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m07:25:56.578455 [info ] [Thread-1 (]: 3 of 5 START sql table model intermediate.int_players .......................... [RUN]
[0m07:25:56.578802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m07:25:56.579061 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m07:25:56.580928 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m07:25:56.581943 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m07:25:56.583874 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m07:25:56.584286 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:25:56.584510 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m07:25:56.584696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:56.585385 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.585593 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:25:56.585838 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 

source as (
    select 
        id,
        web_name,
        position_id,
        now_cost,
        form,
        dreamteam_appearances,
        team_id,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m07:25:56.587577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.588660 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:25:56.589069 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:25:56.589969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.590926 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:25:56.591233 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:25:56.592301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.594247 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:25:56.594489 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m07:25:56.595039 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:25:56.596764 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:25:56.597023 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m07:25:56.598002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.598830 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:25:56.599070 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:25:56.599366 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:25:56.605386 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:25:56.606922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:25:56.607176 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m07:25:56.611742 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:25:56.612791 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m07:25:56.613348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea1513bec0>]}
[0m07:25:56.613762 [info ] [Thread-1 (]: 3 of 5 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.03s]
[0m07:25:56.614153 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m07:25:56.614419 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m07:25:56.614736 [info ] [Thread-1 (]: 4 of 5 START sql table model intermediate.int_teams ............................ [RUN]
[0m07:25:56.615082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_teams)
[0m07:25:56.615326 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m07:25:56.617052 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m07:25:56.617569 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m07:25:56.621149 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m07:25:56.621844 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:25:56.622102 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m07:25:56.622287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:56.622993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.623234 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:25:56.623436 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 

source as (
    select 
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        team_strength_overall_home,
        team_strength_defence_home,
        team_strength_attack_home,
        team_strength_overall_away,
        team_strength_defence_away,
        team_strength_attack_away    
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m07:25:56.624798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.625512 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:25:56.625742 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:25:56.626439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:25:56.627331 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:25:56.627616 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:25:56.628736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.630688 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:25:56.630926 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m07:25:56.631473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:25:56.633093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:25:56.633318 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m07:25:56.633818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:25:56.634620 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:25:56.634874 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:25:56.635076 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:25:56.640355 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:25:56.641849 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:25:56.642116 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m07:25:56.646888 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:25:56.647949 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m07:25:56.648500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea150ac080>]}
[0m07:25:56.648925 [info ] [Thread-1 (]: 4 of 5 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.03s]
[0m07:25:56.649320 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m07:25:56.650257 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m07:25:56.650586 [info ] [Thread-1 (]: 5 of 5 START sql table model core.obt_players .................................. [RUN]
[0m07:25:56.650926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m07:25:56.651142 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m07:25:56.653041 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m07:25:56.653702 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m07:25:56.655302 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m07:25:56.655950 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:25:56.656178 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m07:25:56.656360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:56.657320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:25:56.657611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:25:56.657833 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

add_team_name as (
    select
        players.*,
        team.team_name,
        team.team_abbreviation
    from players left join teams using(team_id)
)

select * from add_team_name
    );
  
  
[0m07:25:56.665989 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

add_team_name as (
    select
        players.*,
        team.team_name,
        team.team_abbreviation
    from players left join teams using(team_id)
)

select * from add_team_name
    );
  
  
[0m07:25:56.666425 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:25:56.666761 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: ROLLBACK
[0m07:25:56.673245 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.obt_players'
[0m07:25:56.673607 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m07:25:56.675203 [debug] [Thread-1 (]: Runtime Error in model obt_players (fpl_analytics/models/core/obt_players.sql)
  Binder Error: Referenced table "team" not found!
  Candidate tables: "teams"
  
  LINE 23:         team.team_name,
                   ^
[0m07:25:56.675597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6268a276-6e52-4f98-9f93-00a1af276516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea1503fa70>]}
[0m07:25:56.676058 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model core.obt_players ......................... [[31mERROR[0m in 0.02s]
[0m07:25:56.676453 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m07:25:56.676859 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'error'.  Reason: Runtime Error in model obt_players (fpl_analytics/models/core/obt_players.sql)
  Binder Error: Referenced table "team" not found!
  Candidate tables: "teams"
  
  LINE 23:         team.team_name,
                   ^.
[0m07:25:56.678429 [debug] [MainThread]: Using duckdb connection "master"
[0m07:25:56.678686 [debug] [MainThread]: On master: BEGIN
[0m07:25:56.678860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:25:56.679599 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:25:56.679852 [debug] [MainThread]: On master: COMMIT
[0m07:25:56.680033 [debug] [MainThread]: Using duckdb connection "master"
[0m07:25:56.680191 [debug] [MainThread]: On master: COMMIT
[0m07:25:56.680635 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:25:56.680855 [debug] [MainThread]: On master: Close
[0m07:25:56.681333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:56.681522 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m07:25:56.681746 [info ] [MainThread]: 
[0m07:25:56.681992 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m07:25:56.682711 [debug] [MainThread]: Command end result
[0m07:25:56.695590 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:25:56.697099 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:25:56.701338 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m07:25:56.701637 [info ] [MainThread]: 
[0m07:25:56.701938 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:25:56.702239 [info ] [MainThread]: 
[0m07:25:56.702558 [error] [MainThread]: [31mFailure in model obt_players (fpl_analytics/models/core/obt_players.sql)[0m
[0m07:25:56.702850 [error] [MainThread]:   Runtime Error in model obt_players (fpl_analytics/models/core/obt_players.sql)
  Binder Error: Referenced table "team" not found!
  Candidate tables: "teams"
  
  LINE 23:         team.team_name,
                   ^
[0m07:25:56.703047 [info ] [MainThread]: 
[0m07:25:56.703311 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/core/obt_players.sql
[0m07:25:56.703599 [info ] [MainThread]: 
[0m07:25:56.703844 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m07:25:56.705440 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.7304648, "process_in_blocks": "110752", "process_kernel_time": 0.412522, "process_mem_max_rss": "168800", "process_out_blocks": "4200", "process_user_time": 3.050949}
[0m07:25:56.705793 [debug] [MainThread]: Command `dbt build` failed at 07:25:56.705720 after 1.73 seconds
[0m07:25:56.706048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea51b7d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea4f649e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ea4f648920>]}
[0m07:25:56.706279 [debug] [MainThread]: Flushing usage events
[0m07:25:57.245762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:26:06.685959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d1f42e720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d21cc3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d1f150830>]}


============================== 07:26:06.688306 | 0ce333d3-b45c-4171-8e97-f96986d4d23f ==============================
[0m07:26:06.688306 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:26:06.688710 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'profiles_dir': '/home/robgriffin247/fpl'}
[0m07:26:06.872269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d1f93c860>]}
[0m07:26:06.928821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d1f453fb0>]}
[0m07:26:06.929958 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m07:26:06.976793 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m07:26:07.034836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:26:07.035307 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m07:26:07.247355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d1337b5c0>]}
[0m07:26:07.287351 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:26:07.288663 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:26:07.305151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d13340da0>]}
[0m07:26:07.305535 [info ] [MainThread]: Found 5 models, 6 sources, 445 macros
[0m07:26:07.307042 [info ] [MainThread]: 
[0m07:26:07.307352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:26:07.307604 [info ] [MainThread]: 
[0m07:26:07.307991 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:26:07.311772 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m07:26:07.334493 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:26:07.334849 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:26:07.335071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:07.351436 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m07:26:07.352696 [debug] [ThreadPool]: On list_analytics: Close
[0m07:26:07.355392 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:26:07.355727 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:26:07.355996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:07.357302 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:26:07.358355 [debug] [ThreadPool]: On list_analytics: Close
[0m07:26:07.403927 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:26:07.404249 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:26:07.404447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:07.405733 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:26:07.406574 [debug] [ThreadPool]: On list_analytics: Close
[0m07:26:07.407425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m07:26:07.407847 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m07:26:07.412680 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:26:07.412943 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:26:07.413162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:07.414296 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:26:07.415232 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:26:07.415447 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m07:26:07.415979 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:07.416184 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:26:07.416348 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m07:26:07.416814 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:07.417404 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:26:07.417612 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:26:07.417783 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:26:07.418407 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:07.418649 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m07:26:07.419267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m07:26:07.419660 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m07:26:07.420788 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:26:07.421029 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:26:07.421219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:07.422106 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:26:07.422919 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:26:07.423192 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m07:26:07.423963 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:26:07.424201 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:26:07.424383 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m07:26:07.425074 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:07.425934 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:26:07.426254 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:26:07.426535 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:26:07.427375 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:07.427821 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m07:26:07.428308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m07:26:07.428679 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m07:26:07.429849 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:26:07.430090 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:26:07.430297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:07.431450 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:26:07.432403 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:26:07.432606 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m07:26:07.433008 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:07.433218 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:26:07.433412 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m07:26:07.433818 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:07.434347 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:26:07.434549 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:26:07.434701 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:26:07.435068 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:26:07.435267 [debug] [ThreadPool]: On create_analytics_core: Close
[0m07:26:07.436739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m07:26:07.440704 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:26:07.440966 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m07:26:07.441174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:07.441763 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:26:07.441977 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:26:07.442151 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m07:26:07.450013 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m07:26:07.450974 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m07:26:07.451784 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m07:26:07.452011 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m07:26:07.453080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m07:26:07.454268 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:26:07.454511 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m07:26:07.454718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:07.455777 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:26:07.456011 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:26:07.456195 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m07:26:07.459220 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m07:26:07.460234 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m07:26:07.460815 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m07:26:07.461043 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m07:26:07.461533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m07:26:07.462569 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:26:07.462807 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m07:26:07.463033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:07.464042 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:26:07.464256 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:26:07.464423 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m07:26:07.466721 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:26:07.467643 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m07:26:07.468190 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m07:26:07.468372 [debug] [ThreadPool]: On list_analytics_core: Close
[0m07:26:07.469245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d111ec5c0>]}
[0m07:26:07.469565 [debug] [MainThread]: Using duckdb connection "master"
[0m07:26:07.469743 [debug] [MainThread]: On master: BEGIN
[0m07:26:07.469896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:26:07.470383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:26:07.470575 [debug] [MainThread]: On master: COMMIT
[0m07:26:07.470733 [debug] [MainThread]: Using duckdb connection "master"
[0m07:26:07.470903 [debug] [MainThread]: On master: COMMIT
[0m07:26:07.471311 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:26:07.471507 [debug] [MainThread]: On master: Close
[0m07:26:07.473847 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m07:26:07.474188 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_players ............................... [RUN]
[0m07:26:07.474524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_players)
[0m07:26:07.474752 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m07:26:07.479665 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m07:26:07.480188 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m07:26:07.501611 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m07:26:07.502241 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:26:07.502498 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m07:26:07.502691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:07.503614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.503876 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:26:07.504132 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count::int as dreamteam_appearances,
    element_type::int as position_id,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team::int as team_id,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
from "rawdb"."fpl"."elements"
    );
  
  
[0m07:26:07.514370 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m07:26:07.518572 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:26:07.518891 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:26:07.519868 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.520726 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:26:07.520955 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:26:07.521885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.526235 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:26:07.526522 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m07:26:07.527173 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:26:07.528972 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:26:07.529218 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m07:26:07.529792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:26:07.540020 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:26:07.540332 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:26:07.540587 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:26:07.551705 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m07:26:07.555806 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:26:07.556130 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m07:26:07.562045 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:26:07.564456 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m07:26:07.566302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d1f601370>]}
[0m07:26:07.566760 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.09s]
[0m07:26:07.567190 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m07:26:07.567498 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m07:26:07.567946 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.stg_teams ................................. [RUN]
[0m07:26:07.568454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m07:26:07.569063 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m07:26:07.571069 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m07:26:07.571521 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m07:26:07.573359 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m07:26:07.573795 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:26:07.574048 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m07:26:07.574260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:07.575537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.576058 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:26:07.576306 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    id::int as team_id,
    name::varchar as team_name,
    short_name::varchar as team_abbreviation,
    strength::int as team_strength_rating,
    strength_overall_home::int as team_strength_overall_home,
    strength_defence_home::int as team_strength_defence_home,
    strength_attack_home::int as team_strength_attack_home,
    strength_overall_away::int as team_strength_overall_away,
    strength_defence_away::int as team_strength_defence_away,
    strength_attack_away::int as team_strength_attack_away,
    *
from "rawdb"."fpl"."teams"
    );
  
  
[0m07:26:07.578331 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:26:07.579132 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:26:07.579377 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:26:07.580106 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:26:07.580973 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:26:07.581228 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:26:07.582199 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.584574 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:26:07.584904 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m07:26:07.585885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.588091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:26:07.588462 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m07:26:07.589401 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.590476 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:26:07.590768 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:26:07.590967 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:26:07.596913 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:26:07.598537 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:26:07.598816 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m07:26:07.604276 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:26:07.605665 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m07:26:07.606310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d14c00e30>]}
[0m07:26:07.606805 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.04s]
[0m07:26:07.607212 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m07:26:07.607493 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m07:26:07.608127 [info ] [Thread-1 (]: 3 of 5 START sql table model intermediate.int_players .......................... [RUN]
[0m07:26:07.608529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m07:26:07.608760 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m07:26:07.610631 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m07:26:07.611105 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m07:26:07.614290 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m07:26:07.614749 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:26:07.614993 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m07:26:07.615188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:07.615911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.616165 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:26:07.616372 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 

source as (
    select 
        id,
        web_name,
        position_id,
        now_cost,
        form,
        dreamteam_appearances,
        team_id,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m07:26:07.618029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.618880 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:26:07.619173 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:26:07.620092 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.620955 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:26:07.621201 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:26:07.622156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.624972 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:26:07.625223 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m07:26:07.626091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.628524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:26:07.628856 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m07:26:07.629806 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.630725 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:26:07.630948 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:26:07.631138 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:26:07.637503 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:26:07.639227 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:26:07.639521 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m07:26:07.644724 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:26:07.645763 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m07:26:07.646352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d11bf7770>]}
[0m07:26:07.646785 [info ] [Thread-1 (]: 3 of 5 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.04s]
[0m07:26:07.647189 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m07:26:07.647464 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m07:26:07.647988 [info ] [Thread-1 (]: 4 of 5 START sql table model intermediate.int_teams ............................ [RUN]
[0m07:26:07.648332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_teams)
[0m07:26:07.648564 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m07:26:07.650369 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m07:26:07.650840 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m07:26:07.652876 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m07:26:07.653332 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:26:07.653567 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m07:26:07.653823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:07.654552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.654780 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:26:07.654994 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 

source as (
    select 
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        team_strength_overall_home,
        team_strength_defence_home,
        team_strength_attack_home,
        team_strength_overall_away,
        team_strength_defence_away,
        team_strength_attack_away    
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m07:26:07.656593 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.657374 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:26:07.657605 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:26:07.658299 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:26:07.659151 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:26:07.659391 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:26:07.660234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.662256 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:26:07.662509 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m07:26:07.663087 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:26:07.664886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:26:07.665139 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m07:26:07.665688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:26:07.666571 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:26:07.666812 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:26:07.667008 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:26:07.673703 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:26:07.676100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:26:07.676627 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m07:26:07.682064 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:26:07.683677 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m07:26:07.684491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d14f99af0>]}
[0m07:26:07.684934 [info ] [Thread-1 (]: 4 of 5 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.04s]
[0m07:26:07.685391 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m07:26:07.686168 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m07:26:07.686570 [info ] [Thread-1 (]: 5 of 5 START sql table model core.obt_players .................................. [RUN]
[0m07:26:07.686962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m07:26:07.687219 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m07:26:07.689372 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m07:26:07.690045 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m07:26:07.691884 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m07:26:07.692297 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:26:07.692534 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m07:26:07.692754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:07.693475 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.693717 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:26:07.693912 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

add_team_name as (
    select
        players.*,
        teams.team_name,
        teams.team_abbreviation
    from players left join teams using(team_id)
)

select * from add_team_name
    );
  
  
[0m07:26:07.699258 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:26:07.702733 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:26:07.703074 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m07:26:07.703920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.704848 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m07:26:07.705105 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:26:07.705398 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m07:26:07.718217 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m07:26:07.720135 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:26:07.720419 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m07:26:07.721302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:26:07.722701 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m07:26:07.723735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ce333d3-b45c-4171-8e97-f96986d4d23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d10fc6390>]}
[0m07:26:07.724287 [info ] [Thread-1 (]: 5 of 5 OK created sql table model core.obt_players ............................. [[32mOK[0m in 0.04s]
[0m07:26:07.724719 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m07:26:07.726741 [debug] [MainThread]: Using duckdb connection "master"
[0m07:26:07.727180 [debug] [MainThread]: On master: BEGIN
[0m07:26:07.727409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:26:07.728290 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:26:07.728546 [debug] [MainThread]: On master: COMMIT
[0m07:26:07.728748 [debug] [MainThread]: Using duckdb connection "master"
[0m07:26:07.728920 [debug] [MainThread]: On master: COMMIT
[0m07:26:07.729507 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:26:07.729788 [debug] [MainThread]: On master: Close
[0m07:26:07.730221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:07.730463 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m07:26:07.730760 [info ] [MainThread]: 
[0m07:26:07.731075 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m07:26:07.731943 [debug] [MainThread]: Command end result
[0m07:26:07.743223 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:26:07.744790 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:26:07.748678 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m07:26:07.748922 [info ] [MainThread]: 
[0m07:26:07.749208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:26:07.749461 [info ] [MainThread]: 
[0m07:26:07.749714 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m07:26:07.750394 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.1116261, "process_in_blocks": "1888", "process_kernel_time": 0.223307, "process_mem_max_rss": "167544", "process_out_blocks": "4272", "process_user_time": 2.095027}
[0m07:26:07.750698 [debug] [MainThread]: Command `dbt build` succeeded at 07:26:07.750633 after 1.11 seconds
[0m07:26:07.750937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d1eba24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d14a78320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d14fc6630>]}
[0m07:26:07.751188 [debug] [MainThread]: Flushing usage events
[0m07:26:08.278417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:31:44.732492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96e76bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96e724ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96e76b9e0>]}


============================== 07:31:44.736684 | 1e1932e6-43ab-46be-97f4-cefc5a5621fe ==============================
[0m07:31:44.736684 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:31:44.737141 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'printer_width': '80', 'invocation_command': 'dbt build', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/robgriffin247/fpl/logs', 'version_check': 'True'}
[0m07:31:44.949739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a964722720>]}
[0m07:31:45.007674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96f1db860>]}
[0m07:31:45.010608 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m07:31:45.061964 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m07:31:45.151243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:45.151530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:45.173269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9645c6c60>]}
[0m07:31:45.217956 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:31:45.219554 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:31:45.248763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9645c6660>]}
[0m07:31:45.249234 [info ] [MainThread]: Found 5 models, 6 sources, 445 macros
[0m07:31:45.250634 [info ] [MainThread]: 
[0m07:31:45.250944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:31:45.251166 [info ] [MainThread]: 
[0m07:31:45.251532 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:31:45.255007 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m07:31:45.286449 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:31:45.286823 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:31:45.287061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:45.308282 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m07:31:45.309605 [debug] [ThreadPool]: On list_analytics: Close
[0m07:31:45.312304 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:31:45.312613 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:31:45.312858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:45.314085 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:31:45.315008 [debug] [ThreadPool]: On list_analytics: Close
[0m07:31:45.316599 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:31:45.316967 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:31:45.317235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:45.318531 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:31:45.319483 [debug] [ThreadPool]: On list_analytics: Close
[0m07:31:45.320361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m07:31:45.320760 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m07:31:45.325916 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:31:45.326260 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:31:45.326469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:45.327607 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:31:45.328563 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:31:45.328786 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m07:31:45.329519 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:31:45.329914 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:31:45.330400 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m07:31:45.330922 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:31:45.331502 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:31:45.331700 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:31:45.331878 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:31:45.332260 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:31:45.332473 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m07:31:45.332984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m07:31:45.333308 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m07:31:45.334435 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:31:45.334727 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:31:45.334917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:45.335896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:31:45.337302 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:31:45.337542 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m07:31:45.337988 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:31:45.338190 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:31:45.338353 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m07:31:45.338789 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:31:45.339316 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:31:45.339501 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:31:45.339654 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:31:45.340008 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:31:45.340198 [debug] [ThreadPool]: On create_analytics_core: Close
[0m07:31:45.340657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m07:31:45.341047 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m07:31:45.342101 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:31:45.342302 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:31:45.342574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:45.343538 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:31:45.344989 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:31:45.345246 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m07:31:45.345948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:31:45.346199 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:31:45.346497 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m07:31:45.346958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:31:45.347554 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:31:45.347754 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:31:45.347923 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:31:45.348307 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:31:45.348518 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m07:31:45.350068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m07:31:45.354716 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:31:45.355037 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m07:31:45.355221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:45.355935 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:31:45.356188 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:31:45.356364 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m07:31:45.364740 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m07:31:45.365811 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m07:31:45.368055 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m07:31:45.368299 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m07:31:45.368833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m07:31:45.370025 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:31:45.370272 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m07:31:45.370474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:45.371345 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:31:45.371560 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:31:45.371734 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m07:31:45.374908 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m07:31:45.376181 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m07:31:45.377117 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m07:31:45.377402 [debug] [ThreadPool]: On list_analytics_core: Close
[0m07:31:45.377867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m07:31:45.379039 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:31:45.379281 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m07:31:45.379494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:45.380387 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:31:45.380628 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:31:45.380819 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m07:31:45.383288 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:31:45.384211 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m07:31:45.384753 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m07:31:45.384987 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m07:31:45.385928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9644bc9b0>]}
[0m07:31:45.386256 [debug] [MainThread]: Using duckdb connection "master"
[0m07:31:45.386446 [debug] [MainThread]: On master: BEGIN
[0m07:31:45.386613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:45.387218 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:31:45.387458 [debug] [MainThread]: On master: COMMIT
[0m07:31:45.387658 [debug] [MainThread]: Using duckdb connection "master"
[0m07:31:45.387818 [debug] [MainThread]: On master: COMMIT
[0m07:31:45.388431 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:31:45.388693 [debug] [MainThread]: On master: Close
[0m07:31:45.392864 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m07:31:45.393409 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_players ............................... [RUN]
[0m07:31:45.393826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_players)
[0m07:31:45.394078 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m07:31:45.399645 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m07:31:45.401035 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m07:31:45.424395 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m07:31:45.425148 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:31:45.425450 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m07:31:45.425654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:45.426468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.426812 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:31:45.427086 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count::int as dreamteam_appearances,
    element_type::int as position_id,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team::int as team_id,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
from "rawdb"."fpl"."elements"
    );
  
  
[0m07:31:45.442710 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m07:31:45.446845 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:31:45.447188 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:31:45.448348 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.449376 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:31:45.449642 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:31:45.450630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.454886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:31:45.455211 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m07:31:45.456848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.458771 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:31:45.459028 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m07:31:45.459795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:31:45.469751 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:31:45.470098 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:31:45.470296 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:31:45.478895 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:31:45.482769 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:31:45.483062 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m07:31:45.487953 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:31:45.490372 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m07:31:45.492690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a961fec6e0>]}
[0m07:31:45.493249 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.10s]
[0m07:31:45.493680 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m07:31:45.493979 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m07:31:45.494790 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.stg_teams ................................. [RUN]
[0m07:31:45.495677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m07:31:45.496311 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m07:31:45.499283 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m07:31:45.500249 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m07:31:45.503152 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m07:31:45.504690 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:31:45.505358 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m07:31:45.505796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:45.506647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.506886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:31:45.507149 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    id::int as team_id,
    name::varchar as team_name,
    short_name::varchar as team_abbreviation,
    strength::int as team_strength_rating,
    strength_overall_home::int as team_strength_overall_home,
    strength_defence_home::int as team_strength_defence_home,
    strength_attack_home::int as team_strength_attack_home,
    strength_overall_away::int as team_strength_overall_away,
    strength_defence_away::int as team_strength_defence_away,
    strength_attack_away::int as team_strength_attack_away,
    *
from "rawdb"."fpl"."teams"
    );
  
  
[0m07:31:45.511944 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:31:45.513123 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:31:45.513430 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:31:45.514233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.515115 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:31:45.515347 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:31:45.516703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.519376 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:31:45.519772 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m07:31:45.520632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.522700 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:31:45.523019 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m07:31:45.523749 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:31:45.524716 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:31:45.524990 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:31:45.525199 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:31:45.530187 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:31:45.531800 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:31:45.532072 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m07:31:45.536813 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:31:45.538190 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m07:31:45.538845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a961fb25a0>]}
[0m07:31:45.539302 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.04s]
[0m07:31:45.539740 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m07:31:45.540041 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m07:31:45.540353 [info ] [Thread-1 (]: 3 of 5 START sql table model intermediate.int_players .......................... [RUN]
[0m07:31:45.540708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m07:31:45.541011 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m07:31:45.542925 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m07:31:45.543841 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m07:31:45.546907 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m07:31:45.547613 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:31:45.547886 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m07:31:45.548084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:45.548914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.549254 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:31:45.549474 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 

source as (
    select 
        id,
        web_name,
        position_id,
        now_cost,
        form,
        dreamteam_appearances,
        team_id,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m07:31:45.551120 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.551893 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:31:45.552134 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:31:45.552992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.553868 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:31:45.554102 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:31:45.554967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.606452 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:31:45.606964 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m07:31:45.607849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.609980 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:31:45.610268 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m07:31:45.610919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:31:45.611821 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:31:45.612068 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:31:45.612272 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:31:45.617614 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:31:45.619367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:31:45.619664 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m07:31:45.624754 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:31:45.626088 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m07:31:45.627109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9600cf890>]}
[0m07:31:45.627587 [info ] [Thread-1 (]: 3 of 5 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.09s]
[0m07:31:45.627975 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m07:31:45.628286 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m07:31:45.628645 [info ] [Thread-1 (]: 4 of 5 START sql table model intermediate.int_teams ............................ [RUN]
[0m07:31:45.629024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_teams)
[0m07:31:45.629319 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m07:31:45.631244 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m07:31:45.632516 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m07:31:45.634450 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m07:31:45.634872 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:31:45.635094 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m07:31:45.635288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:45.635976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.636195 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:31:45.636386 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 

source as (
    select 
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        team_strength_overall_home,
        team_strength_defence_home,
        team_strength_attack_home,
        team_strength_overall_away,
        team_strength_defence_away,
        team_strength_attack_away    
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m07:31:45.637935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.638890 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:31:45.639250 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:31:45.640000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:31:45.640866 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:31:45.641157 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:31:45.641988 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.643952 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:31:45.644201 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m07:31:45.644981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:31:45.647009 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:31:45.647398 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m07:31:45.648028 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:31:45.648869 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:31:45.649165 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:31:45.649371 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:31:45.654993 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:31:45.656669 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:31:45.657023 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m07:31:45.662269 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:31:45.663998 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m07:31:45.665100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a961fadac0>]}
[0m07:31:45.665867 [info ] [Thread-1 (]: 4 of 5 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.04s]
[0m07:31:45.666401 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m07:31:45.668098 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m07:31:45.668571 [info ] [Thread-1 (]: 5 of 5 START sql table model core.obt_players .................................. [RUN]
[0m07:31:45.669129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m07:31:45.669415 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m07:31:45.671502 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m07:31:45.672469 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m07:31:45.674326 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m07:31:45.674773 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:31:45.675012 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m07:31:45.675320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:45.676113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.676337 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:31:45.676530 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

add_team_name as (
    select
        players.*,
        teams.team_name,
        teams.team_abbreviation
    from players left join teams using(team_id)
)

select * from add_team_name
    );
  
  
[0m07:31:45.680002 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:31:45.680966 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:31:45.681228 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m07:31:45.682038 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.682983 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:31:45.683331 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m07:31:45.684420 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.687837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:31:45.688100 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m07:31:45.688854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.690738 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:31:45.690980 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m07:31:45.691816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:31:45.692720 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m07:31:45.693025 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:31:45.693241 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m07:31:45.698985 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:31:45.700734 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:31:45.701083 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m07:31:45.706317 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:31:45.708056 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m07:31:45.709415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1932e6-43ab-46be-97f4-cefc5a5621fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a961fc6450>]}
[0m07:31:45.710041 [info ] [Thread-1 (]: 5 of 5 OK created sql table model core.obt_players ............................. [[32mOK[0m in 0.04s]
[0m07:31:45.710555 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m07:31:45.712790 [debug] [MainThread]: Using duckdb connection "master"
[0m07:31:45.713241 [debug] [MainThread]: On master: BEGIN
[0m07:31:45.713450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:45.714097 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:31:45.714330 [debug] [MainThread]: On master: COMMIT
[0m07:31:45.714506 [debug] [MainThread]: Using duckdb connection "master"
[0m07:31:45.714681 [debug] [MainThread]: On master: COMMIT
[0m07:31:45.715060 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:31:45.715267 [debug] [MainThread]: On master: Close
[0m07:31:45.715574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:45.715747 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m07:31:45.715999 [info ] [MainThread]: 
[0m07:31:45.716237 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m07:31:45.716962 [debug] [MainThread]: Command end result
[0m07:31:45.727257 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:31:45.728715 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:31:45.732709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m07:31:45.732981 [info ] [MainThread]: 
[0m07:31:45.733254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:31:45.733480 [info ] [MainThread]: 
[0m07:31:45.733711 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m07:31:45.735405 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0548439, "process_in_blocks": "95024", "process_kernel_time": 0.273942, "process_mem_max_rss": "164668", "process_out_blocks": "3368", "process_user_time": 2.408039}
[0m07:31:45.735780 [debug] [MainThread]: Command `dbt build` succeeded at 07:31:45.735705 after 1.06 seconds
[0m07:31:45.736070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96ea3c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a961f14110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96f14a450>]}
[0m07:31:45.736329 [debug] [MainThread]: Flushing usage events
[0m07:31:46.268722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:32:22.988101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b343bfb3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b343b8cc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b343df82600>]}


============================== 07:32:22.990537 | cc15e66d-23f1-497f-a1e7-e8cd19126ee7 ==============================
[0m07:32:22.990537 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:32:22.990977 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'log_path': '/home/robgriffin247/fpl/logs', 'fail_fast': 'False', 'empty': 'False', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'printer_width': '80'}
[0m07:32:23.159068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b343b517ad0>]}
[0m07:32:23.210338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b343ba56e70>]}
[0m07:32:23.211536 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m07:32:23.255463 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m07:32:23.310832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:32:23.311105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:32:23.330573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b343185be90>]}
[0m07:32:23.376934 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:32:23.378523 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:32:23.393664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b34317af2c0>]}
[0m07:32:23.394018 [info ] [MainThread]: Found 5 models, 6 sources, 445 macros
[0m07:32:23.395360 [info ] [MainThread]: 
[0m07:32:23.395646 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:32:23.395848 [info ] [MainThread]: 
[0m07:32:23.396178 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:32:23.399455 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m07:32:23.423157 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:32:23.423522 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:32:23.423719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:23.441432 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m07:32:23.442564 [debug] [ThreadPool]: On list_analytics: Close
[0m07:32:23.445276 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:32:23.445675 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:32:23.445924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:23.447121 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:23.448117 [debug] [ThreadPool]: On list_analytics: Close
[0m07:32:23.450063 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:32:23.450411 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:32:23.450670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:23.452025 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:23.452739 [debug] [ThreadPool]: On list_analytics: Close
[0m07:32:23.453406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m07:32:23.453683 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m07:32:23.458004 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:32:23.458405 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:32:23.458600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:23.459809 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:23.460776 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:32:23.461023 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m07:32:23.461523 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:32:23.461724 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:32:23.461870 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m07:32:23.462346 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:32:23.463006 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:32:23.463246 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:32:23.463485 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:32:23.464091 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:32:23.464332 [debug] [ThreadPool]: On create_analytics_core: Close
[0m07:32:23.464863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m07:32:23.465196 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m07:32:23.466335 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:32:23.466650 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:32:23.466851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:23.467896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:23.468701 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:32:23.468939 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m07:32:23.469417 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:32:23.469609 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:32:23.469776 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m07:32:23.470200 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:32:23.470740 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:32:23.470942 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:32:23.471090 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:32:23.471571 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:32:23.471780 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m07:32:23.472232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m07:32:23.472538 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m07:32:23.473571 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:32:23.473807 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:32:23.474004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:23.475037 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:23.475818 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:32:23.476008 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m07:32:23.476387 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:32:23.476626 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:32:23.476802 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m07:32:23.477286 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:32:23.477810 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:32:23.477998 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:32:23.478156 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:32:23.478595 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:32:23.478781 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m07:32:23.480398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m07:32:23.484027 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:32:23.484346 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m07:32:23.484507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:23.485203 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:23.485419 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:32:23.485584 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m07:32:23.493465 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m07:32:23.494501 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m07:32:23.495420 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m07:32:23.495638 [debug] [ThreadPool]: On list_analytics_core: Close
[0m07:32:23.496152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m07:32:23.497293 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:32:23.497526 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m07:32:23.497714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:23.499100 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:23.499588 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:32:23.499777 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m07:32:23.502348 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:32:23.503350 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m07:32:23.503868 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m07:32:23.504031 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m07:32:23.504446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m07:32:23.505534 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:32:23.505776 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m07:32:23.505968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:23.506867 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:23.507375 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:32:23.507598 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m07:32:23.510557 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m07:32:23.511744 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m07:32:23.512390 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m07:32:23.512595 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m07:32:23.513596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3430802060>]}
[0m07:32:23.513890 [debug] [MainThread]: Using duckdb connection "master"
[0m07:32:23.514054 [debug] [MainThread]: On master: BEGIN
[0m07:32:23.514193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:32:23.514725 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:32:23.514950 [debug] [MainThread]: On master: COMMIT
[0m07:32:23.515200 [debug] [MainThread]: Using duckdb connection "master"
[0m07:32:23.515432 [debug] [MainThread]: On master: COMMIT
[0m07:32:23.516069 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:32:23.516289 [debug] [MainThread]: On master: Close
[0m07:32:23.518264 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m07:32:23.518648 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_players ............................... [RUN]
[0m07:32:23.518980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_players)
[0m07:32:23.519199 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m07:32:23.523928 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m07:32:23.524381 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m07:32:23.544731 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m07:32:23.545304 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:32:23.545564 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m07:32:23.545753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:23.546425 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.546640 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:32:23.546852 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count::int as dreamteam_appearances,
    element_type::int as position_id,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team::int as team_id,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
from "rawdb"."fpl"."elements"
    );
  
  
[0m07:32:23.555983 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m07:32:23.559356 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:32:23.559636 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:32:23.560648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.561422 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:32:23.561619 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:32:23.562658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.566611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:32:23.566849 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m07:32:23.567557 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.569013 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:32:23.569211 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m07:32:23.569900 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.579035 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:32:23.579353 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:32:23.579575 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:32:23.587411 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:32:23.590931 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:32:23.591206 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m07:32:23.596383 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:32:23.597943 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m07:32:23.599370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b34308efe30>]}
[0m07:32:23.599793 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.08s]
[0m07:32:23.600164 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m07:32:23.600434 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m07:32:23.601068 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.stg_teams ................................. [RUN]
[0m07:32:23.601441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m07:32:23.601686 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m07:32:23.603485 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m07:32:23.603925 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m07:32:23.605666 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m07:32:23.606291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:32:23.606548 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m07:32:23.606722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:23.607423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.607639 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:32:23.607811 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    id::int as team_id,
    name::varchar as team_name,
    short_name::varchar as team_abbreviation,
    strength::int as team_strength_rating,
    strength_overall_home::int as team_strength_overall_home,
    strength_defence_home::int as team_strength_defence_home,
    strength_attack_home::int as team_strength_attack_home,
    strength_overall_away::int as team_strength_overall_away,
    strength_defence_away::int as team_strength_defence_away,
    strength_attack_away::int as team_strength_attack_away,
    *
from "rawdb"."fpl"."teams"
    );
  
  
[0m07:32:23.609756 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:32:23.610429 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:32:23.610632 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:32:23.611262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.612056 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:32:23.612257 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:32:23.613182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.614861 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:32:23.615089 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m07:32:23.615621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.617050 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:32:23.617251 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m07:32:23.617692 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.618423 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:32:23.618619 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:32:23.618782 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:32:23.624935 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:32:23.626451 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:32:23.626680 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m07:32:23.631224 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:32:23.632279 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m07:32:23.632771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b34308bdc70>]}
[0m07:32:23.633182 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.03s]
[0m07:32:23.633542 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m07:32:23.633856 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m07:32:23.634180 [info ] [Thread-1 (]: 3 of 5 START sql table model intermediate.int_players .......................... [RUN]
[0m07:32:23.634523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m07:32:23.634770 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m07:32:23.636503 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m07:32:23.637390 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m07:32:23.640064 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m07:32:23.640467 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:32:23.640673 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m07:32:23.640873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:23.641513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.641708 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:32:23.641889 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 

source as (
    select 
        id,
        web_name,
        position_id,
        now_cost,
        form,
        dreamteam_appearances,
        team_id,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m07:32:23.643539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.644189 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:32:23.644394 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:32:23.645028 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.645750 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:32:23.645955 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:32:23.646745 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.689630 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:32:23.689990 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m07:32:23.691179 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.692777 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:32:23.692990 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m07:32:23.693537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.694254 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:32:23.694472 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:32:23.694650 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:32:23.703153 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:32:23.704603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:32:23.704838 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m07:32:23.710289 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:32:23.711379 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m07:32:23.712246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b343072ab40>]}
[0m07:32:23.712624 [info ] [Thread-1 (]: 3 of 5 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.08s]
[0m07:32:23.712982 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m07:32:23.713233 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m07:32:23.713542 [info ] [Thread-1 (]: 4 of 5 START sql table model intermediate.int_teams ............................ [RUN]
[0m07:32:23.714141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_teams)
[0m07:32:23.714412 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m07:32:23.716178 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m07:32:23.716564 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m07:32:23.718237 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m07:32:23.718659 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:32:23.718870 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m07:32:23.719072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:23.719791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.720020 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:32:23.720211 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 

source as (
    select 
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        team_strength_overall_home,
        team_strength_defence_home,
        team_strength_attack_home,
        team_strength_overall_away,
        team_strength_defence_away,
        team_strength_attack_away    
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m07:32:23.721817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.722524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:32:23.722826 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:32:23.723539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.724363 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:32:23.724583 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:32:23.725512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.727573 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:32:23.727807 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m07:32:23.728560 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.730339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:32:23.730658 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m07:32:23.731300 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.732054 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:32:23.732258 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:32:23.732454 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:32:23.737997 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:32:23.739546 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:32:23.739797 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m07:32:23.744665 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:32:23.746089 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m07:32:23.746633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b34307076b0>]}
[0m07:32:23.747040 [info ] [Thread-1 (]: 4 of 5 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.03s]
[0m07:32:23.747485 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m07:32:23.748350 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m07:32:23.748675 [info ] [Thread-1 (]: 5 of 5 START sql table model core.obt_players .................................. [RUN]
[0m07:32:23.749000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m07:32:23.749205 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m07:32:23.751044 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m07:32:23.751579 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m07:32:23.753249 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m07:32:23.753647 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:32:23.753856 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m07:32:23.754031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:23.754695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.754926 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:32:23.755120 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

add_team_name as (
    select
        players.*,
        teams.team_name,
        teams.team_abbreviation
    from players left join teams using(team_id)
)

select * from add_team_name
    );
  
  
[0m07:32:23.757919 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:32:23.758729 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:32:23.758975 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m07:32:23.759930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.761172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:32:23.761424 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m07:32:23.762344 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:23.765547 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:32:23.765810 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m07:32:23.766414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.767959 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:32:23.768208 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m07:32:23.768751 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:32:23.769528 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m07:32:23.769746 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:32:23.769955 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m07:32:23.776163 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:32:23.777761 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:32:23.778015 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m07:32:23.782946 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:32:23.784089 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m07:32:23.784686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc15e66d-23f1-497f-a1e7-e8cd19126ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b34309ca6f0>]}
[0m07:32:23.785109 [info ] [Thread-1 (]: 5 of 5 OK created sql table model core.obt_players ............................. [[32mOK[0m in 0.04s]
[0m07:32:23.785476 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m07:32:23.786866 [debug] [MainThread]: Using duckdb connection "master"
[0m07:32:23.787214 [debug] [MainThread]: On master: BEGIN
[0m07:32:23.787518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:32:23.788488 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:32:23.788816 [debug] [MainThread]: On master: COMMIT
[0m07:32:23.789080 [debug] [MainThread]: Using duckdb connection "master"
[0m07:32:23.789328 [debug] [MainThread]: On master: COMMIT
[0m07:32:23.789917 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:32:23.790140 [debug] [MainThread]: On master: Close
[0m07:32:23.790451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:32:23.790629 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m07:32:23.790841 [info ] [MainThread]: 
[0m07:32:23.791102 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m07:32:23.791806 [debug] [MainThread]: Command end result
[0m07:32:23.801499 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:32:23.802907 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:32:23.806661 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m07:32:23.806907 [info ] [MainThread]: 
[0m07:32:23.807171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:32:23.807416 [info ] [MainThread]: 
[0m07:32:23.807649 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m07:32:23.808386 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.86449534, "process_in_blocks": "8", "process_kernel_time": 0.183486, "process_mem_max_rss": "162984", "process_out_blocks": "3368", "process_user_time": 1.991499}
[0m07:32:23.808684 [debug] [MainThread]: Command `dbt build` succeeded at 07:32:23.808618 after 0.86 seconds
[0m07:32:23.808913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3431828770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b343bbea270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b34306f7e90>]}
[0m07:32:23.809144 [debug] [MainThread]: Flushing usage events
[0m07:32:24.293195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:43:56.545376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afc3bfec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afc38b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afc3bfc770>]}


============================== 07:43:56.548820 | f5416dcd-f8ea-413c-8aae-3ed55fd6a876 ==============================
[0m07:43:56.548820 [info ] [MainThread]: Running with dbt=1.10.13
[0m07:43:56.549273 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'invocation_command': 'dbt build', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'printer_width': '80'}
[0m07:43:56.772673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afc41b77d0>]}
[0m07:43:56.833235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afc55d8ec0>]}
[0m07:43:56.836798 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m07:43:56.892568 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m07:43:56.986743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:56.987070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:57.008573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb9663290>]}
[0m07:43:57.047051 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:43:57.051489 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:43:57.084192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb978c3b0>]}
[0m07:43:57.084594 [info ] [MainThread]: Found 5 models, 6 sources, 445 macros
[0m07:43:57.086079 [info ] [MainThread]: 
[0m07:43:57.086375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:57.086625 [info ] [MainThread]: 
[0m07:43:57.086978 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:43:57.090625 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m07:43:57.118600 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:43:57.118917 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:43:57.119156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:57.139996 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m07:43:57.141594 [debug] [ThreadPool]: On list_analytics: Close
[0m07:43:57.143995 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:43:57.144252 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:43:57.144461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:57.145491 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:43:57.146315 [debug] [ThreadPool]: On list_analytics: Close
[0m07:43:57.147606 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m07:43:57.147853 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m07:43:57.148070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:57.149069 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:43:57.150096 [debug] [ThreadPool]: On list_analytics: Close
[0m07:43:57.150688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m07:43:57.150998 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m07:43:57.155192 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:43:57.155439 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:43:57.155628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:57.156583 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:43:57.157372 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:43:57.157640 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m07:43:57.158055 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:43:57.158238 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:43:57.158387 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m07:43:57.158762 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:43:57.159279 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:43:57.159495 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m07:43:57.159685 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m07:43:57.160085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:43:57.160294 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m07:43:57.160757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m07:43:57.161081 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m07:43:57.162240 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:43:57.162542 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:43:57.162761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:57.163828 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:43:57.165038 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:43:57.165271 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m07:43:57.165853 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:43:57.166047 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:43:57.166203 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m07:43:57.166643 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:43:57.167161 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:43:57.167351 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m07:43:57.167514 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m07:43:57.167896 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:43:57.168085 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m07:43:57.168533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m07:43:57.168898 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m07:43:57.170028 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:43:57.170241 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m07:43:57.170425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:57.171262 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:43:57.172050 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:43:57.172247 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m07:43:57.172795 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:43:57.172979 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:43:57.173131 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m07:43:57.173687 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:43:57.174564 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:43:57.174784 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m07:43:57.174950 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m07:43:57.175351 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:43:57.175559 [debug] [ThreadPool]: On create_analytics_core: Close
[0m07:43:57.176683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_intermediate)
[0m07:43:57.180083 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:43:57.180336 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m07:43:57.180615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:57.181303 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:43:57.181703 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m07:43:57.181884 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m07:43:57.189143 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m07:43:57.190194 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m07:43:57.191621 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m07:43:57.191869 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m07:43:57.192484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m07:43:57.193767 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:43:57.194017 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m07:43:57.194221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:57.195195 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:43:57.195384 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m07:43:57.195548 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m07:43:57.198040 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:43:57.198920 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m07:43:57.199458 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m07:43:57.199641 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m07:43:57.200085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m07:43:57.201908 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:43:57.202151 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m07:43:57.202320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:57.203025 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:43:57.203356 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m07:43:57.203640 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m07:43:57.206256 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:43:57.207154 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m07:43:57.207720 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m07:43:57.207910 [debug] [ThreadPool]: On list_analytics_core: Close
[0m07:43:57.208648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb9115550>]}
[0m07:43:57.208968 [debug] [MainThread]: Using duckdb connection "master"
[0m07:43:57.209157 [debug] [MainThread]: On master: BEGIN
[0m07:43:57.209319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:57.209859 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:43:57.210058 [debug] [MainThread]: On master: COMMIT
[0m07:43:57.210234 [debug] [MainThread]: Using duckdb connection "master"
[0m07:43:57.210389 [debug] [MainThread]: On master: COMMIT
[0m07:43:57.210729 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:43:57.210911 [debug] [MainThread]: On master: Close
[0m07:43:57.213759 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m07:43:57.214134 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_players ............................... [RUN]
[0m07:43:57.214482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_players)
[0m07:43:57.214700 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m07:43:57.219661 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m07:43:57.220752 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m07:43:57.241238 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m07:43:57.241852 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:43:57.242116 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m07:43:57.242288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:57.243026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.243272 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:43:57.243488 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      select 
    can_transact,
    can_select,
    code,
    cost_change_event,
    cost_change_event_fall,
    cost_change_start,
    cost_change_start_fall,
    dreamteam_count::int as dreamteam_appearances,
    element_type::int as position_id,
    ep_next,
    ep_this,
    event_points,
    first_name,
    form,
    id,
    in_dreamteam,
    news,
    now_cost,
    photo,
    points_per_game,
    removed,
    second_name,
    selected_by_percent,
    special,
    status,
    team::int as team_id,
    team_code,
    total_points,
    transfers_in,
    transfers_in_event,
    transfers_out,
    transfers_out_event,
    value_form,
    value_season,
    web_name,
    region,
    team_join_date,
    birth_date,
    has_temporary_code,
    opta_code,
    minutes,
    goals_scored,
    assists,
    clean_sheets,
    goals_conceded,
    own_goals,
    penalties_saved,
    penalties_missed,
    yellow_cards,
    red_cards,
    saves,
    bonus,
    bps,
    influence,
    creativity,
    threat,
    ict_index,
    clearances_blocks_interceptions,
    recoveries,
    tackles,
    defensive_contribution,
    starts,
    expected_goals,
    expected_assists,
    expected_goal_involvements,
    expected_goals_conceded,
    influence_rank,
    influence_rank_type,
    creativity_rank,
    creativity_rank_type,
    threat_rank,
    threat_rank_type,
    ict_index_rank,
    ict_index_rank_type,
    corners_and_indirect_freekicks_text,
    direct_freekicks_text,
    penalties_text,
    expected_goals_per_90,
    saves_per_90,
    expected_assists_per_90,
    expected_goal_involvements_per_90,
    expected_goals_conceded_per_90,
    goals_conceded_per_90,
    now_cost_rank,
    now_cost_rank_type,
    form_rank,
    form_rank_type,
    points_per_game_rank,
    points_per_game_rank_type,
    selected_rank,
    selected_rank_type,
    starts_per_90,
    clean_sheets_per_90,
    defensive_contribution_per_90,
    _dlt_load_id,
    _dlt_id,
    chance_of_playing_next_round,
    chance_of_playing_this_round,
    news_added,
    corners_and_indirect_freekicks_order,
    direct_freekicks_order,
    penalties_order,
from "rawdb"."fpl"."elements"
    );
  
  
[0m07:43:57.253532 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m07:43:57.257008 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:43:57.257292 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:43:57.258120 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.258917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:43:57.259134 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m07:43:57.260047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.263917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:43:57.264178 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m07:43:57.265809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.267486 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:43:57.267712 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m07:43:57.268529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.277936 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:43:57.278183 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:43:57.278364 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m07:43:57.288104 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m07:43:57.291784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m07:43:57.292055 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m07:43:57.298081 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:43:57.300443 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m07:43:57.303228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afc5a86c90>]}
[0m07:43:57.303649 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.09s]
[0m07:43:57.304043 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m07:43:57.304345 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m07:43:57.304654 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.stg_teams ................................. [RUN]
[0m07:43:57.305057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_teams)
[0m07:43:57.305306 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m07:43:57.307498 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m07:43:57.307914 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m07:43:57.309745 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m07:43:57.310180 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:43:57.310407 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m07:43:57.310582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:57.311237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.311446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:43:57.311626 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      select 
    id::int as team_id,
    name::varchar as team_name,
    short_name::varchar as team_abbreviation,
    strength::int as team_strength_rating,
    strength_overall_home::int as team_strength_overall_home,
    strength_defence_home::int as team_strength_defence_home,
    strength_attack_home::int as team_strength_attack_home,
    strength_overall_away::int as team_strength_overall_away,
    strength_defence_away::int as team_strength_defence_away,
    strength_attack_away::int as team_strength_attack_away,
    *
from "rawdb"."fpl"."teams"
    );
  
  
[0m07:43:57.313814 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:43:57.314633 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:43:57.314870 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:43:57.315570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:43:57.316326 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:43:57.316535 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m07:43:57.317436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.319186 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:43:57.319402 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m07:43:57.320120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:43:57.322317 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:43:57.322580 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m07:43:57.323093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:43:57.323884 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:43:57.324092 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:43:57.324261 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m07:43:57.330336 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:43:57.331986 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m07:43:57.332243 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m07:43:57.337642 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:43:57.338666 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m07:43:57.339241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb2fb04a0>]}
[0m07:43:57.339679 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.03s]
[0m07:43:57.340145 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m07:43:57.340461 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m07:43:57.341084 [info ] [Thread-1 (]: 3 of 5 START sql table model intermediate.int_players .......................... [RUN]
[0m07:43:57.341448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_players)
[0m07:43:57.341729 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m07:43:57.343461 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m07:43:57.343897 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m07:43:57.346602 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m07:43:57.347005 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:43:57.347224 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m07:43:57.347420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:57.348089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.348302 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:43:57.348518 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 

source as (
    select 
        id,
        web_name,
        position_id,
        now_cost,
        form,
        dreamteam_appearances,
        team_id,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m07:43:57.350239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.350953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:43:57.351175 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:43:57.351851 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:43:57.352655 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:43:57.352884 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m07:43:57.353768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.398504 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:43:57.398886 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m07:43:57.399636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.401363 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:43:57.401698 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m07:43:57.402424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:43:57.403328 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:43:57.403607 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:43:57.403805 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m07:43:57.409604 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:43:57.411367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m07:43:57.411641 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m07:43:57.416771 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:43:57.418092 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m07:43:57.419127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb3089b50>]}
[0m07:43:57.419584 [info ] [Thread-1 (]: 3 of 5 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.08s]
[0m07:43:57.419988 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m07:43:57.420271 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m07:43:57.420592 [info ] [Thread-1 (]: 4 of 5 START sql table model intermediate.int_teams ............................ [RUN]
[0m07:43:57.421012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_teams)
[0m07:43:57.421226 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m07:43:57.423055 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m07:43:57.423554 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m07:43:57.425500 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m07:43:57.426042 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:43:57.426277 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m07:43:57.426500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:57.427193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.427425 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:43:57.427629 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 

source as (
    select 
        team_id,
        team_name,
        team_abbreviation,
        team_strength_rating,
        team_strength_overall_home,
        team_strength_defence_home,
        team_strength_attack_home,
        team_strength_overall_away,
        team_strength_defence_away,
        team_strength_attack_away    
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m07:43:57.429198 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.430161 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:43:57.430529 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:43:57.431414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.432281 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:43:57.432527 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m07:43:57.433388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.435352 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:43:57.435597 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m07:43:57.436134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:43:57.437733 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:43:57.438090 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m07:43:57.438613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:43:57.439572 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:43:57.439816 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:43:57.440015 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m07:43:57.445804 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:43:57.447268 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m07:43:57.447521 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m07:43:57.452581 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:43:57.453937 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m07:43:57.454483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb2f9f110>]}
[0m07:43:57.454912 [info ] [Thread-1 (]: 4 of 5 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.03s]
[0m07:43:57.455336 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m07:43:57.455955 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m07:43:57.456326 [info ] [Thread-1 (]: 5 of 5 START sql table model core.obt_players .................................. [RUN]
[0m07:43:57.456884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m07:43:57.457136 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m07:43:57.459142 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m07:43:57.459992 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m07:43:57.461788 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m07:43:57.462203 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:43:57.462428 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m07:43:57.462612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:57.463283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.463516 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:43:57.463708 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

add_team_name as (
    select
        players.*,
        teams.team_name,
        teams.team_abbreviation
    from players left join teams using(team_id)
)

select * from add_team_name
    );
  
  
[0m07:43:57.466821 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:43:57.467928 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:43:57.468340 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m07:43:57.469344 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.470235 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:43:57.470499 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m07:43:57.471727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:43:57.475123 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:43:57.475377 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m07:43:57.476135 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:43:57.478279 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:43:57.478522 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m07:43:57.479113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:43:57.479881 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m07:43:57.480151 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:43:57.480335 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m07:43:57.485977 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:43:57.488128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m07:43:57.488548 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m07:43:57.493711 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:43:57.494673 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m07:43:57.495242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5416dcd-f8ea-413c-8aae-3ed55fd6a876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb30d9a60>]}
[0m07:43:57.495693 [info ] [Thread-1 (]: 5 of 5 OK created sql table model core.obt_players ............................. [[32mOK[0m in 0.04s]
[0m07:43:57.496089 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m07:43:57.497358 [debug] [MainThread]: Using duckdb connection "master"
[0m07:43:57.497664 [debug] [MainThread]: On master: BEGIN
[0m07:43:57.497860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:57.498432 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:43:57.498632 [debug] [MainThread]: On master: COMMIT
[0m07:43:57.498851 [debug] [MainThread]: Using duckdb connection "master"
[0m07:43:57.499008 [debug] [MainThread]: On master: COMMIT
[0m07:43:57.499601 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:43:57.499946 [debug] [MainThread]: On master: Close
[0m07:43:57.500403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:57.500687 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m07:43:57.501067 [info ] [MainThread]: 
[0m07:43:57.501526 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m07:43:57.502313 [debug] [MainThread]: Command end result
[0m07:43:57.512664 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m07:43:57.513968 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m07:43:57.517938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m07:43:57.518178 [info ] [MainThread]: 
[0m07:43:57.518436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:57.518674 [info ] [MainThread]: 
[0m07:43:57.518919 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m07:43:57.520295 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0256325, "process_in_blocks": "95160", "process_kernel_time": 0.267987, "process_mem_max_rss": "164000", "process_out_blocks": "3360", "process_user_time": 2.258752}
[0m07:43:57.520632 [debug] [MainThread]: Command `dbt build` succeeded at 07:43:57.520565 after 1.03 seconds
[0m07:43:57.520860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb9607440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb937cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79afb937ff50>]}
[0m07:43:57.521105 [debug] [MainThread]: Flushing usage events
[0m07:43:58.087924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:06:08.488169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23716fb470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2371715c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2373527b60>]}


============================== 08:06:08.493212 | 9e6a0e0b-554d-4fd6-8fe6-38042a9bfdc2 ==============================
[0m08:06:08.493212 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:06:08.493660 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'quiet': 'False', 'printer_width': '80', 'invocation_command': 'dbt build', 'empty': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True', 'no_print': 'None'}
[0m08:06:08.727404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e6a0e0b-554d-4fd6-8fe6-38042a9bfdc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23705aa7e0>]}
[0m08:06:08.789925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e6a0e0b-554d-4fd6-8fe6-38042a9bfdc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23707f1cd0>]}
[0m08:06:08.792127 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:06:08.850292 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:06:08.953808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 13 files added, 6 files changed.
[0m08:06:08.954317 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/core/obt_players.yml
[0m08:06:08.954596 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_players.yml
[0m08:06:08.954812 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_teams.yml
[0m08:06:08.955013 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.yml
[0m08:06:08.955254 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_players.yml
[0m08:06:08.955518 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.yml
[0m08:06:08.955719 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.yml
[0m08:06:08.955894 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.sql
[0m08:06:08.956064 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.sql
[0m08:06:08.956273 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.yml
[0m08:06:08.956445 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.sql
[0m08:06:08.956629 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.sql
[0m08:06:08.956874 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.yml
[0m08:06:08.957368 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m08:06:08.957598 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.sql
[0m08:06:08.957823 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:06:08.958006 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m08:06:08.958182 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m08:06:08.958354 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m08:06:09.192659 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in fpl_analytics/models/core/obt_players.yml @ models: {'name': 'obt_players', 'description': None, 'tags': [], 'group': None, 'columns': [{'name': None, 'description': None}], 'original_file_path': 'fpl_analytics/models/core/obt_players.yml', 'yaml_key': 'models', 'package_name': 'fpl_analytics'} - at path ['description']: None is not of type 'string'
[0m08:06:09.196396 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7564289, "process_in_blocks": "78080", "process_kernel_time": 0.329951, "process_mem_max_rss": "144452", "process_out_blocks": "16", "process_user_time": 1.928947}
[0m08:06:09.196799 [debug] [MainThread]: Command `dbt build` failed at 08:06:09.196725 after 0.76 seconds
[0m08:06:09.197224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2370c1b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23668a1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23668ebe00>]}
[0m08:06:09.197503 [debug] [MainThread]: Flushing usage events
[0m08:06:09.656369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:09:59.101164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c957512540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c95796cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c957f01010>]}


============================== 08:09:59.105059 | d7ed1e52-df16-4990-b336-40555dac5013 ==============================
[0m08:09:59.105059 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:09:59.105673 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'write_json': 'True'}
[0m08:09:59.309641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7ed1e52-df16-4990-b336-40555dac5013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c957f02900>]}
[0m08:09:59.367854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7ed1e52-df16-4990-b336-40555dac5013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c956eec620>]}
[0m08:09:59.371756 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:09:59.424245 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:09:59.520967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 13 files added, 6 files changed.
[0m08:09:59.521433 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_players.yml
[0m08:09:59.521724 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.yml
[0m08:09:59.521961 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/core/obt_players.yml
[0m08:09:59.522159 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.yml
[0m08:09:59.522381 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.yml
[0m08:09:59.522622 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_players.yml
[0m08:09:59.522825 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.sql
[0m08:09:59.523024 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_teams.yml
[0m08:09:59.523205 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.yml
[0m08:09:59.523373 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.sql
[0m08:09:59.523545 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.yml
[0m08:09:59.523702 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.sql
[0m08:09:59.523875 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.sql
[0m08:09:59.524353 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m08:09:59.524584 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.sql
[0m08:09:59.524798 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m08:09:59.524979 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:09:59.525153 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m08:09:59.525320 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m08:09:59.854024 [error] [MainThread]: Encountered an error:
Parsing Error in model stg_gameweeks (fpl_analytics/models/staging/stg_gameweeks.sql)
  Invalid group 'stg', expected one of []
[0m08:09:59.858250 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8057393, "process_in_blocks": "90736", "process_kernel_time": 0.329228, "process_mem_max_rss": "146504", "process_out_blocks": "16", "process_user_time": 1.967033}
[0m08:09:59.858652 [debug] [MainThread]: Command `dbt build` failed at 08:09:59.858582 after 0.81 seconds
[0m08:09:59.858943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c957512540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c92dd73b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c92dd73560>]}
[0m08:09:59.859219 [debug] [MainThread]: Flushing usage events
[0m08:10:00.286002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:10:13.355732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d4abe34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d4cbba5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d4a8282c0>]}


============================== 08:10:13.358208 | ca5f8c5a-5bde-4e6f-82b4-e375d5eb0a67 ==============================
[0m08:10:13.358208 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:10:13.358619 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/robgriffin247/fpl', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'invocation_command': 'dbt build', 'empty': 'False', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True'}
[0m08:10:13.539505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca5f8c5a-5bde-4e6f-82b4-e375d5eb0a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d4c8b7980>]}
[0m08:10:13.594778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca5f8c5a-5bde-4e6f-82b4-e375d5eb0a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d4cd7c170>]}
[0m08:10:13.596010 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:10:13.642194 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:10:13.704641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 13 files added, 6 files changed.
[0m08:10:13.705080 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.yml
[0m08:10:13.705309 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.sql
[0m08:10:13.705584 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/core/obt_players.yml
[0m08:10:13.705909 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_players.yml
[0m08:10:13.706125 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.yml
[0m08:10:13.706327 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.sql
[0m08:10:13.706574 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_teams.yml
[0m08:10:13.706764 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.yml
[0m08:10:13.706968 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_players.yml
[0m08:10:13.707135 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.sql
[0m08:10:13.707352 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.yml
[0m08:10:13.707539 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.yml
[0m08:10:13.707688 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.sql
[0m08:10:13.708066 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m08:10:13.708305 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m08:10:13.708489 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m08:10:13.708664 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m08:10:13.708837 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:10:13.708994 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.sql
[0m08:10:14.038000 [error] [MainThread]: Encountered an error:
Parsing Error in model stg_positions (fpl_analytics/models/staging/stg_positions.sql)
  Invalid group 'stg', expected one of []
[0m08:10:14.038899 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7324557, "process_in_blocks": "0", "process_kernel_time": 0.238641, "process_mem_max_rss": "147028", "process_out_blocks": "8", "process_user_time": 1.858892}
[0m08:10:14.039252 [debug] [MainThread]: Command `dbt build` failed at 08:10:14.039184 after 0.73 seconds
[0m08:10:14.039506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d4aff2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d3d116150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d3d01f6b0>]}
[0m08:10:14.039739 [debug] [MainThread]: Flushing usage events
[0m08:10:14.580397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:10:27.534264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62bfbc7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62bfa01fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62c12e2060>]}


============================== 08:10:27.536463 | 66ae74c6-22e6-447e-8903-602dee0c8ac8 ==============================
[0m08:10:27.536463 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:10:27.536846 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'no_print': 'None'}
[0m08:10:27.714367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66ae74c6-22e6-447e-8903-602dee0c8ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62bb1132c0>]}
[0m08:10:27.768909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66ae74c6-22e6-447e-8903-602dee0c8ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62b576a750>]}
[0m08:10:27.770004 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:10:27.816528 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:10:27.875523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 13 files added, 6 files changed.
[0m08:10:27.875919 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/core/obt_players.yml
[0m08:10:27.876158 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.yml
[0m08:10:27.876337 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.sql
[0m08:10:27.876521 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.yml
[0m08:10:27.876695 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_teams.yml
[0m08:10:27.876886 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.sql
[0m08:10:27.877089 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.sql
[0m08:10:27.877264 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.yml
[0m08:10:27.877412 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.sql
[0m08:10:27.877574 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.yml
[0m08:10:27.877731 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.yml
[0m08:10:27.877894 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_players.yml
[0m08:10:27.878085 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_players.yml
[0m08:10:27.878454 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m08:10:27.878676 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m08:10:27.878887 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:10:27.879057 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m08:10:27.879216 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m08:10:27.879373 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.sql
[0m08:10:28.201277 [error] [MainThread]: Encountered an error:
Parsing Error in model stg_positions (fpl_analytics/models/staging/stg_positions.sql)
  Invalid group 'stg', expected one of []
[0m08:10:28.202089 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.714357, "process_in_blocks": "0", "process_kernel_time": 0.169039, "process_mem_max_rss": "147112", "process_out_blocks": "8", "process_user_time": 1.842941}
[0m08:10:28.202420 [debug] [MainThread]: Command `dbt build` failed at 08:10:28.202354 after 0.71 seconds
[0m08:10:28.202664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62c0421460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62b5205880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62af913320>]}
[0m08:10:28.202979 [debug] [MainThread]: Flushing usage events
[0m08:10:28.716115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:11:20.946459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676b74f6f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676b6ae1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676b7095c40>]}


============================== 08:11:20.950871 | c8b568b8-5482-43e2-b38e-3a585b06c17e ==============================
[0m08:11:20.950871 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:11:20.951298 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'log_path': '/home/robgriffin247/fpl/logs', 'debug': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'empty': 'False', 'target_path': 'None'}
[0m08:11:21.153874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676b7605be0>]}
[0m08:11:21.205791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676b6a15820>]}
[0m08:11:21.207780 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:11:21.258575 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:11:21.347762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 14 files added, 6 files changed.
[0m08:11:21.348164 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.yml
[0m08:11:21.348458 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/_groups.yml
[0m08:11:21.348664 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/core/obt_players.yml
[0m08:11:21.348841 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.sql
[0m08:11:21.349060 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.yml
[0m08:11:21.349274 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_players.yml
[0m08:11:21.349447 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.sql
[0m08:11:21.349650 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.yml
[0m08:11:21.349825 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.sql
[0m08:11:21.349983 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.sql
[0m08:11:21.350150 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.yml
[0m08:11:21.350334 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_positions.yml
[0m08:11:21.350508 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_teams.yml
[0m08:11:21.350672 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_players.yml
[0m08:11:21.351121 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m08:11:21.351343 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.sql
[0m08:11:21.351530 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m08:11:21.351705 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:11:21.351882 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m08:11:21.352059 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m08:11:21.746997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676ac4b2c60>]}
[0m08:11:21.786003 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:11:21.787571 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:11:21.814516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676ac564860>]}
[0m08:11:21.814865 [info ] [MainThread]: Found 9 models, 4 sources, 445 macros, 3 groups
[0m08:11:21.816364 [info ] [MainThread]: 
[0m08:11:21.816665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:11:21.816946 [info ] [MainThread]: 
[0m08:11:21.817353 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:11:21.820958 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m08:11:21.848752 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:11:21.849085 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:11:21.849319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:21.874838 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m08:11:21.875894 [debug] [ThreadPool]: On list_analytics: Close
[0m08:11:21.877395 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:11:21.877722 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:11:21.877910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:21.878704 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:11:21.879547 [debug] [ThreadPool]: On list_analytics: Close
[0m08:11:21.880860 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:11:21.881119 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:11:21.881397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:21.882243 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:11:21.882934 [debug] [ThreadPool]: On list_analytics: Close
[0m08:11:21.883479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m08:11:21.883805 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m08:11:21.887898 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:11:21.888120 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:11:21.888295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:21.889199 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:11:21.890183 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:11:21.890378 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m08:11:21.890790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:11:21.890968 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:11:21.891108 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m08:11:21.891534 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:11:21.892012 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:11:21.892179 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:11:21.892311 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:11:21.898520 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m08:11:21.898964 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m08:11:21.899717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m08:11:21.900122 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m08:11:21.901147 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:11:21.901362 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:11:21.901556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:21.902383 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:11:21.903225 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:11:21.903443 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m08:11:21.903862 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:11:21.904041 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:11:21.904187 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m08:11:21.904583 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:11:21.905066 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:11:21.905262 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:11:21.905419 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:11:21.910548 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:11:21.910801 [debug] [ThreadPool]: On create_analytics_core: Close
[0m08:11:21.911255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m08:11:21.911560 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m08:11:21.912605 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:11:21.912830 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:11:21.913030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:21.914026 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:11:21.914795 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:11:21.914984 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m08:11:21.915586 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:11:21.915787 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:11:21.915944 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m08:11:21.916560 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:11:21.917073 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:11:21.917261 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:11:21.917449 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:11:21.921894 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:11:21.922123 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m08:11:21.923623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m08:11:21.926985 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:11:21.927246 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m08:11:21.927446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:21.928067 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:11:21.928247 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:11:21.928391 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m08:11:21.936726 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m08:11:21.937881 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m08:11:21.939371 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m08:11:21.939581 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m08:11:21.940053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m08:11:21.941147 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:11:21.941410 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m08:11:21.941775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:21.942280 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:11:21.942462 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:11:21.942611 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m08:11:21.944862 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:11:21.945624 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m08:11:21.946199 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m08:11:21.946378 [debug] [ThreadPool]: On list_analytics_core: Close
[0m08:11:21.946778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m08:11:21.948619 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:11:21.949003 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m08:11:21.949197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:21.949803 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:11:21.949999 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:11:21.950158 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m08:11:21.952662 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:11:21.953520 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m08:11:21.954115 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m08:11:21.954293 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m08:11:21.954998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676ac195c70>]}
[0m08:11:21.955398 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:21.955568 [debug] [MainThread]: On master: BEGIN
[0m08:11:21.955703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:11:21.956206 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:11:21.956373 [debug] [MainThread]: On master: COMMIT
[0m08:11:21.956537 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:21.956675 [debug] [MainThread]: On master: COMMIT
[0m08:11:21.957038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:11:21.957208 [debug] [MainThread]: On master: Close
[0m08:11:21.961057 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m08:11:21.961560 [info ] [Thread-1 (]: 1 of 9 START sql table model staging.stg_gameweeks ............................. [RUN]
[0m08:11:21.961960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m08:11:21.962183 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m08:11:21.966987 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m08:11:21.967989 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m08:11:21.987644 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m08:11:21.988942 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:11:21.989228 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m08:11:21.989415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:21.990136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:21.990380 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:11:21.990569 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m08:11:21.994353 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:11:21.997879 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:11:21.998143 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m08:11:21.999626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.007174 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:11:22.007422 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:11:22.007597 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:11:22.014014 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:11:22.017152 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:11:22.017414 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m08:11:22.018101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.019497 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m08:11:22.021355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676b75b1490>]}
[0m08:11:22.021840 [info ] [Thread-1 (]: 1 of 9 OK created sql table model staging.stg_gameweeks ........................ [[32mOK[0m in 0.06s]
[0m08:11:22.022202 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m08:11:22.022477 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m08:11:22.022805 [info ] [Thread-1 (]: 2 of 9 START sql table model staging.stg_players ............................... [RUN]
[0m08:11:22.023150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m08:11:22.023393 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m08:11:22.025133 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m08:11:22.025843 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m08:11:22.027495 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m08:11:22.027894 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:11:22.028109 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m08:11:22.028297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:22.029238 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.029492 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:11:22.029770 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
)

select * from source
    );
  
  
[0m08:11:22.040605 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:11:22.042940 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:11:22.043235 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m08:11:22.044365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.045562 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:11:22.045917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:11:22.046093 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:11:22.054417 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:11:22.056851 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:11:22.057108 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m08:11:22.057715 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.058592 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m08:11:22.059347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676810e3a10>]}
[0m08:11:22.059796 [info ] [Thread-1 (]: 2 of 9 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.04s]
[0m08:11:22.060172 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m08:11:22.060440 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m08:11:22.060742 [info ] [Thread-1 (]: 3 of 9 START sql table model staging.stg_positions ............................. [RUN]
[0m08:11:22.061514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m08:11:22.061840 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m08:11:22.063497 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m08:11:22.063863 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m08:11:22.065557 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m08:11:22.066012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:11:22.066243 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m08:11:22.066423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:22.067082 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.067281 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:11:22.067458 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m08:11:22.069769 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:11:22.071357 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:11:22.071599 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m08:11:22.072426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.073544 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:11:22.073901 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:11:22.074127 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:11:22.079658 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:11:22.081629 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:11:22.081879 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m08:11:22.082479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.083381 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m08:11:22.083872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676810186e0>]}
[0m08:11:22.084282 [info ] [Thread-1 (]: 3 of 9 OK created sql table model staging.stg_positions ........................ [[32mOK[0m in 0.02s]
[0m08:11:22.084694 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m08:11:22.084951 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m08:11:22.085255 [info ] [Thread-1 (]: 4 of 9 START sql table model staging.stg_teams ................................. [RUN]
[0m08:11:22.085616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_teams)
[0m08:11:22.086238 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m08:11:22.087813 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m08:11:22.088215 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m08:11:22.090080 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m08:11:22.090569 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:11:22.090789 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m08:11:22.090963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:22.091832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.092198 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:11:22.092560 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m08:11:22.094923 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:11:22.096634 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:11:22.096860 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m08:11:22.097375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.098191 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:11:22.098417 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:11:22.098595 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:11:22.103916 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:11:22.105506 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:11:22.105788 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m08:11:22.106368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.107226 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m08:11:22.107707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76768100e360>]}
[0m08:11:22.108115 [info ] [Thread-1 (]: 4 of 9 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.02s]
[0m08:11:22.108475 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m08:11:22.108728 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m08:11:22.109046 [info ] [Thread-1 (]: 5 of 9 START sql table model intermediate.int_gameweeks ........................ [RUN]
[0m08:11:22.109695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m08:11:22.110288 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m08:11:22.112692 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m08:11:22.113931 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m08:11:22.115549 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m08:11:22.116327 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:11:22.116598 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m08:11:22.116784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:22.117720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.118033 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:11:22.118267 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m08:11:22.120309 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:11:22.123046 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:11:22.123287 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m08:11:22.124089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.125300 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:11:22.125827 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:11:22.126081 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:11:22.132623 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:11:22.134110 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:11:22.134406 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m08:11:22.135066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.135958 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m08:11:22.136673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676800a7d40>]}
[0m08:11:22.137103 [info ] [Thread-1 (]: 5 of 9 OK created sql table model intermediate.int_gameweeks ................... [[32mOK[0m in 0.03s]
[0m08:11:22.137474 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m08:11:22.137786 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m08:11:22.138087 [info ] [Thread-1 (]: 6 of 9 START sql table model intermediate.int_players .......................... [RUN]
[0m08:11:22.138432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m08:11:22.138682 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m08:11:22.140209 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m08:11:22.140761 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m08:11:22.142421 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m08:11:22.142789 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:11:22.142998 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m08:11:22.143175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:22.143784 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.143990 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:11:22.144161 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m08:11:22.152038 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:11:22.154033 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:11:22.154273 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m08:11:22.154927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.155638 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:11:22.155861 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:11:22.156033 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:11:22.164705 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:11:22.166394 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:11:22.166650 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m08:11:22.167233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.168102 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m08:11:22.168734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676811d39b0>]}
[0m08:11:22.169153 [info ] [Thread-1 (]: 6 of 9 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.03s]
[0m08:11:22.169521 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m08:11:22.169815 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m08:11:22.170127 [info ] [Thread-1 (]: 7 of 9 START sql table model intermediate.int_positions ........................ [RUN]
[0m08:11:22.170714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m08:11:22.170926 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m08:11:22.172401 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m08:11:22.172718 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m08:11:22.174357 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m08:11:22.174784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:11:22.174979 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m08:11:22.175138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:22.175680 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.175871 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:11:22.176028 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m08:11:22.177182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.178758 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:11:22.179042 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m08:11:22.179713 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.180573 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:11:22.180808 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:11:22.181000 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:11:22.186951 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:11:22.188291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:11:22.188544 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m08:11:22.189051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.189874 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m08:11:22.190333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676810c02f0>]}
[0m08:11:22.190706 [info ] [Thread-1 (]: 7 of 9 OK created sql table model intermediate.int_positions ................... [[32mOK[0m in 0.02s]
[0m08:11:22.191053 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m08:11:22.191323 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m08:11:22.191615 [info ] [Thread-1 (]: 8 of 9 START sql table model intermediate.int_teams ............................ [RUN]
[0m08:11:22.191957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m08:11:22.192493 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m08:11:22.194169 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m08:11:22.194613 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m08:11:22.197302 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m08:11:22.197765 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:11:22.197994 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m08:11:22.198176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:22.198831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.199022 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:11:22.199185 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m08:11:22.200828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.202432 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:11:22.202702 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m08:11:22.203254 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.204072 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:11:22.204307 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:11:22.204493 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:11:22.209292 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:11:22.210797 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:11:22.211047 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m08:11:22.211607 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.212463 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m08:11:22.212954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767680086ea0>]}
[0m08:11:22.213371 [info ] [Thread-1 (]: 8 of 9 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.02s]
[0m08:11:22.213763 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m08:11:22.214019 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m08:11:22.214319 [info ] [Thread-1 (]: 9 of 9 START sql table model core.obt_players .................................. [RUN]
[0m08:11:22.214761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m08:11:22.214996 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m08:11:22.216576 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m08:11:22.217547 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m08:11:22.219288 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m08:11:22.219697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:11:22.219907 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m08:11:22.220091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:22.220801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.221003 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:11:22.221174 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m08:11:22.228271 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:11:22.230179 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:11:22.230412 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m08:11:22.231095 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:11:22.232109 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:11:22.232356 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:11:22.232546 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:11:22.239317 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:11:22.240922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:11:22.241180 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m08:11:22.241956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:11:22.242843 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m08:11:22.243758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b568b8-5482-43e2-b38e-3a585b06c17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676811d1130>]}
[0m08:11:22.244197 [info ] [Thread-1 (]: 9 of 9 OK created sql table model core.obt_players ............................. [[32mOK[0m in 0.03s]
[0m08:11:22.244577 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m08:11:22.246096 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:22.246385 [debug] [MainThread]: On master: BEGIN
[0m08:11:22.246557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:11:22.247199 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:11:22.247444 [debug] [MainThread]: On master: COMMIT
[0m08:11:22.247614 [debug] [MainThread]: Using duckdb connection "master"
[0m08:11:22.247770 [debug] [MainThread]: On master: COMMIT
[0m08:11:22.248207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:11:22.248402 [debug] [MainThread]: On master: Close
[0m08:11:22.248705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:22.248865 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m08:11:22.249080 [info ] [MainThread]: 
[0m08:11:22.249343 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m08:11:22.250326 [debug] [MainThread]: Command end result
[0m08:11:22.261560 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:11:22.262928 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:11:22.266918 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m08:11:22.267221 [info ] [MainThread]: 
[0m08:11:22.267517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:11:22.267829 [info ] [MainThread]: 
[0m08:11:22.268067 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m08:11:22.270354 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3721724, "process_in_blocks": "59048", "process_kernel_time": 0.249616, "process_mem_max_rss": "172492", "process_out_blocks": "6568", "process_user_time": 2.518451}
[0m08:11:22.270771 [debug] [MainThread]: Command `dbt build` succeeded at 08:11:22.270690 after 1.37 seconds
[0m08:11:22.271015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676b6e8c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676b7095c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676b7464410>]}
[0m08:11:22.271265 [debug] [MainThread]: Flushing usage events
[0m08:11:22.870629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:12:28.860143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19bb17a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19bb145850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19bb146780>]}


============================== 08:12:28.865771 | fb079cf6-8724-41ac-ad0a-b4cf7a74c685 ==============================
[0m08:12:28.865771 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:12:28.866387 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'empty': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'log_format': 'default', 'version_check': 'True', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80'}
[0m08:12:29.095133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19bd17e960>]}
[0m08:12:29.157626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19baa2e1b0>]}
[0m08:12:29.160077 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:12:29.222805 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:12:29.330715 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 9 files changed.
[0m08:12:29.331348 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.yml
[0m08:12:29.331689 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_gameweeks.yml
[0m08:12:29.332009 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.yml
[0m08:12:29.332349 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_positions.yml
[0m08:12:29.332624 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.yml
[0m08:12:29.332878 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.yml
[0m08:12:29.333154 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.yml
[0m08:12:29.333395 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.yml
[0m08:12:29.333613 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_positions.yml
[0m08:12:29.630470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d199b189c40>]}
[0m08:12:29.716392 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:12:29.718411 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:12:29.749224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19b0af2ea0>]}
[0m08:12:29.749626 [info ] [MainThread]: Found 9 models, 4 sources, 445 macros
[0m08:12:29.751303 [info ] [MainThread]: 
[0m08:12:29.751658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:12:29.751903 [info ] [MainThread]: 
[0m08:12:29.752320 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:12:29.756102 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m08:12:29.790614 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:12:29.791087 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:12:29.791367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:29.827004 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m08:12:29.828351 [debug] [ThreadPool]: On list_analytics: Close
[0m08:12:29.830451 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:12:29.830859 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:12:29.831087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:29.832415 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.833319 [debug] [ThreadPool]: On list_analytics: Close
[0m08:12:29.834806 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:12:29.835090 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:12:29.835310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:29.836411 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.837309 [debug] [ThreadPool]: On list_analytics: Close
[0m08:12:29.838048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m08:12:29.838445 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m08:12:29.843955 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:12:29.844339 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:12:29.844598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:29.846086 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.847465 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:12:29.847758 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m08:12:29.848308 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:12:29.848545 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:12:29.848763 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m08:12:29.849262 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:12:29.849939 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:12:29.850198 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:12:29.850384 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:12:29.850852 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:12:29.851116 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m08:12:29.851623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m08:12:29.851955 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m08:12:29.853178 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:12:29.853442 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:12:29.853714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:29.854938 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.856286 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:12:29.856788 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m08:12:29.857849 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.858177 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:12:29.858391 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m08:12:29.859260 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.860006 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:12:29.860289 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:12:29.860484 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:12:29.861475 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.861815 [debug] [ThreadPool]: On create_analytics_core: Close
[0m08:12:29.862505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m08:12:29.862894 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m08:12:29.864269 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:12:29.864542 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:12:29.864812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:29.866071 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.867104 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:12:29.867325 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m08:12:29.867936 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:12:29.868180 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:12:29.868375 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m08:12:29.868853 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:12:29.869480 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:12:29.869764 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:12:29.869993 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:12:29.870506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:12:29.870733 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m08:12:29.872768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m08:12:29.877623 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:12:29.878847 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m08:12:29.879983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:29.881293 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.881587 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:12:29.881803 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m08:12:29.892184 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:12:29.893388 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m08:12:29.896985 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m08:12:29.897258 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m08:12:29.897818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m08:12:29.900118 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:12:29.900394 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m08:12:29.900604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:29.901767 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.902363 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:12:29.902626 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m08:12:29.905608 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:12:29.906863 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m08:12:29.907570 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m08:12:29.907829 [debug] [ThreadPool]: On list_analytics_core: Close
[0m08:12:29.908532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m08:12:29.909806 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:12:29.910074 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m08:12:29.910316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:29.911403 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:12:29.911640 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:12:29.911833 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m08:12:29.914691 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:12:29.915754 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m08:12:29.916324 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m08:12:29.916527 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m08:12:29.917830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d199b10c710>]}
[0m08:12:29.918254 [debug] [MainThread]: Using duckdb connection "master"
[0m08:12:29.918472 [debug] [MainThread]: On master: BEGIN
[0m08:12:29.918648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:29.919277 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:12:29.919537 [debug] [MainThread]: On master: COMMIT
[0m08:12:29.919731 [debug] [MainThread]: Using duckdb connection "master"
[0m08:12:29.919912 [debug] [MainThread]: On master: COMMIT
[0m08:12:29.920378 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:12:29.920593 [debug] [MainThread]: On master: Close
[0m08:12:29.924652 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m08:12:29.925194 [info ] [Thread-1 (]: 1 of 9 START sql table model staging.stg_gameweeks ............................. [RUN]
[0m08:12:29.925655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_gameweeks)
[0m08:12:29.925966 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m08:12:29.931519 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m08:12:29.932030 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m08:12:29.955442 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m08:12:29.956154 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:12:29.956449 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m08:12:29.956663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:29.957581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:29.957859 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:12:29.958080 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m08:12:29.963640 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:12:29.967789 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:12:29.968119 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:12:29.969012 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:29.970349 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:12:29.970785 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:12:29.972552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:29.979294 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:12:29.979724 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m08:12:29.981646 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:12:29.983798 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:12:29.984117 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m08:12:29.985084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:29.996533 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:12:29.996946 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:12:29.997181 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:12:30.005674 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:12:30.010120 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:12:30.010499 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m08:12:30.015640 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:12:30.017551 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m08:12:30.019982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d197a521520>]}
[0m08:12:30.020654 [info ] [Thread-1 (]: 1 of 9 OK created sql table model staging.stg_gameweeks ........................ [[32mOK[0m in 0.09s]
[0m08:12:30.021151 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m08:12:30.021478 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m08:12:30.021874 [info ] [Thread-1 (]: 2 of 9 START sql table model staging.stg_players ............................... [RUN]
[0m08:12:30.022359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m08:12:30.023026 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m08:12:30.025356 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m08:12:30.025956 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m08:12:30.029309 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m08:12:30.029772 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:12:30.030044 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m08:12:30.030275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:30.031017 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.031276 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:12:30.031487 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
)

select * from source
    );
  
  
[0m08:12:30.043573 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m08:12:30.044659 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:12:30.044973 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:12:30.045939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.046905 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:12:30.047160 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:12:30.048383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.050559 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:12:30.050853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m08:12:30.051595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:12:30.053611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:12:30.053915 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m08:12:30.054740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.055705 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:12:30.056009 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:12:30.056218 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:12:30.064683 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:12:30.066620 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:12:30.066934 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m08:12:30.072892 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:12:30.074573 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m08:12:30.075383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19b0db9f70>]}
[0m08:12:30.075865 [info ] [Thread-1 (]: 2 of 9 OK created sql table model staging.stg_players .......................... [[32mOK[0m in 0.05s]
[0m08:12:30.076323 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m08:12:30.076617 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m08:12:30.077303 [info ] [Thread-1 (]: 3 of 9 START sql table model staging.stg_positions ............................. [RUN]
[0m08:12:30.077744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m08:12:30.078008 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m08:12:30.080081 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m08:12:30.080542 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m08:12:30.082621 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m08:12:30.083155 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:12:30.083418 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m08:12:30.083631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:30.084625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.084912 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:12:30.085128 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m08:12:30.087610 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:12:30.088558 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:12:30.088863 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:12:30.089716 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.090705 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:12:30.090966 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:12:30.092135 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.094348 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:12:30.094630 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m08:12:30.095212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:12:30.096917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:12:30.097171 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m08:12:30.097852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:12:30.098816 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:12:30.099085 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:12:30.099292 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:12:30.106061 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:12:30.107963 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:12:30.108265 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m08:12:30.114036 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:12:30.115152 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m08:12:30.115738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d197a545070>]}
[0m08:12:30.116201 [info ] [Thread-1 (]: 3 of 9 OK created sql table model staging.stg_positions ........................ [[32mOK[0m in 0.04s]
[0m08:12:30.116649 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m08:12:30.116950 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m08:12:30.117349 [info ] [Thread-1 (]: 4 of 9 START sql table model staging.stg_teams ................................. [RUN]
[0m08:12:30.119032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_teams)
[0m08:12:30.119656 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m08:12:30.122365 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m08:12:30.122948 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m08:12:30.124950 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m08:12:30.125443 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:12:30.125696 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m08:12:30.125930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:30.127097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.127398 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:12:30.127613 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m08:12:30.131267 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:12:30.132273 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:12:30.132632 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:12:30.133886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.135077 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:12:30.135410 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:12:30.136766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.140267 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:12:30.140552 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m08:12:30.141574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.143383 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:12:30.143640 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m08:12:30.144279 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:12:30.145167 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:12:30.145427 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:12:30.145664 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:12:30.152335 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:12:30.154271 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:12:30.154594 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m08:12:30.161539 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:12:30.162986 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m08:12:30.163840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d197a5826c0>]}
[0m08:12:30.164325 [info ] [Thread-1 (]: 4 of 9 OK created sql table model staging.stg_teams ............................ [[32mOK[0m in 0.05s]
[0m08:12:30.164800 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m08:12:30.165107 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m08:12:30.165459 [info ] [Thread-1 (]: 5 of 9 START sql table model intermediate.int_gameweeks ........................ [RUN]
[0m08:12:30.166320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m08:12:30.166678 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m08:12:30.168823 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m08:12:30.169391 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m08:12:30.171450 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m08:12:30.171928 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:12:30.172185 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m08:12:30.172390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:30.173143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.173375 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:12:30.173580 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m08:12:30.176209 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:12:30.177197 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:12:30.177480 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:12:30.178439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.179493 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:12:30.179790 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:12:30.181095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.183666 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:12:30.183996 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m08:12:30.184945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.187182 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:12:30.187487 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m08:12:30.188170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:12:30.189154 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:12:30.189419 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:12:30.189659 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:12:30.196033 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:12:30.197882 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:12:30.198342 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m08:12:30.203923 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:12:30.205563 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m08:12:30.206491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1998d23680>]}
[0m08:12:30.207100 [info ] [Thread-1 (]: 5 of 9 OK created sql table model intermediate.int_gameweeks ................... [[32mOK[0m in 0.04s]
[0m08:12:30.207575 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m08:12:30.207964 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m08:12:30.208318 [info ] [Thread-1 (]: 6 of 9 START sql table model intermediate.int_players .......................... [RUN]
[0m08:12:30.208754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m08:12:30.209141 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m08:12:30.211175 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m08:12:30.211755 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m08:12:30.214193 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m08:12:30.215291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:12:30.215784 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m08:12:30.216172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:30.217441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.217935 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:12:30.218412 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m08:12:30.228825 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:12:30.229827 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:12:30.230372 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:12:30.231434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.233041 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:12:30.233323 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:12:30.234566 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.238091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:12:30.238426 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m08:12:30.239091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:12:30.240860 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:12:30.241116 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m08:12:30.241955 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.242923 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:12:30.243178 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:12:30.243429 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:12:30.254510 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:12:30.256408 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:12:30.256723 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m08:12:30.262407 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:12:30.263707 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m08:12:30.264971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d197a596480>]}
[0m08:12:30.265489 [info ] [Thread-1 (]: 6 of 9 OK created sql table model intermediate.int_players ..................... [[32mOK[0m in 0.06s]
[0m08:12:30.265976 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m08:12:30.266341 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m08:12:30.266708 [info ] [Thread-1 (]: 7 of 9 START sql table model intermediate.int_positions ........................ [RUN]
[0m08:12:30.267163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m08:12:30.267479 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m08:12:30.269508 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m08:12:30.270386 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m08:12:30.272414 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m08:12:30.272873 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:12:30.273161 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m08:12:30.273379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:30.274193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.274463 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:12:30.274682 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m08:12:30.276059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.276889 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:12:30.277142 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:12:30.278032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.279055 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:12:30.279341 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:12:30.280677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.283126 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:12:30.283413 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m08:12:30.284276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.286996 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:12:30.287416 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m08:12:30.288274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.289231 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:12:30.289496 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:12:30.289710 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:12:30.295431 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:12:30.297372 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:12:30.297658 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m08:12:30.303501 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:12:30.305001 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m08:12:30.305622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d197a51aba0>]}
[0m08:12:30.306141 [info ] [Thread-1 (]: 7 of 9 OK created sql table model intermediate.int_positions ................... [[32mOK[0m in 0.04s]
[0m08:12:30.306587 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m08:12:30.306872 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m08:12:30.307211 [info ] [Thread-1 (]: 8 of 9 START sql table model intermediate.int_teams ............................ [RUN]
[0m08:12:30.307646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m08:12:30.307896 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m08:12:30.309555 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m08:12:30.309991 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m08:12:30.312229 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m08:12:30.312799 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:12:30.313095 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m08:12:30.313315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:30.314316 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.314738 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:12:30.315125 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m08:12:30.317544 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:12:30.318655 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:12:30.318956 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:12:30.319823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.320720 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:12:30.320978 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:12:30.321897 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.323959 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:12:30.324225 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m08:12:30.324935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:12:30.328598 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:12:30.328947 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m08:12:30.329742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.330731 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:12:30.331001 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:12:30.331216 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:12:30.336396 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:12:30.338186 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:12:30.338480 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m08:12:30.343435 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:12:30.344657 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m08:12:30.345302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d197a55d010>]}
[0m08:12:30.345788 [info ] [Thread-1 (]: 8 of 9 OK created sql table model intermediate.int_teams ....................... [[32mOK[0m in 0.04s]
[0m08:12:30.346289 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m08:12:30.346594 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m08:12:30.346973 [info ] [Thread-1 (]: 9 of 9 START sql table model core.obt_players .................................. [RUN]
[0m08:12:30.347601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m08:12:30.347912 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m08:12:30.349858 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m08:12:30.350389 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m08:12:30.352268 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m08:12:30.352711 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:12:30.352947 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m08:12:30.353186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:30.354207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.354660 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:12:30.354900 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m08:12:30.363970 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:12:30.365321 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:12:30.365732 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:12:30.366888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.368046 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:12:30.368323 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:12:30.369318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.371663 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:12:30.372060 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m08:12:30.373008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:12:30.375950 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:12:30.376475 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m08:12:30.377963 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:12:30.379628 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:12:30.379997 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:12:30.380216 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:12:30.389428 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:12:30.391736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:12:30.392313 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m08:12:30.399552 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:12:30.400873 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m08:12:30.402311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb079cf6-8724-41ac-ad0a-b4cf7a74c685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1998d17d40>]}
[0m08:12:30.402999 [info ] [Thread-1 (]: 9 of 9 OK created sql table model core.obt_players ............................. [[32mOK[0m in 0.05s]
[0m08:12:30.403600 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m08:12:30.405865 [debug] [MainThread]: Using duckdb connection "master"
[0m08:12:30.406405 [debug] [MainThread]: On master: BEGIN
[0m08:12:30.406684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:12:30.407547 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:12:30.407876 [debug] [MainThread]: On master: COMMIT
[0m08:12:30.408115 [debug] [MainThread]: Using duckdb connection "master"
[0m08:12:30.408324 [debug] [MainThread]: On master: COMMIT
[0m08:12:30.409031 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:12:30.409363 [debug] [MainThread]: On master: Close
[0m08:12:30.409897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:30.410190 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m08:12:30.410483 [info ] [MainThread]: 
[0m08:12:30.410780 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m08:12:30.411986 [debug] [MainThread]: Command end result
[0m08:12:30.425411 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:12:30.427339 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:12:30.432156 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m08:12:30.432505 [info ] [MainThread]: 
[0m08:12:30.432858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:12:30.433129 [info ] [MainThread]: 
[0m08:12:30.433425 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m08:12:30.435159 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.631337, "process_in_blocks": "105592", "process_kernel_time": 0.402525, "process_mem_max_rss": "173480", "process_out_blocks": "6528", "process_user_time": 2.581855}
[0m08:12:30.435572 [debug] [MainThread]: Command `dbt build` succeeded at 08:12:30.435486 after 1.63 seconds
[0m08:12:30.435857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19bcfc9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d199b1fa450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1998e2fe60>]}
[0m08:12:30.436139 [debug] [MainThread]: Flushing usage events
[0m08:12:30.991460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:22:54.365859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748be709f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748be731f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748be6e50b90>]}


============================== 08:22:54.371090 | 1c2f6d48-ba1a-4e35-9f0f-6fdd80c9db01 ==============================
[0m08:22:54.371090 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:22:54.371560 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False', 'empty': 'False', 'profiles_dir': '/home/robgriffin247/.dbt', 'version_check': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/home/robgriffin247/fpl/logs', 'debug': 'False'}
[0m08:22:54.597186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c2f6d48-ba1a-4e35-9f0f-6fdd80c9db01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748be673aab0>]}
[0m08:22:54.657476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c2f6d48-ba1a-4e35-9f0f-6fdd80c9db01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748bdcb3f200>]}
[0m08:22:54.661442 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:22:54.715465 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:22:54.772527 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:22:54.772955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c2f6d48-ba1a-4e35-9f0f-6fdd80c9db01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748bdc8d77d0>]}
[0m08:22:55.608712 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.fpl_analytics.stg_stats' (fpl_analytics/models/staging/stg_stats.sql) depends on a source named '.' which was not found
[0m08:22:55.620162 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.3095888, "process_in_blocks": "94040", "process_kernel_time": 0.342337, "process_mem_max_rss": "143244", "process_out_blocks": "16", "process_user_time": 2.582325}
[0m08:22:55.620658 [debug] [MainThread]: Command `dbt build` failed at 08:22:55.620563 after 1.31 seconds
[0m08:22:55.620975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748be753b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748bc6fbb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748bc6fb8f20>]}
[0m08:22:55.621269 [debug] [MainThread]: Flushing usage events
[0m08:22:56.105970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:23:11.715775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791d6b921520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791d6901cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791d69ad7410>]}


============================== 08:23:11.717950 | 3b3688ba-eec4-4385-a7a1-07b126d18c6a ==============================
[0m08:23:11.717950 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:23:11.718322 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt build', 'empty': 'False', 'quiet': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m08:23:11.896551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b3688ba-eec4-4385-a7a1-07b126d18c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791d68bab1d0>]}
[0m08:23:11.953249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b3688ba-eec4-4385-a7a1-07b126d18c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791d698bb050>]}
[0m08:23:11.954436 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:23:12.000003 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:23:12.064265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m08:23:12.064751 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_stats.sql
[0m08:23:12.064998 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_stats.yml
[0m08:23:12.065255 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:23:12.288982 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.fpl_analytics.stg_stats' (fpl_analytics/models/staging/stg_stats.sql) depends on a source named 'raw.element_stats' which was not found
[0m08:23:12.289841 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6323807, "process_in_blocks": "280", "process_kernel_time": 0.159405, "process_mem_max_rss": "145424", "process_out_blocks": "8", "process_user_time": 1.852555}
[0m08:23:12.290169 [debug] [MainThread]: Command `dbt build` failed at 08:23:12.290105 after 0.63 seconds
[0m08:23:12.290422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791d6901ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791d5eec6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791d5eec46b0>]}
[0m08:23:12.290718 [debug] [MainThread]: Flushing usage events
[0m08:23:12.700411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:24:48.710515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b14cddacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b14c8ff230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b14ed75730>]}


============================== 08:24:48.714116 | 8ba083c1-9ce8-4b6c-b508-2692b52505e2 ==============================
[0m08:24:48.714116 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:24:48.714764 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/robgriffin247/fpl', 'target_path': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'fail_fast': 'False', 'no_print': 'None', 'log_format': 'default', 'empty': 'False', 'static_parser': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False'}
[0m08:24:48.914776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b14bf64ce0>]}
[0m08:24:48.969750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b14ca3a930>]}
[0m08:24:48.972475 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:24:49.026335 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:24:49.124677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m08:24:49.125131 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_stats.sql
[0m08:24:49.125400 [debug] [MainThread]: Partial parsing: added file: fpl_analytics://fpl_analytics/models/staging/stg_stats.yml
[0m08:24:49.125981 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/_sources.yml
[0m08:24:49.126245 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:24:49.535723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b14e981ee0>]}
[0m08:24:49.574430 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:24:49.576985 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:24:49.608612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b141efc830>]}
[0m08:24:49.609008 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m08:24:49.611846 [info ] [MainThread]: 
[0m08:24:49.612543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:24:49.612980 [info ] [MainThread]: 
[0m08:24:49.613556 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:24:49.617852 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m08:24:49.649478 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:24:49.649863 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:24:49.650087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:24:49.680236 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m08:24:49.681415 [debug] [ThreadPool]: On list_analytics: Close
[0m08:24:49.683000 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:24:49.683277 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:24:49.683524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:49.684503 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.685351 [debug] [ThreadPool]: On list_analytics: Close
[0m08:24:49.686612 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:24:49.686876 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:24:49.687119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:49.688208 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.689372 [debug] [ThreadPool]: On list_analytics: Close
[0m08:24:49.690387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m08:24:49.690871 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m08:24:49.695374 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:24:49.695735 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:24:49.695946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:49.697560 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:24:49.699083 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:24:49.699407 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m08:24:49.700169 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:24:49.700394 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:24:49.700575 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m08:24:49.701166 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:24:49.701695 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:24:49.701900 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:24:49.702063 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:24:49.702445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:24:49.702640 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m08:24:49.703122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m08:24:49.703439 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m08:24:49.704764 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:24:49.705247 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:24:49.705678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:49.706903 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.707925 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:24:49.708185 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m08:24:49.709088 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.709387 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:24:49.709703 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m08:24:49.710602 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:24:49.711336 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:24:49.711562 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:24:49.711755 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:24:49.712391 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:24:49.712650 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m08:24:49.713172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m08:24:49.713596 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m08:24:49.714741 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:24:49.714961 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:24:49.715162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:49.716123 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.717032 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:24:49.717243 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m08:24:49.718047 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.718346 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:24:49.718526 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m08:24:49.719094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:24:49.719847 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:24:49.720174 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:24:49.720373 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:24:49.721221 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.721459 [debug] [ThreadPool]: On create_analytics_core: Close
[0m08:24:49.723065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m08:24:49.727111 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:24:49.727536 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m08:24:49.727745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:49.728488 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.728768 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:24:49.728958 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m08:24:49.737639 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m08:24:49.739021 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m08:24:49.741917 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m08:24:49.742206 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m08:24:49.742799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m08:24:49.743995 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:24:49.744237 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m08:24:49.744446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:49.745628 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.745803 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:24:49.745955 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m08:24:49.749072 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:24:49.750047 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m08:24:49.750698 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m08:24:49.750898 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m08:24:49.751358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m08:24:49.752517 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:24:49.752803 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m08:24:49.753066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:49.754173 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:24:49.754373 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:24:49.754537 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m08:24:49.757336 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:24:49.758361 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m08:24:49.758925 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m08:24:49.759121 [debug] [ThreadPool]: On list_analytics_core: Close
[0m08:24:49.759917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b1421c8170>]}
[0m08:24:49.760231 [debug] [MainThread]: Using duckdb connection "master"
[0m08:24:49.760440 [debug] [MainThread]: On master: BEGIN
[0m08:24:49.760672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:24:49.761399 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:24:49.761811 [debug] [MainThread]: On master: COMMIT
[0m08:24:49.762186 [debug] [MainThread]: Using duckdb connection "master"
[0m08:24:49.762504 [debug] [MainThread]: On master: COMMIT
[0m08:24:49.763076 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:24:49.763289 [debug] [MainThread]: On master: Close
[0m08:24:49.767515 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m08:24:49.768005 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m08:24:49.768400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m08:24:49.768676 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m08:24:49.773664 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.774271 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m08:24:49.795510 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.796076 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.796370 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m08:24:49.796671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:49.797722 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.798138 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.798538 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m08:24:49.803500 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:49.807666 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.807992 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:24:49.809122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.810064 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.810315 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:24:49.811381 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.815728 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.816036 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m08:24:49.817764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.819696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.819951 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m08:24:49.820782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.830773 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:24:49.831125 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.831332 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:24:49.837302 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:24:49.841159 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:24:49.841467 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m08:24:49.846632 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:49.848579 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m08:24:49.850419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b112cbfce0>]}
[0m08:24:49.850881 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m08:24:49.851293 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m08:24:49.851574 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m08:24:49.851902 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m08:24:49.852814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m08:24:49.853106 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m08:24:49.855000 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m08:24:49.855445 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m08:24:49.857360 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m08:24:49.857773 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:24:49.857989 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m08:24:49.858203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:49.858917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.859125 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:24:49.859313 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * from source where can_select
),

select_columns as (
    select
        dreamteam_count::int as dreamteam_appearances,
        element_type::int as position_id,
        ep_next::float,
        ep_this::float,
        *
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m08:24:49.874644 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m08:24:49.875734 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:24:49.876020 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:24:49.877243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.878329 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:24:49.878618 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:24:49.879852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.882378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:24:49.882646 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m08:24:49.883344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:49.886252 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:24:49.886545 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m08:24:49.887503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.888953 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:24:49.889203 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:24:49.889394 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:24:49.897340 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:24:49.899205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:24:49.899517 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m08:24:49.904826 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:49.905860 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m08:24:49.906645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b1122a7650>]}
[0m08:24:49.907139 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m08:24:49.907568 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m08:24:49.907849 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m08:24:49.908169 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m08:24:49.908609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m08:24:49.908884 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m08:24:49.911199 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m08:24:49.911671 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m08:24:49.913708 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m08:24:49.914291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:24:49.914614 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m08:24:49.914912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:49.915689 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.915954 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:24:49.916155 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m08:24:49.918439 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:24:49.919253 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:24:49.919495 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:24:49.920204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:49.921188 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:24:49.921431 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:24:49.922337 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.924769 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:24:49.925161 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m08:24:49.926082 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.927651 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:24:49.927895 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m08:24:49.928613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:49.929455 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:24:49.929750 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:24:49.929946 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:24:49.935692 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:49.937356 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:24:49.937669 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m08:24:49.943496 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:49.944999 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m08:24:49.945615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b141fa4f80>]}
[0m08:24:49.946079 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m08:24:49.946474 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m08:24:49.946734 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m08:24:49.947036 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m08:24:49.947410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m08:24:49.947700 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m08:24:49.949522 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m08:24:49.950226 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m08:24:49.952820 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m08:24:49.953292 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:24:49.953544 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m08:24:49.953794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:49.954644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.954916 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:24:49.955117 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m08:24:49.957565 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:24:49.959632 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:24:49.959909 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m08:24:49.960738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.961596 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:24:49.961835 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:24:49.962025 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:24:49.966908 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:49.968497 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:24:49.968778 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m08:24:49.969387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:49.970414 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m08:24:49.971336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b1123a4cb0>]}
[0m08:24:49.971811 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.02s]
[0m08:24:49.972222 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m08:24:49.972488 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m08:24:49.972847 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m08:24:49.973259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m08:24:49.973698 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m08:24:49.976541 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m08:24:49.977222 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m08:24:49.979016 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m08:24:49.979417 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:24:49.979639 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m08:24:49.979825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:49.980542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.980788 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:24:49.980973 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m08:24:49.983550 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:24:49.984473 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:24:49.984794 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:24:49.986153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.987277 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:24:49.987563 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:24:49.988638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:49.990462 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:24:49.990713 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m08:24:49.991321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:49.992915 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:24:49.993140 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m08:24:49.993702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:49.994457 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:24:49.994670 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:24:49.994843 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:24:50.001314 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:24:50.003097 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:24:50.003390 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m08:24:50.008961 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:50.010134 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m08:24:50.010733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b112d34470>]}
[0m08:24:50.011154 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m08:24:50.011559 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m08:24:50.011828 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m08:24:50.012152 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m08:24:50.012741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m08:24:50.013025 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m08:24:50.014762 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m08:24:50.015552 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m08:24:50.017747 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m08:24:50.018324 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:24:50.018584 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m08:24:50.018769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:50.019494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.019760 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:24:50.019957 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m08:24:50.021792 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:24:50.022597 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:24:50.022891 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:24:50.023640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:50.024503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:24:50.024821 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:24:50.025805 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.028292 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:24:50.028605 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m08:24:50.029676 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.031922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:24:50.032207 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m08:24:50.033186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.034130 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:24:50.034387 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:24:50.034632 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:24:50.040416 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:50.042156 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:24:50.042430 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m08:24:50.048088 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:50.049255 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m08:24:50.049891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b112271fa0>]}
[0m08:24:50.050357 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m08:24:50.050744 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m08:24:50.051011 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m08:24:50.051347 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m08:24:50.051681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m08:24:50.052118 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m08:24:50.055099 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m08:24:50.055567 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m08:24:50.057428 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m08:24:50.057931 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:24:50.058174 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m08:24:50.058367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:50.059236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.059481 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:24:50.059680 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m08:24:50.067666 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:24:50.068837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:24:50.069110 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:24:50.070125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.071365 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:24:50.071790 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:24:50.073121 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.075338 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:24:50.075605 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m08:24:50.076377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.078249 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:24:50.078543 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m08:24:50.079529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.080636 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:24:50.080950 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:24:50.081192 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:24:50.089689 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:24:50.091402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:24:50.091701 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m08:24:50.096659 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:50.097829 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m08:24:50.098806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b111e79700>]}
[0m08:24:50.099258 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m08:24:50.099678 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m08:24:50.099963 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m08:24:50.100286 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m08:24:50.100687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m08:24:50.100951 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m08:24:50.103260 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m08:24:50.103702 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m08:24:50.105638 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m08:24:50.106089 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:24:50.106310 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m08:24:50.106525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:50.107245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.107479 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:24:50.107681 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m08:24:50.109345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.110157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:24:50.110468 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:24:50.111924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.113096 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:24:50.113428 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:24:50.114606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.116692 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:24:50.116984 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m08:24:50.117665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:50.119345 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:24:50.119586 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m08:24:50.120274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:50.121176 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:24:50.121473 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:24:50.121684 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:24:50.127377 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:50.129582 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:24:50.129893 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m08:24:50.135001 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:50.136163 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m08:24:50.136814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b112283bf0>]}
[0m08:24:50.137240 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m08:24:50.137634 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m08:24:50.137921 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m08:24:50.138244 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m08:24:50.138584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m08:24:50.138869 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m08:24:50.140521 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m08:24:50.141313 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m08:24:50.144659 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m08:24:50.145327 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:24:50.145621 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m08:24:50.145827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:50.146521 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.146764 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:24:50.146961 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m08:24:50.148599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.149370 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:24:50.149612 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:24:50.150635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.151964 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:24:50.152484 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:24:50.153534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.155446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:24:50.155688 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m08:24:50.156675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.158834 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:24:50.159147 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m08:24:50.159908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.160858 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:24:50.161138 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:24:50.161335 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:24:50.167295 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:24:50.169402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:24:50.169716 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m08:24:50.174916 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:50.176134 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m08:24:50.176838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b112283bf0>]}
[0m08:24:50.177293 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m08:24:50.177688 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m08:24:50.177960 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m08:24:50.178295 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m08:24:50.178655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m08:24:50.178925 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m08:24:50.180988 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m08:24:50.182148 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m08:24:50.184102 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m08:24:50.184557 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:24:50.184878 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m08:24:50.185100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:50.185794 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.186049 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:24:50.186240 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m08:24:50.196025 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:24:50.197043 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:24:50.197368 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:24:50.198248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.199033 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:24:50.199264 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:24:50.200292 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.202254 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:24:50.202529 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m08:24:50.203221 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:24:50.205088 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:24:50.205390 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m08:24:50.206239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:24:50.207286 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:24:50.207610 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:24:50.207832 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:24:50.215053 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:24:50.216786 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:24:50.217106 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m08:24:50.222762 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:24:50.224179 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m08:24:50.225339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba083c1-9ce8-4b6c-b508-2692b52505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b1122816a0>]}
[0m08:24:50.225855 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.05s]
[0m08:24:50.226288 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m08:24:50.228411 [debug] [MainThread]: Using duckdb connection "master"
[0m08:24:50.228773 [debug] [MainThread]: On master: BEGIN
[0m08:24:50.228963 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:24:50.229641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:24:50.229860 [debug] [MainThread]: On master: COMMIT
[0m08:24:50.230034 [debug] [MainThread]: Using duckdb connection "master"
[0m08:24:50.230191 [debug] [MainThread]: On master: COMMIT
[0m08:24:50.230783 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:24:50.231178 [debug] [MainThread]: On master: Close
[0m08:24:50.231637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:24:50.231877 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m08:24:50.232484 [info ] [MainThread]: 
[0m08:24:50.233012 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m08:24:50.234070 [debug] [MainThread]: Command end result
[0m08:24:50.246363 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:24:50.247882 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:24:50.252096 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m08:24:50.252451 [info ] [MainThread]: 
[0m08:24:50.252789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:24:50.253047 [info ] [MainThread]: 
[0m08:24:50.253317 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m08:24:50.254820 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5928092, "process_in_blocks": "67416", "process_kernel_time": 0.349532, "process_mem_max_rss": "174344", "process_out_blocks": "5960", "process_user_time": 2.698222}
[0m08:24:50.255280 [debug] [MainThread]: Command `dbt build` succeeded at 08:24:50.255191 after 1.59 seconds
[0m08:24:50.255553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b14ed75730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b141fa61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b14d0f2840>]}
[0m08:24:50.255806 [debug] [MainThread]: Flushing usage events
[0m08:24:50.890904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:27:44.679526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b986b57ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b988fe9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b986c1ad20>]}


============================== 08:27:44.684358 | fae156ba-37b1-489f-87e5-76ac73b33fdd ==============================
[0m08:27:44.684358 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:27:44.685194 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt build', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/home/robgriffin247/fpl'}
[0m08:27:44.903918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b986305460>]}
[0m08:27:44.961970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b9867a5a60>]}
[0m08:27:44.965091 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:27:45.018195 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:27:45.115522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:27:45.116019 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:27:45.387336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b97c647fb0>]}
[0m08:27:45.431682 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:27:45.433888 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:27:45.505955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b97c1b6270>]}
[0m08:27:45.506313 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m08:27:45.507884 [info ] [MainThread]: 
[0m08:27:45.508198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:27:45.508404 [info ] [MainThread]: 
[0m08:27:45.508744 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:27:45.512580 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m08:27:45.539448 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:27:45.539847 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:27:45.540049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:45.572591 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m08:27:45.573866 [debug] [ThreadPool]: On list_analytics: Close
[0m08:27:45.576560 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:27:45.576887 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:27:45.577292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:45.578460 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:45.579324 [debug] [ThreadPool]: On list_analytics: Close
[0m08:27:45.580906 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:27:45.581405 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:27:45.581626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:45.582698 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:45.583547 [debug] [ThreadPool]: On list_analytics: Close
[0m08:27:45.584240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m08:27:45.584605 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m08:27:45.588963 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:27:45.589220 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:27:45.589424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:45.590408 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:45.591222 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:27:45.591456 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m08:27:45.591868 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:27:45.592071 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:27:45.592232 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m08:27:45.592892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:27:45.593659 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:27:45.593885 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:27:45.594052 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:27:45.594717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:27:45.595088 [debug] [ThreadPool]: On create_analytics_core: Close
[0m08:27:45.595557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m08:27:45.595878 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m08:27:45.597032 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:27:45.597443 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:27:45.597618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:45.598705 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:45.599924 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:27:45.600306 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m08:27:45.601070 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:27:45.601326 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:27:45.601514 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m08:27:45.602072 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:27:45.602611 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:27:45.602816 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:27:45.602974 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:27:45.603370 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:27:45.603573 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m08:27:45.604108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m08:27:45.604636 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m08:27:45.605915 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:27:45.606175 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:27:45.606393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:45.607497 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:45.608331 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:27:45.608520 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m08:27:45.608933 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:27:45.609143 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:27:45.609297 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m08:27:45.609812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:27:45.610423 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:27:45.610670 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:27:45.610900 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:27:45.611388 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:27:45.611659 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m08:27:45.613252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m08:27:45.617270 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:27:45.617530 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m08:27:45.617695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:45.618537 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:45.618808 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:27:45.619028 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m08:27:45.627890 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m08:27:45.629401 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m08:27:45.632460 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m08:27:45.632690 [debug] [ThreadPool]: On list_analytics_core: Close
[0m08:27:45.633219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m08:27:45.634395 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:27:45.634637 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m08:27:45.634857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:45.636171 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:45.636387 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:27:45.636557 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m08:27:45.639289 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:27:45.640204 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m08:27:45.640738 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m08:27:45.640952 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m08:27:45.641455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m08:27:45.642643 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:27:45.642876 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m08:27:45.643674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:45.644293 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:45.644490 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:27:45.644687 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m08:27:45.647799 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:27:45.648669 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m08:27:45.649254 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m08:27:45.649502 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m08:27:45.650591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b97c1abf50>]}
[0m08:27:45.650955 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:45.651149 [debug] [MainThread]: On master: BEGIN
[0m08:27:45.651307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:27:45.651861 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:27:45.652084 [debug] [MainThread]: On master: COMMIT
[0m08:27:45.652267 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:45.652420 [debug] [MainThread]: On master: COMMIT
[0m08:27:45.652829 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:27:45.653042 [debug] [MainThread]: On master: Close
[0m08:27:45.656843 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m08:27:45.657445 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m08:27:45.657875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m08:27:45.658141 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m08:27:45.663473 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.664066 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m08:27:45.686698 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.687357 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.687635 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m08:27:45.687883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:45.689036 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.689504 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.689735 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m08:27:45.693641 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:27:45.697404 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.697698 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:27:45.698718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.699597 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.699838 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:27:45.701022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.705291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.705635 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m08:27:45.707117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.708803 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.709035 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m08:27:45.709900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.719176 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:27:45.719499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.719834 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:27:45.725998 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:27:45.729757 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:27:45.730081 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m08:27:45.735377 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:27:45.737279 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m08:27:45.739320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b987324410>]}
[0m08:27:45.739834 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m08:27:45.740245 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m08:27:45.740538 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m08:27:45.740871 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m08:27:45.741495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m08:27:45.741789 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m08:27:45.743711 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m08:27:45.744220 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m08:27:45.746130 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m08:27:45.746931 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:27:45.747165 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m08:27:45.747341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:45.748516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.748880 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:27:45.749099 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * from source where can_select
),

select_columns as (
    select
        dreamteam_count::int as dreamteam_appearances,
        element_type::int as position_id,
        -- ep_next::float,
        -- ep_this::float,
        *
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m08:27:45.762945 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m08:27:45.763847 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:27:45.764098 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:27:45.765125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.766239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:27:45.766603 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:27:45.767763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.769785 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:27:45.770046 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m08:27:45.770696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:45.772263 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:27:45.772485 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m08:27:45.773279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.774373 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:27:45.774599 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:27:45.774779 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:27:45.781622 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:27:45.783253 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:27:45.783513 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m08:27:45.788419 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:27:45.789821 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m08:27:45.790543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b974582900>]}
[0m08:27:45.791006 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m08:27:45.791407 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m08:27:45.791673 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m08:27:45.791993 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m08:27:45.792537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m08:27:45.792841 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m08:27:45.794889 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m08:27:45.795688 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m08:27:45.798702 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m08:27:45.799346 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:27:45.799598 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m08:27:45.799877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:45.800594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.800827 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:27:45.801035 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m08:27:45.803616 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:27:45.804428 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:27:45.804685 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:27:45.805498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.806319 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:27:45.806537 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:27:45.807502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.809662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:27:45.809931 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m08:27:45.810675 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:45.812312 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:27:45.812629 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m08:27:45.813397 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:45.814327 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:27:45.814588 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:27:45.814816 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:27:45.820578 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:27:45.822347 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:27:45.822659 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m08:27:45.829672 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:27:45.830911 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m08:27:45.831525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b974563800>]}
[0m08:27:45.831947 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m08:27:45.832336 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m08:27:45.832658 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m08:27:45.832978 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m08:27:45.834015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m08:27:45.834571 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m08:27:45.837092 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m08:27:45.837658 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m08:27:45.839484 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m08:27:45.839888 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:27:45.840130 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m08:27:45.840314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:45.841015 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.841283 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:27:45.841566 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m08:27:45.844379 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:27:45.845669 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:27:45.845951 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:27:45.847270 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.848153 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:27:45.848382 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:27:45.849660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.851648 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:27:45.851889 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m08:27:45.852502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:45.854086 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:27:45.854311 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m08:27:45.854814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:45.855645 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:27:45.855897 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:27:45.856084 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:27:45.863700 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:27:45.865480 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:27:45.865758 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m08:27:45.870544 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:27:45.872152 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m08:27:45.873487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b97451f4a0>]}
[0m08:27:45.873936 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m08:27:45.874313 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m08:27:45.874587 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m08:27:45.874941 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m08:27:45.875419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m08:27:45.875856 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m08:27:45.879178 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m08:27:45.879900 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m08:27:45.883079 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m08:27:45.883560 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:27:45.883824 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m08:27:45.884010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:45.884712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.884949 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:27:45.885213 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m08:27:45.888476 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:27:45.889364 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:27:45.889652 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:27:45.890499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.891360 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:27:45.891606 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:27:45.893260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.896305 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:27:45.896800 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m08:27:45.897704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.899382 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:27:45.899610 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m08:27:45.900544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.901470 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:27:45.901737 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:27:45.901929 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:27:45.909184 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:27:45.911085 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:27:45.911409 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m08:27:45.916687 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:27:45.918135 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m08:27:45.918745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b974535bb0>]}
[0m08:27:45.919197 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m08:27:45.919607 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m08:27:45.919910 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m08:27:45.920585 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m08:27:45.921210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m08:27:45.921773 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m08:27:45.923788 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m08:27:45.924438 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m08:27:45.926400 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m08:27:45.926831 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:27:45.927059 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m08:27:45.927290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:45.927999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.928230 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:27:45.928415 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m08:27:45.930152 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:27:45.930914 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:27:45.931153 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:27:45.931857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:45.932711 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:27:45.932950 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:27:45.934194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.936247 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:27:45.936500 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m08:27:45.937128 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:45.938838 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:27:45.939087 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m08:27:45.939771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:45.940702 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:27:45.940947 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:27:45.941143 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:27:45.946986 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:27:45.948808 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:27:45.949165 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m08:27:45.954181 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:27:45.955438 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m08:27:45.956024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b97c19df40>]}
[0m08:27:45.956465 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m08:27:45.956852 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m08:27:45.957137 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m08:27:45.957516 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m08:27:45.957893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m08:27:45.958188 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m08:27:45.960028 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m08:27:45.960470 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m08:27:45.962313 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m08:27:45.962777 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:27:45.963018 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m08:27:45.963222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:45.964149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.964417 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:27:45.964652 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m08:27:45.972102 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:27:45.973119 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:27:45.973500 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:27:45.974569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.975510 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:27:45.975754 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:27:45.976775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.980253 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:27:45.980633 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m08:27:45.981587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:45.983402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:27:45.983647 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m08:27:45.984295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:45.985145 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:27:45.985418 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:27:45.985615 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:27:45.992580 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:27:45.994372 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:27:45.994666 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m08:27:45.999716 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:27:46.001504 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m08:27:46.002595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b9745ab800>]}
[0m08:27:46.003114 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.04s]
[0m08:27:46.003564 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m08:27:46.003876 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m08:27:46.004217 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m08:27:46.004656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m08:27:46.004932 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m08:27:46.007325 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m08:27:46.007836 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m08:27:46.009928 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m08:27:46.010411 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:27:46.010653 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m08:27:46.010843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:46.011577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.011797 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:27:46.011978 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m08:27:46.013735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.014673 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:27:46.014959 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:27:46.015921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.017150 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:27:46.017562 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:27:46.018883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.020799 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:27:46.021032 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m08:27:46.021828 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:27:46.023621 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:27:46.023917 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m08:27:46.024851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.025826 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:27:46.026125 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:27:46.026325 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:27:46.030857 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:27:46.032523 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:27:46.032849 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m08:27:46.038146 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:27:46.039760 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m08:27:46.040637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b97c1ab380>]}
[0m08:27:46.041451 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m08:27:46.041905 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m08:27:46.042184 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m08:27:46.042488 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m08:27:46.042864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m08:27:46.043140 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m08:27:46.044907 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m08:27:46.045443 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m08:27:46.047155 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m08:27:46.047542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:27:46.047766 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m08:27:46.047956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:46.048755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.049086 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:27:46.049350 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m08:27:46.051965 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:27:46.052978 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:27:46.053275 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:27:46.054258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.055151 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:27:46.055399 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:27:46.056410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.058544 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:27:46.058831 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m08:27:46.059602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.062438 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:27:46.062722 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m08:27:46.063520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.064642 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:27:46.064964 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:27:46.065353 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:27:46.071134 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:27:46.072918 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:27:46.073205 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m08:27:46.078948 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:27:46.080379 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m08:27:46.081013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b9745ba630>]}
[0m08:27:46.081561 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m08:27:46.082063 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m08:27:46.082647 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m08:27:46.083111 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m08:27:46.083549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m08:27:46.083842 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m08:27:46.085959 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m08:27:46.086548 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m08:27:46.088390 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m08:27:46.088848 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:27:46.089113 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m08:27:46.089345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:46.090104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.090334 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:27:46.090525 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m08:27:46.098091 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:27:46.098987 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:27:46.099244 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:27:46.100120 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.100952 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:27:46.101177 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:27:46.102197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.103992 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:27:46.104213 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m08:27:46.105087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.107583 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:27:46.107963 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m08:27:46.108904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:46.109689 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:27:46.109912 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:27:46.110086 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:27:46.117482 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:27:46.119053 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:27:46.119308 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m08:27:46.124178 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:27:46.125657 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m08:27:46.126729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae156ba-37b1-489f-87e5-76ac73b33fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b97c1b4950>]}
[0m08:27:46.127236 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m08:27:46.127645 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m08:27:46.128966 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:46.129255 [debug] [MainThread]: On master: BEGIN
[0m08:27:46.129602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:27:46.130289 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:27:46.130603 [debug] [MainThread]: On master: COMMIT
[0m08:27:46.130802 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:46.130961 [debug] [MainThread]: On master: COMMIT
[0m08:27:46.131575 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:27:46.131969 [debug] [MainThread]: On master: Close
[0m08:27:46.132541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:46.132988 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m08:27:46.133509 [info ] [MainThread]: 
[0m08:27:46.133964 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m08:27:46.135576 [debug] [MainThread]: Command end result
[0m08:27:46.147674 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:27:46.149249 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:27:46.153513 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m08:27:46.153821 [info ] [MainThread]: 
[0m08:27:46.154111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:27:46.154333 [info ] [MainThread]: 
[0m08:27:46.154555 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m08:27:46.155748 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5298167, "process_in_blocks": "107320", "process_kernel_time": 0.430529, "process_mem_max_rss": "173752", "process_out_blocks": "5960", "process_user_time": 2.704397}
[0m08:27:46.156094 [debug] [MainThread]: Command `dbt build` succeeded at 08:27:46.156023 after 1.53 seconds
[0m08:27:46.156360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b9862b3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b987325be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b987326c00>]}
[0m08:27:46.156600 [debug] [MainThread]: Flushing usage events
[0m08:27:46.683746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:23.320373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c7f21640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c622e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c594a900>]}


============================== 08:58:23.326543 | 005257e6-6955-4e5e-869e-b9c269ecaafc ==============================
[0m08:58:23.326543 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:58:23.327136 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'write_json': 'True', 'invocation_command': 'dbt build', 'quiet': 'False', 'no_print': 'None'}
[0m08:58:23.579185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c508f6e0>]}
[0m08:58:23.639680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c597a000>]}
[0m08:58:23.643683 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:58:23.698756 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:58:23.796297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:58:23.796800 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:58:24.093269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b99f7d70>]}
[0m08:58:24.140292 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:58:24.141867 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:58:24.225968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b99e7950>]}
[0m08:58:24.226403 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m08:58:24.228156 [info ] [MainThread]: 
[0m08:58:24.228504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:58:24.228757 [info ] [MainThread]: 
[0m08:58:24.229169 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:58:24.233197 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m08:58:24.263319 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:58:24.263682 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:58:24.263953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:24.301297 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m08:58:24.302435 [debug] [ThreadPool]: On list_analytics: Close
[0m08:58:24.305252 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:58:24.305556 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:58:24.305791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:24.307040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:24.308132 [debug] [ThreadPool]: On list_analytics: Close
[0m08:58:24.309560 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:58:24.309819 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:58:24.310035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:24.310963 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:24.311741 [debug] [ThreadPool]: On list_analytics: Close
[0m08:58:24.312421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m08:58:24.312804 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m08:58:24.317125 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:58:24.317346 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:58:24.317511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:24.318372 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:24.319140 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:58:24.319329 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m08:58:24.319710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:24.319948 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:58:24.320141 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m08:58:24.320603 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:24.321123 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:58:24.321315 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:58:24.321472 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:58:24.321861 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:24.322069 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m08:58:24.322498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m08:58:24.322818 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m08:58:24.323922 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:58:24.324273 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:58:24.324486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:24.325342 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:24.326203 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:58:24.326417 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m08:58:24.327012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:24.327356 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:58:24.327642 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m08:58:24.328321 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:24.328865 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:58:24.329053 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:58:24.329210 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:58:24.329574 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:24.329769 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m08:58:24.330208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m08:58:24.330684 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m08:58:24.331683 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:58:24.331950 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:58:24.332132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:24.332866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:24.333596 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:58:24.333787 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m08:58:24.334181 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:24.334413 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:58:24.334569 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m08:58:24.334965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:24.335454 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:58:24.335641 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:58:24.335795 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:58:24.336204 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:24.336414 [debug] [ThreadPool]: On create_analytics_core: Close
[0m08:58:24.337991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m08:58:24.341694 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:58:24.342236 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m08:58:24.342461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:24.343133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:24.343334 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:58:24.343491 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m08:58:24.351764 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m08:58:24.352882 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m08:58:24.354943 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m08:58:24.355256 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m08:58:24.355773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m08:58:24.357004 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:58:24.357250 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m08:58:24.357463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:24.358601 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:24.358808 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:58:24.358975 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m08:58:24.361575 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:58:24.362454 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m08:58:24.362973 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m08:58:24.363150 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m08:58:24.363628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m08:58:24.364761 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:58:24.365000 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m08:58:24.365204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:24.366156 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:24.366371 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:58:24.366540 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m08:58:24.369075 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:58:24.369970 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m08:58:24.370593 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m08:58:24.370831 [debug] [ThreadPool]: On list_analytics_core: Close
[0m08:58:24.371929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a34bb7a0>]}
[0m08:58:24.372341 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:24.372546 [debug] [MainThread]: On master: BEGIN
[0m08:58:24.372719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:58:24.373316 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:58:24.373530 [debug] [MainThread]: On master: COMMIT
[0m08:58:24.373702 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:24.373871 [debug] [MainThread]: On master: COMMIT
[0m08:58:24.374274 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:58:24.374479 [debug] [MainThread]: On master: Close
[0m08:58:24.377990 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m08:58:24.378383 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m08:58:24.378757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m08:58:24.379026 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m08:58:24.384067 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.384578 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m08:58:24.407106 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.407707 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.408038 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m08:58:24.408271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:24.409253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.409653 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.410001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m08:58:24.414490 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:58:24.418140 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.418429 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:58:24.419492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.420689 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.420990 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:58:24.422616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.426729 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.426979 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m08:58:24.428594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.430434 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.430680 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m08:58:24.431240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:24.442028 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:58:24.442527 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.442769 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:58:24.451297 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:58:24.456157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:24.456645 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m08:58:24.464465 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:58:24.466889 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m08:58:24.469499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c7a56db0>]}
[0m08:58:24.470167 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.09s]
[0m08:58:24.470636 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m08:58:24.470946 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m08:58:24.471795 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m08:58:24.472538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m08:58:24.472860 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m08:58:24.475248 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m08:58:24.475885 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m08:58:24.478103 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m08:58:24.478888 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:58:24.479213 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m08:58:24.479418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:24.480441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.480776 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:58:24.481033 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        status::varchar as availability_code,
        news::varchar as info,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::flaot as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        start::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m08:58:24.492129 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        status::varchar as availability_code,
        news::varchar as info,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::flaot as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        start::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m08:58:24.492604 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:58:24.492944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: ROLLBACK
[0m08:58:24.500592 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.stg_players'
[0m08:58:24.501018 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m08:58:24.503090 [debug] [Thread-1 (]: Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Catalog Error: Type with name flaot does not exist!
  Did you mean "float"?
[0m08:58:24.503612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b99f4b60>]}
[0m08:58:24.504180 [error] [Thread-1 (]: 2 of 10 ERROR creating sql table model staging.stg_players ..................... [[31mERROR[0m in 0.03s]
[0m08:58:24.504673 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m08:58:24.504972 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m08:58:24.505770 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.stg_players' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Catalog Error: Type with name flaot does not exist!
  Did you mean "float"?.
[0m08:58:24.505360 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m08:58:24.507030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m08:58:24.507509 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m08:58:24.509790 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m08:58:24.510485 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m08:58:24.512764 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m08:58:24.513402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:24.513681 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m08:58:24.513887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:24.514772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.515050 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:24.515273 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m08:58:24.517987 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:58:24.519100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:24.519411 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:58:24.520356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.521322 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:24.521578 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:58:24.522918 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.525214 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:24.525564 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m08:58:24.526434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.528732 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:24.529130 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m08:58:24.531667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.533376 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:58:24.533837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:24.534207 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:58:24.541169 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:58:24.543079 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:24.543427 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m08:58:24.548549 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:58:24.550109 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m08:58:24.550867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a33d7e30>]}
[0m08:58:24.551486 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m08:58:24.552159 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m08:58:24.552474 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m08:58:24.553119 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m08:58:24.553494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m08:58:24.553739 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m08:58:24.555525 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m08:58:24.556010 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m08:58:24.557812 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m08:58:24.558234 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:24.558468 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m08:58:24.558665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:24.559626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.560081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:24.560321 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m08:58:24.563174 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:58:24.564403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:24.564684 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:58:24.565551 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.566371 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:24.566601 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:58:24.567559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.569571 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:24.569833 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m08:58:24.570420 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:24.572177 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:24.572430 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m08:58:24.572954 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:24.573832 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:58:24.574079 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:24.574280 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:58:24.580907 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:58:24.582652 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:24.582937 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m08:58:24.588470 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:58:24.589858 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m08:58:24.590780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a33e8bc0>]}
[0m08:58:24.591228 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m08:58:24.591637 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m08:58:24.591972 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m08:58:24.592577 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m08:58:24.592981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m08:58:24.593233 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m08:58:24.595168 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m08:58:24.595686 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m08:58:24.597798 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m08:58:24.598301 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:24.598574 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m08:58:24.598769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:24.599497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.599739 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:24.599969 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m08:58:24.603056 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:58:24.603881 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:24.604168 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:58:24.604926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.605883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:24.606149 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:58:24.607375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.609536 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:24.609785 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m08:58:24.610588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.612800 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:24.613138 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m08:58:24.613870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:24.614914 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:58:24.615173 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:24.615374 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:58:24.621517 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:58:24.624336 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:24.624646 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m08:58:24.630695 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:58:24.632140 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m08:58:24.632914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a0121550>]}
[0m08:58:24.633439 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m08:58:24.633898 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m08:58:24.634238 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m08:58:24.634586 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m08:58:24.635016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m08:58:24.635293 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m08:58:24.637446 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m08:58:24.638674 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m08:58:24.640851 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m08:58:24.641438 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:24.641716 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m08:58:24.641921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:24.642769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.643037 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:24.643240 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m08:58:24.646403 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:58:24.647395 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:24.647652 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:58:24.649051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.650398 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:24.650684 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:58:24.651933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.654061 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:24.654309 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m08:58:24.655130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.657265 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:24.657506 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m08:58:24.658032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:24.658872 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:58:24.659117 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:24.659313 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:58:24.666519 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:58:24.668411 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:24.668713 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m08:58:24.673888 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:58:24.675543 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m08:58:24.676296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a33e7710>]}
[0m08:58:24.676826 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m08:58:24.677283 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m08:58:24.677569 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m08:58:24.677845 [info ] [Thread-1 (]: 7 of 10 SKIP relation intermediate.int_players ................................. [[33mSKIP[0m]
[0m08:58:24.678217 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m08:58:24.678637 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m08:58:24.678957 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'skipped'. 
[0m08:58:24.679368 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m08:58:24.680384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m08:58:24.680814 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m08:58:24.683337 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m08:58:24.684043 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m08:58:24.685931 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m08:58:24.686379 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:24.686610 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m08:58:24.686805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:24.687551 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.687813 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:24.688074 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m08:58:24.689749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.690514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:24.690757 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:58:24.691474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:24.692339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:24.692592 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:58:24.693582 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.695950 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:24.696339 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m08:58:24.697209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.699060 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:24.699342 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m08:58:24.699941 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:24.700814 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:58:24.701058 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:24.701290 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:58:24.707631 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:58:24.709280 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:24.709593 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m08:58:24.715450 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:58:24.716693 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m08:58:24.717463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a3355010>]}
[0m08:58:24.717935 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m08:58:24.718344 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m08:58:24.718619 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m08:58:24.719371 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m08:58:24.719768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m08:58:24.720083 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m08:58:24.722966 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m08:58:24.723389 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m08:58:24.725218 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m08:58:24.725663 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:24.725894 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m08:58:24.726093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:24.726830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.727095 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:24.727304 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m08:58:24.729781 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:58:24.730788 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:24.731083 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:58:24.731892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.732778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:24.733023 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:58:24.734156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:24.736055 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:24.736297 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m08:58:24.737001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:24.738500 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:24.738737 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m08:58:24.739253 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:24.740220 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:58:24.740450 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:24.740648 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:58:24.747239 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:58:24.749050 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:24.749324 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m08:58:24.754518 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:58:24.756108 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m08:58:24.756899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005257e6-6955-4e5e-869e-b9c269ecaafc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a33db140>]}
[0m08:58:24.757501 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m08:58:24.757943 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m08:58:24.758222 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m08:58:24.758493 [info ] [Thread-1 (]: 10 of 10 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m08:58:24.758803 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m08:58:24.759170 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m08:58:24.760630 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:24.760884 [debug] [MainThread]: On master: BEGIN
[0m08:58:24.761073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:58:24.761890 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:58:24.762158 [debug] [MainThread]: On master: COMMIT
[0m08:58:24.762383 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:24.762613 [debug] [MainThread]: On master: COMMIT
[0m08:58:24.763276 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:58:24.763681 [debug] [MainThread]: On master: Close
[0m08:58:24.764238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:58:24.764447 [debug] [MainThread]: Connection 'model.fpl_analytics.int_teams' was properly closed.
[0m08:58:24.764700 [info ] [MainThread]: 
[0m08:58:24.764967 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m08:58:24.766009 [debug] [MainThread]: Command end result
[0m08:58:24.778454 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:58:24.780019 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:58:24.784236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m08:58:24.784493 [info ] [MainThread]: 
[0m08:58:24.784795 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:58:24.785050 [info ] [MainThread]: 
[0m08:58:24.785347 [error] [MainThread]: [31mFailure in model stg_players (fpl_analytics/models/staging/stg_players.sql)[0m
[0m08:58:24.785618 [error] [MainThread]:   Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Catalog Error: Type with name flaot does not exist!
  Did you mean "float"?
[0m08:58:24.785840 [info ] [MainThread]: 
[0m08:58:24.786091 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/staging/stg_players.sql
[0m08:58:24.786296 [info ] [MainThread]: 
[0m08:58:24.786526 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=10
[0m08:58:24.787941 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5391759, "process_in_blocks": "113712", "process_kernel_time": 0.364022, "process_mem_max_rss": "167616", "process_out_blocks": "3328", "process_user_time": 2.659848}
[0m08:58:24.788300 [debug] [MainThread]: Command `dbt build` failed at 08:58:24.788230 after 1.54 seconds
[0m08:58:24.788540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c5630a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18bb517560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c52b8920>]}
[0m08:58:24.788769 [debug] [MainThread]: Flushing usage events
[0m08:58:25.405506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:53.774404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508bc8e58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508b9cc04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508b9cc1280>]}


============================== 08:58:53.776845 | cea2ae1c-0fd9-419a-9e83-ed8c493a6852 ==============================
[0m08:58:53.776845 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:58:53.786123 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'profiles_dir': '/home/robgriffin247/fpl', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'empty': 'False'}
[0m08:58:53.960744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508bc407a70>]}
[0m08:58:54.013794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508baaef7d0>]}
[0m08:58:54.014953 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:58:54.059803 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:58:54.118910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:58:54.119377 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:58:54.366852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ae1e1940>]}
[0m08:58:54.404580 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:58:54.405828 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:58:54.463808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508afae7830>]}
[0m08:58:54.464172 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m08:58:54.465751 [info ] [MainThread]: 
[0m08:58:54.466070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:58:54.466305 [info ] [MainThread]: 
[0m08:58:54.466667 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:58:54.470518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m08:58:54.490871 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:58:54.491266 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:58:54.491538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:54.511247 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m08:58:54.512353 [debug] [ThreadPool]: On list_analytics: Close
[0m08:58:54.515023 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:58:54.515351 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:58:54.515572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:54.516634 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:54.517421 [debug] [ThreadPool]: On list_analytics: Close
[0m08:58:54.518642 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:58:54.518875 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:58:54.519099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:54.519902 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:54.520692 [debug] [ThreadPool]: On list_analytics: Close
[0m08:58:54.521365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m08:58:54.521643 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m08:58:54.525651 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:58:54.525897 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:58:54.526062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:54.527230 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:54.528386 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:58:54.528581 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m08:58:54.529000 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:54.529185 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:58:54.529329 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m08:58:54.529709 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:54.530183 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:58:54.530402 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:58:54.530552 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:58:54.530897 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:54.531077 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m08:58:54.531509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m08:58:54.531815 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m08:58:54.532840 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:58:54.533135 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:58:54.533341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:54.534132 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:54.534835 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:58:54.535019 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m08:58:54.535390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:54.535607 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:58:54.535789 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m08:58:54.536400 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:54.537228 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:58:54.537451 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:58:54.537607 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:58:54.537976 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:54.538161 [debug] [ThreadPool]: On create_analytics_core: Close
[0m08:58:54.538608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m08:58:54.538903 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m08:58:54.539861 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:58:54.540086 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:58:54.540278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:54.541113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:54.541864 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:58:54.542055 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m08:58:54.542433 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:54.542603 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:58:54.542751 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m08:58:54.543123 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:54.543595 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:58:54.543760 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:58:54.543899 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:58:54.544240 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:58:54.544455 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m08:58:54.546030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m08:58:54.549829 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:58:54.550174 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m08:58:54.550393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:54.551463 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:54.551691 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:58:54.551887 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m08:58:54.559122 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:58:54.560157 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m08:58:54.561038 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m08:58:54.561251 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m08:58:54.561778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m08:58:54.562863 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:58:54.563095 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m08:58:54.563284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:54.564375 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:54.564594 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:58:54.564837 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m08:58:54.567474 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:58:54.568415 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m08:58:54.569075 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m08:58:54.569265 [debug] [ThreadPool]: On list_analytics_core: Close
[0m08:58:54.569739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m08:58:54.570865 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:58:54.571087 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m08:58:54.571283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:54.572317 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:58:54.572609 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:58:54.572846 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m08:58:54.575547 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:58:54.576512 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m08:58:54.577108 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m08:58:54.577324 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m08:58:54.578354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ac7e3590>]}
[0m08:58:54.578671 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:54.578876 [debug] [MainThread]: On master: BEGIN
[0m08:58:54.579035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:58:54.579572 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:58:54.579773 [debug] [MainThread]: On master: COMMIT
[0m08:58:54.579982 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:54.580150 [debug] [MainThread]: On master: COMMIT
[0m08:58:54.580713 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:58:54.580919 [debug] [MainThread]: On master: Close
[0m08:58:54.583149 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m08:58:54.583578 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m08:58:54.583958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_gameweeks)
[0m08:58:54.584196 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m08:58:54.589192 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.589690 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m08:58:54.611244 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.611849 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.612148 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m08:58:54.612375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:54.613044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.613276 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.613455 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m08:58:54.617294 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:58:54.621018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.621355 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:58:54.622259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.623131 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.623370 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:58:54.624336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.628547 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.628897 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m08:58:54.629877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.632301 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.632769 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m08:58:54.633574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.642600 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:58:54.642945 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.643142 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:58:54.649786 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:58:54.653603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:58:54.653880 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m08:58:54.658628 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:58:54.661057 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m08:58:54.662562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508baa5c050>]}
[0m08:58:54.662993 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m08:58:54.663390 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m08:58:54.663681 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m08:58:54.664011 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m08:58:54.664624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m08:58:54.664979 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m08:58:54.667055 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m08:58:54.667526 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m08:58:54.669334 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m08:58:54.669777 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:58:54.670022 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m08:58:54.670221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:54.670921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.671160 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:58:54.671394 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        status::varchar as availability_code,
        news::varchar as info,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        start::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m08:58:54.675838 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        status::varchar as availability_code,
        news::varchar as info,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        start::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m08:58:54.676289 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:58:54.676633 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: ROLLBACK
[0m08:58:54.678952 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.stg_players'
[0m08:58:54.679207 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m08:58:54.680733 [debug] [Thread-1 (]: Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Binder Error: Referenced column "start" not found in FROM clause!
  Candidate bindings: "starts", "starts_per_90", "status", "threat", "transfers_out_event"
  
  LINE 55:         start::int as starts,
                   ^
[0m08:58:54.681094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ac65bb60>]}
[0m08:58:54.681517 [error] [Thread-1 (]: 2 of 10 ERROR creating sql table model staging.stg_players ..................... [[31mERROR[0m in 0.02s]
[0m08:58:54.681928 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m08:58:54.682189 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m08:58:54.682511 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m08:58:54.682836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m08:58:54.683232 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.stg_players' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Binder Error: Referenced column "start" not found in FROM clause!
  Candidate bindings: "starts", "starts_per_90", "status", "threat", "transfers_out_event"
  
  LINE 55:         start::int as starts,
                   ^.
[0m08:58:54.683658 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m08:58:54.686338 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m08:58:54.686836 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m08:58:54.688588 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m08:58:54.689131 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:54.689387 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m08:58:54.689590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:54.690648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.690952 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:54.691161 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m08:58:54.693257 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:58:54.694233 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:54.694488 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:58:54.695315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.696145 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:54.696417 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:58:54.697396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.699844 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:54.700114 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m08:58:54.700944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.702602 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:54.702816 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m08:58:54.704898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.705959 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:58:54.706225 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:54.706462 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:58:54.711621 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:58:54.713258 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:58:54.713547 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m08:58:54.718942 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:58:54.719988 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m08:58:54.720594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ac6d91f0>]}
[0m08:58:54.721073 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m08:58:54.721476 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m08:58:54.721739 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m08:58:54.722049 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m08:58:54.722420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m08:58:54.722897 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m08:58:54.725031 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m08:58:54.725925 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m08:58:54.727756 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m08:58:54.728181 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:54.728427 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m08:58:54.728627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:54.729594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.729976 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:54.730351 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m08:58:54.732519 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:58:54.733787 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:54.734038 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:58:54.735120 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.736181 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:54.736454 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:58:54.737655 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.739551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:54.739775 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m08:58:54.740564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.742257 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:54.742488 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m08:58:54.743265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.744131 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:58:54.744372 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:54.744582 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:58:54.750649 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:58:54.752752 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:58:54.753056 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m08:58:54.757827 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:58:54.758959 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m08:58:54.759525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ac679310>]}
[0m08:58:54.759954 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m08:58:54.760372 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m08:58:54.760659 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m08:58:54.761013 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m08:58:54.761458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m08:58:54.761700 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m08:58:54.763433 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m08:58:54.763878 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m08:58:54.765949 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m08:58:54.766646 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:54.766917 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m08:58:54.767096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:54.767792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.768013 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:54.768189 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m08:58:54.770234 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:58:54.770992 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:54.771216 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:58:54.772218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.773161 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:54.773406 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:58:54.774439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.777330 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:54.777747 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m08:58:54.778809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.780698 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:54.781004 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m08:58:54.782143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.783241 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:58:54.783524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:54.783765 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:58:54.789018 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:58:54.791727 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:58:54.792063 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m08:58:54.796569 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:58:54.797679 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m08:58:54.798539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75085810acc0>]}
[0m08:58:54.798991 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m08:58:54.799375 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m08:58:54.799656 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m08:58:54.799983 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m08:58:54.800504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m08:58:54.800806 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m08:58:54.802699 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m08:58:54.803454 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m08:58:54.805316 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m08:58:54.805782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:54.806005 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m08:58:54.806184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:54.807339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.807878 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:54.808269 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m08:58:54.810771 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:58:54.811714 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:54.811988 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:58:54.813056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.813992 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:54.814236 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:58:54.815190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.817585 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:54.817908 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m08:58:54.818687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.820422 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:54.820712 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m08:58:54.821769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.822802 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:58:54.823061 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:54.823344 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:58:54.829322 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:58:54.831237 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:58:54.831522 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m08:58:54.836365 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:58:54.837723 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m08:58:54.838374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ac79ae10>]}
[0m08:58:54.838826 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m08:58:54.839241 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m08:58:54.839521 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m08:58:54.839786 [info ] [Thread-1 (]: 7 of 10 SKIP relation intermediate.int_players ................................. [[33mSKIP[0m]
[0m08:58:54.840127 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m08:58:54.840416 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m08:58:54.840731 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'skipped'. 
[0m08:58:54.841153 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m08:58:54.841948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m08:58:54.842283 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m08:58:54.844470 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m08:58:54.845055 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m08:58:54.846969 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m08:58:54.847458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:54.847688 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m08:58:54.847900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:54.848607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.848872 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:54.849073 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m08:58:54.850933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.851813 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:54.852084 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:58:54.853222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.854166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:54.854417 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:58:54.855520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.857705 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:54.858139 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m08:58:54.859055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.860908 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:54.861189 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m08:58:54.861817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:54.862740 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:58:54.862988 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:54.863186 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:58:54.868315 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:58:54.870037 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:58:54.870313 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m08:58:54.875049 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:58:54.876264 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m08:58:54.876927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ac699f40>]}
[0m08:58:54.877417 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m08:58:54.877801 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m08:58:54.878059 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m08:58:54.878382 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m08:58:54.878955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m08:58:54.879198 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m08:58:54.882029 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m08:58:54.882535 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m08:58:54.884285 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m08:58:54.884751 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:54.884980 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m08:58:54.885168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:54.885821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.886081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:54.886286 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m08:58:54.888312 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:58:54.889612 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:54.889933 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:58:54.891002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.892239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:54.892763 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:58:54.893854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:58:54.895753 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:54.896008 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m08:58:54.896884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:54.898469 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:54.898696 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m08:58:54.899285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:58:54.900130 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:58:54.900347 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:54.900524 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:58:54.907345 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:58:54.909091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:58:54.909378 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m08:58:54.914778 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:58:54.916254 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m08:58:54.917292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea2ae1c-0fd9-419a-9e83-ed8c493a6852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ac6953d0>]}
[0m08:58:54.917851 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m08:58:54.918273 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m08:58:54.918644 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m08:58:54.918985 [info ] [Thread-1 (]: 10 of 10 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m08:58:54.919305 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m08:58:54.920002 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m08:58:54.921516 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:54.921887 [debug] [MainThread]: On master: BEGIN
[0m08:58:54.922164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:58:54.923106 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:58:54.923346 [debug] [MainThread]: On master: COMMIT
[0m08:58:54.923536 [debug] [MainThread]: Using duckdb connection "master"
[0m08:58:54.923692 [debug] [MainThread]: On master: COMMIT
[0m08:58:54.924300 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:58:54.924629 [debug] [MainThread]: On master: Close
[0m08:58:54.925034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:58:54.925207 [debug] [MainThread]: Connection 'model.fpl_analytics.int_teams' was properly closed.
[0m08:58:54.925463 [info ] [MainThread]: 
[0m08:58:54.925709 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m08:58:54.926597 [debug] [MainThread]: Command end result
[0m08:58:54.938110 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:58:54.939523 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:58:54.943636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m08:58:54.943911 [info ] [MainThread]: 
[0m08:58:54.944195 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:58:54.944438 [info ] [MainThread]: 
[0m08:58:54.944736 [error] [MainThread]: [31mFailure in model stg_players (fpl_analytics/models/staging/stg_players.sql)[0m
[0m08:58:54.944995 [error] [MainThread]:   Runtime Error in model stg_players (fpl_analytics/models/staging/stg_players.sql)
  Binder Error: Referenced column "start" not found in FROM clause!
  Candidate bindings: "starts", "starts_per_90", "status", "threat", "transfers_out_event"
  
  LINE 55:         start::int as starts,
                   ^
[0m08:58:54.945187 [info ] [MainThread]: 
[0m08:58:54.945413 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/staging/stg_players.sql
[0m08:58:54.945603 [info ] [MainThread]: 
[0m08:58:54.945807 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=10
[0m08:58:54.946494 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2170522, "process_in_blocks": "512", "process_kernel_time": 0.255507, "process_mem_max_rss": "167832", "process_out_blocks": "3320", "process_user_time": 2.316891}
[0m08:58:54.946791 [debug] [MainThread]: Command `dbt build` failed at 08:58:54.946728 after 1.22 seconds
[0m08:58:54.947020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508b9b9a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508afa09610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508afa08470>]}
[0m08:58:54.947233 [debug] [MainThread]: Flushing usage events
[0m08:58:55.441058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:11.901804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b9510cab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b9514fb4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b9514faf30>]}


============================== 08:59:11.904282 | f300e5e9-2be1-4405-9c0f-d9a45cb66d72 ==============================
[0m08:59:11.904282 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:59:11.904715 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/robgriffin247/fpl', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'empty': 'False', 'fail_fast': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m08:59:12.091386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b9504904d0>]}
[0m08:59:12.148394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b952972210>]}
[0m08:59:12.149755 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:59:12.198330 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:59:12.261702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:59:12.262225 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:59:12.530868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b93fd75370>]}
[0m08:59:12.573118 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:59:12.574541 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:59:12.641998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b944d0eea0>]}
[0m08:59:12.642428 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m08:59:12.644164 [info ] [MainThread]: 
[0m08:59:12.644536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:12.644856 [info ] [MainThread]: 
[0m08:59:12.645298 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:59:12.649344 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m08:59:12.671473 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:59:12.671857 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:59:12.672054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:12.693031 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m08:59:12.694221 [debug] [ThreadPool]: On list_analytics: Close
[0m08:59:12.697003 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:59:12.697312 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:59:12.697558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:12.698728 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:12.699621 [debug] [ThreadPool]: On list_analytics: Close
[0m08:59:12.701126 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:59:12.701410 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:59:12.701628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:12.702553 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:12.703349 [debug] [ThreadPool]: On list_analytics: Close
[0m08:59:12.703994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m08:59:12.704322 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m08:59:12.708530 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:59:12.708839 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:59:12.709014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:12.710033 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:12.710857 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:59:12.711061 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m08:59:12.711478 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:12.711684 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:59:12.711841 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m08:59:12.712245 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:12.712822 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:59:12.713039 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:59:12.713202 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:59:12.713578 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:12.713817 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m08:59:12.714413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m08:59:12.714775 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m08:59:12.715948 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:59:12.716290 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:59:12.716512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:12.717556 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:12.718396 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:59:12.718597 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m08:59:12.719005 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:12.719203 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:59:12.719358 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m08:59:12.719763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:12.720272 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:59:12.720467 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:59:12.720624 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:59:12.721081 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:12.721274 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m08:59:12.721732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m08:59:12.722082 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m08:59:12.723140 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:59:12.723387 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:59:12.723602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:12.724482 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:12.725329 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:59:12.725537 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m08:59:12.725943 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:12.726130 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:59:12.726281 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m08:59:12.726671 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:12.727220 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:59:12.727406 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:59:12.727560 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:59:12.727936 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:12.728141 [debug] [ThreadPool]: On create_analytics_core: Close
[0m08:59:12.730025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_intermediate)
[0m08:59:12.733852 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:59:12.734196 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m08:59:12.734448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:12.735192 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:12.735413 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:59:12.735607 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m08:59:12.743403 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m08:59:12.744346 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m08:59:12.745142 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m08:59:12.745352 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m08:59:12.745830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m08:59:12.746972 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:59:12.747223 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m08:59:12.747437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:12.748526 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:12.748785 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:59:12.748981 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m08:59:12.751686 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:59:12.752619 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m08:59:12.753241 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m08:59:12.753424 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m08:59:12.753861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m08:59:12.754961 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:59:12.755190 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m08:59:12.755402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:12.756590 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:12.757085 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:59:12.757289 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m08:59:12.759902 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:59:12.760857 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m08:59:12.761470 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m08:59:12.761684 [debug] [ThreadPool]: On list_analytics_core: Close
[0m08:59:12.762525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b94660b3b0>]}
[0m08:59:12.762857 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:12.763041 [debug] [MainThread]: On master: BEGIN
[0m08:59:12.763202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:59:12.763732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:59:12.763930 [debug] [MainThread]: On master: COMMIT
[0m08:59:12.764091 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:12.764261 [debug] [MainThread]: On master: COMMIT
[0m08:59:12.764699 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:59:12.764922 [debug] [MainThread]: On master: Close
[0m08:59:12.767273 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m08:59:12.767665 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m08:59:12.768113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m08:59:12.768354 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m08:59:12.773369 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.773876 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m08:59:12.797065 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.797677 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.797944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m08:59:12.798163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:12.798907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.799167 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.799383 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m08:59:12.802272 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:59:12.806235 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.806556 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:59:12.807413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.808333 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.808593 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:59:12.809612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.814670 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.815002 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m08:59:12.815801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.817866 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.818165 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m08:59:12.818886 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:12.829315 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:59:12.829667 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.829888 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:59:12.836041 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:12.840092 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:12.840407 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m08:59:12.846271 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:12.849115 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m08:59:12.850958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b93e7c03e0>]}
[0m08:59:12.851481 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m08:59:12.851933 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m08:59:12.852277 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m08:59:12.852647 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m08:59:12.853115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m08:59:12.853406 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m08:59:12.855660 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m08:59:12.857390 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m08:59:12.859776 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m08:59:12.860466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:12.860793 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m08:59:12.861047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:12.861888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.862197 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:12.862449 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        status::varchar as availability_code,
        news::varchar as info,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        starts::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m08:59:12.872367 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:59:12.873517 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:12.873892 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:59:12.875432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.876712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:12.877097 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:59:12.878839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.881205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:12.881523 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m08:59:12.882228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:12.884468 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:12.884969 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m08:59:12.885931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.887059 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:59:12.887358 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:12.887564 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:59:12.895208 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:59:12.897148 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:12.897453 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m08:59:12.904179 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:12.905615 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m08:59:12.906330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b93e7be840>]}
[0m08:59:12.906821 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m08:59:12.907248 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m08:59:12.907544 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m08:59:12.907891 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m08:59:12.908499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m08:59:12.908834 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m08:59:12.910761 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m08:59:12.911755 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m08:59:12.915072 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m08:59:12.915621 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:12.915887 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m08:59:12.916112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:12.917178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.917697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:12.917933 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m08:59:12.919699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.920672 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:12.920982 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:59:12.921817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.922778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:12.923036 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:59:12.924115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.926312 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:12.926615 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m08:59:12.927304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:12.929132 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:12.929398 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m08:59:12.930267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.932090 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:59:12.932533 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:12.932990 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:59:12.939720 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:12.941601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:12.941887 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m08:59:12.947988 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:12.949512 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m08:59:12.950380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b93e7137d0>]}
[0m08:59:12.950891 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m08:59:12.951295 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m08:59:12.951606 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m08:59:12.951943 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m08:59:12.952350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m08:59:12.952707 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m08:59:12.954855 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m08:59:12.955778 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m08:59:12.957800 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m08:59:12.958258 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:12.958515 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m08:59:12.958722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:12.959563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.959831 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:12.960037 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m08:59:12.962807 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:59:12.963711 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:12.963973 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:59:12.965088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:12.966150 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:12.966448 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:59:12.968384 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:59:12.971129 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:12.971423 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m08:59:12.972124 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:12.973941 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:12.974203 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m08:59:12.974818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:12.975686 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:59:12.975967 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:12.976190 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:59:12.981317 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:12.983047 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:12.983385 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m08:59:12.989313 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:12.991138 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m08:59:12.991979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b93e879190>]}
[0m08:59:12.992840 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m08:59:12.993295 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m08:59:12.993598 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m08:59:12.993942 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m08:59:12.994369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m08:59:12.994678 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m08:59:12.996717 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m08:59:12.997299 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m08:59:13.000746 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m08:59:13.001406 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:13.001674 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m08:59:13.001871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:13.002634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.002923 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:13.003138 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m08:59:13.007770 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:59:13.008745 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:13.009034 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:59:13.009849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.010738 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:13.010981 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:59:13.012313 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.015335 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:13.015673 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m08:59:13.016776 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.019106 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:13.019457 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m08:59:13.020279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.021330 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:59:13.021609 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:13.021816 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:59:13.027644 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:13.029476 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:13.029765 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m08:59:13.035204 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:13.036939 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m08:59:13.037592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b904101a90>]}
[0m08:59:13.038037 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m08:59:13.038456 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m08:59:13.038796 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m08:59:13.039134 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m08:59:13.039536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m08:59:13.039796 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m08:59:13.041718 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m08:59:13.042489 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m08:59:13.044326 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m08:59:13.044821 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:13.045083 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m08:59:13.045284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:13.046001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.046269 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:13.046479 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m08:59:13.048541 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:59:13.049560 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:13.049912 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:59:13.051211 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.052864 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:13.053150 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:59:13.054153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.056374 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:13.056664 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m08:59:13.057574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.059674 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:13.060002 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m08:59:13.060619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:13.061575 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:59:13.061869 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:13.062092 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:59:13.067772 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:13.069769 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:13.070081 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m08:59:13.075868 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:13.077474 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m08:59:13.078380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b93e87a810>]}
[0m08:59:13.078887 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m08:59:13.079341 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m08:59:13.079642 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m08:59:13.079971 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m08:59:13.080358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m08:59:13.080657 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m08:59:13.082658 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m08:59:13.083532 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m08:59:13.085868 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m08:59:13.086370 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:13.086639 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m08:59:13.086889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:13.087690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.087943 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:13.088145 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m08:59:13.091585 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:59:13.092432 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:13.092710 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:59:13.093501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.094460 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:13.094704 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:59:13.095807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.099076 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:13.099373 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m08:59:13.100143 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:13.101978 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:13.102258 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m08:59:13.102868 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:13.103789 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:59:13.104044 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:13.104281 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:59:13.110501 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:13.112221 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:13.112496 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m08:59:13.119269 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:13.120944 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m08:59:13.121678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b90411d4f0>]}
[0m08:59:13.122154 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.04s]
[0m08:59:13.122598 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m08:59:13.122907 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m08:59:13.123239 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m08:59:13.123695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m08:59:13.123963 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m08:59:13.126006 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m08:59:13.127191 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m08:59:13.129387 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m08:59:13.129887 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:13.130142 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m08:59:13.130344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:13.131095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.131347 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:13.131571 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m08:59:13.134691 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:59:13.135682 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:13.135970 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:59:13.137032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.138187 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:13.138447 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:59:13.139901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.142556 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:13.142913 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m08:59:13.143905 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.145734 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:13.146013 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m08:59:13.146873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.147940 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:59:13.148202 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:13.148410 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:59:13.154626 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:13.156484 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:13.156850 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m08:59:13.162797 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:13.164464 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m08:59:13.165248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b93e87bc80>]}
[0m08:59:13.165727 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m08:59:13.166165 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m08:59:13.166483 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m08:59:13.166890 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m08:59:13.167308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m08:59:13.167607 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m08:59:13.169668 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m08:59:13.170331 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m08:59:13.172234 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m08:59:13.172761 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:13.173026 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m08:59:13.173234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:13.174205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.174570 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:13.174799 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m08:59:13.177785 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:59:13.178749 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:13.179034 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:59:13.179927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.180898 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:13.181163 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:59:13.182198 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.184518 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:13.184996 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m08:59:13.185866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.188998 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:13.189309 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m08:59:13.190107 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.191124 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:59:13.191421 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:13.191654 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:59:13.197668 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:13.200036 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:13.200361 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m08:59:13.206498 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:13.208078 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m08:59:13.209077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b90412a570>]}
[0m08:59:13.209564 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m08:59:13.209999 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m08:59:13.210306 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m08:59:13.210641 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m08:59:13.211254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m08:59:13.211539 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m08:59:13.213542 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m08:59:13.214812 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m08:59:13.217169 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m08:59:13.217846 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:13.218210 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m08:59:13.218469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:13.219252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.219500 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:13.219710 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m08:59:13.223217 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:59:13.224238 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:13.224550 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:59:13.225799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.226857 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:13.227148 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:59:13.228539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.230848 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:13.231130 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m08:59:13.231949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.234043 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:13.234431 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m08:59:13.235289 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:13.236282 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:59:13.236550 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:13.236959 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:59:13.243870 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:59:13.245680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:13.245962 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m08:59:13.252932 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:13.254224 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m08:59:13.254942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f300e5e9-2be1-4405-9c0f-d9a45cb66d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b90411b800>]}
[0m08:59:13.255417 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m08:59:13.255844 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m08:59:13.258065 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:13.258437 [debug] [MainThread]: On master: BEGIN
[0m08:59:13.258649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:59:13.259602 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:59:13.259878 [debug] [MainThread]: On master: COMMIT
[0m08:59:13.260101 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:13.260290 [debug] [MainThread]: On master: COMMIT
[0m08:59:13.260918 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:59:13.261171 [debug] [MainThread]: On master: Close
[0m08:59:13.261530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:13.261717 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m08:59:13.262048 [info ] [MainThread]: 
[0m08:59:13.262332 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m08:59:13.263571 [debug] [MainThread]: Command end result
[0m08:59:13.277526 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:59:13.279194 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:59:13.283811 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m08:59:13.284189 [info ] [MainThread]: 
[0m08:59:13.284591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:13.284880 [info ] [MainThread]: 
[0m08:59:13.285184 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m08:59:13.286188 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.4361117, "process_in_blocks": "912", "process_kernel_time": 0.236509, "process_mem_max_rss": "168184", "process_out_blocks": "4104", "process_user_time": 2.405177}
[0m08:59:13.286613 [debug] [MainThread]: Command `dbt build` succeeded at 08:59:13.286529 after 1.44 seconds
[0m08:59:13.286938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b9505f4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b951469a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b95146ae40>]}
[0m08:59:13.287235 [debug] [MainThread]: Flushing usage events
[0m08:59:13.857341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:57.998726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bad076e7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bad072605f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bad070511c0>]}


============================== 08:59:58.001006 | 56e7d120-0fd4-4829-8a36-04c43d79e821 ==============================
[0m08:59:58.001006 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:59:58.001371 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/robgriffin247/fpl/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'empty': 'False', 'printer_width': '80', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'quiet': 'False', 'profiles_dir': '/home/robgriffin247/fpl'}
[0m08:59:58.181052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bad0659e0f0>]}
[0m08:59:58.234986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bad07a99e20>]}
[0m08:59:58.236061 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m08:59:58.279986 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:59:58.340158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:59:58.340646 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m08:59:58.592293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bad06734530>]}
[0m08:59:58.633084 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:59:58.634320 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:59:58.692901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacfc6df3e0>]}
[0m08:59:58.693258 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m08:59:58.694786 [info ] [MainThread]: 
[0m08:59:58.695117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:58.695326 [info ] [MainThread]: 
[0m08:59:58.695667 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:59:58.699559 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m08:59:58.720346 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:59:58.720726 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:59:58.720955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:58.738925 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m08:59:58.739942 [debug] [ThreadPool]: On list_analytics: Close
[0m08:59:58.742570 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:59:58.742911 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:59:58.743130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:58.744570 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:58.745563 [debug] [ThreadPool]: On list_analytics: Close
[0m08:59:58.747181 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m08:59:58.747453 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m08:59:58.747806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:58.748785 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:58.749574 [debug] [ThreadPool]: On list_analytics: Close
[0m08:59:58.750265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m08:59:58.750596 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m08:59:58.754831 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:59:58.755068 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:59:58.755234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:58.756085 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:58.756917 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:59:58.757122 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m08:59:58.757703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:58.758021 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:59:58.758287 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m08:59:58.758965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:58.759516 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:59:58.759713 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m08:59:58.759876 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m08:59:58.760294 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:58.760584 [debug] [ThreadPool]: On create_analytics_core: Close
[0m08:59:58.761155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m08:59:58.761495 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m08:59:58.762590 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:59:58.762878 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:59:58.763079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:58.764239 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:58.765310 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:59:58.765580 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m08:59:58.765971 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:58.766151 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:59:58.766310 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m08:59:58.766678 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:58.767145 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:59:58.767328 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m08:59:58.767470 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m08:59:58.767874 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:58.768078 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m08:59:58.768555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m08:59:58.769054 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m08:59:58.770024 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:59:58.770197 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m08:59:58.770343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:58.771205 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:58.771903 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:59:58.772082 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m08:59:58.772430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:58.772620 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:59:58.772836 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m08:59:58.773195 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:58.773715 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:59:58.773921 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m08:59:58.774080 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m08:59:58.774915 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:58.775319 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m08:59:58.777350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m08:59:58.780987 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:59:58.781206 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m08:59:58.781389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:58.782014 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:58.782225 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m08:59:58.782380 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m08:59:58.791426 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m08:59:58.792834 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m08:59:58.793679 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m08:59:58.793917 [debug] [ThreadPool]: On list_analytics_core: Close
[0m08:59:58.794457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m08:59:58.795576 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:59:58.795810 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m08:59:58.796008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:58.797080 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:58.797341 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m08:59:58.797507 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m08:59:58.800156 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:59:58.801169 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m08:59:58.801676 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m08:59:58.801852 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m08:59:58.802346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m08:59:58.803390 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:59:58.803616 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m08:59:58.803811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:58.805232 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:59:58.805521 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m08:59:58.805707 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m08:59:58.808605 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:59:58.809761 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m08:59:58.810352 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m08:59:58.810540 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m08:59:58.811707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacfc6ed880>]}
[0m08:59:58.812026 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:58.812194 [debug] [MainThread]: On master: BEGIN
[0m08:59:58.812368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:59:58.812922 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:59:58.813108 [debug] [MainThread]: On master: COMMIT
[0m08:59:58.813281 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:58.813420 [debug] [MainThread]: On master: COMMIT
[0m08:59:58.813794 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:59:58.813987 [debug] [MainThread]: On master: Close
[0m08:59:58.816174 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m08:59:58.816546 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m08:59:58.816929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_gameweeks)
[0m08:59:58.817150 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m08:59:58.822283 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.823033 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m08:59:58.844001 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.844594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.844906 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m08:59:58.845091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:58.846190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.846434 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.846616 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m08:59:58.848739 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:59:58.852466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.852900 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:59:58.854164 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.855106 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.855337 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m08:59:58.856440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.860703 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.861043 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m08:59:58.861802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.863402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.863667 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m08:59:58.864172 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:58.873547 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:59:58.873887 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.874087 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m08:59:58.880241 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:58.884018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m08:59:58.884296 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m08:59:58.889059 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:59:58.890925 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m08:59:58.892340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacf8db58b0>]}
[0m08:59:58.892845 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.07s]
[0m08:59:58.893233 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m08:59:58.893493 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m08:59:58.893792 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m08:59:58.894149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m08:59:58.894417 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m08:59:58.896359 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m08:59:58.897318 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m08:59:58.899186 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m08:59:58.899664 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:58.899899 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m08:59:58.900079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:58.901263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.901730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:58.902124 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        status::varchar as availability_code,
        news::varchar as info,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        starts::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        *
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m08:59:58.917337 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m08:59:58.918197 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:58.918436 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:59:58.919424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.920676 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:58.920969 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m08:59:58.921994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.923847 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:58.924089 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m08:59:58.924668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:58.926274 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:58.926506 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m08:59:58.927085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:58.927989 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:59:58.928224 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:58.928421 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m08:59:58.936330 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:59:58.938121 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m08:59:58.938439 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m08:59:58.943350 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:58.945097 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m08:59:58.945962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacf8cb6990>]}
[0m08:59:58.946443 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m08:59:58.946846 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m08:59:58.947152 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m08:59:58.947493 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m08:59:58.947949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m08:59:58.948324 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m08:59:58.950541 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m08:59:58.951057 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m08:59:58.954368 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m08:59:58.954993 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:58.955284 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m08:59:58.955479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:58.956255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.956657 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:58.956967 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m08:59:58.958988 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:59:58.959958 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:58.960220 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:59:58.961227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.962125 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:58.962354 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m08:59:58.963260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.965218 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:58.965465 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m08:59:58.966076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:58.968012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:58.968351 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m08:59:58.969441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.970401 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:59:58.970662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:58.970869 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m08:59:58.976602 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:58.978398 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m08:59:58.978673 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m08:59:58.984029 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:58.985231 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m08:59:58.985783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacf8caff50>]}
[0m08:59:58.986222 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m08:59:58.986593 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m08:59:58.986846 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m08:59:58.987153 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m08:59:58.988189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m08:59:58.988565 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m08:59:58.990701 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m08:59:58.991231 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m08:59:58.993052 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m08:59:58.993486 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:58.993714 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m08:59:58.993915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:58.994602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.994808 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:58.994993 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m08:59:58.996527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:58.997367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:58.997615 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:59:58.998664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.000100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:59.000586 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m08:59:59.001741 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.003764 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:59.004109 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m08:59:59.005084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.006886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:59.007105 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m08:59:59.007693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:59.008592 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:59:59.008897 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:59.009071 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m08:59:59.014647 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:59.016373 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m08:59:59.016661 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m08:59:59.022087 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:59.023484 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m08:59:59.024476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacfc6c5f10>]}
[0m08:59:59.024990 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m08:59:59.025411 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m08:59:59.025718 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m08:59:59.026049 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m08:59:59.026766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m08:59:59.027046 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m08:59:59.029229 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m08:59:59.029718 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m08:59:59.032626 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m08:59:59.033109 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:59.033355 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m08:59:59.033557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:59.034310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.034591 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:59.034790 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m08:59:59.037061 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:59:59.038017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:59.038278 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:59:59.039074 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.040049 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:59.040310 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m08:59:59.041438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.043454 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:59.043711 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m08:59:59.044479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.046367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:59.046684 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m08:59:59.047415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:59.048283 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:59:59.048597 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:59.048884 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m08:59:59.055344 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:59.057165 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m08:59:59.057452 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m08:59:59.062677 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:59.064032 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m08:59:59.064634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacf8c754c0>]}
[0m08:59:59.065164 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m08:59:59.065583 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m08:59:59.065873 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m08:59:59.066203 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m08:59:59.066702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m08:59:59.067005 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m08:59:59.068998 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m08:59:59.070093 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m08:59:59.072339 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m08:59:59.073135 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:59.073484 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m08:59:59.073693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:59.074746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.075253 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:59.075669 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m08:59:59.079279 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:59:59.080419 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:59.080818 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:59:59.081870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.082812 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:59.083057 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m08:59:59.084473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.086701 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:59.086977 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m08:59:59.087652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:59.089450 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:59.089714 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m08:59:59.090318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:59.091152 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:59:59.091388 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:59.091611 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m08:59:59.097272 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:59.099142 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m08:59:59.099427 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m08:59:59.105000 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:59.106129 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m08:59:59.106767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacf8c51a60>]}
[0m08:59:59.107196 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m08:59:59.107572 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m08:59:59.107846 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m08:59:59.108177 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m08:59:59.108514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m08:59:59.108761 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m08:59:59.110900 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m08:59:59.111441 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m08:59:59.113444 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m08:59:59.113922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:59.114158 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m08:59:59.114365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:59.115077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.115295 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:59.115477 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m08:59:59.124964 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:59:59.125952 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:59.126350 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:59:59.127657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.128757 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:59.129047 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m08:59:59.130151 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.133409 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:59.133735 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m08:59:59.134511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.136206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:59.136438 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m08:59:59.137362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.138627 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:59:59.138876 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:59.139065 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m08:59:59.146610 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:59:59.148366 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m08:59:59.148658 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m08:59:59.153226 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:59:59.154242 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m08:59:59.155483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacf8cdda30>]}
[0m08:59:59.155947 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m08:59:59.156354 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m08:59:59.156689 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m08:59:59.157085 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m08:59:59.157533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m08:59:59.157781 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m08:59:59.159714 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m08:59:59.160639 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m08:59:59.162485 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m08:59:59.162914 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:59.163141 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m08:59:59.163326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:59.164001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.164219 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:59.164410 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m08:59:59.165906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.166616 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:59.166832 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:59:59.167527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:59.168559 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:59.168840 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m08:59:59.169974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.172104 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:59.172386 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m08:59:59.173586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.176035 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:59.176493 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m08:59:59.177199 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:59.178163 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:59:59.178394 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:59.178578 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m08:59:59.184933 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:59.186601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m08:59:59.186934 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m08:59:59.192646 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:59.193782 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m08:59:59.194293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacfc6c5e20>]}
[0m08:59:59.194730 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m08:59:59.195104 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m08:59:59.195375 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m08:59:59.195990 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m08:59:59.196436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m08:59:59.196693 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m08:59:59.198710 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m08:59:59.199137 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m08:59:59.200950 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m08:59:59.201402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:59.201638 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m08:59:59.201826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:59.202667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.202928 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:59.203160 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m08:59:59.205288 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:59:59.206094 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:59.206336 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:59:59.207324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.208591 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:59.208886 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m08:59:59.209956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.211887 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:59.212107 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m08:59:59.212753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:59.215617 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:59.215854 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m08:59:59.216515 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:59.217473 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:59:59.217736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:59.217958 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m08:59:59.224157 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:59:59.225845 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m08:59:59.226103 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m08:59:59.231417 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:59.232905 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m08:59:59.233494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacf8cf92e0>]}
[0m08:59:59.234016 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m08:59:59.234412 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m08:59:59.234681 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m08:59:59.235005 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m08:59:59.235404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m08:59:59.235668 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m08:59:59.237643 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m08:59:59.238166 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m08:59:59.239986 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m08:59:59.240443 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:59.240667 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m08:59:59.240931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:59.241741 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.241972 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:59.242165 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m08:59:59.251085 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:59:59.252118 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:59.252403 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:59:59.253329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.254195 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:59.254427 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m08:59:59.255664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.257929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:59.258212 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m08:59:59.258964 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:59.260639 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:59.260924 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m08:59:59.261669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:59:59.262570 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:59:59.262843 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:59.263042 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m08:59:59.271219 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:59:59.273115 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m08:59:59.273414 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m08:59:59.278437 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:59.279623 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m08:59:59.280872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e7d120-0fd4-4829-8a36-04c43d79e821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacfc768b60>]}
[0m08:59:59.281345 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.05s]
[0m08:59:59.281766 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m08:59:59.283457 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:59.283739 [debug] [MainThread]: On master: BEGIN
[0m08:59:59.283945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:59:59.284661 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:59:59.284952 [debug] [MainThread]: On master: COMMIT
[0m08:59:59.285196 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:59.285376 [debug] [MainThread]: On master: COMMIT
[0m08:59:59.285875 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:59:59.286107 [debug] [MainThread]: On master: Close
[0m08:59:59.286435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:59.286622 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m08:59:59.286979 [info ] [MainThread]: 
[0m08:59:59.287245 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m08:59:59.288334 [debug] [MainThread]: Command end result
[0m08:59:59.300857 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m08:59:59.302526 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m08:59:59.306777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m08:59:59.307022 [info ] [MainThread]: 
[0m08:59:59.307304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:59.307567 [info ] [MainThread]: 
[0m08:59:59.307798 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m08:59:59.308648 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3552201, "process_in_blocks": "0", "process_kernel_time": 0.333244, "process_mem_max_rss": "174972", "process_out_blocks": "6600", "process_user_time": 2.410613}
[0m08:59:59.309111 [debug] [MainThread]: Command `dbt build` succeeded at 08:59:59.309019 after 1.36 seconds
[0m08:59:59.309445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bacfc5f8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bad06f4a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bad06f48830>]}
[0m08:59:59.309726 [debug] [MainThread]: Flushing usage events
[0m08:59:59.821995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:29.042121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e1ab2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e1d97290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e10b8c20>]}


============================== 09:10:29.046639 | d28c533a-6558-4da9-be27-9d2387ddcd30 ==============================
[0m09:10:29.046639 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:10:29.047159 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'invocation_command': 'dbt build', 'no_print': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'empty': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True'}
[0m09:10:29.267716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e0dc5f70>]}
[0m09:10:29.345627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e35c2360>]}
[0m09:10:29.349239 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:10:29.420595 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:10:29.548765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:10:29.549348 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:10:29.549675 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m09:10:29.856109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5d579b560>]}
[0m09:10:29.899279 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:10:29.901393 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:10:29.977763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5d5638740>]}
[0m09:10:29.978206 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:10:29.981304 [info ] [MainThread]: 
[0m09:10:29.981931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:10:29.982433 [info ] [MainThread]: 
[0m09:10:29.983062 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:10:29.987031 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:10:30.016762 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:10:30.017115 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:10:30.017315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:30.047830 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m09:10:30.048904 [debug] [ThreadPool]: On list_analytics: Close
[0m09:10:30.050388 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:10:30.050826 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:10:30.051015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:30.051992 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:30.053048 [debug] [ThreadPool]: On list_analytics: Close
[0m09:10:30.054963 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:10:30.055329 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:10:30.055535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:30.056532 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:30.057213 [debug] [ThreadPool]: On list_analytics: Close
[0m09:10:30.057880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m09:10:30.058151 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:10:30.062038 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:10:30.062254 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:10:30.062455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:30.063231 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:30.064069 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:10:30.064250 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:10:30.064613 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:30.064791 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:10:30.064928 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:10:30.065331 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:30.065833 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:10:30.066025 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:10:30.066169 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:10:30.066529 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:30.066727 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:10:30.067121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m09:10:30.067440 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:10:30.068362 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:10:30.068581 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:10:30.068772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:30.069676 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:30.070483 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:10:30.070720 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:10:30.071162 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:30.071348 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:10:30.071500 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:10:30.072054 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:30.072736 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:10:30.072953 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:10:30.073134 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:10:30.073817 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:30.074050 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:10:30.074552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m09:10:30.075065 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:10:30.076130 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:10:30.076349 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:10:30.076511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:30.077294 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:30.078190 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:10:30.078389 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:10:30.078867 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:30.079076 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:10:30.079231 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:10:30.079669 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:30.080185 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:10:30.080385 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:10:30.080545 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:10:30.081076 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:10:30.081403 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:10:30.083138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m09:10:30.086951 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:10:30.087272 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:10:30.087448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:30.088410 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:30.088764 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:10:30.089039 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:10:30.097669 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:10:30.098646 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:10:30.100558 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:10:30.100816 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:10:30.101368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m09:10:30.102470 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:10:30.102984 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:10:30.103169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:30.104017 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:30.104338 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:10:30.104612 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:10:30.108207 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:10:30.109205 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:10:30.109753 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:10:30.109944 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:10:30.110419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m09:10:30.112146 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:10:30.112395 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:10:30.112559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:30.113229 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:30.113546 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:10:30.113821 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:10:30.117434 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:10:30.118756 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:10:30.119302 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:10:30.119483 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:10:30.120440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e3729f70>]}
[0m09:10:30.120738 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:30.120915 [debug] [MainThread]: On master: BEGIN
[0m09:10:30.121065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:30.121528 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:10:30.121717 [debug] [MainThread]: On master: COMMIT
[0m09:10:30.121874 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:30.122045 [debug] [MainThread]: On master: COMMIT
[0m09:10:30.122404 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:10:30.122629 [debug] [MainThread]: On master: Close
[0m09:10:30.125204 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:10:30.125556 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:10:30.125884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m09:10:30.126101 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:10:30.130599 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.131173 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:10:30.152240 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.152779 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.153035 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:10:30.153204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.153888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.154134 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.154335 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:10:30.157649 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:10:30.161093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.161371 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:10:30.162207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.163008 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.163223 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:10:30.164208 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.168883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.169124 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:10:30.170718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.172303 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.172514 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:10:30.173252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.183535 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:10:30.183908 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.184123 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:10:30.190002 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:10:30.193598 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:10:30.193875 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:10:30.199402 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.201078 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:10:30.202918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e3656930>]}
[0m09:10:30.203373 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m09:10:30.203773 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:10:30.204043 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:10:30.204349 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:10:30.204748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:10:30.205363 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:10:30.207450 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:10:30.207881 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:10:30.209637 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:10:30.210004 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:10:30.210210 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:10:30.210403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.211101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.211300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:10:30.211505 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        starts::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:10:30.218306 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:10:30.219232 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:10:30.219508 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:10:30.220522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.221664 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:10:30.221944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:10:30.223114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.225105 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:10:30.225334 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:10:30.225994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.227777 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:10:30.228028 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:10:30.228600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.229424 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:10:30.229651 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:10:30.229837 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:10:30.235026 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.236663 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:10:30.236933 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:10:30.242102 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.243392 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:10:30.244047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5bf130500>]}
[0m09:10:30.244458 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m09:10:30.244839 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:10:30.245092 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:10:30.245385 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:10:30.245723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:10:30.245996 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:10:30.248949 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:10:30.249386 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:10:30.251097 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:10:30.251491 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:10:30.251730 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:10:30.251943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.252620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.252845 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:10:30.253035 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:10:30.255527 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:30.256634 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:10:30.257041 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:10:30.258360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.259234 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:10:30.259471 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:10:30.260399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.262250 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:10:30.262542 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:10:30.263362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.265211 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:10:30.265472 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:10:30.266243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.267174 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:10:30.267429 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:10:30.267632 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:10:30.273004 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.275064 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:10:30.275363 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:10:30.279951 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:10:30.281335 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:10:30.282036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5bf1312b0>]}
[0m09:10:30.282617 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m09:10:30.283229 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:10:30.283818 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:10:30.284585 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:10:30.285018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:10:30.285282 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:10:30.287070 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:10:30.287759 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:10:30.289500 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:10:30.289890 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:10:30.290104 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:10:30.290297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.291152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.291414 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:10:30.291626 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:10:30.293459 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:30.294219 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:10:30.294498 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:10:30.295220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.296031 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:10:30.296282 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:10:30.297333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.299372 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:10:30.299638 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:10:30.300533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.303039 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:10:30.303419 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:10:30.304235 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.305079 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:10:30.305318 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:10:30.305507 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:10:30.311032 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.312451 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:10:30.312690 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:10:30.318428 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.319717 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:10:30.320408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5bc1395e0>]}
[0m09:10:30.320810 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m09:10:30.321173 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:10:30.321442 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:10:30.321729 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:10:30.322028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:10:30.322260 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:10:30.324020 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:10:30.324536 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:10:30.327383 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:10:30.327797 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:10:30.328013 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:10:30.328193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.328909 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.329126 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:10:30.329349 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:10:30.332354 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:10:30.333283 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:10:30.333567 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:10:30.334533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.335492 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:10:30.335737 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:10:30.336754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.338727 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:10:30.338982 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:10:30.339594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.341225 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:10:30.341457 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:10:30.342007 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.342848 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:10:30.343081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:10:30.343268 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:10:30.348578 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.350226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:10:30.350491 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:10:30.355156 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:10:30.356415 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:10:30.357165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5bc154590>]}
[0m09:10:30.357766 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m09:10:30.358337 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:10:30.358632 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:10:30.359193 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:10:30.359558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:10:30.359805 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:10:30.361825 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:10:30.362332 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:10:30.364227 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:10:30.364695 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:10:30.364920 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:10:30.365103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.365802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.366042 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:10:30.366258 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:10:30.368099 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:30.368830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:10:30.369061 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:10:30.369773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.370646 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:10:30.370894 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:10:30.371890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.373703 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:10:30.373971 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:10:30.374574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.376347 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:10:30.376610 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:10:30.377414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.378311 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:10:30.378560 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:10:30.378789 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:10:30.384023 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.385603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:10:30.385842 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:10:30.390327 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:10:30.391531 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:10:30.392230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5bf1f5f10>]}
[0m09:10:30.392700 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m09:10:30.393101 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:10:30.393381 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:10:30.393715 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:10:30.394174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m09:10:30.394395 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:10:30.396284 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:10:30.396789 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:10:30.399925 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:10:30.400448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:10:30.400705 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:10:30.400894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.401577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.401803 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:10:30.402012 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select
        player_id,
        display_name,
        team_id,
        position_id,
        cost,
        availability_next_gameweek,
        case availability_code
            when 's' then 'suspended'
            when 'i' then 'injured'
            when 'd' then 'injury risk'
            when 'a' then 'availabile'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m09:10:30.406915 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.407855 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:10:30.408140 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:10:30.409136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.410048 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:10:30.410303 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:10:30.411426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.413471 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:10:30.413717 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m09:10:30.414348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.415951 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:10:30.416183 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m09:10:30.416735 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.417511 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:10:30.417743 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:10:30.417933 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:10:30.423835 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:10:30.425499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:10:30.425770 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m09:10:30.430838 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.431777 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:10:30.432562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5bc110b90>]}
[0m09:10:30.432969 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.04s]
[0m09:10:30.433340 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:10:30.433593 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:10:30.433879 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:10:30.434401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m09:10:30.434723 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:10:30.436463 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:10:30.436903 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:10:30.438844 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:10:30.439287 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:10:30.439543 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:10:30.439752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.440760 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.441177 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:10:30.441529 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:10:30.443340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.444015 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:10:30.444219 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:10:30.444890 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.445660 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:10:30.445862 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:10:30.446853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.448918 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:10:30.449183 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:10:30.449840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.451531 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:10:30.451786 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:10:30.452570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.453495 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:10:30.453746 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:10:30.453949 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:10:30.459325 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.460965 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:10:30.461248 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:10:30.465991 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:10:30.467280 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:10:30.467821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5bf16de80>]}
[0m09:10:30.468289 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.03s]
[0m09:10:30.468701 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:10:30.468978 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:10:30.469328 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:10:30.469939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:10:30.470373 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:10:30.472135 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:10:30.472557 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:10:30.474345 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:10:30.474802 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:10:30.475035 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:10:30.475227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.476079 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.476366 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:10:30.476576 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:10:30.478743 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:30.479558 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:10:30.479809 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:10:30.480509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.481300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:10:30.481524 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:10:30.482508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.485717 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:10:30.486040 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:10:30.486787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.488404 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:10:30.488643 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:10:30.489234 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.490054 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:10:30.490318 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:10:30.490526 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:10:30.496336 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:10:30.497927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:10:30.498266 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:10:30.504196 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:10:30.505684 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:10:30.506485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5bc1013d0>]}
[0m09:10:30.507148 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m09:10:30.507570 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:10:30.507824 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:10:30.508125 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m09:10:30.508486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m09:10:30.508771 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m09:10:30.510297 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m09:10:30.511344 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m09:10:30.513067 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m09:10:30.513501 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:10:30.513784 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m09:10:30.513997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.514749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.514969 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:10:30.515143 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m09:10:30.518046 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:10:30.519080 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:10:30.519347 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:10:30.520129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.520969 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:10:30.521188 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:10:30.522061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.523775 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:10:30.523992 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m09:10:30.524708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.526084 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:10:30.526282 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m09:10:30.526781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:10:30.527752 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:10:30.527998 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:10:30.528200 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:10:30.534700 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:10:30.536375 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:10:30.536650 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m09:10:30.541838 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:10:30.543105 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m09:10:30.543841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c533a-6558-4da9-be27-9d2387ddcd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5bf1e5f10>]}
[0m09:10:30.544277 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m09:10:30.544654 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:10:30.545854 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:30.546082 [debug] [MainThread]: On master: BEGIN
[0m09:10:30.546253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:10:30.547121 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:10:30.547465 [debug] [MainThread]: On master: COMMIT
[0m09:10:30.547752 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:30.548008 [debug] [MainThread]: On master: COMMIT
[0m09:10:30.548618 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:10:30.548849 [debug] [MainThread]: On master: Close
[0m09:10:30.549159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:30.549331 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m09:10:30.549554 [info ] [MainThread]: 
[0m09:10:30.549792 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m09:10:30.550802 [debug] [MainThread]: Command end result
[0m09:10:30.562163 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:10:30.563337 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:10:30.567154 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:10:30.567376 [info ] [MainThread]: 
[0m09:10:30.567595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:10:30.567810 [info ] [MainThread]: 
[0m09:10:30.568030 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:10:30.569489 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5846862, "process_in_blocks": "69840", "process_kernel_time": 0.402309, "process_mem_max_rss": "167976", "process_out_blocks": "4096", "process_user_time": 2.573958}
[0m09:10:30.569774 [debug] [MainThread]: Command `dbt build` succeeded at 09:10:30.569713 after 1.59 seconds
[0m09:10:30.569985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e10b8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5d6fc1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e1611dc0>]}
[0m09:10:30.570202 [debug] [MainThread]: Flushing usage events
[0m09:10:31.242388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:21:43.201628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb2a0b5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb2a0b5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb2a120b30>]}


============================== 09:21:43.205412 | 1d98397d-22c7-4cf7-a5fb-a2fe9cb72807 ==============================
[0m09:21:43.205412 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:21:43.205847 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'profiles_dir': '/home/robgriffin247/fpl', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'empty': 'False'}
[0m09:21:43.417039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb2558bef0>]}
[0m09:21:43.477253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb1fc6c5c0>]}
[0m09:21:43.480505 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:21:43.532792 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:21:43.627477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:21:43.628037 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:21:43.628338 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_gameweeks.sql
[0m09:21:43.628581 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m09:21:43.628811 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_positions.sql
[0m09:21:43.895906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb1dfea8a0>]}
[0m09:21:43.934224 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:21:43.936127 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:21:44.012922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb1dfbbc20>]}
[0m09:21:44.013320 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:21:44.014972 [info ] [MainThread]: 
[0m09:21:44.015333 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:21:44.015616 [info ] [MainThread]: 
[0m09:21:44.016037 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:21:44.020166 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:21:44.050829 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:21:44.051194 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:21:44.051423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:44.079345 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m09:21:44.080556 [debug] [ThreadPool]: On list_analytics: Close
[0m09:21:44.082199 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:21:44.082651 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:21:44.082889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:44.083859 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:21:44.084614 [debug] [ThreadPool]: On list_analytics: Close
[0m09:21:44.086013 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:21:44.086430 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:21:44.086646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:44.087479 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:21:44.088236 [debug] [ThreadPool]: On list_analytics: Close
[0m09:21:44.088845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m09:21:44.089154 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:21:44.093495 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:21:44.093739 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:21:44.093917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:44.094974 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:21:44.095917 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:21:44.096126 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:21:44.096537 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:44.096726 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:21:44.096881 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:21:44.097355 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:44.097920 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:21:44.098146 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:21:44.098341 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:21:44.098917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:44.099259 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:21:44.099942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m09:21:44.100286 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:21:44.101369 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:21:44.101609 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:21:44.101814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:44.102741 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:21:44.103572 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:21:44.103763 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:21:44.104163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:44.104344 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:21:44.104489 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:21:44.104867 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:44.105359 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:21:44.105546 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:21:44.105695 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:21:44.106044 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:44.106258 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:21:44.106783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m09:21:44.107100 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:21:44.108262 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:21:44.108555 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:21:44.108765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:44.109962 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:21:44.110810 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:21:44.111009 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:21:44.111426 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:44.111669 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:21:44.111876 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:21:44.112277 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:44.112826 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:21:44.113054 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:21:44.113204 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:21:44.113577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:21:44.113770 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:21:44.115819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m09:21:44.119652 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:21:44.119989 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:21:44.120211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:44.120980 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:21:44.121177 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:21:44.121346 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:21:44.129429 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:21:44.130483 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:21:44.132614 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:21:44.132851 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:21:44.133325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m09:21:44.134468 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:21:44.134714 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:21:44.134921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:44.136161 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:21:44.136535 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:21:44.137245 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:21:44.139938 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:21:44.140793 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:21:44.141300 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:21:44.141473 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:21:44.141894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m09:21:44.142974 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:21:44.143204 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:21:44.143410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:44.144477 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:21:44.144676 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:21:44.144834 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:21:44.147224 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:21:44.148142 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:21:44.148635 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:21:44.148805 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:21:44.149792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb1df58bf0>]}
[0m09:21:44.150105 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:44.150279 [debug] [MainThread]: On master: BEGIN
[0m09:21:44.150429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:21:44.150934 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:21:44.151122 [debug] [MainThread]: On master: COMMIT
[0m09:21:44.151307 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:44.151545 [debug] [MainThread]: On master: COMMIT
[0m09:21:44.151957 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:21:44.152211 [debug] [MainThread]: On master: Close
[0m09:21:44.155951 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:21:44.156347 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:21:44.156731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m09:21:44.156970 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:21:44.162327 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.162826 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:21:44.182829 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.184166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.184453 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:21:44.184631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:44.185295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.185553 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.185752 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:21:44.188859 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:21:44.192236 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.192496 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:21:44.193279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.194088 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.194308 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:21:44.195370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.199254 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.199598 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:21:44.201319 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.202995 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.203233 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:21:44.204051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.213397 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:21:44.213767 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.214036 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:21:44.220595 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:21:44.224315 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:21:44.224587 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:21:44.230435 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:21:44.232330 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:21:44.234149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb2bfeee70>]}
[0m09:21:44.234621 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m09:21:44.235028 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:21:44.235333 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:21:44.235738 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:21:44.236342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:21:44.236643 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:21:44.239230 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:21:44.239777 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:21:44.241629 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:21:44.242049 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:21:44.242273 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:21:44.242459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:44.243185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.243440 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:21:44.243748 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        starts::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:21:44.251193 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:21:44.252126 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:21:44.252380 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:21:44.253148 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.253908 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:21:44.254120 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:21:44.255186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.257352 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:21:44.257604 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:21:44.258348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:44.260716 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:21:44.261082 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:21:44.262080 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.263101 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:21:44.263391 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:21:44.263690 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:21:44.270253 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:21:44.273009 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:21:44.273381 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:21:44.278976 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:21:44.280460 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:21:44.281115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72babc240740>]}
[0m09:21:44.281548 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m09:21:44.281958 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:21:44.282282 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:21:44.282608 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:21:44.283656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:21:44.284006 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:21:44.286052 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:21:44.286945 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:21:44.289057 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:21:44.289528 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:21:44.289775 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:21:44.289977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:44.290774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.291013 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:21:44.291212 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:21:44.294309 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:21:44.295312 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:21:44.295660 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:21:44.296803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.298171 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:21:44.298603 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:21:44.299960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.302611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:21:44.302928 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:21:44.304100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.306128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:21:44.306398 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:21:44.307278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:44.308491 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:21:44.308778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:21:44.309001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:21:44.315233 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:21:44.316971 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:21:44.317247 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:21:44.322764 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:21:44.324246 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:21:44.324810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb1c358350>]}
[0m09:21:44.325280 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m09:21:44.325713 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:21:44.326010 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:21:44.326345 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:21:44.326742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:21:44.327434 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:21:44.329547 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:21:44.330071 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:21:44.332128 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:21:44.332555 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:21:44.332821 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:21:44.333038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:44.333783 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.334012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:21:44.334205 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:21:44.336444 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:21:44.337293 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:21:44.337590 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:21:44.338354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.339226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:21:44.339534 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:21:44.340729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.343244 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:21:44.343564 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:21:44.344272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:44.346104 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:21:44.346354 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:21:44.346946 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:44.347876 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:21:44.348166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:21:44.348372 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:21:44.354870 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:21:44.356749 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:21:44.357081 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:21:44.363728 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:21:44.366085 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:21:44.366896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72babc224560>]}
[0m09:21:44.367394 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m09:21:44.367843 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:21:44.368128 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:21:44.368444 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:21:44.368842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:21:44.369115 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:21:44.370826 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:21:44.371405 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:21:44.373861 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:21:44.374476 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:21:44.374775 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:21:44.375010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:44.376138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.376436 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:21:44.376665 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_home_attack::int as team_strength_home_attack,
        strength_home_defence::int as team_strength_home_defence,
        strength_away_attack::int as team_strength_away_attack,
        strength_away_defence::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:21:44.385887 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_home_attack::int as team_strength_home_attack,
        strength_home_defence::int as team_strength_home_defence,
        strength_away_attack::int as team_strength_away_attack,
        strength_away_defence::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:21:44.386265 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:21:44.386590 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: ROLLBACK
[0m09:21:44.393486 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.stg_teams'
[0m09:21:44.393834 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:21:44.395577 [debug] [Thread-1 (]: Runtime Error in model stg_teams (fpl_analytics/models/staging/stg_teams.sql)
  Binder Error: Referenced column "strength_home_attack" not found in FROM clause!
  Candidate bindings: "strength_attack_home", "strength_attack_away", "strength", "strength_defence_away", "strength_overall_away"
  
  LINE 18:         strength_home_attack::int as team_strength_home_attack,
                   ^
[0m09:21:44.396014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72babc233800>]}
[0m09:21:44.396517 [error] [Thread-1 (]: 5 of 10 ERROR creating sql table model staging.stg_teams ....................... [[31mERROR[0m in 0.03s]
[0m09:21:44.396962 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:21:44.397254 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:21:44.397597 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:21:44.397963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:21:44.398252 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:21:44.398664 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.stg_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_teams (fpl_analytics/models/staging/stg_teams.sql)
  Binder Error: Referenced column "strength_home_attack" not found in FROM clause!
  Candidate bindings: "strength_attack_home", "strength_attack_away", "strength", "strength_defence_away", "strength_overall_away"
  
  LINE 18:         strength_home_attack::int as team_strength_home_attack,
                   ^.
[0m09:21:44.400775 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:21:44.402013 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:21:44.404036 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:21:44.404648 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:21:44.404940 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:21:44.405145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:44.406357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.406662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:21:44.406915 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:21:44.408373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.409233 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:21:44.409551 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:21:44.410607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.411596 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:21:44.411855 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:21:44.412851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.414917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:21:44.415162 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:21:44.416064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.418705 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:21:44.419214 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:21:44.420113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:21:44.421117 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:21:44.421383 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:21:44.421587 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:21:44.436305 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m09:21:44.438458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:21:44.438752 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:21:44.445442 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:21:44.447990 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:21:44.448827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb1c3de570>]}
[0m09:21:44.449424 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.05s]
[0m09:21:44.450005 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:21:44.450392 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:21:44.450864 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:21:44.451439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m09:21:44.452039 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:21:44.454286 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:21:44.455261 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:21:44.457362 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:21:44.457825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:21:44.458073 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:21:44.458268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:44.459017 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.459258 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:21:44.459515 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select
        player_id,
        display_name,
        team_id,
        position_id,
        cost,
        availability_next_gameweek,
        case availability_code
            when 's' then 'suspended'
            when 'i' then 'injured'
            when 'd' then 'injury risk'
            when 'a' then 'availabile'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in - gameweek_transfers_out,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m09:21:44.463498 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select
        player_id,
        display_name,
        team_id,
        position_id,
        cost,
        availability_next_gameweek,
        case availability_code
            when 's' then 'suspended'
            when 'i' then 'injured'
            when 'd' then 'injury risk'
            when 'a' then 'availabile'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in - gameweek_transfers_out,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m09:21:44.463850 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:21:44.464156 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m09:21:44.465817 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m09:21:44.466085 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:21:44.467839 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name source does not exist!
  Did you mean "duckdb_types or pg_sequences"?
  
  LINE 65: select * from source
                         ^
[0m09:21:44.468187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72babc2e5cd0>]}
[0m09:21:44.468643 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model intermediate.int_players ................ [[31mERROR[0m in 0.02s]
[0m09:21:44.469053 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:21:44.469325 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:21:44.469659 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:21:44.470267 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name source does not exist!
  Did you mean "duckdb_types or pg_sequences"?
  
  LINE 65: select * from source
                         ^.
[0m09:21:44.471396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m09:21:44.472588 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:21:44.474688 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:21:44.475282 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:21:44.478563 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:21:44.479136 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:21:44.479429 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:21:44.479683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:44.480405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.480659 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:21:44.480873 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:21:44.482260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.483107 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:21:44.483540 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:21:44.484778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.485841 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:21:44.486125 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:21:44.487664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.490489 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:21:44.490897 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:21:44.492200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.495145 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:21:44.495861 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:21:44.497150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:21:44.498346 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:21:44.498718 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:21:44.498995 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:21:44.506818 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:21:44.509481 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:21:44.509891 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:21:44.517027 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:21:44.518464 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:21:44.519136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d98397d-22c7-4cf7-a5fb-a2fe9cb72807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72babc2d1340>]}
[0m09:21:44.519673 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.05s]
[0m09:21:44.520093 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:21:44.520440 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:21:44.520720 [info ] [Thread-1 (]: 9 of 10 SKIP relation intermediate.int_teams ................................... [[33mSKIP[0m]
[0m09:21:44.521049 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:21:44.521327 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:21:44.521576 [info ] [Thread-1 (]: 10 of 10 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m09:21:44.521870 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:21:44.522267 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_teams' to be skipped because of status 'skipped'. 
[0m09:21:44.522687 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m09:21:44.524364 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:44.524727 [debug] [MainThread]: On master: BEGIN
[0m09:21:44.525016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:21:44.526046 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:21:44.526309 [debug] [MainThread]: On master: COMMIT
[0m09:21:44.526514 [debug] [MainThread]: Using duckdb connection "master"
[0m09:21:44.526693 [debug] [MainThread]: On master: COMMIT
[0m09:21:44.527192 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:21:44.527529 [debug] [MainThread]: On master: Close
[0m09:21:44.527945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:44.528150 [debug] [MainThread]: Connection 'model.fpl_analytics.int_positions' was properly closed.
[0m09:21:44.528468 [info ] [MainThread]: 
[0m09:21:44.528782 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m09:21:44.530024 [debug] [MainThread]: Command end result
[0m09:21:44.543240 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:21:44.544704 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:21:44.549065 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:21:44.549371 [info ] [MainThread]: 
[0m09:21:44.549633 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:21:44.549907 [info ] [MainThread]: 
[0m09:21:44.550228 [error] [MainThread]: [31mFailure in model stg_teams (fpl_analytics/models/staging/stg_teams.sql)[0m
[0m09:21:44.550506 [error] [MainThread]:   Runtime Error in model stg_teams (fpl_analytics/models/staging/stg_teams.sql)
  Binder Error: Referenced column "strength_home_attack" not found in FROM clause!
  Candidate bindings: "strength_attack_home", "strength_attack_away", "strength", "strength_defence_away", "strength_overall_away"
  
  LINE 18:         strength_home_attack::int as team_strength_home_attack,
                   ^
[0m09:21:44.550714 [info ] [MainThread]: 
[0m09:21:44.550949 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/staging/stg_teams.sql
[0m09:21:44.551152 [info ] [MainThread]: 
[0m09:21:44.551393 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m09:21:44.551686 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name source does not exist!
  Did you mean "duckdb_types or pg_sequences"?
  
  LINE 65: select * from source
                         ^
[0m09:21:44.551883 [info ] [MainThread]: 
[0m09:21:44.552121 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m09:21:44.552334 [info ] [MainThread]: 
[0m09:21:44.552581 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=10
[0m09:21:44.554189 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4021941, "process_in_blocks": "109192", "process_kernel_time": 0.420767, "process_mem_max_rss": "165368", "process_out_blocks": "3528", "process_user_time": 2.424622}
[0m09:21:44.554566 [debug] [MainThread]: Command `dbt build` failed at 09:21:44.554488 after 1.40 seconds
[0m09:21:44.554850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb2a2b1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb29caecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb1c4290d0>]}
[0m09:21:44.555115 [debug] [MainThread]: Flushing usage events
[0m09:21:45.200293 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:23:35.127395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db53a4b6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db53cb757c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db53aaecb00>]}


============================== 09:23:35.133081 | 5e11c641-42fe-4141-bce7-77e5799b7d32 ==============================
[0m09:23:35.133081 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:23:35.133535 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'introspect': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'use_experimental_parser': 'False', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt build'}
[0m09:23:35.355993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db539dda600>]}
[0m09:23:35.418982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db53ac0c560>]}
[0m09:23:35.421941 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:23:35.481694 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:23:35.584725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:35.585396 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_teams.sql
[0m09:23:35.864953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52fd31670>]}
[0m09:23:35.907592 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:23:35.909930 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:23:35.993757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52fde7bc0>]}
[0m09:23:35.994190 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:23:35.996015 [info ] [MainThread]: 
[0m09:23:35.996362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:23:35.996589 [info ] [MainThread]: 
[0m09:23:35.996999 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:23:36.001055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:23:36.032010 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:23:36.032395 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:23:36.032616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:36.062522 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m09:23:36.064081 [debug] [ThreadPool]: On list_analytics: Close
[0m09:23:36.067226 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:23:36.067536 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:23:36.067791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.069056 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:36.069893 [debug] [ThreadPool]: On list_analytics: Close
[0m09:23:36.071342 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:23:36.071604 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:23:36.071875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.072738 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:36.073492 [debug] [ThreadPool]: On list_analytics: Close
[0m09:23:36.074197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m09:23:36.074555 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:23:36.079175 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:23:36.079442 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:23:36.079625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.080713 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:36.081621 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:23:36.081848 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:23:36.082349 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:23:36.082535 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:23:36.082686 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:23:36.083107 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:23:36.083649 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:23:36.083840 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:23:36.084029 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:23:36.084397 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:23:36.084589 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:23:36.085016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m09:23:36.085341 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:23:36.086671 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:23:36.086978 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:23:36.087257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.088143 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:36.088914 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:23:36.089112 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:23:36.089545 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:23:36.089758 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:23:36.089944 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:23:36.090337 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:23:36.090913 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:23:36.091205 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:23:36.091395 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:23:36.091903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:23:36.092125 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:23:36.092618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m09:23:36.093009 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:23:36.094304 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:23:36.094620 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:23:36.094864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.096051 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:36.097053 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:23:36.097317 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:23:36.097891 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:23:36.098103 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:23:36.098267 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:23:36.098753 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:23:36.099459 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:23:36.099689 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:23:36.099872 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:23:36.100281 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:23:36.100517 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:23:36.102245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m09:23:36.106002 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:23:36.106329 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:23:36.106592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.107400 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:36.107642 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:23:36.107857 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:23:36.116980 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m09:23:36.118694 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:23:36.121076 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:23:36.121478 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:23:36.122072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m09:23:36.123304 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:23:36.123561 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:23:36.123780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.124896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:36.125115 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:23:36.125294 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:23:36.128036 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:23:36.128986 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:23:36.129540 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:23:36.129770 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:23:36.130256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m09:23:36.131440 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:23:36.131705 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:23:36.131922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:36.133346 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:36.133712 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:23:36.134010 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:23:36.137339 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:23:36.138320 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:23:36.138868 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:23:36.139094 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:23:36.140506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52fddb920>]}
[0m09:23:36.140846 [debug] [MainThread]: Using duckdb connection "master"
[0m09:23:36.141041 [debug] [MainThread]: On master: BEGIN
[0m09:23:36.141195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:23:36.141725 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:23:36.141926 [debug] [MainThread]: On master: COMMIT
[0m09:23:36.142136 [debug] [MainThread]: Using duckdb connection "master"
[0m09:23:36.142294 [debug] [MainThread]: On master: COMMIT
[0m09:23:36.142670 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:23:36.142870 [debug] [MainThread]: On master: Close
[0m09:23:36.147441 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:23:36.147889 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:23:36.148272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_gameweeks)
[0m09:23:36.148506 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:23:36.153746 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.154328 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:23:36.177679 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.178321 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.178617 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:23:36.178824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.179620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.179882 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.180073 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:23:36.183459 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:23:36.187322 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.187591 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:23:36.188697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.190322 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.190782 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:23:36.192394 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.196727 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.197033 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:23:36.198799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.200730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.201097 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:23:36.202323 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.212592 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:23:36.212959 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.213196 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:23:36.220594 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:23:36.224827 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:23:36.225185 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:23:36.230656 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:23:36.233082 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:23:36.235064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db53c6ded20>]}
[0m09:23:36.235654 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.09s]
[0m09:23:36.236146 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:23:36.236442 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:23:36.236805 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:23:36.237246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:23:36.238089 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:23:36.240395 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:23:36.240905 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:23:36.243055 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:23:36.243678 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:23:36.243944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:23:36.244156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.245398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.245899 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:23:36.246302 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        starts::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:23:36.254425 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:23:36.255445 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:23:36.255729 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:23:36.256540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.257390 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:23:36.257637 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:23:36.258603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.260835 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:23:36.261132 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:23:36.261873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.263657 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:23:36.263920 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:23:36.264623 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.265478 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:23:36.265719 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:23:36.265925 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:23:36.273505 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:23:36.275332 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:23:36.275668 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:23:36.281527 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:23:36.282809 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:23:36.283615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52c1aea80>]}
[0m09:23:36.284157 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m09:23:36.284591 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:23:36.284890 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:23:36.285264 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:23:36.285655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:23:36.285934 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:23:36.287974 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:23:36.288834 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:23:36.292113 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:23:36.292848 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:23:36.293175 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:23:36.293414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.294778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.295414 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:23:36.295672 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:23:36.297996 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:23:36.298858 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:23:36.299158 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:23:36.300010 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.300852 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:23:36.301080 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:23:36.302076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.304165 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:23:36.304409 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:23:36.305215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.308062 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:23:36.308429 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:23:36.309327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.310456 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:23:36.310772 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:23:36.310987 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:23:36.317894 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:23:36.319746 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:23:36.320026 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:23:36.326084 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:23:36.327521 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:23:36.328189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52c1a57c0>]}
[0m09:23:36.328674 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m09:23:36.329139 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:23:36.329470 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:23:36.329820 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:23:36.330553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:23:36.330826 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:23:36.332755 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:23:36.333188 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:23:36.335185 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:23:36.335652 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:23:36.335901 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:23:36.336165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.336894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.337135 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:23:36.337350 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:23:36.339205 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:23:36.340068 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:23:36.340397 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:23:36.341404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.342380 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:23:36.342635 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:23:36.343913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.346157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:23:36.346428 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:23:36.347031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.348829 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:23:36.349072 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:23:36.349625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.350556 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:23:36.350801 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:23:36.351042 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:23:36.357228 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:23:36.359446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:23:36.359814 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:23:36.365730 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:23:36.366805 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:23:36.367676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52c1ad6d0>]}
[0m09:23:36.368141 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m09:23:36.368575 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:23:36.368890 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:23:36.369388 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:23:36.369787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:23:36.370078 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:23:36.372115 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:23:36.372606 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:23:36.377908 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:23:36.378485 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:23:36.378780 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:23:36.378992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.379753 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.379974 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:23:36.380162 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:23:36.383337 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:23:36.384159 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:23:36.384407 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:23:36.385215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.386062 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:23:36.386289 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:23:36.387325 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.389325 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:23:36.389621 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:23:36.390351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.392326 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:23:36.392601 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:23:36.393544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.394409 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:23:36.394649 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:23:36.394848 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:23:36.401755 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:23:36.403681 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:23:36.403991 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:23:36.409555 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:23:36.410832 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:23:36.411592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52c16d400>]}
[0m09:23:36.412077 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m09:23:36.412490 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:23:36.412838 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:23:36.413216 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:23:36.413801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:23:36.414396 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:23:36.416472 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:23:36.416914 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:23:36.418937 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:23:36.419524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:23:36.419783 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:23:36.420029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.420852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.421106 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:23:36.421340 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:23:36.422422 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.423351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:23:36.423670 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:23:36.424667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.425564 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:23:36.425816 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:23:36.426935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.429106 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:23:36.429368 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:23:36.430003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.431797 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:23:36.432064 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:23:36.432651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.433537 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:23:36.433868 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:23:36.434088 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:23:36.439217 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:23:36.441216 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:23:36.441533 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:23:36.446746 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:23:36.448169 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:23:36.448771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52c2a1040>]}
[0m09:23:36.449285 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m09:23:36.449721 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:23:36.450032 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:23:36.450378 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:23:36.450862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m09:23:36.451155 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:23:36.453048 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:23:36.453450 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:23:36.455631 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:23:36.456270 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:23:36.456577 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:23:36.456810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.457930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.458337 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:23:36.458611 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select
        player_id,
        display_name,
        team_id,
        position_id,
        cost,
        availability_next_gameweek,
        case availability_code
            when 's' then 'suspended'
            when 'i' then 'injured'
            when 'd' then 'injury risk'
            when 'a' then 'availabile'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in - gameweek_transfers_out,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m09:23:36.468134 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select
        player_id,
        display_name,
        team_id,
        position_id,
        cost,
        availability_next_gameweek,
        case availability_code
            when 's' then 'suspended'
            when 'i' then 'injured'
            when 'd' then 'injury risk'
            when 'a' then 'availabile'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in - gameweek_transfers_out,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from "analytics"."staging"."stg_players"
)

select * from source
    );
  
  
[0m09:23:36.468646 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:23:36.469040 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m09:23:36.476612 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m09:23:36.476989 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:23:36.478939 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name source does not exist!
  Did you mean "duckdb_types or pg_sequences"?
  
  LINE 65: select * from source
                         ^
[0m09:23:36.479436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52c155970>]}
[0m09:23:36.480005 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model intermediate.int_players ................ [[31mERROR[0m in 0.03s]
[0m09:23:36.480456 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:23:36.480773 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:23:36.481125 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:23:36.481519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m09:23:36.481816 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:23:36.482251 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name source does not exist!
  Did you mean "duckdb_types or pg_sequences"?
  
  LINE 65: select * from source
                         ^.
[0m09:23:36.485801 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:23:36.487262 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:23:36.489517 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:23:36.490146 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:23:36.490425 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:23:36.490650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.491743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.492194 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:23:36.492553 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:23:36.494423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.495575 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:23:36.495856 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:23:36.496674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.497556 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:23:36.497787 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:23:36.498833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.500854 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:23:36.501095 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:23:36.501756 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.503449 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:23:36.503692 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:23:36.504287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.505197 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:23:36.505445 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:23:36.505686 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:23:36.511592 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:23:36.513556 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:23:36.513885 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:23:36.519938 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:23:36.521884 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:23:36.522506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52c234b60>]}
[0m09:23:36.523019 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m09:23:36.523582 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:23:36.523891 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:23:36.524244 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:23:36.524803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:23:36.525077 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:23:36.527156 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:23:36.527629 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:23:36.529618 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:23:36.530087 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:23:36.530349 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:23:36.530569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:36.531613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.532110 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:23:36.532461 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:23:36.534207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.534926 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:23:36.535184 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:23:36.535957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.536854 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:23:36.537119 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:23:36.538459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:36.540967 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:23:36.541225 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:23:36.541876 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.543808 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:23:36.544082 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:23:36.544704 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:23:36.545579 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:23:36.545808 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:23:36.546017 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:23:36.552967 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:23:36.554668 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:23:36.554945 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:23:36.561739 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:23:36.563516 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:23:36.564124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e11c641-42fe-4141-bce7-77e5799b7d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db52c188920>]}
[0m09:23:36.564581 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m09:23:36.565005 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:23:36.565309 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:23:36.565618 [info ] [Thread-1 (]: 10 of 10 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m09:23:36.565917 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:23:36.566312 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m09:23:36.568041 [debug] [MainThread]: Using duckdb connection "master"
[0m09:23:36.568316 [debug] [MainThread]: On master: BEGIN
[0m09:23:36.568505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:23:36.569131 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:23:36.569398 [debug] [MainThread]: On master: COMMIT
[0m09:23:36.569589 [debug] [MainThread]: Using duckdb connection "master"
[0m09:23:36.569762 [debug] [MainThread]: On master: COMMIT
[0m09:23:36.570341 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:23:36.570593 [debug] [MainThread]: On master: Close
[0m09:23:36.570939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:36.571231 [debug] [MainThread]: Connection 'model.fpl_analytics.int_teams' was properly closed.
[0m09:23:36.571535 [info ] [MainThread]: 
[0m09:23:36.571804 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m09:23:36.573027 [debug] [MainThread]: Command end result
[0m09:23:36.587372 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:23:36.589235 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:23:36.593862 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:23:36.594132 [info ] [MainThread]: 
[0m09:23:36.594477 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:23:36.594757 [info ] [MainThread]: 
[0m09:23:36.595151 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m09:23:36.595493 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name source does not exist!
  Did you mean "duckdb_types or pg_sequences"?
  
  LINE 65: select * from source
                         ^
[0m09:23:36.595757 [info ] [MainThread]: 
[0m09:23:36.595996 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m09:23:36.596209 [info ] [MainThread]: 
[0m09:23:36.596460 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=10
[0m09:23:36.598239 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5265372, "process_in_blocks": "112456", "process_kernel_time": 0.39789, "process_mem_max_rss": "166440", "process_out_blocks": "3584", "process_user_time": 2.563251}
[0m09:23:36.598622 [debug] [MainThread]: Command `dbt build` failed at 09:23:36.598549 after 1.53 seconds
[0m09:23:36.598882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db53af0ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db53b2fc380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db53aaecb00>]}
[0m09:23:36.599149 [debug] [MainThread]: Flushing usage events
[0m09:23:37.238608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:01.188071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71284f7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71277bafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b712a2647d0>]}


============================== 09:24:01.190885 | 7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe ==============================
[0m09:24:01.190885 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:24:01.191479 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build', 'empty': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False'}
[0m09:24:01.381542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71271c3410>]}
[0m09:24:01.438653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71272c10d0>]}
[0m09:24:01.439960 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:24:01.489733 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:24:01.554851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:24:01.555674 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:24:01.825791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b711cfeda30>]}
[0m09:24:01.868376 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:24:01.870181 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:24:01.946653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b711d0e9d90>]}
[0m09:24:01.947155 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:24:01.948929 [info ] [MainThread]: 
[0m09:24:01.949296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:24:01.949544 [info ] [MainThread]: 
[0m09:24:01.949985 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:24:01.954543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:24:01.977677 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:24:01.978013 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:24:01.978208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:01.997071 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m09:24:01.998179 [debug] [ThreadPool]: On list_analytics: Close
[0m09:24:02.001721 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:24:02.002164 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:24:02.002429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:02.003823 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:02.004646 [debug] [ThreadPool]: On list_analytics: Close
[0m09:24:02.006036 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:24:02.006288 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:24:02.006497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:02.007455 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:02.008245 [debug] [ThreadPool]: On list_analytics: Close
[0m09:24:02.008865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m09:24:02.009186 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:24:02.013712 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:24:02.014028 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:24:02.014326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:02.015926 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:24:02.017034 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:24:02.017264 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:24:02.017757 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:24:02.017962 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:24:02.018114 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:24:02.018592 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:24:02.019157 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:24:02.019371 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:24:02.019526 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:24:02.019919 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:24:02.020144 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:24:02.020641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m09:24:02.020954 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:24:02.022109 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:24:02.022405 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:24:02.022627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:02.023565 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:02.024397 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:24:02.024607 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:24:02.024998 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:24:02.025198 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:24:02.025358 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:24:02.025954 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:24:02.026831 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:24:02.027259 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:24:02.027479 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:24:02.027909 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:24:02.028097 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:24:02.028593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m09:24:02.028936 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:24:02.030072 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:24:02.030390 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:24:02.030617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:02.032122 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:02.033052 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:24:02.033268 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:24:02.033719 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:24:02.033921 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:24:02.034065 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:24:02.034462 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:24:02.035032 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:24:02.035295 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:24:02.035446 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:24:02.035831 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:24:02.036043 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:24:02.037712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_intermediate)
[0m09:24:02.041232 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:24:02.041495 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:24:02.041697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:02.042473 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:02.042672 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:24:02.042876 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:24:02.051522 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:24:02.052646 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:24:02.053437 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:24:02.053652 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:24:02.054121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m09:24:02.055353 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:24:02.055618 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:24:02.055840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:02.057120 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:02.057349 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:24:02.057541 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:24:02.060352 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:24:02.061396 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:24:02.062507 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:24:02.062752 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:24:02.063452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m09:24:02.064776 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:24:02.065061 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:24:02.065273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:02.066462 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:02.066665 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:24:02.066852 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:24:02.069486 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:24:02.070462 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:24:02.071040 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:24:02.071264 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:24:02.072252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b711d0c6420>]}
[0m09:24:02.072618 [debug] [MainThread]: Using duckdb connection "master"
[0m09:24:02.072797 [debug] [MainThread]: On master: BEGIN
[0m09:24:02.072964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:02.073492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:24:02.073686 [debug] [MainThread]: On master: COMMIT
[0m09:24:02.073860 [debug] [MainThread]: Using duckdb connection "master"
[0m09:24:02.074022 [debug] [MainThread]: On master: COMMIT
[0m09:24:02.074401 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:24:02.074607 [debug] [MainThread]: On master: Close
[0m09:24:02.077291 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:24:02.077769 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:24:02.078160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m09:24:02.078502 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:24:02.083761 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.084312 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:24:02.106483 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.107162 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.107511 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:24:02.107711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.108440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.108713 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.108936 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:24:02.111953 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:24:02.115566 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.115905 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:24:02.116680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.117469 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.117701 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:24:02.118920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.123192 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.123480 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:24:02.124260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.126009 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.126366 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:24:02.127320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.136691 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:24:02.136986 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.137207 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:24:02.144667 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:24:02.148760 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:24:02.149054 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:24:02.155209 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:24:02.157296 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:24:02.159219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b711d001a30>]}
[0m09:24:02.159780 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m09:24:02.160273 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:24:02.160596 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:24:02.160930 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:24:02.161304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:24:02.161717 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:24:02.163884 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:24:02.164795 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:24:02.166694 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:24:02.167160 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:24:02.167397 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:24:02.167600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.168379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.168601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:24:02.168829 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        starts::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:24:02.176218 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:24:02.177137 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:24:02.177413 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:24:02.178264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.179172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:24:02.179436 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:24:02.180512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.182372 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:24:02.182611 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:24:02.183196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:24:02.184745 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:24:02.184976 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:24:02.185524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:24:02.186447 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:24:02.186754 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:24:02.186969 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:24:02.193678 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:24:02.195927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:24:02.196246 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:24:02.201259 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.202572 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:24:02.203338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70f9465820>]}
[0m09:24:02.203849 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m09:24:02.204292 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:24:02.204639 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:24:02.205020 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:24:02.205497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:24:02.206393 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:24:02.208726 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:24:02.209267 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:24:02.212369 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:24:02.212908 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:24:02.213179 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:24:02.213387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.214344 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.214633 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:24:02.214877 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:24:02.216641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.217473 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:24:02.217759 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:24:02.218597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.219721 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:24:02.220065 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:24:02.221407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.223915 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:24:02.224242 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:24:02.225016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.226748 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:24:02.227016 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:24:02.227631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:24:02.228482 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:24:02.228766 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:24:02.229004 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:24:02.233715 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:24:02.235635 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:24:02.236060 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:24:02.241403 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.242679 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:24:02.243378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70f94518b0>]}
[0m09:24:02.243845 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m09:24:02.244253 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:24:02.244516 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:24:02.244844 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:24:02.245195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:24:02.245460 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:24:02.247418 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:24:02.248271 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:24:02.250222 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:24:02.250832 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:24:02.251244 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:24:02.251469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.252388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.252707 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:24:02.252964 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:24:02.255810 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:24:02.256754 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:24:02.257050 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:24:02.258034 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.259013 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:24:02.259346 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:24:02.260662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.263544 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:24:02.263840 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:24:02.264845 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.267374 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:24:02.267723 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:24:02.269159 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.270676 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:24:02.271149 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:24:02.271410 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:24:02.276993 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.278856 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:24:02.279296 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:24:02.285303 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:24:02.286572 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:24:02.287454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70f95c4a10>]}
[0m09:24:02.287939 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m09:24:02.288355 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:24:02.288630 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:24:02.288965 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:24:02.289337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:24:02.289633 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:24:02.291964 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:24:02.292452 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:24:02.295688 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:24:02.296187 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:24:02.296458 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:24:02.296682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.297494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.297776 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:24:02.298007 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:24:02.300204 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:24:02.301365 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:24:02.301725 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:24:02.302930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.304092 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:24:02.304426 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:24:02.305396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.307527 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:24:02.307787 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:24:02.308617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.310474 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:24:02.310741 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:24:02.311575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.312972 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:24:02.313377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:24:02.313619 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:24:02.319570 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:24:02.321420 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:24:02.321715 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:24:02.327355 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.328432 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:24:02.329084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70f945fdd0>]}
[0m09:24:02.329601 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m09:24:02.330115 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:24:02.330415 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:24:02.330766 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:24:02.331772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:24:02.332206 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:24:02.334756 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:24:02.335429 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:24:02.337469 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:24:02.337939 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:24:02.338183 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:24:02.338380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.339225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.339535 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:24:02.339761 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:24:02.340934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.341755 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:24:02.342006 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:24:02.342776 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.343765 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:24:02.344044 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:24:02.345235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.347755 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:24:02.348156 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:24:02.349448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.352075 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:24:02.352434 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:24:02.353125 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:24:02.354044 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:24:02.354317 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:24:02.354525 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:24:02.359866 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.361677 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:24:02.361961 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:24:02.367737 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.369775 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:24:02.371012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70f95b1730>]}
[0m09:24:02.372084 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m09:24:02.372742 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:24:02.373129 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:24:02.373524 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:24:02.374074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m09:24:02.374361 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:24:02.376519 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:24:02.377095 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:24:02.379628 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:24:02.380311 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:24:02.380625 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:24:02.380880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.382024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.382446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:24:02.382865 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select
        player_id,
        display_name,
        team_id,
        position_id,
        cost,
        availability_next_gameweek,
        case availability_code
            when 's' then 'suspended'
            when 'i' then 'injured'
            when 'd' then 'injury risk'
            when 'a' then 'availabile'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in - gameweek_transfers_out,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from "analytics"."staging"."stg_players"
)

select * from players
    );
  
  
[0m09:24:02.390031 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:24:02.391063 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:24:02.391505 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:24:02.392485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.393514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:24:02.393802 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:24:02.394766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.398215 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:24:02.398615 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m09:24:02.399450 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.401257 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:24:02.401512 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m09:24:02.402334 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.403747 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:24:02.404055 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:24:02.404299 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:24:02.411074 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:24:02.413355 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:24:02.413779 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m09:24:02.419749 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:24:02.421420 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:24:02.422331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70f9457a70>]}
[0m09:24:02.422802 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m09:24:02.423300 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:24:02.423611 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:24:02.423954 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:24:02.424868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m09:24:02.425199 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:24:02.427503 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:24:02.428370 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:24:02.430720 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:24:02.431339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:24:02.431621 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:24:02.431839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.432673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.432962 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:24:02.433180 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:24:02.434407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.435363 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:24:02.435627 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:24:02.436391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.437398 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:24:02.437707 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:24:02.439194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.441804 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:24:02.442300 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:24:02.443482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.445735 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:24:02.446094 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:24:02.447052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.448238 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:24:02.448542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:24:02.448775 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:24:02.454358 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.456184 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:24:02.456478 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:24:02.462277 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.463963 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:24:02.464528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70f945a6f0>]}
[0m09:24:02.465015 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m09:24:02.465439 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:24:02.465766 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:24:02.466110 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:24:02.466512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:24:02.466954 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:24:02.468964 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:24:02.469465 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:24:02.471632 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:24:02.472253 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:24:02.472593 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:24:02.472819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.474005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.474418 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:24:02.474695 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:24:02.476602 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:24:02.477661 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:24:02.477967 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:24:02.478902 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.479855 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:24:02.480130 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:24:02.481285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.484578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:24:02.485064 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:24:02.486011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.489219 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:24:02.489688 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:24:02.490816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.492140 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:24:02.492536 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:24:02.492772 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:24:02.499159 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:24:02.500981 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:24:02.501261 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:24:02.507247 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.509007 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:24:02.509652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70f94ea6c0>]}
[0m09:24:02.510122 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m09:24:02.510557 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:24:02.510901 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:24:02.511280 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m09:24:02.511719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m09:24:02.512087 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m09:24:02.514058 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m09:24:02.514508 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m09:24:02.516481 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m09:24:02.516941 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:24:02.517200 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m09:24:02.517408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:02.518121 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.518347 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:24:02.518592 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m09:24:02.522488 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:24:02.523717 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:24:02.524112 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:24:02.525343 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.526435 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:24:02.526717 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:24:02.527820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.530063 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:24:02.530327 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m09:24:02.531151 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:02.533051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:24:02.533310 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m09:24:02.533896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:24:02.534859 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:24:02.535156 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:24:02.535411 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:24:02.543647 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:24:02.545611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:24:02.545910 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m09:24:02.551567 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:24:02.552953 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m09:24:02.554007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbc665f-40f2-40c6-94cf-bfdd2ad6efbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b70f94668a0>]}
[0m09:24:02.554647 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m09:24:02.555231 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:24:02.557144 [debug] [MainThread]: Using duckdb connection "master"
[0m09:24:02.557462 [debug] [MainThread]: On master: BEGIN
[0m09:24:02.557693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:02.558769 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:24:02.559060 [debug] [MainThread]: On master: COMMIT
[0m09:24:02.559336 [debug] [MainThread]: Using duckdb connection "master"
[0m09:24:02.559519 [debug] [MainThread]: On master: COMMIT
[0m09:24:02.560166 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:24:02.560673 [debug] [MainThread]: On master: Close
[0m09:24:02.561231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:02.561589 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m09:24:02.562044 [info ] [MainThread]: 
[0m09:24:02.562364 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m09:24:02.563662 [debug] [MainThread]: Command end result
[0m09:24:02.578643 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:24:02.580411 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:24:02.585193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:24:02.585612 [info ] [MainThread]: 
[0m09:24:02.585994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:02.586243 [info ] [MainThread]: 
[0m09:24:02.586522 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:24:02.587810 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.4510843, "process_in_blocks": "768", "process_kernel_time": 0.30727, "process_mem_max_rss": "165340", "process_out_blocks": "4072", "process_user_time": 2.512884}
[0m09:24:02.588332 [debug] [MainThread]: Command `dbt build` succeeded at 09:24:02.588237 after 1.45 seconds
[0m09:24:02.588635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b712794e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b712805af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7128059be0>]}
[0m09:24:02.588922 [debug] [MainThread]: Flushing usage events
[0m09:24:03.102078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:18.227673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844b9cd4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844bc2f17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844b9cd52b0>]}


============================== 09:28:18.231426 | ddf7725a-496d-4a67-8c3c-e9ef84d5f52e ==============================
[0m09:28:18.231426 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:28:18.231859 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'target_path': 'None', 'log_path': '/home/robgriffin247/fpl/logs', 'version_check': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'fail_fast': 'False', 'empty': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m09:28:18.443495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844bbe13e00>]}
[0m09:28:18.496367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844ba0d71a0>]}
[0m09:28:18.499014 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:28:18.553446 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:28:18.640453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:28:18.640917 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:28:18.884876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844af7a88c0>]}
[0m09:28:18.920853 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:28:18.922702 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:28:18.989067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844af4e2720>]}
[0m09:28:18.989442 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:28:18.991046 [info ] [MainThread]: 
[0m09:28:18.991377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:28:18.991600 [info ] [MainThread]: 
[0m09:28:18.991982 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:28:18.995709 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:28:19.022271 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:28:19.022599 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:28:19.022794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:19.050693 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m09:28:19.051796 [debug] [ThreadPool]: On list_analytics: Close
[0m09:28:19.054611 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:28:19.054902 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:28:19.055128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:19.056280 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:19.057065 [debug] [ThreadPool]: On list_analytics: Close
[0m09:28:19.058423 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:28:19.058676 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:28:19.059017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:19.059821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:19.060528 [debug] [ThreadPool]: On list_analytics: Close
[0m09:28:19.061101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m09:28:19.061401 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:28:19.065392 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:28:19.065638 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:28:19.065807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:19.066713 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:19.067523 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:28:19.067734 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:28:19.068170 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:19.068374 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:28:19.068518 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:28:19.068937 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:19.069514 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:28:19.069796 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:28:19.069996 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:28:19.070418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:19.070606 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:28:19.071085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m09:28:19.071388 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:28:19.072431 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:28:19.072742 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:28:19.073005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:19.073950 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:19.074752 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:28:19.074945 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:28:19.075353 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:19.075536 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:28:19.075704 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:28:19.076109 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:19.076606 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:28:19.076800 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:28:19.076952 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:28:19.077315 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:19.077506 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:28:19.077986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m09:28:19.078285 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:28:19.079514 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:28:19.079723 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:28:19.079884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:19.080616 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:19.081366 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:28:19.081603 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:28:19.082118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:19.082304 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:28:19.082452 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:28:19.082842 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:19.083338 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:28:19.083518 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:28:19.083664 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:28:19.084031 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:19.084215 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:28:19.085752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m09:28:19.089291 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:28:19.089915 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:28:19.090132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:19.090729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:19.090931 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:28:19.091093 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:28:19.099191 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:28:19.100623 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:28:19.102197 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:28:19.102449 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:28:19.102995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m09:28:19.104131 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:28:19.104368 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:28:19.105147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:19.105987 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:19.106302 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:28:19.106573 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:28:19.110314 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:28:19.111518 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:28:19.112342 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:28:19.112629 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:28:19.113468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m09:28:19.115110 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:28:19.115322 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:28:19.115476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:19.116198 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:19.116509 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:28:19.116775 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:28:19.119509 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:28:19.120315 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:28:19.120792 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:28:19.120960 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:28:19.121868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844ac1cf4d0>]}
[0m09:28:19.122354 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:19.122640 [debug] [MainThread]: On master: BEGIN
[0m09:28:19.122933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:19.123637 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:28:19.123845 [debug] [MainThread]: On master: COMMIT
[0m09:28:19.124024 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:19.124190 [debug] [MainThread]: On master: COMMIT
[0m09:28:19.124560 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:28:19.124753 [debug] [MainThread]: On master: Close
[0m09:28:19.127908 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:28:19.128277 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:28:19.128604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m09:28:19.128826 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:28:19.133397 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.133881 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:28:19.154581 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.155118 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.155364 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:28:19.155545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:19.156167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.156372 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.156558 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:28:19.160242 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:28:19.163657 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.163944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:28:19.164938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.166223 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.166655 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:28:19.168161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.172144 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.172474 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:28:19.173944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.175579 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.175807 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:28:19.176378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.184992 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:28:19.185345 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.185562 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:28:19.191540 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:28:19.195193 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:19.195521 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:28:19.200656 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:19.202320 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:28:19.204074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844ac1bc260>]}
[0m09:28:19.204466 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.07s]
[0m09:28:19.204838 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:28:19.205132 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:28:19.205430 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:28:19.205829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:28:19.206086 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:28:19.207875 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:28:19.208932 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:28:19.210643 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:28:19.211020 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:19.211219 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:28:19.211393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:19.212026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.212237 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:19.212442 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        starts::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:28:19.220474 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:28:19.221348 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:19.221636 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:28:19.222385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.223109 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:19.223310 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:28:19.224129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.225752 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:19.225963 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:28:19.226659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.228937 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:19.229371 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:28:19.230165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.230999 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:28:19.231218 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:19.231388 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:28:19.237031 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:19.238499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:19.238721 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:28:19.243070 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:19.244254 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:28:19.244827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844577b2a20>]}
[0m09:28:19.245225 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m09:28:19.245658 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:28:19.245917 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:28:19.246221 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:28:19.246663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:28:19.246883 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:28:19.248641 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:28:19.249041 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:28:19.251774 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:28:19.252174 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:19.252383 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:28:19.252560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:19.253200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.253422 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:19.253659 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:28:19.255632 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:28:19.256355 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:19.256600 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:28:19.257273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.258091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:19.258322 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:28:19.259652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.261930 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:19.262205 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:28:19.262843 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.264370 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:19.264600 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:28:19.265107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.265914 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:28:19.266144 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:19.266326 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:28:19.270805 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:19.272048 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:19.272297 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:28:19.276688 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:19.277860 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:28:19.278423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844577a6060>]}
[0m09:28:19.278836 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.03s]
[0m09:28:19.279217 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:28:19.279479 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:28:19.279759 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:28:19.280090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:28:19.280339 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:28:19.282018 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:28:19.282741 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:28:19.284388 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:28:19.284784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:19.284996 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:28:19.285176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:19.286080 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.286447 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:19.286820 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:28:19.289898 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:28:19.290812 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:19.291087 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:28:19.291874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.292666 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:19.292886 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:28:19.293829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.295515 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:19.295724 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:28:19.296474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.298363 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:19.298580 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:28:19.299055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.299788 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:28:19.299993 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:19.300160 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:28:19.304820 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:19.306628 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:19.306930 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:28:19.311448 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:19.312750 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:28:19.313833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784457779a90>]}
[0m09:28:19.314265 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.03s]
[0m09:28:19.314628 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:28:19.314902 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:28:19.315269 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:28:19.315584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:28:19.315787 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:28:19.317376 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:28:19.317775 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:28:19.320639 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:28:19.321211 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:19.321463 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:28:19.321741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:19.322421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.322629 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:19.322812 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:28:19.324740 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:28:19.325442 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:19.325716 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:28:19.326356 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.327143 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:19.327363 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:28:19.328180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.329996 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:19.330234 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:28:19.330752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.332241 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:19.332466 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:28:19.332949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.333792 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:28:19.334043 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:19.334258 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:28:19.339655 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:19.341068 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:19.341312 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:28:19.345995 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:19.347199 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:28:19.347932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78445775a390>]}
[0m09:28:19.348487 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.03s]
[0m09:28:19.349062 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:28:19.349365 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:28:19.349748 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:28:19.350342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:28:19.350621 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:28:19.352353 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:28:19.352734 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:28:19.354426 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:28:19.354811 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:19.355028 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:28:19.355202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:19.355851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.356054 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:19.356229 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:28:19.357287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.357935 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:19.358165 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:28:19.359161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.359894 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:19.360101 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:28:19.360959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.362716 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:19.362958 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:28:19.363445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.365033 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:19.365285 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:28:19.366182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.367254 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:28:19.367498 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:19.367671 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:28:19.372880 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:19.374403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:19.374647 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:28:19.379623 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:19.380660 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:28:19.381229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844577b0290>]}
[0m09:28:19.381728 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m09:28:19.382137 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:28:19.382403 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:28:19.382703 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:28:19.383051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m09:28:19.383379 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:28:19.385026 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:28:19.385412 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:28:19.387204 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:28:19.387657 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:19.387872 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:28:19.388048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:19.388679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.388878 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:19.389054 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:28:19.390367 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.391232 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:19.391473 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:28:19.392107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.392932 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:19.393155 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:28:19.393888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.397095 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:19.397391 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:28:19.398498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.400832 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:19.401295 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:28:19.401961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:19.402715 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:28:19.402951 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:19.403129 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:28:19.407821 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:19.409289 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:19.409547 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:28:19.413822 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:19.415076 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:28:19.415946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844577d9520>]}
[0m09:28:19.416390 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.03s]
[0m09:28:19.416768 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:28:19.417016 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:28:19.417322 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:28:19.417656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:28:19.417993 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:28:19.419620 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:28:19.419983 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:28:19.421641 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:28:19.422022 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:19.422238 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:28:19.422417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:19.422987 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.423212 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:19.423389 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:28:19.424491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.425338 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:19.425632 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:28:19.426389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.427340 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:19.427562 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:28:19.428341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.430213 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:19.430496 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:28:19.431535 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.433381 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:19.433684 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:28:19.434793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.436261 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:28:19.436696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:19.437021 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:28:19.444246 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:28:19.445946 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:19.446189 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:28:19.451004 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:19.452254 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:28:19.452943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844af4e3f50>]}
[0m09:28:19.453550 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m09:28:19.454006 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:28:19.455077 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:28:19.455503 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:28:19.455861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m09:28:19.456080 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:28:19.458148 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:28:19.458558 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:28:19.460183 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:28:19.460577 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:19.460796 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:28:19.461041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:19.461927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:19.462298 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:19.462663 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

int_players as (
    select
        players.player_id,
        players.display_name,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        players.cost,
        players.availability_next_gameweek,
        players.case availability_code
            when 's' then 'suspended'
            when 'i' then 'injured'
            when 'd' then 'injury risk'
            when 'a' then 'availabile'
            else null end as availability_reason,
        players.availability_details,
        players.total_points,
        players.gameweek_points,
        players.points_per_game,
        players.current_form,
        players.current_dreamteam,
        players.dreamteam_appearances,
        players.influence,
        players.creativity,
        players.threat,
        players.ict_index,
        players.selection_rate,
        players.gameweek_transfers_in,
        players.gameweek_transfers_out,
        players.gameweek_transfers_in - gameweek_transfers_out,
        players.starts,
        players.minutes_played,
        players.goals_scored,
        players.expected_goals_scored,
        players.goals_assisted,
        players.expected_goals_assisted,
        players.goals_conceded,
        players.expected_goals_conceded,
        players.clearances_blocks_interceptions,
        players.recoveries,
        players.tackles,
        players.own_goals,
        players.saves_made,
        players.clean_sheets,
        players.penalties_saved,
        players.yellow_cards,
        players.red_cards,
        players.bonus_points,
        players.bonus_points_system,
        players.team_penalty_takers_rank,
        players.penalties_missed,
    from "analytics"."staging"."stg_players" as players 
        left join teams using(team_id)
        left join positions using(position_id)
)



select * from int_players
    );
  
  
[0m09:28:19.470608 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

int_players as (
    select
        players.player_id,
        players.display_name,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        players.cost,
        players.availability_next_gameweek,
        players.case availability_code
            when 's' then 'suspended'
            when 'i' then 'injured'
            when 'd' then 'injury risk'
            when 'a' then 'availabile'
            else null end as availability_reason,
        players.availability_details,
        players.total_points,
        players.gameweek_points,
        players.points_per_game,
        players.current_form,
        players.current_dreamteam,
        players.dreamteam_appearances,
        players.influence,
        players.creativity,
        players.threat,
        players.ict_index,
        players.selection_rate,
        players.gameweek_transfers_in,
        players.gameweek_transfers_out,
        players.gameweek_transfers_in - gameweek_transfers_out,
        players.starts,
        players.minutes_played,
        players.goals_scored,
        players.expected_goals_scored,
        players.goals_assisted,
        players.expected_goals_assisted,
        players.goals_conceded,
        players.expected_goals_conceded,
        players.clearances_blocks_interceptions,
        players.recoveries,
        players.tackles,
        players.own_goals,
        players.saves_made,
        players.clean_sheets,
        players.penalties_saved,
        players.yellow_cards,
        players.red_cards,
        players.bonus_points,
        players.bonus_points_system,
        players.team_penalty_takers_rank,
        players.penalties_missed,
    from "analytics"."staging"."stg_players" as players 
        left join teams using(team_id)
        left join positions using(position_id)
)



select * from int_players
    );
  
  
[0m09:28:19.471045 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:28:19.471383 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m09:28:19.476974 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m09:28:19.477263 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:28:19.478725 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "when"
  
  LINE 30:             when 's' then 'suspended'
                       ^
[0m09:28:19.479056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf7725a-496d-4a67-8c3c-e9ef84d5f52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78445775a270>]}
[0m09:28:19.479455 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model intermediate.int_players ................ [[31mERROR[0m in 0.02s]
[0m09:28:19.479833 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:28:19.480188 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "when"
  
  LINE 30:             when 's' then 'suspended'
                       ^.
[0m09:28:19.480848 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:28:19.481484 [info ] [Thread-1 (]: 10 of 10 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m09:28:19.481813 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:28:19.482059 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m09:28:19.483048 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:19.483254 [debug] [MainThread]: On master: BEGIN
[0m09:28:19.483412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:28:19.483971 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:28:19.484190 [debug] [MainThread]: On master: COMMIT
[0m09:28:19.484385 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:19.484559 [debug] [MainThread]: On master: COMMIT
[0m09:28:19.485230 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:28:19.485499 [debug] [MainThread]: On master: Close
[0m09:28:19.485914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:19.486146 [debug] [MainThread]: Connection 'model.fpl_analytics.int_players' was properly closed.
[0m09:28:19.486398 [info ] [MainThread]: 
[0m09:28:19.486665 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m09:28:19.487612 [debug] [MainThread]: Command end result
[0m09:28:19.499123 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:28:19.500522 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:28:19.504452 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:28:19.504688 [info ] [MainThread]: 
[0m09:28:19.504946 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:28:19.505204 [info ] [MainThread]: 
[0m09:28:19.505496 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m09:28:19.505792 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "when"
  
  LINE 30:             when 's' then 'suspended'
                       ^
[0m09:28:19.506000 [info ] [MainThread]: 
[0m09:28:19.506223 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m09:28:19.506423 [info ] [MainThread]: 
[0m09:28:19.506640 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=10
[0m09:28:19.507920 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.3273103, "process_in_blocks": "109064", "process_kernel_time": 0.399407, "process_mem_max_rss": "166316", "process_out_blocks": "3592", "process_user_time": 2.508637}
[0m09:28:19.508206 [debug] [MainThread]: Command `dbt build` failed at 09:28:19.508145 after 1.33 seconds
[0m09:28:19.508425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844b9591b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844af3fc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844b9f10110>]}
[0m09:28:19.508628 [debug] [MainThread]: Flushing usage events
[0m09:28:20.128269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:33.425091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af57482cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af5779fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af575a1eb0>]}


============================== 09:28:33.428111 | d7478266-8095-4b28-9350-573be6674054 ==============================
[0m09:28:33.428111 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:28:33.428578 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt build', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'profiles_dir': '/home/robgriffin247/fpl', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'debug': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'fail_fast': 'False'}
[0m09:28:33.605890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af4cfa5bb0>]}
[0m09:28:33.662347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af5933e0c0>]}
[0m09:28:33.663491 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:28:33.709667 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:28:33.770841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:28:33.771313 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:28:34.029231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af46fdd6d0>]}
[0m09:28:34.067835 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:28:34.069222 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:28:34.126197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af4c9b7800>]}
[0m09:28:34.126604 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:28:34.128147 [info ] [MainThread]: 
[0m09:28:34.128440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:28:34.128679 [info ] [MainThread]: 
[0m09:28:34.129021 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:28:34.132914 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:28:34.155234 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:28:34.155582 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:28:34.155796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:34.173389 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m09:28:34.174577 [debug] [ThreadPool]: On list_analytics: Close
[0m09:28:34.177608 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:28:34.177918 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:28:34.178325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:34.179509 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:34.180300 [debug] [ThreadPool]: On list_analytics: Close
[0m09:28:34.181660 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:28:34.182008 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:28:34.182217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:34.182963 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:34.183754 [debug] [ThreadPool]: On list_analytics: Close
[0m09:28:34.184391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m09:28:34.184739 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:28:34.189022 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:28:34.189257 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:28:34.189432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:34.190309 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:34.191061 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:28:34.191253 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:28:34.191635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:34.191822 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:28:34.191988 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:28:34.192364 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:34.192945 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:28:34.193168 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:28:34.193343 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:28:34.194040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:34.194410 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:28:34.195315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m09:28:34.195843 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:28:34.196949 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:28:34.197226 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:28:34.197426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:34.198257 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:34.199098 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:28:34.199329 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:28:34.199848 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:34.200032 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:28:34.200236 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:28:34.200899 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:34.201868 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:28:34.202107 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:28:34.202269 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:28:34.202644 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:34.202851 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:28:34.203279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m09:28:34.203625 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:28:34.204651 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:28:34.204887 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:28:34.205097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:34.206054 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:34.206941 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:28:34.207136 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:28:34.207744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:34.208088 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:28:34.208429 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:28:34.208928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:34.209462 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:28:34.209758 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:28:34.209919 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:28:34.210353 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:34.210551 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:28:34.212259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m09:28:34.216051 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:28:34.216467 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:28:34.217059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:34.217943 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:34.218250 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:28:34.218467 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:28:34.227129 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:28:34.228316 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:28:34.229200 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:28:34.229480 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:28:34.230108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m09:28:34.231256 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:28:34.231512 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:28:34.231724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:34.235352 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:28:34.235587 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:28:34.235757 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:28:34.238310 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:28:34.239203 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:28:34.239777 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:28:34.239996 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:28:34.240536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m09:28:34.241741 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:28:34.241995 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:28:34.242204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:34.243688 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:34.243916 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:28:34.244100 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:28:34.248796 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:28:34.250462 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:28:34.251071 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:28:34.251254 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:28:34.252530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af46fe1730>]}
[0m09:28:34.252858 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:34.253036 [debug] [MainThread]: On master: BEGIN
[0m09:28:34.253188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:34.253789 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:28:34.253997 [debug] [MainThread]: On master: COMMIT
[0m09:28:34.254182 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:34.254330 [debug] [MainThread]: On master: COMMIT
[0m09:28:34.254701 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:28:34.254889 [debug] [MainThread]: On master: Close
[0m09:28:34.257153 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:28:34.257561 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:28:34.257953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m09:28:34.258172 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:28:34.262960 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.263447 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:28:34.284901 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.285528 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.285865 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:28:34.286056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.286844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.287102 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.287294 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:28:34.288980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.294448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.294706 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:28:34.295528 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.296313 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.296531 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:28:34.297427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.301744 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.302031 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:28:34.302795 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.304391 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.304621 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:28:34.305151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.314389 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:28:34.314712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.314954 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:28:34.321968 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:28:34.325831 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:28:34.326122 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:28:34.331148 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.332860 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:28:34.334377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af4c9b5df0>]}
[0m09:28:34.334829 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m09:28:34.335241 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:28:34.335558 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:28:34.335905 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:28:34.336301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:28:34.336573 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:28:34.338649 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:28:34.339540 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:28:34.341317 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:28:34.341736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:34.341966 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:28:34.342153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.342845 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.343080 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:34.343308 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,

        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,

        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,

        starts::int as starts,
        minutes::int as minutes_played,

        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,

        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,

        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:28:34.351261 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:28:34.352193 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:34.352459 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:28:34.353223 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.354157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:34.354391 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:28:34.355549 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.358364 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:34.358625 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:28:34.359432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.361977 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:34.362217 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:28:34.362730 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.363570 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:28:34.363831 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:34.364032 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:28:34.370899 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:28:34.372591 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:28:34.372862 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:28:34.377984 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.379324 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:28:34.380221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af44c3d010>]}
[0m09:28:34.380679 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m09:28:34.381105 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:28:34.381384 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:28:34.381759 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:28:34.382154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:28:34.382423 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:28:34.384330 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:28:34.384901 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:28:34.387946 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:28:34.388407 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:34.388660 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:28:34.388857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.389556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.389798 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:34.390081 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:28:34.391752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.392484 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:34.392717 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:28:34.393406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.394297 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:34.394540 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:28:34.395576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.397680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:34.397971 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:28:34.398789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.400472 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:34.400702 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:28:34.401233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.402065 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:28:34.402297 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:34.402519 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:28:34.408522 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:28:34.409958 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:28:34.410236 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:28:34.415384 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.417088 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:28:34.417732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af44c83dd0>]}
[0m09:28:34.418185 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m09:28:34.418611 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:28:34.418896 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:28:34.419219 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:28:34.419606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:28:34.419882 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:28:34.422068 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:28:34.422565 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:28:34.424321 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:28:34.424743 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:34.424974 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:28:34.425162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.426030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.426274 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:34.426504 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:28:34.428192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.429354 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:34.429913 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:28:34.432749 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:28:34.433760 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:34.434012 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:28:34.435205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.437228 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:34.437484 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:28:34.438068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.439749 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:34.439992 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:28:34.440499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.441362 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:28:34.441652 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:34.441910 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:28:34.447782 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.449584 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:28:34.449911 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:28:34.454502 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:34.455913 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:28:34.457054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af44c824e0>]}
[0m09:28:34.457704 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m09:28:34.458162 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:28:34.458460 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:28:34.458825 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:28:34.459251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:28:34.459601 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:28:34.461441 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:28:34.462309 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:28:34.465876 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:28:34.466402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:34.466661 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:28:34.466857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.467586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.467839 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:34.468047 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:28:34.469718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.470575 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:34.470831 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:28:34.471562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.472473 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:34.472738 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:28:34.473968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.476067 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:34.476325 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:28:34.476910 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.478754 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:34.479037 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:28:34.479724 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.480705 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:28:34.480965 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:34.481195 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:28:34.486136 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.487633 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:28:34.487895 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:28:34.492967 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.494444 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:28:34.495149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af44c948c0>]}
[0m09:28:34.495655 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m09:28:34.496071 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:28:34.496372 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:28:34.497113 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:28:34.497508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:28:34.497810 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:28:34.499705 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:28:34.500141 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:28:34.501985 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:28:34.502400 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:34.502661 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:28:34.502868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.503569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.503847 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:34.504045 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:28:34.505422 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.506226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:34.506451 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:28:34.507175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.507955 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:34.508177 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:28:34.509166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.511451 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:34.511762 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:28:34.512473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.514288 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:34.514532 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:28:34.515077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.515891 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:28:34.516121 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:34.516309 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:28:34.521964 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.523544 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:28:34.523807 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:28:34.528343 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:34.529450 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:28:34.530070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af44c4a5a0>]}
[0m09:28:34.530599 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m09:28:34.531015 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:28:34.531291 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:28:34.531637 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:28:34.532005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m09:28:34.532276 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:28:34.534203 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:28:34.534783 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:28:34.536668 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:28:34.537099 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:34.537341 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:28:34.537550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.538329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.538551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:34.538754 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:28:34.540211 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.541336 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:34.541755 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:28:34.542516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.543450 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:34.543733 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:28:34.544819 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.548150 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:34.548449 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:28:34.549076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.550863 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:34.551144 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:28:34.551766 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.552665 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:28:34.552912 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:34.553115 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:28:34.558141 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.559568 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:28:34.559890 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:28:34.564953 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.566383 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:28:34.567141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af44cb1460>]}
[0m09:28:34.567621 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m09:28:34.568036 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:28:34.568314 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:28:34.568922 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:28:34.569328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:28:34.569573 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:28:34.571446 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:28:34.571868 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:28:34.573682 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:28:34.574104 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:34.574342 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:28:34.574537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.575180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.575401 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:34.575591 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:28:34.577560 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:28:34.578555 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:34.578827 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:28:34.579697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.580706 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:34.580935 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:28:34.581911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.583939 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:34.584204 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:28:34.584951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.586654 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:34.586903 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:28:34.587550 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.588398 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:28:34.588640 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:34.588840 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:28:34.594559 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.596327 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:28:34.596581 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:28:34.602000 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.603495 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:28:34.604271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af4c9c2210>]}
[0m09:28:34.604891 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.03s]
[0m09:28:34.605547 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:28:34.606641 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:28:34.607032 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:28:34.607382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m09:28:34.607622 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:28:34.609817 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:28:34.610354 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:28:34.612286 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:28:34.612710 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:34.612935 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:28:34.613166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.614234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.614749 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:34.615183 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

int_players as (
    select
        players.player_id,
        players.display_name,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        players.cost,
        players.availability_next_gameweek,
        case players.availability_code
            when 's' then 'suspended'
            when 'i' then 'injured'
            when 'd' then 'injury risk'
            when 'a' then 'availabile'
            else null end as availability_reason,
        players.availability_details,
        players.total_points,
        players.gameweek_points,
        players.points_per_game,
        players.current_form,
        players.current_dreamteam,
        players.dreamteam_appearances,
        players.influence,
        players.creativity,
        players.threat,
        players.ict_index,
        players.selection_rate,
        players.gameweek_transfers_in,
        players.gameweek_transfers_out,
        players.gameweek_transfers_in - gameweek_transfers_out,
        players.starts,
        players.minutes_played,
        players.goals_scored,
        players.expected_goals_scored,
        players.goals_assisted,
        players.expected_goals_assisted,
        players.goals_conceded,
        players.expected_goals_conceded,
        players.clearances_blocks_interceptions,
        players.recoveries,
        players.tackles,
        players.own_goals,
        players.saves_made,
        players.clean_sheets,
        players.penalties_saved,
        players.yellow_cards,
        players.red_cards,
        players.bonus_points,
        players.bonus_points_system,
        players.team_penalty_takers_rank,
        players.penalties_missed,
    from "analytics"."staging"."stg_players" as players 
        left join teams using(team_id)
        left join positions using(position_id)
)



select * from int_players
    );
  
  
[0m09:28:34.627965 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m09:28:34.629093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:34.629444 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:28:34.630434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.631250 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:34.631475 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:28:34.632460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.634459 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:34.634690 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m09:28:34.635276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.637859 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:34.638115 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m09:28:34.638662 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.639426 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:28:34.639651 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:34.639838 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:28:34.646521 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:28:34.648193 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:28:34.648458 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m09:28:34.653869 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:34.654779 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:28:34.655496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af44d73fe0>]}
[0m09:28:34.655903 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m09:28:34.656292 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:28:34.657339 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:28:34.657724 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m09:28:34.658087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.obt_players)
[0m09:28:34.658318 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m09:28:34.660254 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m09:28:34.661711 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m09:28:34.663662 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m09:28:34.664088 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:28:34.664326 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m09:28:34.664513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:34.665227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.665448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:28:34.665663 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m09:28:34.669170 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:28:34.669942 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:28:34.670177 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:28:34.671038 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.672356 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:28:34.672789 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:28:34.674312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.676678 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:28:34.676946 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m09:28:34.677724 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:34.679329 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:28:34.679547 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m09:28:34.680099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:28:34.680911 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:28:34.681136 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:28:34.681318 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:28:34.688388 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:28:34.689927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:28:34.690185 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m09:28:34.696378 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:28:34.697613 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m09:28:34.698708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7478266-8095-4b28-9350-573be6674054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af44c657f0>]}
[0m09:28:34.699183 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m09:28:34.699598 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:28:34.701133 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:34.701387 [debug] [MainThread]: On master: BEGIN
[0m09:28:34.701625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:28:34.702339 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:28:34.702596 [debug] [MainThread]: On master: COMMIT
[0m09:28:34.702801 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:34.702964 [debug] [MainThread]: On master: COMMIT
[0m09:28:34.703560 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:28:34.703922 [debug] [MainThread]: On master: Close
[0m09:28:34.704402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:34.704697 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m09:28:34.705067 [info ] [MainThread]: 
[0m09:28:34.705625 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m09:28:34.706889 [debug] [MainThread]: Command end result
[0m09:28:34.719894 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:28:34.721147 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:28:34.725273 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:28:34.725589 [info ] [MainThread]: 
[0m09:28:34.725896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:28:34.726127 [info ] [MainThread]: 
[0m09:28:34.726364 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:28:34.727153 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3493038, "process_in_blocks": "1024", "process_kernel_time": 0.308415, "process_mem_max_rss": "167768", "process_out_blocks": "4096", "process_user_time": 2.302837}
[0m09:28:34.727483 [debug] [MainThread]: Command `dbt build` succeeded at 09:28:34.727414 after 1.35 seconds
[0m09:28:34.727726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af5757d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af44e980e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77af57449640>]}
[0m09:28:34.727960 [debug] [MainThread]: Flushing usage events
[0m09:28:35.272192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:41:37.874265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3424d88b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3425350440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3424e03380>]}


============================== 09:41:37.879343 | a94f3b75-2cc3-412e-b0e6-2ff410042d06 ==============================
[0m09:41:37.879343 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:41:37.879759 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'no_print': 'None', 'log_path': '/home/robgriffin247/fpl/logs', 'invocation_command': 'dbt build', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80'}
[0m09:41:38.086751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a94f3b75-2cc3-412e-b0e6-2ff410042d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342430bf80>]}
[0m09:41:38.142078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a94f3b75-2cc3-412e-b0e6-2ff410042d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3424f94c20>]}
[0m09:41:38.145257 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:41:38.199495 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:41:38.294207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:41:38.294693 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/staging/stg_players.sql
[0m09:41:38.294982 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:41:38.557651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a94f3b75-2cc3-412e-b0e6-2ff410042d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f341a67e510>]}
[0m09:41:38.598823 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:41:38.600887 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:41:38.675347 [error] [MainThread]: Encountered an error:
Found a cycle: model.fpl_analytics.int_players
[0m09:41:38.679062 [error] [MainThread]: Traceback (most recent call last):
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 210, in build
    results = task.run()
              ^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/build.py", line 195, in compile_manifest
    self.graph: Graph = self.compiler.compile(self.manifest, add_test_edges=True)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.fpl_analytics.int_players

[0m09:41:38.681052 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8559774, "process_in_blocks": "93280", "process_kernel_time": 0.240941, "process_mem_max_rss": "147012", "process_out_blocks": "1928", "process_user_time": 2.054341}
[0m09:41:38.681473 [debug] [MainThread]: Command `dbt build` failed at 09:41:38.681392 after 0.86 seconds
[0m09:41:38.681817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34181a79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34181a79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34181e1c70>]}
[0m09:41:38.682078 [debug] [MainThread]: Flushing usage events
[0m09:41:39.123385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:42:06.763142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4ab22f0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4ab1820aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4ab41018b0>]}


============================== 09:42:06.765431 | ae18fa82-5b0c-4e38-b611-d7f9d8b88f86 ==============================
[0m09:42:06.765431 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:42:06.765800 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'no_print': 'None', 'empty': 'False', 'invocation_command': 'dbt build', 'static_parser': 'True', 'log_path': '/home/robgriffin247/fpl/logs'}
[0m09:42:06.950179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae18fa82-5b0c-4e38-b611-d7f9d8b88f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4ab1420350>]}
[0m09:42:07.006050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae18fa82-5b0c-4e38-b611-d7f9d8b88f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4ab1a83d40>]}
[0m09:42:07.007193 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:42:07.051466 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:42:07.111122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:42:07.111598 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:42:07.360123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae18fa82-5b0c-4e38-b611-d7f9d8b88f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4aa770e450>]}
[0m09:42:07.398134 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:42:07.399340 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:42:07.453059 [error] [MainThread]: Encountered an error:
Found a cycle: model.fpl_analytics.int_players
[0m09:42:07.454407 [error] [MainThread]: Traceback (most recent call last):
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 210, in build
    results = task.run()
              ^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/build.py", line 195, in compile_manifest
    self.graph: Graph = self.compiler.compile(self.manifest, add_test_edges=True)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.fpl_analytics.int_players

[0m09:42:07.455171 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.73708695, "process_in_blocks": "0", "process_kernel_time": 0.238112, "process_mem_max_rss": "146996", "process_out_blocks": "1920", "process_user_time": 1.849624}
[0m09:42:07.455472 [debug] [MainThread]: Command `dbt build` failed at 09:42:07.455409 after 0.74 seconds
[0m09:42:07.455735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4aa5bbf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4aa5be75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4aa72d6030>]}
[0m09:42:07.456027 [debug] [MainThread]: Flushing usage events
[0m09:42:07.885564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:42:55.572850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b11a02870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b10149a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b102d6f90>]}


============================== 09:42:55.577983 | 9aba0727-37ef-435d-a0d9-84330b1d7b8e ==============================
[0m09:42:55.577983 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:42:55.578453 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt build', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'False', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True'}
[0m09:42:55.789497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aba0727-37ef-435d-a0d9-84330b1d7b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b0f5cb560>]}
[0m09:42:55.845968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aba0727-37ef-435d-a0d9-84330b1d7b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b10a4b020>]}
[0m09:42:55.848796 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:42:55.901606 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:42:55.995098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:42:55.995677 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:42:56.253419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9aba0727-37ef-435d-a0d9-84330b1d7b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b057b9460>]}
[0m09:42:56.292047 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:42:56.293811 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:42:56.368924 [error] [MainThread]: Encountered an error:
Found a cycle: model.fpl_analytics.int_players
[0m09:42:56.373400 [error] [MainThread]: Traceback (most recent call last):
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 210, in build
    results = task.run()
              ^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/build.py", line 195, in compile_manifest
    self.graph: Graph = self.compiler.compile(self.manifest, add_test_edges=True)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.fpl_analytics.int_players

[0m09:42:56.374923 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.85630906, "process_in_blocks": "93216", "process_kernel_time": 0.274683, "process_mem_max_rss": "147264", "process_out_blocks": "1920", "process_user_time": 2.014348}
[0m09:42:56.375311 [debug] [MainThread]: Command `dbt build` failed at 09:42:56.375235 after 0.86 seconds
[0m09:42:56.375590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b10b1e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b057d5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796b053e5ca0>]}
[0m09:42:56.375835 [debug] [MainThread]: Flushing usage events
[0m09:42:56.825827 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:11.908084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cd15cbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cd06b8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cd06b9910>]}


============================== 09:43:11.910304 | 413d558c-026d-436c-9b8e-f60ace485fdd ==============================
[0m09:43:11.910304 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:43:11.910689 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'partial_parse': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False'}
[0m09:43:12.093816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '413d558c-026d-436c-9b8e-f60ace485fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cd0607b00>]}
[0m09:43:12.150779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '413d558c-026d-436c-9b8e-f60ace485fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cd1632210>]}
[0m09:43:12.151905 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:43:12.197662 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:43:12.259106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:43:12.259524 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:43:12.522246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '413d558c-026d-436c-9b8e-f60ace485fdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cc4de1bb0>]}
[0m09:43:12.568633 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:43:12.569909 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:43:12.633140 [error] [MainThread]: Encountered an error:
Found a cycle: model.fpl_analytics.int_players
[0m09:43:12.634521 [error] [MainThread]: Traceback (most recent call last):
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 210, in build
    results = task.run()
              ^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/build.py", line 195, in compile_manifest
    self.graph: Graph = self.compiler.compile(self.manifest, add_test_edges=True)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.fpl_analytics.int_players

[0m09:43:12.635355 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7754745, "process_in_blocks": "0", "process_kernel_time": 0.209151, "process_mem_max_rss": "147664", "process_out_blocks": "1920", "process_user_time": 2.08706}
[0m09:43:12.635672 [debug] [MainThread]: Command `dbt build` failed at 09:43:12.635595 after 0.78 seconds
[0m09:43:12.635932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cc4dc37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cc6692750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cc64e1e20>]}
[0m09:43:12.636206 [debug] [MainThread]: Flushing usage events
[0m09:43:13.070965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:33.143522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0d9e50f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0d948ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0d9a32690>]}


============================== 09:43:33.145951 | f27ffa43-e8c9-4a56-bfb5-c71c7224468e ==============================
[0m09:43:33.145951 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:43:33.146385 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/robgriffin247/fpl/logs', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'no_print': 'None'}
[0m09:43:33.331401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f27ffa43-e8c9-4a56-bfb5-c71c7224468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0d90f3e00>]}
[0m09:43:33.388641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f27ffa43-e8c9-4a56-bfb5-c71c7224468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0d9a32ba0>]}
[0m09:43:33.389787 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:43:33.435784 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:43:33.495820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:43:33.496339 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:43:33.754187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f27ffa43-e8c9-4a56-bfb5-c71c7224468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0ccbf9a30>]}
[0m09:43:33.793920 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:43:33.795344 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:43:33.851726 [error] [MainThread]: Encountered an error:
Found a cycle: model.fpl_analytics.int_players
[0m09:43:33.853081 [error] [MainThread]: Traceback (most recent call last):
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 210, in build
    results = task.run()
              ^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/task/build.py", line 195, in compile_manifest
    self.graph: Graph = self.compiler.compile(self.manifest, add_test_edges=True)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/home/robgriffin247/.cache/pypoetry/virtualenvs/fpl-I1OrtLff-py3.12/lib/python3.12/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.fpl_analytics.int_players

[0m09:43:33.853947 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7587512, "process_in_blocks": "0", "process_kernel_time": 0.193423, "process_mem_max_rss": "147552", "process_out_blocks": "1920", "process_user_time": 1.83349}
[0m09:43:33.854270 [debug] [MainThread]: Command `dbt build` failed at 09:43:33.854192 after 0.76 seconds
[0m09:43:33.854519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0ccbf1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0cf1783e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0ccbdb860>]}
[0m09:43:33.854731 [debug] [MainThread]: Flushing usage events
[0m09:43:34.305818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:20.293681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2a2d4c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2a2039f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2a21ce6f0>]}


============================== 09:44:20.296087 | 5f510146-c81c-4487-a922-e7ff899d30a2 ==============================
[0m09:44:20.296087 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:44:20.296479 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/robgriffin247/fpl', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'False', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'log_cache_events': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'quiet': 'False'}
[0m09:44:20.464120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2a1c04500>]}
[0m09:44:20.514779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2a45b1e20>]}
[0m09:44:20.515951 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:44:20.559345 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:44:20.615944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:20.616355 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:44:20.852347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2962e14c0>]}
[0m09:44:20.888520 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:44:20.889617 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:44:20.944051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b297be1100>]}
[0m09:44:20.944426 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:44:20.945962 [info ] [MainThread]: 
[0m09:44:20.946280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:44:20.946492 [info ] [MainThread]: 
[0m09:44:20.946840 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:44:20.950508 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:44:20.975353 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:44:20.975690 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:44:20.975887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:21.000200 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m09:44:21.001760 [debug] [ThreadPool]: On list_analytics: Close
[0m09:44:21.004302 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:44:21.004631 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:44:21.004823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:21.005777 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:21.006498 [debug] [ThreadPool]: On list_analytics: Close
[0m09:44:21.007758 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:44:21.008009 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:44:21.008237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:21.009015 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:21.009721 [debug] [ThreadPool]: On list_analytics: Close
[0m09:44:21.010295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m09:44:21.010590 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:44:21.014547 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:21.014783 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:44:21.014958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:21.015865 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:21.016577 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:21.016756 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:44:21.017119 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:21.017305 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:21.017485 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:44:21.018055 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:21.018859 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:44:21.019132 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:21.019320 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:44:21.019662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:21.019857 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:44:21.020264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m09:44:21.020583 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:44:21.021515 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:21.021822 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:44:21.022013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:21.022751 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:21.023510 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:21.023711 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:44:21.024090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:21.024280 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:21.024432 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:44:21.024837 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:21.025313 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:44:21.025503 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:21.025674 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:44:21.026014 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:21.026194 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:44:21.026617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m09:44:21.026892 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:44:21.027865 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:21.028133 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:44:21.028364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:21.029205 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:21.029936 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:21.030126 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:44:21.030548 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:21.030727 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:21.030876 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:44:21.031259 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:21.031768 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:44:21.031953 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:21.032130 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:44:21.032499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:21.032695 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:44:21.033992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_intermediate)
[0m09:44:21.037441 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:44:21.037704 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:44:21.037886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:21.038513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:21.038865 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:44:21.039085 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:44:21.046595 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m09:44:21.047584 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:44:21.049181 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:44:21.049378 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:44:21.049800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m09:44:21.050803 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:44:21.051030 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:44:21.051286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:21.052156 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:21.052330 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:44:21.052476 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:44:21.054728 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:44:21.055608 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:44:21.056102 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:44:21.056277 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:44:21.056703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m09:44:21.057672 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:44:21.057886 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:44:21.058075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:21.059246 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:21.059449 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:44:21.059614 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:44:21.061922 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:44:21.062840 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:44:21.063458 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:44:21.063665 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:44:21.064639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2961f1520>]}
[0m09:44:21.064952 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:21.065117 [debug] [MainThread]: On master: BEGIN
[0m09:44:21.065267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:21.065897 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:44:21.066070 [debug] [MainThread]: On master: COMMIT
[0m09:44:21.066241 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:21.066382 [debug] [MainThread]: On master: COMMIT
[0m09:44:21.066772 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:44:21.066963 [debug] [MainThread]: On master: Close
[0m09:44:21.070937 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:44:21.071394 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:44:21.071746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m09:44:21.071967 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:44:21.077363 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.078626 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:44:21.100033 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.100540 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.100803 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:44:21.100994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:21.102102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.102472 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.102675 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:44:21.105285 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:44:21.108798 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.109070 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:44:21.109858 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.110702 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.110930 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:44:21.112292 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.116077 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.116335 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:44:21.117951 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.120081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.120320 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:44:21.120908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.129669 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:44:21.129970 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.130211 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:44:21.136883 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:21.140499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:21.140761 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:44:21.145362 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:44:21.147358 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:44:21.148976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2a44e2a80>]}
[0m09:44:21.149416 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m09:44:21.149808 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:44:21.150063 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:44:21.150386 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:44:21.150745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:44:21.150994 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:44:21.153279 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:44:21.153754 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:44:21.155454 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:44:21.155835 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:21.156046 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:44:21.156223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:21.156885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.157109 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:21.157338 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:44:21.164138 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:21.164972 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:21.165212 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:44:21.165938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.166660 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:21.166879 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:44:21.168465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.171206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:21.171443 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:44:21.172042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.173514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:21.173756 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:44:21.174357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.175188 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:44:21.175426 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:21.175601 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:44:21.181630 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:21.183312 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:21.183572 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:44:21.187884 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:44:21.188892 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:44:21.189486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b237eb69c0>]}
[0m09:44:21.189891 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m09:44:21.190257 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:44:21.190532 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:44:21.190871 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:44:21.191478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:44:21.191753 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:44:21.193525 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:44:21.193922 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:44:21.196710 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:44:21.197110 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:21.197309 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:44:21.197502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:21.198175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.198400 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:21.198584 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:44:21.201099 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:44:21.201801 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:21.202052 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:44:21.202782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.203570 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:21.203787 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:44:21.204786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.207439 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:21.207740 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:44:21.208369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.209796 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:21.210010 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:44:21.210495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.211299 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:44:21.211514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:21.211690 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:44:21.217534 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:21.218933 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:21.219228 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:44:21.224303 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:21.225670 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:44:21.226385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b237eaf740>]}
[0m09:44:21.226965 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.03s]
[0m09:44:21.227739 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:44:21.227999 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:44:21.228298 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:44:21.228624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:44:21.229156 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:44:21.230917 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:44:21.231381 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:44:21.233080 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:44:21.233466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:21.233678 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:44:21.233861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:21.234524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.234739 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:21.234927 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:44:21.237706 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:44:21.238502 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:21.238743 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:44:21.239539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.240359 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:21.240585 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:44:21.241495 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.243403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:21.243639 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:44:21.244174 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.245850 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:21.246099 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:44:21.247170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.248398 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:44:21.248798 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:21.249111 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:44:21.254364 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:21.255913 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:21.256159 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:44:21.261049 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:21.262384 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:44:21.263397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b237f979b0>]}
[0m09:44:21.263836 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.03s]
[0m09:44:21.264193 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:44:21.264456 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:44:21.264900 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:44:21.265258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:44:21.265473 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:44:21.267256 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:44:21.267671 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:44:21.270421 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:44:21.270817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:21.271032 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:44:21.271283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:21.271941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.272149 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:21.272375 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:44:21.275130 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:44:21.275862 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:21.276075 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:44:21.276775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.277515 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:21.277721 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:44:21.278552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.280313 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:21.280546 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:44:21.281059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.282716 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:21.282963 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:44:21.283675 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.284420 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:44:21.284625 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:21.284805 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:44:21.290103 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:21.291495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:21.291721 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:44:21.296383 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:44:21.297485 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:44:21.298022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b237e5eea0>]}
[0m09:44:21.298500 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.03s]
[0m09:44:21.298880 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:44:21.299191 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:44:21.299811 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:44:21.300256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:44:21.300851 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:44:21.302739 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:44:21.303291 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:44:21.304994 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:44:21.305382 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:21.305627 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:44:21.305825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:21.306488 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.306711 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:21.306893 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:44:21.308001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.308646 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:21.308850 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:44:21.309482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.310194 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:21.310389 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:44:21.311174 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.313051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:21.313299 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:44:21.313949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.315500 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:21.315727 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:44:21.316283 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.317145 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:44:21.317373 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:21.317599 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:44:21.322877 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:21.324317 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:21.324552 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:44:21.329577 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:21.330767 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:44:21.331517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b237f979b0>]}
[0m09:44:21.331939 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m09:44:21.332311 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:44:21.332575 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:44:21.332895 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:44:21.333237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m09:44:21.333499 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:44:21.335317 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:44:21.336053 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:44:21.337664 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:44:21.338058 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:21.338262 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:44:21.338442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:21.339122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.339360 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:21.339548 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:44:21.340856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.341576 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:21.341814 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:44:21.342754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.343665 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:21.343882 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:44:21.345468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.349153 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:21.349421 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:44:21.350052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.351529 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:21.351742 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:44:21.352346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.353174 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:44:21.353402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:21.353579 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:44:21.359507 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:21.360884 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:21.361106 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:44:21.366433 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:21.367714 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:44:21.368315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b237e70b00>]}
[0m09:44:21.368679 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m09:44:21.369053 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:44:21.369319 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:44:21.369613 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:44:21.370191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:44:21.370450 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:44:21.372241 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:44:21.372679 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:44:21.374345 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:44:21.374738 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:21.374955 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:44:21.375183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:21.375867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.376073 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:21.376249 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:44:21.377652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.378352 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:21.378558 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:44:21.379256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.380143 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:21.380357 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:44:21.381330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.383746 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:21.383976 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:44:21.384792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.387381 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:21.387713 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:44:21.388479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:21.389270 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:44:21.389476 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:21.389641 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:44:21.396251 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:21.397664 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:21.397867 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:44:21.404537 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:21.405647 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:44:21.406231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b237e537d0>]}
[0m09:44:21.406625 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m09:44:21.406992 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:44:21.408009 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:44:21.408350 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:44:21.408676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m09:44:21.408919 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:44:21.410939 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:44:21.411442 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:44:21.413013 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:44:21.413381 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:21.413606 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:44:21.413792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:21.414431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:21.414625 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:21.414843 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
)

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        availability_next_gameweek as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt'
            when 's' then 'suspended'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m09:44:21.423460 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
)

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        availability_next_gameweek as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt'
            when 's' then 'suspended'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m09:44:21.423903 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:44:21.424222 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m09:44:21.430257 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m09:44:21.430565 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:44:21.432093 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "teams"
  
  LINE 16: teams as (
           ^
[0m09:44:21.432499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f510146-c81c-4487-a922-e7ff899d30a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b22df10980>]}
[0m09:44:21.432911 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model intermediate.int_players ................ [[31mERROR[0m in 0.02s]
[0m09:44:21.433308 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:44:21.433675 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "teams"
  
  LINE 16: teams as (
           ^.
[0m09:44:21.434595 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:44:21.435003 [info ] [Thread-1 (]: 10 of 10 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m09:44:21.435316 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:44:21.435557 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m09:44:21.436939 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:21.437292 [debug] [MainThread]: On master: BEGIN
[0m09:44:21.437559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:21.438630 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:44:21.439003 [debug] [MainThread]: On master: COMMIT
[0m09:44:21.439266 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:21.439440 [debug] [MainThread]: On master: COMMIT
[0m09:44:21.439946 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:44:21.440159 [debug] [MainThread]: On master: Close
[0m09:44:21.440478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:21.440655 [debug] [MainThread]: Connection 'model.fpl_analytics.int_players' was properly closed.
[0m09:44:21.440873 [info ] [MainThread]: 
[0m09:44:21.441099 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m09:44:21.441994 [debug] [MainThread]: Command end result
[0m09:44:21.453484 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:44:21.454528 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:44:21.458333 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:44:21.458582 [info ] [MainThread]: 
[0m09:44:21.458845 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:44:21.459075 [info ] [MainThread]: 
[0m09:44:21.459367 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m09:44:21.459600 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "teams"
  
  LINE 16: teams as (
           ^
[0m09:44:21.459777 [info ] [MainThread]: 
[0m09:44:21.459984 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m09:44:21.460184 [info ] [MainThread]: 
[0m09:44:21.460392 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=10
[0m09:44:21.461001 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2136439, "process_in_blocks": "16776", "process_kernel_time": 0.312345, "process_mem_max_rss": "165960", "process_out_blocks": "3592", "process_user_time": 2.280123}
[0m09:44:21.461294 [debug] [MainThread]: Command `dbt build` failed at 09:44:21.461232 after 1.21 seconds
[0m09:44:21.461526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2a2301280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2a2b51cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b2a2b52c90>]}
[0m09:44:21.461746 [debug] [MainThread]: Flushing usage events
[0m09:44:21.978927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:35.956516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794d7106e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794cb11820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794cb118e0>]}


============================== 09:44:35.958935 | 349bb829-44f3-474d-8fe4-b07f792dc152 ==============================
[0m09:44:35.958935 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:44:35.959340 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/robgriffin247/fpl/logs', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt build', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True'}
[0m09:44:36.138206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707942bddc10>]}
[0m09:44:36.193130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794cf888c0>]}
[0m09:44:36.194279 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:44:36.239779 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:44:36.301635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:36.302080 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:44:36.571595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707940edd820>]}
[0m09:44:36.611910 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:44:36.613183 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:44:36.673628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079425f3560>]}
[0m09:44:36.674058 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:44:36.675784 [info ] [MainThread]: 
[0m09:44:36.676147 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:44:36.676385 [info ] [MainThread]: 
[0m09:44:36.676761 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:44:36.680758 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:44:36.702402 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:44:36.702849 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:44:36.703076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:36.719767 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m09:44:36.720855 [debug] [ThreadPool]: On list_analytics: Close
[0m09:44:36.723562 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:44:36.723864 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:44:36.724110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:36.725261 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:36.725990 [debug] [ThreadPool]: On list_analytics: Close
[0m09:44:36.727395 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:44:36.727693 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:44:36.727926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:36.728934 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:36.729657 [debug] [ThreadPool]: On list_analytics: Close
[0m09:44:36.730351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m09:44:36.730779 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:44:36.734968 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:36.735190 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:44:36.735367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:36.736225 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:36.736985 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:36.737177 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:44:36.737575 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:36.737792 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:36.737986 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:44:36.738382 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:36.738977 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:44:36.739173 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:36.739321 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:44:36.739683 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:36.739893 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:44:36.740343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m09:44:36.740654 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:44:36.741650 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:36.741959 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:44:36.742219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:36.743018 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:36.743790 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:36.744021 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:44:36.744396 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:36.744586 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:36.744737 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:44:36.745112 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:36.745617 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:44:36.745795 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:36.745968 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:44:36.746337 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:36.746544 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:44:36.747017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m09:44:36.747320 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:44:36.748329 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:36.748565 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:44:36.748770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:36.749606 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:36.750389 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:36.750608 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:44:36.751423 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:36.751660 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:36.751820 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:44:36.752287 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:36.752821 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:44:36.753029 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:36.753226 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:44:36.753931 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:36.754168 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:44:36.755649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m09:44:36.759508 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:44:36.759767 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:44:36.759954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:36.760692 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:36.761037 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:44:36.761330 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:44:36.769950 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:44:36.771058 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:44:36.771833 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:44:36.772037 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:44:36.772504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m09:44:36.773640 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:44:36.773878 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:44:36.774084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:36.775113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:36.775329 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:44:36.775496 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:44:36.778224 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:44:36.779319 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:44:36.779880 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:44:36.780066 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:44:36.780517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m09:44:36.781637 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:44:36.781878 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:44:36.782086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:36.783343 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:36.783564 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:44:36.783732 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:44:36.786221 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:44:36.787179 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:44:36.787695 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:44:36.787871 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:44:36.789087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794c73f9e0>]}
[0m09:44:36.789402 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:36.789581 [debug] [MainThread]: On master: BEGIN
[0m09:44:36.789734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:36.790185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:44:36.790379 [debug] [MainThread]: On master: COMMIT
[0m09:44:36.790535 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:36.790782 [debug] [MainThread]: On master: COMMIT
[0m09:44:36.791179 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:44:36.791371 [debug] [MainThread]: On master: Close
[0m09:44:36.793748 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:44:36.794161 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:44:36.794511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_gameweeks)
[0m09:44:36.794838 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:44:36.799641 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.800126 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:44:36.822111 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.822866 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.823192 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:44:36.823403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:36.824076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.824308 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.824500 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:44:36.826663 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:44:36.830217 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.830510 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:44:36.831866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.833146 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.833403 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:44:36.834694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.838686 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.838950 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:44:36.839796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.841696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.842002 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:44:36.842670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:36.852047 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:44:36.852335 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.852530 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:44:36.859281 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:36.863291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:36.863588 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:44:36.869226 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:36.871510 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:44:36.873050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794eeb6b40>]}
[0m09:44:36.873568 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m09:44:36.874027 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:44:36.874343 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:44:36.874755 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:44:36.875714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:44:36.876216 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:44:36.878580 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:44:36.879316 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:44:36.881368 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:44:36.881925 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:36.882179 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:44:36.882380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:36.883497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.883966 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:36.884394 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:44:36.893288 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:44:36.894226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:36.894501 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:44:36.895619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.896581 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:36.896826 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:44:36.898363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.900566 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:36.900830 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:44:36.901546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:36.903445 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:36.903728 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:44:36.904512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.905530 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:44:36.905787 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:36.906010 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:44:36.914075 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:44:36.916118 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:36.916468 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:44:36.922375 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:36.923741 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:44:36.924516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70793ab88b00>]}
[0m09:44:36.925004 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m09:44:36.925452 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:44:36.925764 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:44:36.926117 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:44:36.926530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:44:36.927144 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:44:36.929147 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:44:36.929687 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:44:36.933023 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:44:36.933666 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:36.933995 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:44:36.934199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:36.935061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.935327 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:36.935533 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:44:36.938834 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:44:36.939779 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:36.940140 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:44:36.941325 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.942382 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:36.942736 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:44:36.944209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.946456 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:36.946813 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:44:36.947689 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.949619 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:36.949919 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:44:36.951029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.952319 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:44:36.952579 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:36.952776 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:44:36.959743 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:44:36.961618 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:36.961915 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:44:36.968260 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:36.969923 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:44:36.970939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70793abbe150>]}
[0m09:44:36.971499 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m09:44:36.971938 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:44:36.972238 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:44:36.972593 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:44:36.973034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:44:36.973328 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:44:36.975471 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:44:36.976801 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:44:36.979088 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:44:36.979697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:36.979968 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:44:36.980176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:36.981154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.981450 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:36.981755 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:44:36.983477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.984325 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:36.984605 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:44:36.985393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.986251 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:36.986495 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:44:36.987461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:36.989246 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:36.989471 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:44:36.989985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:36.991703 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:36.991961 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:44:36.992613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:36.993453 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:44:36.993681 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:36.993863 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:44:36.999998 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:37.001511 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:37.001759 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:44:37.007990 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:37.009133 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:44:37.009950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70793acb3830>]}
[0m09:44:37.010403 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m09:44:37.010844 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:44:37.011142 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:44:37.011483 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:44:37.011863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:44:37.012133 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:44:37.014276 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:44:37.014850 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:44:37.017792 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:44:37.018224 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:37.018498 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:44:37.018767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:37.019479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.019685 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:37.019868 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:44:37.021499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.022184 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:37.022399 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:44:37.023121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:37.024001 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:37.024252 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:44:37.025578 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.027537 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:37.027777 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:44:37.028605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.030984 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:37.031246 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:44:37.031834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:37.032665 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:44:37.032887 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:37.033074 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:44:37.039875 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:44:37.041381 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:37.041643 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:44:37.047833 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:37.048977 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:44:37.049576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70793ab896a0>]}
[0m09:44:37.050060 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m09:44:37.050473 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:44:37.050841 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:44:37.051175 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:44:37.051536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:44:37.051817 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:44:37.053685 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:44:37.054672 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:44:37.056666 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:44:37.057129 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:37.057452 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:44:37.057659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:37.058499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.058811 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:37.059006 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:44:37.060163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.061260 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:37.061689 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:44:37.062638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:37.063487 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:37.063759 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:44:37.064857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.067682 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:37.068091 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:44:37.069053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.070529 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:37.070806 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:44:37.071345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:37.072105 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:44:37.072321 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:37.072519 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:44:37.079611 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:44:37.081627 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:37.081973 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:44:37.086944 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:37.087984 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:44:37.088511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079425d9f40>]}
[0m09:44:37.088936 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m09:44:37.089365 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:44:37.089662 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:44:37.089990 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:44:37.090352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m09:44:37.090674 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:44:37.092540 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:44:37.093053 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:44:37.095119 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:44:37.095570 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:37.095818 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:44:37.096018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:37.096775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.097006 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:37.097214 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:44:37.098675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.099420 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:37.099643 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:44:37.100553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.101896 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:37.102360 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:44:37.104046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.107314 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:37.107714 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:44:37.108663 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.110547 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:37.110840 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:44:37.111436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:37.112275 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:44:37.112508 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:37.112698 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:44:37.119310 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:37.120965 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:37.121243 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:44:37.126071 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:44:37.127439 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:44:37.128246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70793ab6fda0>]}
[0m09:44:37.128739 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m09:44:37.129147 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:44:37.129432 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:44:37.129768 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:44:37.130114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:44:37.130383 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:44:37.132298 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:44:37.132955 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:44:37.134805 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:44:37.135233 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:37.135469 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:44:37.135681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:37.136403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.136632 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:37.136840 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:44:37.138296 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.139138 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:37.139429 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:44:37.140314 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.141463 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:37.141861 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:44:37.143011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.144808 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:37.145038 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:44:37.145689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:37.147396 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:37.147630 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:44:37.148226 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:37.149009 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:44:37.149259 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:37.149447 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:44:37.156208 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:44:37.157736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:37.157991 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:44:37.164867 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:37.166385 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:44:37.167222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079425e7a40>]}
[0m09:44:37.167653 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m09:44:37.168047 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:44:37.169028 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:44:37.169465 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:44:37.169805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m09:44:37.170048 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:44:37.172301 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:44:37.172804 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:44:37.174747 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:44:37.175246 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:37.175484 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:44:37.175682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:37.176419 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:37.176671 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:37.176919 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        availability_next_gameweek as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt'
            when 's' then 'suspended'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m09:44:37.177577 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        availability_next_gameweek as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt'
            when 's' then 'suspended'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m09:44:37.177872 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:44:37.178160 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m09:44:37.180707 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m09:44:37.180987 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:44:37.182528 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "."
  
  LINE 27:         teams.team,
                        ^
[0m09:44:37.182936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349bb829-44f3-474d-8fe4-b07f792dc152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707940e03d40>]}
[0m09:44:37.183378 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model intermediate.int_players ................ [[31mERROR[0m in 0.01s]
[0m09:44:37.183782 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:44:37.184236 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "."
  
  LINE 27:         teams.team,
                        ^.
[0m09:44:37.185653 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:44:37.185946 [info ] [Thread-1 (]: 10 of 10 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m09:44:37.186250 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:44:37.186820 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m09:44:37.188376 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:37.188641 [debug] [MainThread]: On master: BEGIN
[0m09:44:37.188827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:37.189509 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:44:37.189755 [debug] [MainThread]: On master: COMMIT
[0m09:44:37.189951 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:37.190125 [debug] [MainThread]: On master: COMMIT
[0m09:44:37.190588 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:44:37.190869 [debug] [MainThread]: On master: Close
[0m09:44:37.191194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:37.191392 [debug] [MainThread]: Connection 'model.fpl_analytics.int_players' was properly closed.
[0m09:44:37.191633 [info ] [MainThread]: 
[0m09:44:37.191883 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m09:44:37.192920 [debug] [MainThread]: Command end result
[0m09:44:37.205511 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:44:37.206982 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:44:37.211326 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:44:37.211576 [info ] [MainThread]: 
[0m09:44:37.211863 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:44:37.212117 [info ] [MainThread]: 
[0m09:44:37.212394 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m09:44:37.212663 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "."
  
  LINE 27:         teams.team,
                        ^
[0m09:44:37.212866 [info ] [MainThread]: 
[0m09:44:37.213095 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m09:44:37.213291 [info ] [MainThread]: 
[0m09:44:37.213514 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=10
[0m09:44:37.214211 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.3058511, "process_in_blocks": "0", "process_kernel_time": 0.256125, "process_mem_max_rss": "166264", "process_out_blocks": "3592", "process_user_time": 2.355518}
[0m09:44:37.214532 [debug] [MainThread]: Command `dbt build` failed at 09:44:37.214465 after 1.31 seconds
[0m09:44:37.214820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794c7c5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794c7c5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794c7c50d0>]}
[0m09:44:37.215065 [debug] [MainThread]: Flushing usage events
[0m09:44:37.855068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:48.419006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214e40c2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214e464f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214e44ffd70>]}


============================== 09:44:48.421019 | 1b811a0e-6a40-4517-b8f7-e7c23f927d6f ==============================
[0m09:44:48.421019 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:44:48.421376 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build'}
[0m09:44:48.584614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214df943e90>]}
[0m09:44:48.635277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214e477c230>]}
[0m09:44:48.636296 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:44:48.678139 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:44:48.732865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:48.733283 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:44:48.972734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214d9f6e600>]}
[0m09:44:49.008874 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:44:49.010049 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:44:49.062125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214d9ad7e30>]}
[0m09:44:49.062484 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:44:49.064133 [info ] [MainThread]: 
[0m09:44:49.064450 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:44:49.064666 [info ] [MainThread]: 
[0m09:44:49.065019 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:44:49.068671 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:44:49.087598 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:44:49.087887 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:44:49.088059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:49.103137 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:44:49.104068 [debug] [ThreadPool]: On list_analytics: Close
[0m09:44:49.106699 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:44:49.107129 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:44:49.107331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:49.108409 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:49.109161 [debug] [ThreadPool]: On list_analytics: Close
[0m09:44:49.110682 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:44:49.110929 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:44:49.111135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:49.112056 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:49.112717 [debug] [ThreadPool]: On list_analytics: Close
[0m09:44:49.113388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m09:44:49.113659 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:44:49.117649 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:49.117892 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:44:49.118083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:49.119131 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:49.119914 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:49.120091 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:44:49.120466 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.120663 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:49.120840 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:44:49.121225 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.121733 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:44:49.121919 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:44:49.122070 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:44:49.122562 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.122786 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:44:49.123233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m09:44:49.123738 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:44:49.124755 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:49.124995 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:44:49.125144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:49.126172 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:49.127005 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:49.127201 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:44:49.127648 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.127854 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:49.128005 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:44:49.128635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.129146 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:44:49.129325 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:44:49.129474 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:44:49.129907 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.130108 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:44:49.130523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m09:44:49.131002 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:44:49.131984 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:49.132171 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:44:49.132327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:49.133053 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:49.133833 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:49.134025 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:44:49.134371 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.134580 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:49.134755 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:44:49.135371 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.135877 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:44:49.136060 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:44:49.136211 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:44:49.136574 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.136772 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:44:49.138051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m09:44:49.141306 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:44:49.141545 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:44:49.141880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:49.142417 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:49.142617 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:44:49.142797 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:44:49.149602 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m09:44:49.150470 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:44:49.151161 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:44:49.151353 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:44:49.151792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m09:44:49.152843 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:44:49.153095 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:44:49.153287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:49.154242 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:44:49.154451 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:44:49.154622 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:44:49.156861 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:44:49.157627 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:44:49.158118 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:44:49.158305 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:44:49.158726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m09:44:49.159939 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:44:49.160139 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:44:49.160292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:49.160759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:44:49.160955 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:44:49.161116 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:44:49.163658 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:44:49.164691 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:44:49.165223 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:44:49.165404 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:44:49.166740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214d9ae0470>]}
[0m09:44:49.167035 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:49.167196 [debug] [MainThread]: On master: BEGIN
[0m09:44:49.167332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:49.167783 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:44:49.167972 [debug] [MainThread]: On master: COMMIT
[0m09:44:49.168188 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:49.168366 [debug] [MainThread]: On master: COMMIT
[0m09:44:49.168740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:44:49.168918 [debug] [MainThread]: On master: Close
[0m09:44:49.171368 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:44:49.171706 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:44:49.172007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m09:44:49.172243 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:44:49.176809 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.177258 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:44:49.197455 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.197991 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.198324 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:44:49.198514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.199202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.199524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.199710 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:44:49.201881 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:44:49.205069 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.205328 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:44:49.205975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.206825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.207043 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:44:49.207911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.211524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.211743 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:44:49.212321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.213725 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.213971 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:44:49.214447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.222939 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:44:49.223176 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.223349 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:44:49.229403 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:49.232907 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:44:49.233166 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:44:49.237726 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:44:49.239663 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:44:49.241015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9e6aea0>]}
[0m09:44:49.241457 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.07s]
[0m09:44:49.241847 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:44:49.242105 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:44:49.242403 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:44:49.242938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:44:49.243214 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:44:49.245163 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:44:49.245958 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:44:49.247898 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:44:49.248301 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:49.248503 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:44:49.248678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.249333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.249555 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:49.249777 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:44:49.255860 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:49.256895 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:49.257281 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:44:49.258625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.259608 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:49.259924 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:44:49.261068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.262962 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:49.263189 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:44:49.263776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.265363 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:49.265609 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:44:49.266409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.267257 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:44:49.267482 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:49.267667 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:44:49.273041 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.274493 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:44:49.274795 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:44:49.279185 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:44:49.280084 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:44:49.280691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9f86690>]}
[0m09:44:49.281099 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m09:44:49.281491 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:44:49.281749 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:44:49.282317 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:44:49.282707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:44:49.282936 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:44:49.284575 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:44:49.284956 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:44:49.287582 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:44:49.288017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:49.288311 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:44:49.288506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.289281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.289514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:49.289773 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:44:49.291723 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:44:49.292448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:49.292660 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:44:49.293353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.294124 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:49.294359 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:44:49.295384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.297995 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:49.298375 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:44:49.299317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.300657 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:49.300868 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:44:49.301390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.302143 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:44:49.302358 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:49.302550 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:44:49.308284 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.309725 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:44:49.309967 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:44:49.314999 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.316203 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:44:49.316866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9e9e8a0>]}
[0m09:44:49.317414 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.03s]
[0m09:44:49.318005 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:44:49.318374 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:44:49.318752 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:44:49.319184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:44:49.319895 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:44:49.321576 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:44:49.321998 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:44:49.323653 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:44:49.324016 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:49.324215 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:44:49.324420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.325084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.325272 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:49.325432 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:44:49.326575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.327240 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:49.327450 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:44:49.328038 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.328770 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:49.328971 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:44:49.329803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.331929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:49.332143 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:44:49.332832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.334949 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:49.335219 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:44:49.335848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.336674 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:44:49.336908 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:49.337105 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:44:49.342716 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.344119 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:44:49.344350 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:44:49.349701 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.350938 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:44:49.351621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9ea85c0>]}
[0m09:44:49.352002 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.03s]
[0m09:44:49.352362 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:44:49.352647 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:44:49.352932 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:44:49.353348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:44:49.353568 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:44:49.355491 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:44:49.355917 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:44:49.358656 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:44:49.359079 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:49.359295 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:44:49.359471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.360100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.360306 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:49.360472 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:44:49.362241 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:44:49.363288 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:49.363853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:44:49.364660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.365608 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:49.365853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:44:49.366742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.368467 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:49.368676 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:44:49.369434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.371142 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:49.371377 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:44:49.371862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.372565 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:44:49.372770 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:49.372942 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:44:49.379049 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:49.380438 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:44:49.380669 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:44:49.385364 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:44:49.386515 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:44:49.387069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9e52840>]}
[0m09:44:49.387458 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.03s]
[0m09:44:49.387856 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:44:49.388106 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:44:49.388404 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:44:49.389144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:44:49.389530 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:44:49.391591 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:44:49.391998 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:44:49.393721 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:44:49.394274 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:49.394516 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:44:49.394842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.395708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.395940 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:49.396127 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:44:49.397241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.398014 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:49.398254 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:44:49.399028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.399905 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:49.400133 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:44:49.400948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.402773 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:49.403008 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:44:49.403504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.405030 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:49.405256 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:44:49.405719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.406531 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:44:49.406785 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:49.406980 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:44:49.412743 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.414161 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:44:49.414398 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:44:49.419317 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.420529 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:44:49.421196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9e6a8a0>]}
[0m09:44:49.421782 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m09:44:49.422240 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:44:49.422507 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:44:49.422842 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:44:49.423287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m09:44:49.423501 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:44:49.425320 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:44:49.425874 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:44:49.427693 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:44:49.428099 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:49.428338 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:44:49.428535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.429194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.429404 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:49.429639 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:44:49.430830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.431510 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:49.431722 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:44:49.432338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.433102 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:49.433323 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:44:49.434172 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.436943 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:49.437167 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:44:49.437887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.439837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:49.440131 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:44:49.440990 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.441831 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:44:49.442056 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:49.442242 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:44:49.447376 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.448728 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:44:49.448983 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:44:49.454534 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.455641 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:44:49.456389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9ed4f80>]}
[0m09:44:49.456810 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.03s]
[0m09:44:49.457180 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:44:49.457462 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:44:49.457780 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:44:49.458089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:44:49.458311 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:44:49.460046 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:44:49.460638 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:44:49.462315 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:44:49.462758 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:49.462989 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:44:49.463174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.463822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.464021 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:49.464194 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:44:49.465503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.466181 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:49.466403 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:44:49.467066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.467957 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:49.468210 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:44:49.469287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.471578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:49.471837 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:44:49.472486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.473961 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:49.474182 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:44:49.474744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.475527 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:44:49.475753 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:49.475938 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:44:49.481870 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:49.483386 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:44:49.483635 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:44:49.488708 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:44:49.489904 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:44:49.490382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9f84830>]}
[0m09:44:49.490810 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.03s]
[0m09:44:49.491195 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:44:49.491831 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:44:49.492173 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:44:49.492523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m09:44:49.492782 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:44:49.495540 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:44:49.495988 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:44:49.497582 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:44:49.497984 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:49.498265 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:44:49.498454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.499439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.499860 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:49.500474 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        availability_next_gameweek as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt'
            when 's' then 'suspended'
            else null end as availability_reason,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m09:44:49.512745 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m09:44:49.513607 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:49.513862 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:44:49.514707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.515476 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:49.515689 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:44:49.516566 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.518239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:49.518474 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m09:44:49.519056 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.521412 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:49.521705 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m09:44:49.522275 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.523080 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:44:49.523294 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:49.523482 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:44:49.530005 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:49.531649 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:44:49.531901 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m09:44:49.536363 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:44:49.537592 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:44:49.538836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9ee2c90>]}
[0m09:44:49.539285 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m09:44:49.539659 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:44:49.540259 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:44:49.540577 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m09:44:49.540899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.obt_players)
[0m09:44:49.541138 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m09:44:49.542844 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m09:44:49.543985 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m09:44:49.546031 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m09:44:49.546503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:44:49.546803 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m09:44:49.546997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.547658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.547869 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:44:49.548046 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m09:44:49.551459 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:44:49.552167 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:44:49.552384 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:44:49.553247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.554402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:44:49.554881 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:44:49.555749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.558316 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:44:49.558857 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m09:44:49.559614 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:44:49.561847 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:44:49.562204 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m09:44:49.563038 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:44:49.563783 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:44:49.563987 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:44:49.564188 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:44:49.571666 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:44:49.573240 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:44:49.573488 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m09:44:49.579478 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:44:49.580627 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m09:44:49.581555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b811a0e-6a40-4517-b8f7-e7c23f927d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214b9e5faa0>]}
[0m09:44:49.581930 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m09:44:49.582288 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:44:49.584123 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:49.584364 [debug] [MainThread]: On master: BEGIN
[0m09:44:49.584530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:49.585221 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:44:49.585448 [debug] [MainThread]: On master: COMMIT
[0m09:44:49.585618 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:49.585763 [debug] [MainThread]: On master: COMMIT
[0m09:44:49.586303 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:44:49.586753 [debug] [MainThread]: On master: Close
[0m09:44:49.587071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:49.587247 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m09:44:49.587462 [info ] [MainThread]: 
[0m09:44:49.587701 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m09:44:49.588715 [debug] [MainThread]: Command end result
[0m09:44:49.600096 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:44:49.601275 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:44:49.605074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:44:49.605336 [info ] [MainThread]: 
[0m09:44:49.605590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:49.605924 [info ] [MainThread]: 
[0m09:44:49.606179 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:44:49.606981 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2310978, "process_in_blocks": "1536", "process_kernel_time": 0.255463, "process_mem_max_rss": "167976", "process_out_blocks": "4128", "process_user_time": 2.303571}
[0m09:44:49.607301 [debug] [MainThread]: Command `dbt build` succeeded at 09:44:49.607235 after 1.23 seconds
[0m09:44:49.607524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214e4530b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214e4a46ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214e4a45ee0>]}
[0m09:44:49.607766 [debug] [MainThread]: Flushing usage events
[0m09:44:50.086730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:55.272528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5f50584a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5f6c815e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5f48e3170>]}


============================== 09:46:55.276205 | 733f26e5-81f3-487c-9ca2-f2366f2d52f9 ==============================
[0m09:46:55.276205 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:46:55.276660 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/robgriffin247/fpl', 'invocation_command': 'dbt build', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'empty': 'False', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80'}
[0m09:46:55.496253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5f40139e0>]}
[0m09:46:55.559568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5f3fe9af0>]}
[0m09:46:55.563496 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:46:55.623174 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:46:55.730049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:46:55.730620 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:46:56.025173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c2dedca0>]}
[0m09:46:56.093481 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:46:56.096340 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:46:56.191585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5e87f65a0>]}
[0m09:46:56.192020 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:46:56.193875 [info ] [MainThread]: 
[0m09:46:56.194255 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:46:56.194549 [info ] [MainThread]: 
[0m09:46:56.195011 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:46:56.199731 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:46:56.229129 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:46:56.229531 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:46:56.229825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:56.252628 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m09:46:56.253934 [debug] [ThreadPool]: On list_analytics: Close
[0m09:46:56.256942 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:46:56.257297 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:46:56.257760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:56.259086 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:46:56.259948 [debug] [ThreadPool]: On list_analytics: Close
[0m09:46:56.261410 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:46:56.261696 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:46:56.262084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:56.263187 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:46:56.263954 [debug] [ThreadPool]: On list_analytics: Close
[0m09:46:56.264964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m09:46:56.265321 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:46:56.270095 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:46:56.270407 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:46:56.270600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:56.271783 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:46:56.272800 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:46:56.273046 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:46:56.273690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:56.274059 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:46:56.274428 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:46:56.275160 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:56.275775 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:46:56.275999 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:46:56.276170 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:46:56.276822 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:56.277274 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:46:56.278197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m09:46:56.278604 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:46:56.279835 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:46:56.280177 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:46:56.280406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:56.281593 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:46:56.282913 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:46:56.283264 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:46:56.283719 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:56.283945 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:46:56.284104 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:46:56.284513 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:56.285165 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:46:56.285428 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:46:56.285612 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:46:56.286050 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:56.286279 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:46:56.286795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m09:46:56.287295 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:46:56.288439 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:46:56.288700 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:46:56.288922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:56.290015 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:46:56.290956 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:46:56.291185 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:46:56.291683 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:56.291899 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:46:56.292075 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:46:56.292691 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:56.293596 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:46:56.293933 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:46:56.294223 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:46:56.295170 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:46:56.295415 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:46:56.297197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m09:46:56.300931 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:46:56.301232 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:46:56.301937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:56.303219 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:46:56.303551 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:46:56.303769 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:46:56.312342 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:46:56.313578 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:46:56.317098 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:46:56.317359 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:46:56.317949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m09:46:56.319379 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:46:56.319670 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:46:56.319883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:56.321036 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:46:56.321302 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:46:56.321495 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:46:56.325065 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:46:56.326249 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:46:56.326925 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:46:56.327185 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:46:56.327726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m09:46:56.329592 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:46:56.329840 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:46:56.330014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:56.330853 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:46:56.331152 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:46:56.331345 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:46:56.334346 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:46:56.335617 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:46:56.336252 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:46:56.336481 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:46:56.338093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5ea1d26c0>]}
[0m09:46:56.338561 [debug] [MainThread]: Using duckdb connection "master"
[0m09:46:56.338804 [debug] [MainThread]: On master: BEGIN
[0m09:46:56.339095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:56.339774 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:46:56.339994 [debug] [MainThread]: On master: COMMIT
[0m09:46:56.340194 [debug] [MainThread]: Using duckdb connection "master"
[0m09:46:56.340376 [debug] [MainThread]: On master: COMMIT
[0m09:46:56.340882 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:46:56.341099 [debug] [MainThread]: On master: Close
[0m09:46:56.344661 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:46:56.345115 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:46:56.345524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m09:46:56.345790 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:46:56.351602 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.352202 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:46:56.376977 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.377615 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.377905 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:46:56.378108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.379497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.379937 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.380232 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:46:56.384482 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:46:56.388697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.389068 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:46:56.390252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.391601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.391879 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:46:56.393092 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.397805 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.398114 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:46:56.399968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.402320 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.402657 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:46:56.403403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.414260 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:46:56.414735 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.415018 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:46:56.420284 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.424655 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:46:56.424991 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:46:56.429929 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.433112 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:46:56.435141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c2d064b0>]}
[0m09:46:56.435678 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.09s]
[0m09:46:56.436122 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:46:56.436457 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:46:56.436820 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:46:56.437578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:46:56.437853 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:46:56.440207 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:46:56.440740 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:46:56.442722 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:46:56.443230 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:46:56.443533 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:46:56.443759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.444525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.444765 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:46:56.445025 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:46:56.453028 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:46:56.454466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:46:56.455036 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:46:56.455982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.456994 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:46:56.457274 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:46:56.458443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.460645 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:46:56.460956 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:46:56.461662 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.463458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:46:56.463728 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:46:56.464403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.465301 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:46:56.465555 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:46:56.465795 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:46:56.472070 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:46:56.473904 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:46:56.474213 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:46:56.479778 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.481692 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:46:56.483283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c2165d00>]}
[0m09:46:56.483861 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m09:46:56.484337 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:46:56.484629 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:46:56.485076 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:46:56.485519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:46:56.485799 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:46:56.488018 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:46:56.488520 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:46:56.492844 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:46:56.493594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:46:56.493933 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:46:56.494165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.496485 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:46:56.496789 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:46:56.497016 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:46:56.499261 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:46:56.500203 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:46:56.500525 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:46:56.501376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.502386 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:46:56.502663 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:46:56.503865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.505996 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:46:56.506307 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:46:56.507120 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.509188 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:46:56.509490 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:46:56.510320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.511369 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:46:56.511685 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:46:56.511933 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:46:56.517309 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.519016 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:46:56.519297 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:46:56.524335 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.525779 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:46:56.526469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c21bc260>]}
[0m09:46:56.527020 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m09:46:56.527449 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:46:56.527736 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:46:56.528112 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:46:56.528785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:46:56.529167 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:46:56.531534 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:46:56.532309 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:46:56.534350 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:46:56.534837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:46:56.535187 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:46:56.535415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.536460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.536866 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:46:56.537275 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:46:56.539577 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:46:56.540778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:46:56.541254 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:46:56.542701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.544057 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:46:56.544395 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:46:56.545772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.548889 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:46:56.549209 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:46:56.549982 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.551982 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:46:56.552379 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:46:56.553279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.554449 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:46:56.554745 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:46:56.555040 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:46:56.560220 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.561964 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:46:56.562298 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:46:56.567249 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.568727 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:46:56.569560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c21beae0>]}
[0m09:46:56.570180 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m09:46:56.570708 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:46:56.571049 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:46:56.571513 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:46:56.571908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:46:56.572240 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:46:56.574487 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:46:56.575303 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:46:56.578779 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:46:56.579366 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:46:56.579653 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:46:56.579864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.580623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.580880 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:46:56.581095 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:46:56.583292 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:46:56.584500 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:46:56.584966 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:46:56.586227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.587225 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:46:56.587493 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:46:56.588533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.590693 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:46:56.591041 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:46:56.591730 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.593671 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:46:56.593976 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:46:56.594558 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.595502 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:46:56.595758 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:46:56.595992 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:46:56.602139 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:46:56.603984 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:46:56.604310 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:46:56.609392 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.611043 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:46:56.611995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c21c9340>]}
[0m09:46:56.612472 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m09:46:56.612953 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:46:56.613305 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:46:56.613679 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:46:56.614122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:46:56.614658 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:46:56.616730 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:46:56.617193 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:46:56.619155 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:46:56.619615 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:46:56.619864 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:46:56.620067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.620830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.621065 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:46:56.621270 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:46:56.622425 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.623228 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:46:56.623491 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:46:56.624345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.625346 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:46:56.625607 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:46:56.626661 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.628906 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:46:56.629220 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:46:56.629926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.631855 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:46:56.632119 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:46:56.632684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.633507 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:46:56.633777 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:46:56.633969 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:46:56.639602 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.641558 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:46:56.641926 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:46:56.646983 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.648257 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:46:56.648867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c217e960>]}
[0m09:46:56.649315 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m09:46:56.649759 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:46:56.650069 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:46:56.650435 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:46:56.650939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m09:46:56.651197 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:46:56.653236 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:46:56.653744 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:46:56.655936 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:46:56.656542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:46:56.656849 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:46:56.657059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.658168 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.658626 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:46:56.658899 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:46:56.660340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.661360 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:46:56.661651 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:46:56.662745 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.663838 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:46:56.664108 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:46:56.665319 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.668794 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:46:56.669107 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:46:56.669773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.671621 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:46:56.671914 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:46:56.672558 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.673569 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:46:56.673850 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:46:56.674072 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:46:56.679236 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.681075 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:46:56.681370 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:46:56.686367 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.687632 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:46:56.688289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c218aff0>]}
[0m09:46:56.688816 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m09:46:56.689280 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:46:56.689580 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:46:56.689918 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:46:56.690482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:46:56.690802 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:46:56.693244 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:46:56.693889 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:46:56.696162 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:46:56.696721 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:46:56.696987 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:46:56.697193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.698003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.698254 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:46:56.698466 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:46:56.700225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.701452 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:46:56.701938 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:46:56.703074 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.704232 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:46:56.704551 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:46:56.705674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.707806 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:46:56.708086 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:46:56.708873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.710745 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:46:56.711069 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:46:56.711906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.712950 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:46:56.713234 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:46:56.713479 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:46:56.719798 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:46:56.721785 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:46:56.722153 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:46:56.727397 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.728722 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:46:56.729587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c217d610>]}
[0m09:46:56.730097 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m09:46:56.730600 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:46:56.731379 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:46:56.732007 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:46:56.732650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m09:46:56.733069 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:46:56.736088 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:46:56.736821 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:46:56.739422 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:46:56.740151 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:46:56.740530 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:46:56.740794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.741653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.741918 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:46:56.742252 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt'
            when 's' then 'suspended'
            else null end as availability_status,
        availability_details,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        starts,
        minutes_played,
        goals_scored,
        expected_goals_scored,
        goals_assisted,
        expected_goals_assisted,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m09:46:56.755624 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:46:56.756758 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:46:56.757091 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:46:56.758126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.759190 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:46:56.759459 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:46:56.760677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.763963 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:46:56.764331 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m09:46:56.765245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.768698 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:46:56.769077 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m09:46:56.770098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.771188 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:46:56.771481 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:46:56.771723 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:46:56.777419 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.779394 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:46:56.779741 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m09:46:56.785746 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:46:56.787166 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:46:56.788294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c00f6870>]}
[0m09:46:56.788830 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.06s]
[0m09:46:56.789314 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:46:56.790175 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:46:56.790580 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m09:46:56.791068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.obt_players)
[0m09:46:56.791328 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m09:46:56.793341 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m09:46:56.793823 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m09:46:56.796342 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m09:46:56.797315 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:46:56.797650 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m09:46:56.797858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:56.798693 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.799057 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:46:56.799279 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m09:46:56.802698 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:46:56.803625 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:46:56.803887 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:46:56.804860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.805833 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:46:56.806089 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:46:56.807102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:46:56.809204 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:46:56.809489 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m09:46:56.810127 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.812004 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:46:56.812294 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m09:46:56.813064 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:56.814146 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:46:56.814479 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:46:56.814718 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:46:56.821781 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:46:56.823884 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:46:56.824184 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m09:46:56.829040 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:46:56.830237 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m09:46:56.831368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733f26e5-81f3-487c-9ca2-f2366f2d52f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5c00fd820>]}
[0m09:46:56.831874 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m09:46:56.832296 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:46:56.833593 [debug] [MainThread]: Using duckdb connection "master"
[0m09:46:56.833859 [debug] [MainThread]: On master: BEGIN
[0m09:46:56.834041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:46:56.834735 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:46:56.835033 [debug] [MainThread]: On master: COMMIT
[0m09:46:56.835256 [debug] [MainThread]: Using duckdb connection "master"
[0m09:46:56.835443 [debug] [MainThread]: On master: COMMIT
[0m09:46:56.836100 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:46:56.836471 [debug] [MainThread]: On master: Close
[0m09:46:56.837133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:56.837460 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m09:46:56.838096 [info ] [MainThread]: 
[0m09:46:56.838659 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m09:46:56.839883 [debug] [MainThread]: Command end result
[0m09:46:56.853311 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:46:56.854866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:46:56.859682 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:46:56.860021 [info ] [MainThread]: 
[0m09:46:56.860348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:56.860621 [info ] [MainThread]: 
[0m09:46:56.860943 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:46:56.863056 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.6432183, "process_in_blocks": "94880", "process_kernel_time": 0.362285, "process_mem_max_rss": "168296", "process_out_blocks": "4128", "process_user_time": 2.683299}
[0m09:46:56.863546 [debug] [MainThread]: Command `dbt build` succeeded at 09:46:56.863418 after 1.64 seconds
[0m09:46:56.864004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5f4064bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5ea19f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5f44dd8e0>]}
[0m09:46:56.864308 [debug] [MainThread]: Flushing usage events
[0m09:46:57.436963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:22.116560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f9cf1c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f9ca49a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f9ceffd10>]}


============================== 09:51:22.121260 | 3af4146f-15df-4294-b70a-d6fe9f2d0737 ==============================
[0m09:51:22.121260 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:51:22.121718 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'profiles_dir': '/home/robgriffin247/fpl', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'target_path': 'None', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'write_json': 'True'}
[0m09:51:22.350686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f9e67f7d0>]}
[0m09:51:22.412899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f9c277800>]}
[0m09:51:22.417954 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:51:22.474762 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:51:22.576189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:51:22.576775 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:51:22.862699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f901ed760>]}
[0m09:51:22.906232 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:51:22.908098 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:51:22.988120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f91dc16d0>]}
[0m09:51:22.988503 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:51:22.990129 [info ] [MainThread]: 
[0m09:51:22.990456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:51:22.990700 [info ] [MainThread]: 
[0m09:51:22.991103 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:51:22.995115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:51:23.026727 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:51:23.027113 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:51:23.027450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:23.056469 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m09:51:23.057545 [debug] [ThreadPool]: On list_analytics: Close
[0m09:51:23.060425 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:51:23.060809 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:51:23.061028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:23.062119 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:51:23.062928 [debug] [ThreadPool]: On list_analytics: Close
[0m09:51:23.064343 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:51:23.064610 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:51:23.064887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:23.065681 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:51:23.066408 [debug] [ThreadPool]: On list_analytics: Close
[0m09:51:23.067015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m09:51:23.067375 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:51:23.071566 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:51:23.071801 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:51:23.071979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:23.072864 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:51:23.073757 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:51:23.073972 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:51:23.074546 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:23.074888 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:51:23.075248 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:51:23.075803 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:23.076355 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:51:23.076551 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:51:23.076711 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:51:23.077292 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:23.077547 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:51:23.078048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m09:51:23.078390 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:51:23.079666 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:51:23.080022 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:51:23.080249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:23.081299 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:51:23.082213 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:51:23.082428 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:51:23.082889 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:23.083091 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:51:23.083314 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:51:23.083989 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:23.084583 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:51:23.084806 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:51:23.084977 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:51:23.085388 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:23.085640 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:51:23.086124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m09:51:23.086499 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:51:23.087667 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:51:23.087880 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:51:23.088086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:23.088932 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:51:23.089794 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:51:23.090015 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:51:23.090492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:23.090713 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:51:23.090883 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:51:23.091319 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:23.091911 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:51:23.092168 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:51:23.092353 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:51:23.092770 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:23.092992 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:51:23.094556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m09:51:23.098761 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:51:23.099305 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:51:23.099556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:23.100303 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:51:23.100537 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:51:23.100715 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:51:23.109597 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m09:51:23.110841 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:51:23.112551 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:51:23.112817 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:51:23.113365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m09:51:23.114598 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:51:23.114843 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:51:23.115051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:23.116329 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:51:23.116540 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:51:23.116717 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:51:23.119357 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:51:23.120245 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:51:23.120801 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:51:23.120994 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:51:23.121457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m09:51:23.122575 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:51:23.122806 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:51:23.123004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:23.123854 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:51:23.124086 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:51:23.124270 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:51:23.126915 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:51:23.127881 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:51:23.128429 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:51:23.128619 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:51:23.129694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f91db5ee0>]}
[0m09:51:23.130027 [debug] [MainThread]: Using duckdb connection "master"
[0m09:51:23.130224 [debug] [MainThread]: On master: BEGIN
[0m09:51:23.130391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:23.131105 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:51:23.131365 [debug] [MainThread]: On master: COMMIT
[0m09:51:23.131546 [debug] [MainThread]: Using duckdb connection "master"
[0m09:51:23.131705 [debug] [MainThread]: On master: COMMIT
[0m09:51:23.132147 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:51:23.132359 [debug] [MainThread]: On master: Close
[0m09:51:23.135276 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:51:23.135660 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:51:23.136006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m09:51:23.136248 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:51:23.141351 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.141913 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:51:23.164212 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.164814 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.165088 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:51:23.165310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.165975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.166210 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.166405 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:51:23.169307 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:23.173072 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.173408 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:51:23.174363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.175321 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.175574 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:51:23.176631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.181094 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.181377 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:51:23.183069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.184944 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.185262 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:51:23.186124 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.196986 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:51:23.197392 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.197622 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:51:23.203779 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.207842 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:51:23.208144 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:51:23.212829 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:51:23.214790 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:51:23.216616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f9227b650>]}
[0m09:51:23.217115 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m09:51:23.217574 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:51:23.217869 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:51:23.218216 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:51:23.219029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:51:23.219508 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:51:23.221819 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:51:23.222335 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:51:23.224240 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:51:23.224671 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:51:23.224943 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:51:23.225145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.226143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.226405 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:51:23.226662 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:51:23.235213 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:51:23.236245 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:51:23.236538 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:51:23.237412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.238323 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:51:23.238575 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:51:23.239816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.241893 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:51:23.242152 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:51:23.242743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.244430 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:51:23.244689 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:51:23.245451 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.246814 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:51:23.247427 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:51:23.247673 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:51:23.254940 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:51:23.257011 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:51:23.257307 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:51:23.262017 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:51:23.263455 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:51:23.264127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f5e37e570>]}
[0m09:51:23.264656 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m09:51:23.265107 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:51:23.265400 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:51:23.265827 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:51:23.266403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:51:23.266736 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:51:23.268870 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:51:23.269514 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:51:23.272531 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:51:23.272982 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:51:23.273223 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:51:23.273419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.274470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.274873 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:51:23.275413 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:51:23.279002 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:23.279876 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:51:23.280164 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:51:23.281034 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.282045 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:51:23.282353 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:51:23.283890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.286061 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:51:23.286325 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:51:23.287225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.289206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:51:23.289476 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:51:23.290020 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.290879 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:51:23.291166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:51:23.291383 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:51:23.297412 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.299328 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:51:23.299638 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:51:23.304935 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:51:23.306167 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:51:23.306683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f5e28b7a0>]}
[0m09:51:23.307132 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m09:51:23.307574 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:51:23.307846 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:51:23.308161 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:51:23.308504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:51:23.308797 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:51:23.310605 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:51:23.311448 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:51:23.313630 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:51:23.314141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:51:23.314400 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:51:23.314643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.315471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.315722 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:51:23.315926 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:51:23.317870 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:51:23.318688 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:51:23.318943 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:51:23.319709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.320599 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:51:23.320853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:51:23.321906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.323908 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:51:23.324174 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:51:23.324719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.326449 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:51:23.326734 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:51:23.327429 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.328342 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:51:23.328594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:51:23.328802 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:51:23.335552 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.337379 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:51:23.337702 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:51:23.344008 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.345308 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:51:23.346143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f5e2871a0>]}
[0m09:51:23.346783 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m09:51:23.347300 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:51:23.347633 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:51:23.348237 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:51:23.348842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:51:23.349148 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:51:23.351241 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:51:23.351714 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:51:23.354811 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:51:23.355345 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:51:23.355595 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:51:23.355819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.356533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.356785 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:51:23.356998 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:51:23.359737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:51:23.360851 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:51:23.361178 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:51:23.362062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.363051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:51:23.363403 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:51:23.364504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.366586 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:51:23.366842 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:51:23.367432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.369179 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:51:23.369443 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:51:23.369942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.370811 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:51:23.371081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:51:23.371315 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:51:23.377219 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.379066 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:51:23.379439 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:51:23.384262 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:51:23.385595 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:51:23.386393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f5e23e4e0>]}
[0m09:51:23.386898 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m09:51:23.387439 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:51:23.387736 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:51:23.388120 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:51:23.388870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:51:23.389163 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:51:23.391000 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:51:23.391626 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:51:23.393754 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:51:23.394277 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:51:23.394532 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:51:23.394731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.395870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.396287 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:51:23.396641 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:51:23.398084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.399261 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:51:23.399682 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:51:23.400712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.401555 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:51:23.401804 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:51:23.402841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.404838 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:51:23.405093 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:51:23.405647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.407485 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:51:23.407772 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:51:23.408819 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.409941 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:51:23.410244 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:51:23.410454 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:51:23.416045 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:51:23.417688 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:51:23.417940 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:51:23.423411 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:51:23.424749 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:51:23.425445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f5e38d850>]}
[0m09:51:23.425898 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m09:51:23.426320 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:51:23.426607 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:51:23.426952 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:51:23.427469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m09:51:23.427786 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:51:23.429781 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:51:23.430259 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:51:23.432266 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:51:23.432694 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:51:23.432942 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:51:23.433143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.433874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.434099 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:51:23.434326 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:51:23.435876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.437031 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:51:23.437343 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:51:23.438181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.439180 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:51:23.439489 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:51:23.441137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.444768 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:51:23.445110 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:51:23.445861 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.447670 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:51:23.447934 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:51:23.448735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.449613 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:51:23.449861 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:51:23.450066 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:51:23.456234 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.458276 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:51:23.458601 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:51:23.464107 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:51:23.465535 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:51:23.466515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f5e2bcd70>]}
[0m09:51:23.467218 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m09:51:23.467899 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:51:23.468176 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:51:23.468504 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:51:23.468869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:51:23.469175 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:51:23.471218 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:51:23.471920 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:51:23.473934 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:51:23.474405 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:51:23.474649 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:51:23.474843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.475732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.475986 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:51:23.476193 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:51:23.477785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.478538 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:51:23.478804 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:51:23.479526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.480582 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:51:23.480829 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:51:23.481888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.484174 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:51:23.484441 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:51:23.485241 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.487225 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:51:23.487561 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:51:23.488756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.490199 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:51:23.490601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:51:23.490944 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:51:23.497143 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.498659 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:51:23.498908 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:51:23.504892 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.506490 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:51:23.507482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f5e24a330>]}
[0m09:51:23.508015 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m09:51:23.508431 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:51:23.509616 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:51:23.509978 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:51:23.510316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m09:51:23.510580 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:51:23.512773 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:51:23.513198 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:51:23.514977 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:51:23.515435 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:51:23.515687 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:51:23.515905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.516654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.516917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:51:23.517190 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt'
            when 's' then 'suspended'
            else null end as availability_status,
        availability_details,


        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored/expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted/expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted)/(expected_goals_scored + expected_goals_assisted) as goals_assisted_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m09:51:23.530964 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:51:23.532136 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:51:23.532458 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:51:23.533506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.534551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:51:23.534818 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:51:23.536158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.538329 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:51:23.538590 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m09:51:23.539285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.542254 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:51:23.542506 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m09:51:23.543119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.544030 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:51:23.544285 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:51:23.544508 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:51:23.551289 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.553141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:51:23.553430 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m09:51:23.558066 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:51:23.559605 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:51:23.560357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f5e2cfbf0>]}
[0m09:51:23.560772 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m09:51:23.561204 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:51:23.562329 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:51:23.562860 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m09:51:23.563470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.obt_players)
[0m09:51:23.563753 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m09:51:23.565700 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m09:51:23.566843 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m09:51:23.568949 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m09:51:23.569412 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:51:23.569656 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m09:51:23.569871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.571006 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.571446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:51:23.571798 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m09:51:23.576119 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:51:23.576947 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:51:23.577195 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:51:23.577905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.578756 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:51:23.579017 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:51:23.580033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:51:23.581920 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:51:23.582183 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m09:51:23.582866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.584773 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:51:23.585041 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m09:51:23.585718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:23.586612 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:51:23.586890 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:51:23.587114 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:51:23.593189 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:51:23.594669 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:51:23.594921 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m09:51:23.600232 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:51:23.601843 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m09:51:23.603703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af4146f-15df-4294-b70a-d6fe9f2d0737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f5e249070>]}
[0m09:51:23.604250 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m09:51:23.604703 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:51:23.606215 [debug] [MainThread]: Using duckdb connection "master"
[0m09:51:23.606473 [debug] [MainThread]: On master: BEGIN
[0m09:51:23.606658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:23.607349 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:51:23.607611 [debug] [MainThread]: On master: COMMIT
[0m09:51:23.607815 [debug] [MainThread]: Using duckdb connection "master"
[0m09:51:23.607991 [debug] [MainThread]: On master: COMMIT
[0m09:51:23.608429 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:51:23.608651 [debug] [MainThread]: On master: Close
[0m09:51:23.608974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:23.609202 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m09:51:23.609461 [info ] [MainThread]: 
[0m09:51:23.609709 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m09:51:23.610715 [debug] [MainThread]: Command end result
[0m09:51:23.623099 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:51:23.624406 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:51:23.628633 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:51:23.628910 [info ] [MainThread]: 
[0m09:51:23.629223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:51:23.629458 [info ] [MainThread]: 
[0m09:51:23.629713 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:51:23.631414 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5711334, "process_in_blocks": "105472", "process_kernel_time": 0.43157, "process_mem_max_rss": "168188", "process_out_blocks": "4176", "process_user_time": 2.715125}
[0m09:51:23.631851 [debug] [MainThread]: Command `dbt build` succeeded at 09:51:23.631761 after 1.57 seconds
[0m09:51:23.632146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f9e431d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f9200fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760f9c23b6e0>]}
[0m09:51:23.632407 [debug] [MainThread]: Flushing usage events
[0m09:51:24.181164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:06.484060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d31863020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d31cc0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d31861a30>]}


============================== 09:53:06.487397 | 1b4f074d-b36b-40eb-9289-a5c9579e808b ==============================
[0m09:53:06.487397 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:53:06.487801 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'invocation_command': 'dbt build', 'log_format': 'default', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/home/robgriffin247/fpl/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True'}
[0m09:53:06.684442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d30cfc170>]}
[0m09:53:06.741336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d31bdb9e0>]}
[0m09:53:06.743761 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m09:53:06.795719 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m09:53:06.891423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:06.891899 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m09:53:07.144852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d241e9370>]}
[0m09:53:07.183401 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:53:07.185040 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:53:07.251605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d26bdf7d0>]}
[0m09:53:07.252002 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m09:53:07.253559 [info ] [MainThread]: 
[0m09:53:07.253851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:07.254074 [info ] [MainThread]: 
[0m09:53:07.254430 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:53:07.258441 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m09:53:07.285144 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:53:07.285485 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:53:07.285686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:07.306166 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m09:53:07.307239 [debug] [ThreadPool]: On list_analytics: Close
[0m09:53:07.310110 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:53:07.310391 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:53:07.310630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.311630 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:53:07.312434 [debug] [ThreadPool]: On list_analytics: Close
[0m09:53:07.313682 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m09:53:07.313917 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m09:53:07.314123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.315239 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:53:07.316442 [debug] [ThreadPool]: On list_analytics: Close
[0m09:53:07.317226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m09:53:07.317509 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m09:53:07.321679 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:53:07.321948 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:53:07.322114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.323155 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:53:07.323974 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:53:07.324174 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m09:53:07.324599 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.324778 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:53:07.324920 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m09:53:07.325297 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.325786 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:53:07.325963 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m09:53:07.326104 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m09:53:07.326452 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.326633 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m09:53:07.327044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m09:53:07.327358 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m09:53:07.328414 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:53:07.328709 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:53:07.328917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.329684 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:53:07.330412 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:53:07.330599 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m09:53:07.330951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.331144 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:53:07.331286 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m09:53:07.331648 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.332164 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:53:07.332362 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m09:53:07.332512 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m09:53:07.332846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.333045 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m09:53:07.333443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m09:53:07.333726 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m09:53:07.334693 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:53:07.334926 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m09:53:07.335126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.335938 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:53:07.336701 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:53:07.336893 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m09:53:07.337293 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.337482 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:53:07.337625 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m09:53:07.338072 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.338611 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:53:07.338797 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m09:53:07.338935 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m09:53:07.339273 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.339472 [debug] [ThreadPool]: On create_analytics_core: Close
[0m09:53:07.340965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m09:53:07.344552 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:53:07.344769 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:53:07.344955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.345477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:53:07.345663 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m09:53:07.345818 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m09:53:07.353637 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:53:07.354817 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:53:07.357094 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m09:53:07.357407 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:53:07.358035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m09:53:07.359367 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:53:07.359625 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m09:53:07.359820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.361615 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:53:07.361893 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m09:53:07.362075 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m09:53:07.364745 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:53:07.365738 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m09:53:07.366289 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m09:53:07.366479 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m09:53:07.366934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m09:53:07.368230 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:53:07.368561 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m09:53:07.368778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.369951 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:53:07.370155 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m09:53:07.370312 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m09:53:07.372872 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:53:07.373763 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m09:53:07.374274 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m09:53:07.374459 [debug] [ThreadPool]: On list_analytics_core: Close
[0m09:53:07.375544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceefdad50>]}
[0m09:53:07.375895 [debug] [MainThread]: Using duckdb connection "master"
[0m09:53:07.376087 [debug] [MainThread]: On master: BEGIN
[0m09:53:07.376276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:07.376809 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:53:07.377004 [debug] [MainThread]: On master: COMMIT
[0m09:53:07.377188 [debug] [MainThread]: Using duckdb connection "master"
[0m09:53:07.377333 [debug] [MainThread]: On master: COMMIT
[0m09:53:07.377710 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:53:07.377910 [debug] [MainThread]: On master: Close
[0m09:53:07.382409 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m09:53:07.382893 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m09:53:07.383264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m09:53:07.383512 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m09:53:07.388180 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.388745 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m09:53:07.410337 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.411501 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.411773 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m09:53:07.411964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.412649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.412885 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.413139 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m09:53:07.415679 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:53:07.419097 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.419377 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:53:07.420089 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.420890 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.421114 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m09:53:07.422218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.425957 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.426195 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m09:53:07.427410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.429051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.429313 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m09:53:07.429887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.439644 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:53:07.439958 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.440212 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m09:53:07.445940 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:53:07.449632 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m09:53:07.449918 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m09:53:07.455042 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:53:07.457176 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m09:53:07.459014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceefb1bb0>]}
[0m09:53:07.459527 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.07s]
[0m09:53:07.459955 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m09:53:07.460266 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m09:53:07.460650 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m09:53:07.461033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m09:53:07.461417 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m09:53:07.463535 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m09:53:07.464185 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m09:53:07.466039 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m09:53:07.466446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:53:07.466673 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m09:53:07.466860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.467587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.467827 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:53:07.468102 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m09:53:07.475098 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:53:07.476108 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:53:07.476409 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:53:07.477214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.478082 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:53:07.478326 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m09:53:07.479480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.481873 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:53:07.482134 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m09:53:07.482736 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.484272 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:53:07.484527 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m09:53:07.485049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.485826 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:53:07.486039 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:53:07.486215 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m09:53:07.492543 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:53:07.494255 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m09:53:07.494523 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m09:53:07.499442 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:53:07.500680 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m09:53:07.501368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceee5afc0>]}
[0m09:53:07.501823 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m09:53:07.502222 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m09:53:07.502504 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m09:53:07.502994 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m09:53:07.503392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m09:53:07.503639 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m09:53:07.505583 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m09:53:07.506019 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m09:53:07.509071 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m09:53:07.509495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:53:07.509789 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m09:53:07.509994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.510962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.511464 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:53:07.511760 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m09:53:07.513795 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:53:07.514569 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:53:07.514800 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:53:07.515526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.516391 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:53:07.516631 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m09:53:07.517499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.519365 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:53:07.519661 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m09:53:07.520291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.521978 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:53:07.522225 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m09:53:07.522752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.523596 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:53:07.523830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:53:07.524019 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m09:53:07.529945 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:53:07.531599 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m09:53:07.531860 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m09:53:07.536860 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:53:07.538373 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m09:53:07.539079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceee52a50>]}
[0m09:53:07.539673 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m09:53:07.540378 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m09:53:07.540677 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m09:53:07.540994 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m09:53:07.541867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m09:53:07.542134 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m09:53:07.544034 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m09:53:07.544565 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m09:53:07.546293 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m09:53:07.546702 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:53:07.546934 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m09:53:07.547120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.547821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.548032 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:53:07.548225 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m09:53:07.550209 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:53:07.551001 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:53:07.551255 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:53:07.551961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.552848 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:53:07.553087 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m09:53:07.554213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.556830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:53:07.557144 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m09:53:07.557860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.559671 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:53:07.559917 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m09:53:07.560626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.561455 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:53:07.561695 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:53:07.561895 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m09:53:07.566567 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:53:07.568035 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m09:53:07.568341 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m09:53:07.572791 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:53:07.573967 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m09:53:07.574719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceeea9e20>]}
[0m09:53:07.575147 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.03s]
[0m09:53:07.575556 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m09:53:07.575824 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m09:53:07.576634 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m09:53:07.577205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m09:53:07.577458 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m09:53:07.579366 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m09:53:07.579884 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m09:53:07.582789 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m09:53:07.583206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:53:07.583432 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m09:53:07.583624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.584373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.584615 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:53:07.584821 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m09:53:07.586435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.587163 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:53:07.587398 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:53:07.588073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.589007 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:53:07.589246 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m09:53:07.590415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.592472 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:53:07.592726 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m09:53:07.593277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.594883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:53:07.595114 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m09:53:07.595635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.596551 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:53:07.596817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:53:07.597021 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m09:53:07.602287 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:53:07.603912 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m09:53:07.604181 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m09:53:07.609937 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:53:07.611130 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m09:53:07.611761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceeebd5b0>]}
[0m09:53:07.612230 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.03s]
[0m09:53:07.612711 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m09:53:07.612994 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m09:53:07.613726 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m09:53:07.614131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m09:53:07.614357 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m09:53:07.616182 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m09:53:07.616670 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m09:53:07.618441 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m09:53:07.618849 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:53:07.619099 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m09:53:07.619307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.619976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.620203 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:53:07.620513 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m09:53:07.621878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.622882 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:53:07.623195 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:53:07.623964 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.624876 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:53:07.625125 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m09:53:07.625979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.627929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:53:07.628178 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m09:53:07.628757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.630315 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:53:07.630533 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m09:53:07.630999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.631775 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:53:07.631988 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:53:07.632184 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m09:53:07.637163 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:53:07.638902 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m09:53:07.639164 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m09:53:07.643911 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:53:07.645184 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m09:53:07.645719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d26bc6cf0>]}
[0m09:53:07.646172 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m09:53:07.646619 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m09:53:07.646885 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m09:53:07.647441 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m09:53:07.647832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m09:53:07.648066 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m09:53:07.649833 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m09:53:07.650243 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m09:53:07.652021 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m09:53:07.652488 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:53:07.652723 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m09:53:07.652920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.653798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.654036 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:53:07.654291 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m09:53:07.655523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.656267 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:53:07.656515 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:53:07.657347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.658631 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:53:07.659048 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m09:53:07.660481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.663274 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:53:07.663516 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m09:53:07.664142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.665624 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:53:07.665851 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m09:53:07.666325 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.667034 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:53:07.667246 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:53:07.667423 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m09:53:07.673085 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:53:07.674781 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m09:53:07.675048 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m09:53:07.679622 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:53:07.681020 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m09:53:07.681688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceeed9a60>]}
[0m09:53:07.682111 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.03s]
[0m09:53:07.682486 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m09:53:07.682768 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m09:53:07.683093 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m09:53:07.683422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m09:53:07.683734 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m09:53:07.685701 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m09:53:07.686303 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m09:53:07.688145 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m09:53:07.688645 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:53:07.688874 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m09:53:07.689066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.689758 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.689977 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:53:07.690170 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m09:53:07.691605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.692701 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:53:07.693150 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:53:07.694368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.695716 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:53:07.695986 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m09:53:07.697202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.699898 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:53:07.700372 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m09:53:07.701585 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.703485 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:53:07.703745 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m09:53:07.704579 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.705520 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:53:07.705764 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:53:07.705954 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m09:53:07.712781 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:53:07.714309 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m09:53:07.714553 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m09:53:07.721039 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:53:07.722763 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m09:53:07.723581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceee91c40>]}
[0m09:53:07.724246 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m09:53:07.724954 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m09:53:07.725971 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m09:53:07.726458 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m09:53:07.727051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m09:53:07.727312 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m09:53:07.730075 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m09:53:07.730647 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m09:53:07.732818 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m09:53:07.733453 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:53:07.733693 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m09:53:07.733886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.734595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.734810 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:53:07.735027 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt'
            when 's' then 'suspended'
            else null end as availability_status,
        availability_details,


        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored/expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted/expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted)/(expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m09:53:07.746474 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:53:07.747761 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:53:07.748060 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:53:07.749315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.750198 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:53:07.750441 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m09:53:07.751311 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.753296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:53:07.753614 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m09:53:07.754166 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.756754 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:53:07.756986 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m09:53:07.757696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.758963 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:53:07.759392 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:53:07.759728 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m09:53:07.767300 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:53:07.768886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m09:53:07.769146 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m09:53:07.773814 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:53:07.775115 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m09:53:07.776099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceeeeb500>]}
[0m09:53:07.776616 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m09:53:07.777039 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m09:53:07.777921 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m09:53:07.778841 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m09:53:07.779294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.obt_players)
[0m09:53:07.779591 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m09:53:07.781573 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m09:53:07.782398 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m09:53:07.784168 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m09:53:07.784656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:53:07.784884 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m09:53:07.785078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.785786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.786033 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:53:07.786243 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m09:53:07.789498 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:53:07.790247 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:53:07.790486 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:53:07.791432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.792602 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:53:07.792868 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m09:53:07.793688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.795686 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:53:07.796080 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m09:53:07.797196 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:53:07.799143 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:53:07.799393 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m09:53:07.800229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:53:07.801229 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:53:07.801477 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:53:07.801667 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m09:53:07.807674 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:53:07.809365 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m09:53:07.809641 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m09:53:07.815036 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:53:07.816137 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m09:53:07.817150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f074d-b36b-40eb-9289-a5c9579e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783ceee66ab0>]}
[0m09:53:07.817599 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m09:53:07.817991 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m09:53:07.819217 [debug] [MainThread]: Using duckdb connection "master"
[0m09:53:07.819460 [debug] [MainThread]: On master: BEGIN
[0m09:53:07.819635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:07.820480 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:53:07.820786 [debug] [MainThread]: On master: COMMIT
[0m09:53:07.821088 [debug] [MainThread]: Using duckdb connection "master"
[0m09:53:07.821289 [debug] [MainThread]: On master: COMMIT
[0m09:53:07.821722 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:53:07.821927 [debug] [MainThread]: On master: Close
[0m09:53:07.822231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:07.822420 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m09:53:07.822655 [info ] [MainThread]: 
[0m09:53:07.822902 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m09:53:07.823917 [debug] [MainThread]: Command end result
[0m09:53:07.835886 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m09:53:07.837247 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m09:53:07.841358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m09:53:07.841605 [info ] [MainThread]: 
[0m09:53:07.841835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:07.842087 [info ] [MainThread]: 
[0m09:53:07.842354 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:53:07.843990 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.4121757, "process_in_blocks": "95640", "process_kernel_time": 0.340267, "process_mem_max_rss": "168096", "process_out_blocks": "4192", "process_user_time": 2.454178}
[0m09:53:07.844503 [debug] [MainThread]: Command `dbt build` succeeded at 09:53:07.844377 after 1.41 seconds
[0m09:53:07.844803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d31603c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d310d39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d310d3aa0>]}
[0m09:53:07.845050 [debug] [MainThread]: Flushing usage events
[0m09:53:08.382839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:42:11.315076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4135863140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4134f50e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4135152ae0>]}


============================== 10:42:11.319051 | a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab ==============================
[0m10:42:11.319051 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:42:11.319519 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m10:42:11.541217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4134e11880>]}
[0m10:42:11.604449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41358f3260>]}
[0m10:42:11.606934 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:42:11.660205 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:42:11.765905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:11.766267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:11.791345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4134a13b30>]}
[0m10:42:11.837112 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:42:11.839695 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:42:11.871478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c412a907a40>]}
[0m10:42:11.871873 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m10:42:11.873480 [info ] [MainThread]: 
[0m10:42:11.873798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:42:11.874015 [info ] [MainThread]: 
[0m10:42:11.874374 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:42:11.878166 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:42:11.909099 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:42:11.909439 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:42:11.909639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:11.941328 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m10:42:11.942462 [debug] [ThreadPool]: On list_analytics: Close
[0m10:42:11.944329 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:42:11.944736 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:42:11.945126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:11.946861 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:42:11.947849 [debug] [ThreadPool]: On list_analytics: Close
[0m10:42:11.949384 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:42:11.949813 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:42:11.950015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:11.951350 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:11.952288 [debug] [ThreadPool]: On list_analytics: Close
[0m10:42:11.952995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m10:42:11.953330 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:42:11.957678 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:42:11.957996 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:42:11.958249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:11.959431 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:11.961094 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:42:11.961391 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:42:11.962164 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:11.962531 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:42:11.962779 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:42:11.963235 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:11.963769 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:42:11.963967 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:42:11.964160 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:42:11.964783 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:11.964989 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:42:11.965457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m10:42:11.965773 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:42:11.966930 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:42:11.967175 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:42:11.967431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:11.968320 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:11.969147 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:42:11.969347 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:42:11.969796 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:11.969985 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:42:11.970142 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:42:11.970566 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:11.971116 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:42:11.971311 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:42:11.971465 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:42:11.972006 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:11.972203 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:42:11.972659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m10:42:11.972985 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:42:11.974187 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:42:11.974607 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:42:11.974885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:11.976843 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:42:11.977876 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:42:11.978141 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:42:11.979033 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:11.979314 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:42:11.979491 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:42:11.980079 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:11.980663 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:42:11.980862 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:42:11.981019 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:42:11.981571 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:11.981967 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:42:11.983632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m10:42:11.987260 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:42:11.987562 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:42:11.987733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:11.988687 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:11.989073 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:42:11.989397 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:42:11.998253 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m10:42:11.999393 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:42:12.001851 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:42:12.002105 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:42:12.002684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m10:42:12.004388 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:42:12.004635 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:42:12.004797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.005451 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:12.005709 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:42:12.005935 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:42:12.009437 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:42:12.010565 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:42:12.011317 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:42:12.011526 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:42:12.012073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m10:42:12.013439 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:42:12.013644 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:42:12.013797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.014453 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:12.014660 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:42:12.014828 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:42:12.017954 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:42:12.019095 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:42:12.019714 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:42:12.019940 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:42:12.021455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c412adc8ec0>]}
[0m10:42:12.021881 [debug] [MainThread]: Using duckdb connection "master"
[0m10:42:12.022094 [debug] [MainThread]: On master: BEGIN
[0m10:42:12.022255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:12.023229 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:42:12.023508 [debug] [MainThread]: On master: COMMIT
[0m10:42:12.023702 [debug] [MainThread]: Using duckdb connection "master"
[0m10:42:12.023866 [debug] [MainThread]: On master: COMMIT
[0m10:42:12.024317 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:42:12.024556 [debug] [MainThread]: On master: Close
[0m10:42:12.027771 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:42:12.028223 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:42:12.028612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_gameweeks)
[0m10:42:12.028837 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:42:12.034775 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.035399 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:42:12.057614 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.058278 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.058602 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:42:12.058821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.059987 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.060272 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.060485 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:42:12.063552 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:42:12.067425 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.067824 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:42:12.068917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.069892 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.070172 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:42:12.071888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.076433 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.076788 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:42:12.078229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.080141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.080432 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:42:12.081203 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.091627 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:42:12.092008 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.092255 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:42:12.098058 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.102062 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.102424 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:42:12.108617 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.110558 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:42:12.113209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41371ea990>]}
[0m10:42:12.114022 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m10:42:12.114538 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:42:12.114943 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:42:12.115315 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m10:42:12.115734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:42:12.116009 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:42:12.118447 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:42:12.119686 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:42:12.121536 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:42:12.121973 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.122181 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:42:12.122402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.123140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.123334 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.123535 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:42:12.132850 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:42:12.133815 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.134115 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:42:12.135275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.136277 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.136517 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:42:12.137923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.140256 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.140531 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:42:12.141305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.143397 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.143771 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:42:12.144994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.146168 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:42:12.146528 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.146815 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:42:12.154121 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.156702 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.156997 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:42:12.163288 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.164794 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:42:12.165624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41285f6000>]}
[0m10:42:12.166209 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m10:42:12.166950 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:42:12.167404 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:42:12.167869 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m10:42:12.168515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:42:12.168765 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:42:12.222012 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:42:12.222676 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:42:12.224662 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:42:12.225170 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.225427 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:42:12.225631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.226468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.226743 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.226943 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:42:12.229035 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.229818 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.230063 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:42:12.230839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.231723 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.231968 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:42:12.232915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.235093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.235570 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:42:12.236515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.238404 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.238743 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:42:12.239563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.240592 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:42:12.240896 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.241110 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:42:12.248113 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.249942 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.250299 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:42:12.256081 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:42:12.257709 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:42:12.259220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41349c5a90>]}
[0m10:42:12.259744 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.09s]
[0m10:42:12.260178 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:42:12.260493 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:42:12.261104 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m10:42:12.261539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:42:12.261789 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:42:12.263748 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:42:12.264215 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:42:12.266197 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:42:12.266905 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.267184 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:42:12.267386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.268665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.269057 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.269281 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:42:12.271867 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.272894 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.273168 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:42:12.274005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.274893 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.275154 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:42:12.276240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.278387 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.278710 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:42:12.279379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.281121 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.281400 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:42:12.282301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.283371 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:42:12.283718 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.283979 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:42:12.289536 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:42:12.291402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.291703 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:42:12.296906 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:42:12.298199 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:42:12.298846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41285c69f0>]}
[0m10:42:12.299383 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m10:42:12.299847 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:42:12.300159 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:42:12.300494 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m10:42:12.300942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:42:12.301512 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:42:12.305018 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:42:12.305627 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:42:12.307595 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:42:12.308082 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.308323 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:42:12.308519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.309279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.309511 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.309719 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:42:12.312048 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.312911 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.313182 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:42:12.313961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.314922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.315237 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:42:12.316628 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.319291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.319667 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:42:12.320587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.322653 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.322957 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:42:12.323980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.325368 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:42:12.325712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.325929 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:42:12.332016 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.333902 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.334240 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:42:12.340715 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.342148 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:42:12.342932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41285afcb0>]}
[0m10:42:12.343476 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m10:42:12.343909 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:42:12.344231 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:42:12.344575 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:42:12.344987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m10:42:12.345500 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:42:12.347911 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:42:12.348939 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:42:12.351649 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:42:12.352687 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.353040 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:42:12.353247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.354093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.354374 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.354610 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:42:12.356407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.357376 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.357657 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:42:12.358520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.359443 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.359700 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:42:12.360842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.363563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.363856 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:42:12.364569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.366407 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.366878 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:42:12.368171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.369436 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:42:12.369753 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.369967 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:42:12.376241 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.378057 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.378338 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:42:12.383447 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:42:12.385062 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:42:12.386013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41286a5d30>]}
[0m10:42:12.386589 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m10:42:12.387187 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:42:12.387586 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:42:12.388166 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:42:12.388901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:42:12.389171 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:42:12.391288 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:42:12.391789 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:42:12.394987 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:42:12.395540 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.395794 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:42:12.395991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.396773 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.397012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.397241 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:42:12.398583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.399455 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.399735 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:42:12.400957 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.402270 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.402662 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:42:12.404027 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.406276 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.406552 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:42:12.407252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.409015 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.409264 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:42:12.409838 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.410790 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:42:12.411057 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.411269 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:42:12.416995 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:42:12.419059 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.419463 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:42:12.424785 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:42:12.426189 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:42:12.426827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41285d3200>]}
[0m10:42:12.427304 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m10:42:12.427701 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:42:12.427979 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:42:12.428398 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m10:42:12.428751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:42:12.428995 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:42:12.430883 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:42:12.431351 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:42:12.433288 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:42:12.433823 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.434119 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:42:12.434344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.435506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.435886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.436116 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:42:12.437953 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.438849 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.439129 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:42:12.440098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.441094 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.441370 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:42:12.442286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.444265 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.444508 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:42:12.445288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.447859 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.448208 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:42:12.449050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.450267 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:42:12.450715 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.450989 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:42:12.457726 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.459555 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.459846 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:42:12.466563 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.469098 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:42:12.469776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41348993d0>]}
[0m10:42:12.470282 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m10:42:12.470731 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:42:12.471903 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:42:12.472368 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m10:42:12.472819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m10:42:12.473109 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:42:12.475730 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:42:12.476477 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:42:12.479968 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:42:12.480531 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:42:12.480820 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:42:12.481060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.482346 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.482778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:42:12.483090 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt'
            when 's' then 'suspended'
            else null end as availability_status,
        availability_details,


        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored/expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted/expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted)/(expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m10:42:12.499950 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:42:12.501071 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:42:12.501422 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:42:12.503342 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.504590 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:42:12.504935 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:42:12.506321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.508372 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:42:12.508618 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:42:12.509460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.511155 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:42:12.511396 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:42:12.511949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.512842 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:42:12.513121 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:42:12.513317 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:42:12.521340 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:42:12.523166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:42:12.523457 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:42:12.529135 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:42:12.530380 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:42:12.531753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c412869d1c0>]}
[0m10:42:12.532293 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.06s]
[0m10:42:12.532773 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:42:12.533959 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:42:12.534590 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m10:42:12.535119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.obt_players)
[0m10:42:12.535483 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:42:12.537960 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:42:12.539562 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:42:12.541674 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:42:12.542201 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:42:12.542457 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:42:12.542655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.543614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.543885 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:42:12.544069 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m10:42:12.548347 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:42:12.549297 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:42:12.549573 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:42:12.550898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.552141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:42:12.552510 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:42:12.553793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.555870 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:42:12.556127 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:42:12.556743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.558381 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:42:12.558622 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:42:12.559316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.560195 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:42:12.560426 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:42:12.560630 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:42:12.567121 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.569137 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:42:12.569486 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:42:12.575324 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:42:12.576647 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:42:12.577373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0bac8ef-1b29-446e-bbf5-88bc7a0f6aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41347a2c30>]}
[0m10:42:12.577852 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m10:42:12.578271 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:42:12.579694 [debug] [MainThread]: Using duckdb connection "master"
[0m10:42:12.579966 [debug] [MainThread]: On master: BEGIN
[0m10:42:12.580173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:12.581215 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:42:12.581499 [debug] [MainThread]: On master: COMMIT
[0m10:42:12.581705 [debug] [MainThread]: Using duckdb connection "master"
[0m10:42:12.581883 [debug] [MainThread]: On master: COMMIT
[0m10:42:12.582564 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:42:12.583011 [debug] [MainThread]: On master: Close
[0m10:42:12.583473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:12.583687 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:42:12.583962 [info ] [MainThread]: 
[0m10:42:12.584280 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m10:42:12.585552 [debug] [MainThread]: Command end result
[0m10:42:12.598954 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:42:12.600765 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:42:12.605603 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:42:12.605918 [info ] [MainThread]: 
[0m10:42:12.606236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:12.606471 [info ] [MainThread]: 
[0m10:42:12.606755 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m10:42:12.608120 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3438126, "process_in_blocks": "104840", "process_kernel_time": 0.421106, "process_mem_max_rss": "164328", "process_out_blocks": "3224", "process_user_time": 2.535411}
[0m10:42:12.608489 [debug] [MainThread]: Command `dbt build` succeeded at 10:42:12.608410 after 1.34 seconds
[0m10:42:12.608845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4135184680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4135862d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4135861dc0>]}
[0m10:42:12.609095 [debug] [MainThread]: Flushing usage events
[0m10:42:13.280239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:43:58.235201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8e927ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8e92b6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8e96a2060>]}


============================== 10:43:58.238847 | c78fd4b9-fc47-45ca-aece-dae4bdec4266 ==============================
[0m10:43:58.238847 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:43:58.239248 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'invocation_command': 'dbt build', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/home/robgriffin247/fpl/logs', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:58.449854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8eb32baa0>]}
[0m10:43:58.505868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8e8a23020>]}
[0m10:43:58.509773 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:43:58.558088 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:43:58.649001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:43:58.649460 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:43:58.905031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8de7d5b50>]}
[0m10:43:58.945034 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:43:58.947036 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:43:59.014357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8de8b2e10>]}
[0m10:43:59.014706 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m10:43:59.016256 [info ] [MainThread]: 
[0m10:43:59.016546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:59.016754 [info ] [MainThread]: 
[0m10:43:59.017109 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:43:59.020956 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:43:59.048633 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:43:59.048964 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:43:59.049164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:59.077074 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m10:43:59.078104 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:59.080715 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:43:59.081143 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:43:59.081366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:59.082333 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:59.083216 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:59.084645 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:43:59.084897 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:43:59.085248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:59.086105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:59.086814 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:59.087408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m10:43:59.087711 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:43:59.091833 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:59.092074 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:43:59.092261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:59.093194 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:59.093979 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:59.094180 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:43:59.094608 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:59.094794 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:59.094943 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:43:59.095374 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:59.095871 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:43:59.096123 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:59.096294 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:43:59.096742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:59.096948 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:43:59.097411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m10:43:59.098119 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:43:59.099232 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:59.099491 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:43:59.099666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:59.100767 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:59.101592 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:59.101795 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:43:59.102213 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:59.102425 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:59.102594 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:43:59.103018 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:59.103557 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:43:59.103743 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:59.103891 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:43:59.104292 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:59.104505 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:43:59.104934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m10:43:59.105251 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:43:59.106418 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:59.106644 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:43:59.106811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:59.107555 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:59.108340 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:59.108563 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:43:59.108951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:59.109132 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:59.109285 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:43:59.109674 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:59.110189 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:43:59.110369 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:59.110524 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:43:59.110876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:59.111072 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:43:59.112875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_intermediate)
[0m10:43:59.116890 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:43:59.117152 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:43:59.117339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:59.117983 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:59.118186 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:43:59.118373 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:43:59.126036 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m10:43:59.126969 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:43:59.128765 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:43:59.128978 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:43:59.129484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m10:43:59.130629 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:43:59.130868 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:43:59.131032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:59.132248 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:59.132436 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:43:59.132587 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:43:59.135089 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:59.135995 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:43:59.136547 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:43:59.136725 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:43:59.137137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m10:43:59.138179 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:43:59.138409 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:43:59.138603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:59.139583 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:59.139796 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:43:59.139964 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:43:59.142301 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:59.143319 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:43:59.143898 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:43:59.144138 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:43:59.144959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8becaf320>]}
[0m10:43:59.145259 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:59.145431 [debug] [MainThread]: On master: BEGIN
[0m10:43:59.145602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:59.146152 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:59.146334 [debug] [MainThread]: On master: COMMIT
[0m10:43:59.146505 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:59.146647 [debug] [MainThread]: On master: COMMIT
[0m10:43:59.147012 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:43:59.147196 [debug] [MainThread]: On master: Close
[0m10:43:59.150209 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:43:59.150575 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:43:59.150896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m10:43:59.151147 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:43:59.156075 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.156553 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:43:59.177379 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.178000 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.178259 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:43:59.178451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.179254 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.179497 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.179682 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:43:59.182316 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:59.185777 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.186037 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:43:59.186793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.187624 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.187867 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:43:59.188767 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.192795 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.193064 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:43:59.194497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.196681 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.196930 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:43:59.197655 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.207572 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:43:59.207899 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.208135 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:43:59.213821 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:59.217344 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:59.217603 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:43:59.222017 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:43:59.224420 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:43:59.226081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8e9810d70>]}
[0m10:43:59.226512 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.07s]
[0m10:43:59.226912 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:43:59.227189 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:43:59.227495 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m10:43:59.227870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:43:59.228165 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:43:59.230146 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:43:59.230931 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:43:59.232749 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:43:59.233155 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:59.233371 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:43:59.233548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.234220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.234501 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:59.234745 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:43:59.241787 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:59.242677 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:59.242939 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:43:59.243723 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.244568 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:59.244825 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:43:59.245890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.248623 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:59.248884 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:43:59.249436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.251111 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:59.251356 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:43:59.251951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.252888 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:43:59.253131 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:59.253321 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:43:59.259196 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:59.261254 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:59.261605 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:43:59.265917 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:43:59.266844 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:43:59.267423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8beb3d5b0>]}
[0m10:43:59.267897 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m10:43:59.268346 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:43:59.268620 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:43:59.269071 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m10:43:59.269480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:43:59.269701 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:43:59.271571 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:43:59.271999 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:43:59.274857 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:43:59.275267 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:59.275493 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:43:59.275681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.276394 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.276639 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:59.276842 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:43:59.279146 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:59.279926 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:59.280195 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:43:59.281075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.281918 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:59.282150 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:43:59.283277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.285242 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:59.285497 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:43:59.286130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.287633 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:59.287861 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:43:59.288376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.289113 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:43:59.289341 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:59.289579 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:43:59.294756 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:59.296291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:59.296545 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:43:59.300947 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:43:59.302340 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:43:59.303037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8beb8ab10>]}
[0m10:43:59.303614 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.03s]
[0m10:43:59.304280 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:43:59.304573 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:43:59.304911 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m10:43:59.305430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:43:59.305707 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:43:59.307543 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:43:59.308354 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:43:59.310086 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:43:59.310479 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:59.310700 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:43:59.310948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.311820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.312096 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:59.312300 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:43:59.314387 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:59.315251 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:59.315477 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:43:59.316527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.317803 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:59.318321 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:43:59.319445 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.321342 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:59.321587 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:43:59.322163 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.323747 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:59.323972 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:43:59.324480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.325284 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:43:59.325545 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:59.325744 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:43:59.332434 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:59.334142 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:59.334402 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:43:59.339965 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:59.341301 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:43:59.342052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8beb8a690>]}
[0m10:43:59.342452 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m10:43:59.342818 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:43:59.343132 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:43:59.343431 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m10:43:59.343771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:43:59.344116 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:43:59.346013 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:43:59.346662 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:43:59.349779 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:43:59.350237 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:59.350451 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:43:59.350643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.351358 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.351594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:59.351785 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:43:59.354456 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:59.355241 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:59.355474 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:43:59.356288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.357181 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:59.357470 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:43:59.358470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.360942 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:59.361234 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:43:59.361951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.363553 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:59.363810 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:43:59.364603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.365373 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:43:59.365579 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:59.365750 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:43:59.371255 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:59.372872 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:59.373122 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:43:59.377895 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:43:59.379335 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:43:59.380222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8beb3e060>]}
[0m10:43:59.380716 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m10:43:59.381100 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:43:59.381390 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:43:59.381682 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:43:59.382039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m10:43:59.382533 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:43:59.384370 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:43:59.384790 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:43:59.386572 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:43:59.386975 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:59.387253 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:43:59.387456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.388294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.388572 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:59.388769 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:43:59.389689 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.390417 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:59.390642 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:43:59.391539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.392509 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:59.392783 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:43:59.393843 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.396519 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:59.396780 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:43:59.397363 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.398925 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:59.399154 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:43:59.399699 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.400542 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:43:59.400776 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:59.400962 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:43:59.405989 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:59.407804 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:59.408127 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:43:59.412593 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:43:59.413870 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:43:59.414610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8beb63f50>]}
[0m10:43:59.415185 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m10:43:59.415784 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:43:59.416110 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:43:59.416448 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:43:59.416862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:43:59.417095 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:43:59.418806 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:43:59.419247 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:43:59.421114 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:43:59.421536 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:59.421757 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:43:59.421974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.422808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.423021 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:59.423201 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:43:59.424496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.425176 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:59.425381 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:43:59.426023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.426751 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:59.426952 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:43:59.427939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.430892 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:59.431112 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:43:59.431990 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.433882 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:59.434195 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:43:59.434917 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.435865 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:43:59.436174 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:59.436384 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:43:59.442293 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:59.443968 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:59.444263 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:43:59.449260 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:59.450266 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:43:59.450980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8bebb1640>]}
[0m10:43:59.451400 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.03s]
[0m10:43:59.451773 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:43:59.452097 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:43:59.452531 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m10:43:59.452843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:43:59.453048 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:43:59.454858 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:43:59.455253 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:43:59.456964 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:43:59.457360 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:59.457584 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:43:59.457795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.458447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.458655 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:59.458832 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:43:59.460260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.460921 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:59.461125 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:43:59.461836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.462756 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:59.462993 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:43:59.463933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.465716 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:59.465931 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:43:59.466640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.468284 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:59.468524 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:43:59.469393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.470254 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:43:59.470469 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:59.470640 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:43:59.476461 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:59.477881 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:59.478118 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:43:59.483316 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:59.484689 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:43:59.485320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8beb27440>]}
[0m10:43:59.485772 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.03s]
[0m10:43:59.486211 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:43:59.487143 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:43:59.487528 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m10:43:59.488063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.int_players)
[0m10:43:59.488313 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:43:59.490355 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:43:59.490749 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:43:59.492490 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:43:59.492899 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:59.493139 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:43:59.493329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.494046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.494329 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:59.494640 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."staging"."stg_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from join_players
),

derive as (
    select
        player_id,
        display_name,
        team, 
        team_abbreviation,
        position,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'available'
            when 'i' then 'injured'
            when 'd' then 'injury doubt (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'suspended'
            else null end as availability_status,
        availability_details,


        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored/expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted/expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted)/(expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m10:43:59.509780 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m10:43:59.510706 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:59.510955 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:43:59.511728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.512593 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:59.512852 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:43:59.513812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.515877 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:59.516152 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:43:59.516715 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.519344 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:59.519575 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:43:59.520253 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.521039 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:43:59.521262 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:59.521443 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:43:59.527540 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:59.529238 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:59.529499 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:43:59.534680 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:59.536213 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:43:59.537016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8bebc3350>]}
[0m10:43:59.537482 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m10:43:59.537905 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:43:59.538650 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:43:59.539044 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m10:43:59.539538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.obt_players)
[0m10:43:59.539757 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:43:59.541461 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:43:59.542469 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:43:59.544595 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:43:59.545170 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:59.545428 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:43:59.545617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:59.546331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.546552 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:59.546745 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m10:43:59.549916 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:59.550651 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:59.550883 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:43:59.551608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.552456 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:59.552686 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:43:59.553738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.555810 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:59.556109 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:43:59.556780 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:43:59.558357 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:59.558596 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:43:59.559441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:59.560648 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:43:59.560970 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:59.561171 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:43:59.567088 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:59.568636 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:59.568890 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:43:59.573329 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:43:59.574406 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:43:59.575523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c78fd4b9-fc47-45ca-aece-dae4bdec4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8beb3e6c0>]}
[0m10:43:59.576002 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m10:43:59.576497 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:43:59.577787 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:59.578038 [debug] [MainThread]: On master: BEGIN
[0m10:43:59.578211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:59.578966 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:59.579205 [debug] [MainThread]: On master: COMMIT
[0m10:43:59.579400 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:59.579574 [debug] [MainThread]: On master: COMMIT
[0m10:43:59.580121 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:43:59.580336 [debug] [MainThread]: On master: Close
[0m10:43:59.580659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:59.580827 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:43:59.581045 [info ] [MainThread]: 
[0m10:43:59.581291 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m10:43:59.582256 [debug] [MainThread]: Command end result
[0m10:43:59.593768 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:43:59.595057 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:43:59.598874 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:43:59.599109 [info ] [MainThread]: 
[0m10:43:59.599375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:59.599595 [info ] [MainThread]: 
[0m10:43:59.599828 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m10:43:59.601612 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.4167635, "process_in_blocks": "105488", "process_kernel_time": 0.29547, "process_mem_max_rss": "167832", "process_out_blocks": "4184", "process_user_time": 2.56221}
[0m10:43:59.601983 [debug] [MainThread]: Command `dbt build` succeeded at 10:43:59.601910 after 1.42 seconds
[0m10:43:59.602218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8e96eede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8bed98230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a8de9cda00>]}
[0m10:43:59.602454 [debug] [MainThread]: Flushing usage events
[0m10:44:00.110172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:40.565374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8c9084e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8c8aa6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8c89497c0>]}


============================== 10:48:40.570932 | facaa558-d8ff-4d81-a573-758d0826ea2a ==============================
[0m10:48:40.570932 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:48:40.571451 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'invocation_command': 'dbt build', 'log_path': '/home/robgriffin247/fpl/logs', 'profiles_dir': '/home/robgriffin247/fpl', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'version_check': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m10:48:42.360948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8c8b91310>]}
[0m10:48:42.423779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8ca888b60>]}
[0m10:48:42.427647 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:48:42.484049 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:48:42.586940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:48:42.587437 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m10:48:42.587745 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:48:42.856472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8bc9f5550>]}
[0m10:48:42.896366 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:48:42.898062 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:48:42.968317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8bc9b1b20>]}
[0m10:48:42.968675 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m10:48:42.970294 [info ] [MainThread]: 
[0m10:48:42.970659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:42.970925 [info ] [MainThread]: 
[0m10:48:42.971329 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:48:42.975226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:48:43.002880 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:48:43.003199 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:48:43.003404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:43.021711 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:48:43.022784 [debug] [ThreadPool]: On list_analytics: Close
[0m10:48:43.024342 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:48:43.024605 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:48:43.024832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:43.025790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:48:43.026477 [debug] [ThreadPool]: On list_analytics: Close
[0m10:48:43.027677 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:48:43.027920 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:48:43.028126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:43.028991 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:48:43.029700 [debug] [ThreadPool]: On list_analytics: Close
[0m10:48:43.030288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m10:48:43.030606 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:48:43.034620 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:48:43.034844 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:48:43.035010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:43.036112 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:48:43.037191 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:48:43.037402 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:48:43.037820 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.038041 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:48:43.038205 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:48:43.038625 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.039124 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:48:43.039319 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:48:43.039476 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:48:43.039888 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.040173 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:48:43.040632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m10:48:43.040929 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:48:43.041895 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:48:43.042111 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:48:43.042310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:43.043048 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:48:43.043765 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:48:43.043977 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:48:43.044532 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.044724 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:48:43.044870 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:48:43.045233 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.045728 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:48:43.045931 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:48:43.046139 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:48:43.046538 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.046729 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:48:43.047153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m10:48:43.047469 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:48:43.048551 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:48:43.048788 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:48:43.048998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:43.050031 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:48:43.050788 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:48:43.050996 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:48:43.051404 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.051586 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:48:43.051740 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:48:43.052188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.052736 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:48:43.052949 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:48:43.053115 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:48:43.053525 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.053713 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:48:43.055026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m10:48:43.058551 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:48:43.058788 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:48:43.058955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:43.059463 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:48:43.059672 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:48:43.059837 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:48:43.067332 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m10:48:43.068239 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:48:43.069833 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:48:43.070048 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:48:43.070521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m10:48:43.071616 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:48:43.071843 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:48:43.072375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:43.072943 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:48:43.073136 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:48:43.073296 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:48:43.075768 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:48:43.076870 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:48:43.077457 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:48:43.077671 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:48:43.078143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m10:48:43.079276 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:48:43.079512 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:48:43.080315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:43.080896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:48:43.081106 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:48:43.081276 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:48:43.083941 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:48:43.084989 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:48:43.085563 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:48:43.085751 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:48:43.086776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8bcaf69f0>]}
[0m10:48:43.087078 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:43.087258 [debug] [MainThread]: On master: BEGIN
[0m10:48:43.087404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:43.087849 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:48:43.088046 [debug] [MainThread]: On master: COMMIT
[0m10:48:43.088215 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:43.088437 [debug] [MainThread]: On master: COMMIT
[0m10:48:43.088833 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:48:43.089029 [debug] [MainThread]: On master: Close
[0m10:48:43.091711 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:48:43.092114 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:48:43.092519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m10:48:43.092748 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:48:43.097748 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.098506 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:48:43.120946 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.121528 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.121797 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:48:43.122042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.122821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.123087 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.123282 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:48:43.126103 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:48:43.129902 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.130238 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:48:43.131067 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.131924 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.132189 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:48:43.133374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.137490 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.137811 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:48:43.139305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.141451 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.141709 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:48:43.142276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.151910 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:48:43.152255 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.152508 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:48:43.158490 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:48:43.162211 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:48:43.162588 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:48:43.168132 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.169860 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:48:43.171536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8bc9619a0>]}
[0m10:48:43.171959 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m10:48:43.172420 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:48:43.172720 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:48:43.173064 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m10:48:43.173483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:48:43.173768 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:48:43.176131 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:48:43.176659 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:48:43.178492 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:48:43.178929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:48:43.179164 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:48:43.179347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.180262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.180649 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:48:43.180887 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:48:43.187753 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:48:43.188741 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:48:43.189016 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:48:43.190059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.190919 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:48:43.191148 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:48:43.192380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.194283 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:48:43.194520 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:48:43.195076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.196794 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:48:43.197043 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:48:43.197562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.198419 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:48:43.198679 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:48:43.198932 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:48:43.204935 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:48:43.206742 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:48:43.207065 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:48:43.212206 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.213242 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:48:43.213872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8a408cfb0>]}
[0m10:48:43.214301 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m10:48:43.214681 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:48:43.214968 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:48:43.215288 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m10:48:43.215663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:48:43.215924 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:48:43.218706 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:48:43.219416 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:48:43.221187 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:48:43.221583 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:48:43.221797 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:48:43.221982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.222668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.222901 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:48:43.223100 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:48:43.224996 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:48:43.225705 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:48:43.225935 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:48:43.226601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.227392 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:48:43.227616 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:48:43.228711 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.230704 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:48:43.230974 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:48:43.231739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.234164 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:48:43.234671 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:48:43.235464 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.236417 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:48:43.236654 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:48:43.236826 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:48:43.243015 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:48:43.244435 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:48:43.244692 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:48:43.250082 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.251518 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:48:43.252045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8a4091730>]}
[0m10:48:43.252516 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m10:48:43.252898 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:48:43.253171 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:48:43.253462 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m10:48:43.253796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:48:43.254055 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:48:43.256483 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:48:43.256890 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:48:43.258537 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:48:43.258929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:48:43.259177 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:48:43.259365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.260341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.260594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:48:43.260787 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:48:43.262817 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:48:43.263890 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:48:43.264330 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:48:43.265375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.266246 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:48:43.266569 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:48:43.267848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.269776 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:48:43.270014 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:48:43.270548 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.272123 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:48:43.272375 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:48:43.273065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.274077 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:48:43.274309 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:48:43.274491 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:48:43.280313 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.282182 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:48:43.282478 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:48:43.287674 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.288804 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:48:43.289512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8a408e240>]}
[0m10:48:43.289941 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m10:48:43.290311 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:48:43.290571 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:48:43.290910 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m10:48:43.291444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:48:43.291715 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:48:43.293534 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:48:43.293915 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:48:43.296797 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:48:43.297309 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:48:43.297572 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:48:43.297760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.298800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.299176 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:48:43.299382 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:48:43.301429 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:48:43.302115 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:48:43.302333 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:48:43.302973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.303696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:48:43.303902 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:48:43.304827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.306699 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:48:43.306933 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:48:43.307516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.309143 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:48:43.309383 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:48:43.309866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.310673 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:48:43.310901 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:48:43.311088 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:48:43.316645 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.318704 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:48:43.319071 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:48:43.324531 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.325571 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:48:43.326100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8a40ee540>]}
[0m10:48:43.326521 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.03s]
[0m10:48:43.326901 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:48:43.327165 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:48:43.327482 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:48:43.328187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m10:48:43.328507 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:48:43.330851 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:48:43.331259 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:48:43.332981 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:48:43.333397 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:48:43.333641 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:48:43.333838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.334841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.335120 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:48:43.335328 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:48:43.338896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.339788 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:48:43.340045 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:48:43.341077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.341944 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:48:43.342182 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:48:43.343160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.345335 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:48:43.345578 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:48:43.346119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.347608 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:48:43.347826 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:48:43.348382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.349196 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:48:43.349427 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:48:43.349629 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:48:43.354465 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.356705 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:48:43.356978 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:48:43.361531 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:48:43.362729 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:48:43.363244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8a40cf200>]}
[0m10:48:43.363648 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m10:48:43.364039 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:48:43.364345 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:48:43.364665 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m10:48:43.365021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m10:48:43.365335 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:48:43.367176 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:48:43.367598 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:48:43.370467 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:48:43.370984 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:48:43.371279 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:48:43.371514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.372229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.372542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:48:43.372819 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from source
),

derive as (
    select
        player_id,
        display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored/expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted/expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted)/(expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m10:48:43.380634 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:48:43.381869 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:48:43.382138 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:48:43.382879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.383737 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:48:43.383997 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:48:43.385058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.386959 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:48:43.387207 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:48:43.387877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.389792 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:48:43.390044 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:48:43.390669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.391492 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:48:43.391743 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:48:43.391950 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:48:43.398005 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:48:43.399618 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:48:43.399871 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:48:43.405664 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.406711 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:48:43.407534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8a40d18b0>]}
[0m10:48:43.407958 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.04s]
[0m10:48:43.408355 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:48:43.408610 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:48:43.408931 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:48:43.409469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m10:48:43.409707 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:48:43.411396 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:48:43.411778 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:48:43.413587 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:48:43.414074 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:48:43.414316 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:48:43.414518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.415223 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.415452 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:48:43.415651 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:48:43.416867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.417564 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:48:43.417789 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:48:43.418569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.419464 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:48:43.419713 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:48:43.420750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.422791 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:48:43.423056 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:48:43.423754 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.425388 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:48:43.425624 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:48:43.426170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.426989 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:48:43.427226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:48:43.427414 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:48:43.432529 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.434109 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:48:43.434385 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:48:43.440260 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:48:43.441447 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:48:43.441964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8a647dbe0>]}
[0m10:48:43.442367 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.03s]
[0m10:48:43.442812 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:48:43.443112 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:48:43.443443 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m10:48:43.443986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:48:43.444258 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:48:43.445929 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:48:43.446312 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:48:43.448062 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:48:43.448493 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:48:43.448737 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:48:43.448941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.449699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.449922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:48:43.450112 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:48:43.451633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.452408 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:48:43.452637 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:48:43.453282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.454087 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:48:43.454307 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:48:43.455193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.458437 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:48:43.458722 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:48:43.459558 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.461521 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:48:43.461779 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:48:43.462375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:48:43.463205 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:48:43.463461 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:48:43.463651 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:48:43.468597 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.470090 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:48:43.470337 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:48:43.475424 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:48:43.476742 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:48:43.477316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8a40993a0>]}
[0m10:48:43.477732 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.03s]
[0m10:48:43.478099 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:48:43.479084 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:48:43.479470 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m10:48:43.479811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m10:48:43.480082 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:48:43.482512 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:48:43.483397 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:48:43.485147 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:48:43.485572 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:48:43.485794 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:48:43.485984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:43.486667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:48:43.486879 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:48:43.487070 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m10:48:43.491667 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),
players as (
    select *
    from "analytics"."intermediate"."int_players"
)

select * from players
    );
  
  
[0m10:48:43.492053 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:48:43.492546 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: ROLLBACK
[0m10:48:43.498982 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.obt_players'
[0m10:48:43.499298 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:48:43.500893 [debug] [Thread-1 (]: Runtime Error in model obt_players (fpl_analytics/models/core/obt_players.sql)
  Parser Error: Duplicate CTE name "players"
[0m10:48:43.501249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facaa558-d8ff-4d81-a573-758d0826ea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8a409a4b0>]}
[0m10:48:43.501698 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model core.obt_players ....................... [[31mERROR[0m in 0.02s]
[0m10:48:43.502163 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:48:43.502716 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'error'.  Reason: Runtime Error in model obt_players (fpl_analytics/models/core/obt_players.sql)
  Parser Error: Duplicate CTE name "players".
[0m10:48:43.504591 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:43.504885 [debug] [MainThread]: On master: BEGIN
[0m10:48:43.505068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:43.505701 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:48:43.505920 [debug] [MainThread]: On master: COMMIT
[0m10:48:43.506097 [debug] [MainThread]: Using duckdb connection "master"
[0m10:48:43.506261 [debug] [MainThread]: On master: COMMIT
[0m10:48:43.506841 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:48:43.507080 [debug] [MainThread]: On master: Close
[0m10:48:43.507630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:43.507820 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:48:43.508053 [info ] [MainThread]: 
[0m10:48:43.508308 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m10:48:43.509325 [debug] [MainThread]: Command end result
[0m10:48:43.520987 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:48:43.522320 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:48:43.526189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:48:43.526450 [info ] [MainThread]: 
[0m10:48:43.526737 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:48:43.527001 [info ] [MainThread]: 
[0m10:48:43.527328 [error] [MainThread]: [31mFailure in model obt_players (fpl_analytics/models/core/obt_players.sql)[0m
[0m10:48:43.527591 [error] [MainThread]:   Runtime Error in model obt_players (fpl_analytics/models/core/obt_players.sql)
  Parser Error: Duplicate CTE name "players"
[0m10:48:43.527798 [info ] [MainThread]: 
[0m10:48:43.528046 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/core/obt_players.sql
[0m10:48:43.528245 [info ] [MainThread]: 
[0m10:48:43.528512 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m10:48:43.529983 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.451949, "process_in_blocks": "103048", "process_kernel_time": 0.301475, "process_mem_max_rss": "166476", "process_out_blocks": "3888", "process_user_time": 2.549981}
[0m10:48:43.530291 [debug] [MainThread]: Command `dbt build` failed at 10:48:43.530227 after 1.45 seconds
[0m10:48:43.530534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8c81d8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8bc9e49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d8c9052ed0>]}
[0m10:48:43.530761 [debug] [MainThread]: Flushing usage events
[0m10:48:44.065632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:00.349317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb43792570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb44b3be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb43544ce0>]}


============================== 10:49:00.351588 | e83a33cf-0468-4373-9f4d-e47f6bb60568 ==============================
[0m10:49:00.351588 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:49:00.351990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error': 'None', 'log_path': '/home/robgriffin247/fpl/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt build', 'empty': 'False', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m10:49:00.571134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb42cb2780>]}
[0m10:49:00.662164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb44b3aea0>]}
[0m10:49:00.664051 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:49:00.741146 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:49:00.839033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:49:00.839721 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m10:49:01.660741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb42d8ef60>]}
[0m10:49:01.768851 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:49:01.771530 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:49:01.899148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb1b5eb590>]}
[0m10:49:01.900570 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m10:49:01.905510 [info ] [MainThread]: 
[0m10:49:01.906593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:01.907438 [info ] [MainThread]: 
[0m10:49:01.908611 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:49:01.920928 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:49:01.966298 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:49:01.967073 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:49:01.967506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:02.001250 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m10:49:02.003235 [debug] [ThreadPool]: On list_analytics: Close
[0m10:49:02.008446 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:49:02.009235 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:49:02.009639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:02.011428 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:49:02.012981 [debug] [ThreadPool]: On list_analytics: Close
[0m10:49:02.015610 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:49:02.016654 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:49:02.017244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:02.019519 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:49:02.021038 [debug] [ThreadPool]: On list_analytics: Close
[0m10:49:02.022370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m10:49:02.023042 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:49:02.030413 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:49:02.030945 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:49:02.031250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:02.032868 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:49:02.034477 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:49:02.034941 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:49:02.036206 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.036959 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:49:02.037334 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:49:02.038297 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.039315 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:49:02.039740 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:49:02.040051 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:49:02.041238 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.041633 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:49:02.042428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m10:49:02.043006 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:49:02.044861 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:49:02.045467 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:49:02.045824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:02.047338 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.048960 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:49:02.049398 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:49:02.050638 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.050995 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:49:02.051283 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:49:02.052167 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.053148 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:49:02.053466 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:49:02.053759 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:49:02.054363 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:02.054717 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:49:02.055541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m10:49:02.056100 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:49:02.058002 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:49:02.058420 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:49:02.058862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:02.060407 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.061882 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:49:02.062298 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:49:02.063472 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.063914 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:49:02.064269 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:49:02.065200 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.066113 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:49:02.066434 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:49:02.066716 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:49:02.067719 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.068117 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:49:02.070644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m10:49:02.077484 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:49:02.077942 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:49:02.078208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:02.079165 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.079509 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:49:02.079764 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:49:02.091167 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:49:02.093282 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:49:02.094723 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:49:02.095101 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:49:02.096090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m10:49:02.097882 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:49:02.098233 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:49:02.098496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:02.100018 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.100352 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:49:02.100619 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:49:02.104327 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:49:02.105631 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:49:02.106406 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:49:02.106677 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:49:02.107438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m10:49:02.109107 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:49:02.109482 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:49:02.109768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:02.111147 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:02.111449 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:49:02.111681 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:49:02.115429 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:49:02.117089 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:49:02.117881 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:49:02.118186 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:49:02.120033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb191c74a0>]}
[0m10:49:02.120641 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:02.120945 [debug] [MainThread]: On master: BEGIN
[0m10:49:02.121205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:49:02.122109 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:02.122491 [debug] [MainThread]: On master: COMMIT
[0m10:49:02.122773 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:02.123008 [debug] [MainThread]: On master: COMMIT
[0m10:49:02.123623 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:49:02.123915 [debug] [MainThread]: On master: Close
[0m10:49:02.127558 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:49:02.128253 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:49:02.128884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m10:49:02.129303 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:49:02.136975 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.137908 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:49:02.171910 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.172817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.173226 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:49:02.173542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.174542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.174929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.175281 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:49:02.177799 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.183546 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.184100 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:49:02.185517 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.186826 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.187191 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:49:02.188555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.194951 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.195494 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:49:02.196695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.199378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.199787 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:49:02.201003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.215983 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:49:02.216543 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.216872 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:49:02.222696 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:02.228242 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:02.228812 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:49:02.234152 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:02.237159 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:49:02.239658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb191b2570>]}
[0m10:49:02.240561 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.11s]
[0m10:49:02.241231 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:49:02.241621 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:49:02.242115 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m10:49:02.243038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:49:02.243456 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:49:02.246436 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:49:02.247145 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:49:02.249612 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:49:02.250317 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:02.250654 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:49:02.250900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.252022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.252482 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:02.252853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:49:02.262316 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:49:02.263609 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:02.264007 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:49:02.265204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.266368 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:02.266672 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:49:02.268552 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.271565 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:02.272076 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:49:02.273133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.275798 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:02.276225 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:49:02.277292 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.278540 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:49:02.278924 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:02.279245 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:49:02.287158 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:49:02.289578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:02.290000 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:49:02.295636 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:02.297548 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:49:02.298517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb190a27b0>]}
[0m10:49:02.299112 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.06s]
[0m10:49:02.299691 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:49:02.300121 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:49:02.300645 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m10:49:02.301185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:49:02.301808 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:49:02.304458 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:49:02.305554 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:49:02.309188 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:49:02.309715 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:02.310006 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:49:02.310249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.312539 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.313486 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:02.313986 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:49:02.316914 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.318064 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:02.318440 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:49:02.319522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.320814 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:02.321192 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:49:02.322872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.325676 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:02.326117 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:49:02.327315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.329731 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:02.330153 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:49:02.331188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.332636 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:49:02.333026 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:02.333330 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:49:02.339655 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:02.342149 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:02.342670 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:49:02.348708 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:02.350198 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:49:02.351391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb190944d0>]}
[0m10:49:02.352159 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.05s]
[0m10:49:02.352834 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:49:02.353253 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:49:02.353755 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m10:49:02.354882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:49:02.355365 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:49:02.358239 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:49:02.358911 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:49:02.361794 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:49:02.362624 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:02.363017 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:49:02.363293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.364262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.364643 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:02.364916 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:49:02.367163 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.368728 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:02.369247 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:49:02.370777 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.372559 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:02.373003 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:49:02.374316 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.377429 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:02.377907 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:49:02.378888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.381493 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:02.382151 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:49:02.383333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.384756 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:49:02.385141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:02.385417 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:49:02.391420 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:02.393780 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:02.394215 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:49:02.399895 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:02.401680 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:49:02.402455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb1919c0b0>]}
[0m10:49:02.403055 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.05s]
[0m10:49:02.403598 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:49:02.403983 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:49:02.404479 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m10:49:02.405096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:49:02.405412 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:49:02.408344 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:49:02.409101 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:49:02.413545 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:49:02.414408 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:02.414781 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:49:02.415060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.416327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.416815 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:02.417160 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:49:02.422334 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:49:02.423779 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:02.424405 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:49:02.425852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.427409 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:02.428217 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:49:02.430744 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.434156 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:02.434710 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:49:02.435876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.438889 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:02.439410 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:49:02.440546 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.442055 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:49:02.442496 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:02.442813 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:49:02.453141 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:49:02.455425 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:02.455846 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:49:02.462690 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:02.464395 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:49:02.465572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb1904a4e0>]}
[0m10:49:02.466332 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.06s]
[0m10:49:02.467115 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:49:02.467752 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:49:02.468748 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:49:02.469477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m10:49:02.469913 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:49:02.473392 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:49:02.474170 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:49:02.477294 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:49:02.478101 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:02.478467 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:49:02.478738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.479656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.480063 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:02.480388 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:49:02.481900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.483244 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:02.483702 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:49:02.485324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.487360 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:02.488075 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:49:02.491033 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.494076 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:02.494545 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:49:02.495454 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.497822 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:02.498269 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:49:02.499240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.500537 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:49:02.500901 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:02.501170 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:49:02.507505 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:02.509803 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:02.510265 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:49:02.516561 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:02.518065 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:49:02.519183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb190a2600>]}
[0m10:49:02.520405 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.05s]
[0m10:49:02.521129 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:49:02.521567 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:49:02.522235 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m10:49:02.522882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m10:49:02.523294 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:49:02.526023 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:49:02.526743 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:49:02.529716 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:49:02.530457 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:02.530831 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:49:02.531156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.532194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.532705 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:02.533098 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from source
),

derive as (
    select
        player_id,
        display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored/expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted/expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted)/(expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m10:49:02.540907 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:49:02.542267 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:02.542696 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:49:02.544626 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.546100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:02.546497 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:49:02.547972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.552647 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:02.553151 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:49:02.554524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.557437 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:02.557891 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:49:02.559682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.561334 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:49:02.561833 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:02.562180 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:49:02.569906 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:49:02.572401 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:02.572903 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:49:02.578803 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:02.580526 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:49:02.581707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb190c99a0>]}
[0m10:49:02.582430 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.06s]
[0m10:49:02.583058 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:49:02.583499 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:49:02.584269 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:49:02.584998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m10:49:02.585399 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:49:02.588414 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:49:02.589350 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:49:02.592493 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:49:02.593474 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:02.594052 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:49:02.594525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.596202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.596950 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:02.597309 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:49:02.599572 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.601778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:02.602691 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:49:02.605024 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.606962 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:02.607461 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:49:02.609350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.612922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:02.613428 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:49:02.614718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.617453 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:02.617934 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:49:02.619239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.621630 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:49:02.622508 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:02.623183 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:49:02.630603 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:49:02.633508 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:02.634053 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:49:02.642453 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:49:02.644532 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:49:02.645629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb190818b0>]}
[0m10:49:02.646450 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.06s]
[0m10:49:02.647261 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:49:02.647842 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:49:02.648519 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m10:49:02.649470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:49:02.650185 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:49:02.654065 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:49:02.655076 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:49:02.658953 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:49:02.660069 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:02.660645 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:49:02.661008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.662181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.662671 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:02.663035 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:49:02.665338 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.666804 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:02.667248 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:49:02.668779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.670480 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:02.671021 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:49:02.674184 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.683311 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:02.684343 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:49:02.686561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.696728 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:02.697933 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:49:02.700117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.703320 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:49:02.704432 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:02.705431 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:49:02.714977 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:49:02.718396 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:02.719121 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:49:02.726129 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:02.729341 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:49:02.730940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb190da3c0>]}
[0m10:49:02.731887 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.08s]
[0m10:49:02.733035 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:49:02.735964 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:49:02.736961 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m10:49:02.737769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m10:49:02.738260 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:49:02.743318 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:49:02.744905 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:49:02.751294 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:49:02.752848 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:02.753439 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:49:02.753867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:02.755433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.756542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:02.758312 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
)

select * from players
    );
  
  
[0m10:49:02.773851 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:49:02.775635 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:02.776219 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:49:02.778022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.780009 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:02.780766 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:49:02.782830 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:02.786857 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:02.787442 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:49:02.789294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.792927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:02.793481 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:49:02.795414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:02.797349 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:49:02.797902 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:02.798316 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:49:02.807691 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:49:02.810517 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:02.811031 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:49:02.818174 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:02.820585 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:49:02.821660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83a33cf-0468-4373-9f4d-e47f6bb60568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb1904ad20>]}
[0m10:49:02.822456 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.08s]
[0m10:49:02.823310 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:49:02.826572 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:02.827349 [debug] [MainThread]: On master: BEGIN
[0m10:49:02.827930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:49:02.829363 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:02.829845 [debug] [MainThread]: On master: COMMIT
[0m10:49:02.830258 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:02.830654 [debug] [MainThread]: On master: COMMIT
[0m10:49:02.831585 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:02.832042 [debug] [MainThread]: On master: Close
[0m10:49:02.833162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:02.833792 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:49:02.834325 [info ] [MainThread]: 
[0m10:49:02.834874 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m10:49:02.836981 [debug] [MainThread]: Command end result
[0m10:49:02.862470 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:49:02.865488 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:49:02.875619 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:49:02.876721 [info ] [MainThread]: 
[0m10:49:02.877904 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:02.878841 [info ] [MainThread]: 
[0m10:49:02.879928 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m10:49:02.882504 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.5860748, "process_in_blocks": "8", "process_kernel_time": 0.309289, "process_mem_max_rss": "165996", "process_out_blocks": "4152", "process_user_time": 3.70706}
[0m10:49:02.883749 [debug] [MainThread]: Command `dbt build` succeeded at 10:49:02.883486 after 2.59 seconds
[0m10:49:02.884671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb43860ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb19ced1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb43c50ec0>]}
[0m10:49:02.885541 [debug] [MainThread]: Flushing usage events
[0m10:49:03.412352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:35.934001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5550d5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5572da6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a554c7b9e0>]}


============================== 10:49:35.936619 | 8069374c-f44e-4aa6-ba82-2fa73333e46f ==============================
[0m10:49:35.936619 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:49:35.937442 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'invocation_command': 'dbt build', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'target_path': 'None', 'debug': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'printer_width': '80', 'log_path': '/home/robgriffin247/fpl/logs', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False'}
[0m10:49:36.142777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a556fe7bf0>]}
[0m10:49:36.205513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a554cd57f0>]}
[0m10:49:36.206798 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:49:36.259169 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:49:36.328589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:49:36.329106 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m10:49:36.628265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a554c04d10>]}
[0m10:49:36.672246 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:49:36.673565 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:49:36.733169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a54a6e3a70>]}
[0m10:49:36.733539 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m10:49:36.735208 [info ] [MainThread]: 
[0m10:49:36.735528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:36.735762 [info ] [MainThread]: 
[0m10:49:36.736174 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:49:36.740566 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:49:36.763231 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:49:36.763579 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:49:36.763787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:36.781461 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:49:36.782753 [debug] [ThreadPool]: On list_analytics: Close
[0m10:49:36.785673 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:49:36.786076 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:49:36.786337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:36.787628 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:36.788532 [debug] [ThreadPool]: On list_analytics: Close
[0m10:49:36.790114 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:49:36.790415 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:49:36.790680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:36.791755 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:36.792582 [debug] [ThreadPool]: On list_analytics: Close
[0m10:49:36.793263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m10:49:36.793604 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:49:36.798487 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:49:36.798835 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:49:36.799041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:36.800140 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:36.801162 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:49:36.801408 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:49:36.801887 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:36.802160 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:49:36.802345 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:49:36.803042 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:36.803985 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:49:36.804338 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:49:36.804695 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:49:36.805399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:36.805654 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:49:36.806208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m10:49:36.806651 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:49:36.807801 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:49:36.808119 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:49:36.808321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:36.809371 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:36.810305 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:49:36.810553 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:49:36.810975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:36.811178 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:49:36.811346 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:49:36.812028 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:36.812662 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:49:36.812908 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:49:36.813100 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:49:36.813592 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:36.813824 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:49:36.814381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m10:49:36.814737 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:49:36.815949 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:49:36.816239 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:49:36.816630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:36.817584 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:36.818552 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:49:36.818785 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:49:36.819258 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:36.819468 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:49:36.819638 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:49:36.820105 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:36.820690 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:49:36.820899 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:49:36.821071 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:49:36.821714 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:49:36.822024 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:49:36.823863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m10:49:36.827989 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:49:36.828262 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:49:36.828452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:36.829113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:36.829344 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:49:36.829527 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:49:36.838403 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m10:49:36.839514 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:49:36.840323 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:49:36.840563 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:49:36.841090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m10:49:36.843073 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:49:36.843322 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:49:36.843546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:36.844377 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:36.844631 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:49:36.844846 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:49:36.848291 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:49:36.849743 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:49:36.850399 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:49:36.850606 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:49:36.851098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m10:49:36.852369 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:49:36.852628 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:49:36.852853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:36.853905 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:36.854272 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:49:36.854468 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:49:36.857570 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:49:36.858696 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:49:36.859346 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:49:36.859568 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:49:36.860796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a532adf230>]}
[0m10:49:36.861148 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:36.861356 [debug] [MainThread]: On master: BEGIN
[0m10:49:36.861537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:49:36.862240 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:36.862493 [debug] [MainThread]: On master: COMMIT
[0m10:49:36.862697 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:36.862874 [debug] [MainThread]: On master: COMMIT
[0m10:49:36.863280 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:49:36.863504 [debug] [MainThread]: On master: Close
[0m10:49:36.865662 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:49:36.866098 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:49:36.866471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m10:49:36.866723 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:49:36.871879 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.872428 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:49:36.898745 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.899424 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.899731 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:49:36.899987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:36.901118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:36.901594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.902104 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:49:36.904741 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:36.909251 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.909632 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:49:36.910666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:36.911709 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.911989 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:49:36.913415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:36.918490 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.918822 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:49:36.919935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:36.922025 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.922333 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:49:36.923208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:36.935101 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:49:36.935447 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.935731 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:49:36.942962 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:49:36.947355 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:49:36.947674 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:49:36.954452 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:36.956725 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:49:36.958512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a554613200>]}
[0m10:49:36.959027 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.09s]
[0m10:49:36.959483 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:49:36.959812 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:49:36.960179 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m10:49:36.960629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:49:36.960964 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:49:36.963322 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:49:36.964197 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:49:36.966285 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:49:36.966763 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:36.967022 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:49:36.967237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:36.967996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:36.968252 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:36.968519 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:49:36.976725 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:49:36.978193 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:36.978524 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:49:36.979379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:36.980414 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:36.980774 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:49:36.981944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:36.984226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:36.984500 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:49:36.985130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:36.987003 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:36.987295 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:49:36.987882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:36.988925 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:49:36.989331 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:36.989573 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:49:36.997911 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:49:36.999979 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:49:37.000289 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:49:37.005130 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:49:37.006575 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:49:37.007309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a532a429f0>]}
[0m10:49:37.007807 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m10:49:37.008228 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:49:37.008518 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:49:37.009519 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m10:49:37.010077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:49:37.010422 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:49:37.012453 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:49:37.012968 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:49:37.016510 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:49:37.017051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:37.017347 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:49:37.017570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:37.018366 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.018739 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:37.018977 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:49:37.021717 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:37.022700 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:37.023005 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:49:37.024094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.025103 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:37.025380 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:49:37.026707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.029809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:37.030232 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:49:37.031011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.032865 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:37.033140 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:49:37.034196 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.035226 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:49:37.035491 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:37.035732 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:49:37.042353 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:37.044339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:49:37.044636 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:49:37.050768 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:37.052266 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:49:37.052867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a53299e450>]}
[0m10:49:37.053363 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m10:49:37.053800 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:49:37.054122 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:49:37.054922 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m10:49:37.055378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:49:37.055643 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:49:37.057924 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:49:37.058613 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:49:37.060614 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:49:37.061092 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:37.061346 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:49:37.061559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:37.062841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.063140 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:37.063368 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:49:37.064993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.066212 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:37.066677 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:49:37.068021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.069096 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:37.069360 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:49:37.070683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.073659 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:37.074018 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:49:37.074739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:37.076563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:37.076836 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:49:37.077426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:37.078346 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:49:37.078638 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:37.078879 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:49:37.084981 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:37.086886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:49:37.087183 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:49:37.092646 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:37.094322 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:49:37.095127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a532abe9f0>]}
[0m10:49:37.095586 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m10:49:37.096032 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:49:37.096329 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:49:37.096683 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m10:49:37.097126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:49:37.097462 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:49:37.099617 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:49:37.100196 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:49:37.103549 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:49:37.104264 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:37.104532 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:49:37.104754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:37.105505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.105783 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:37.106091 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:49:37.108151 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:37.109098 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:37.109383 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:49:37.110506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.111905 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:37.112371 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:49:37.114237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.116539 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:37.116822 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:49:37.117662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.119810 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:37.120136 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:49:37.120727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:37.121653 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:49:37.121937 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:37.122216 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:49:37.128789 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:37.130694 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:49:37.131001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:49:37.136185 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:37.137730 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:49:37.138536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5329c4590>]}
[0m10:49:37.139045 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m10:49:37.139518 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:49:37.139875 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:49:37.140307 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:49:37.140900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m10:49:37.141475 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:49:37.143812 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:49:37.144270 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:49:37.146324 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:49:37.146808 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:37.147064 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:49:37.147284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:37.148054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.148295 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:37.148503 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:49:37.149635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.150446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:37.150708 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:49:37.151497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.152447 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:37.152710 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:49:37.153619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.155703 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:37.155977 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:49:37.156559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:37.158413 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:37.158685 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:49:37.159280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:37.160174 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:49:37.160432 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:37.160650 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:49:37.167355 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:37.169817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:49:37.170342 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:49:37.176349 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:37.178205 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:49:37.179475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a532ab6d80>]}
[0m10:49:37.179978 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m10:49:37.180418 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:49:37.180732 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:49:37.181109 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m10:49:37.181524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m10:49:37.181847 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:49:37.184232 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:49:37.184725 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:49:37.186786 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:49:37.187275 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:37.187530 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:49:37.187743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:37.188498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.188744 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:37.189003 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

null_values as (
    select * exclude(minutes_played, total_points), 
        case when minutes_played>0 then minutes_played else null end as minutes_played,
        case when total_points>0 then total_points else null end as total_points
    from source
),

derive as (
    select
        player_id,
        display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored/expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted/expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted)/(expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m10:49:37.194519 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:37.195435 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:37.195715 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:49:37.196834 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.197843 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:37.198176 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:49:37.199256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.202564 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:37.202873 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:49:37.203602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:37.205410 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:37.205674 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:49:37.206516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.207741 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:49:37.208077 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:37.208315 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:49:37.216265 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:49:37.218315 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:49:37.218669 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:49:37.225690 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:49:37.227202 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:49:37.228276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5329e1490>]}
[0m10:49:37.228838 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m10:49:37.229352 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:49:37.229688 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:49:37.230119 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:49:37.230603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m10:49:37.230965 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:49:37.233196 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:49:37.234045 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:49:37.236318 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:49:37.236943 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:37.237304 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:49:37.237572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:37.238487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.238817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:37.239098 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:49:37.241013 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:37.242175 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:37.242568 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:49:37.243675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.244987 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:37.245291 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:49:37.246922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.249551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:37.249966 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:49:37.251162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.253366 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:37.253696 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:49:37.254824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.255984 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:49:37.256367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:37.256756 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:49:37.263606 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:37.265617 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:49:37.266036 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:49:37.272034 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:37.273653 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:49:37.274511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a532986120>]}
[0m10:49:37.275026 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m10:49:37.275501 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:49:37.275839 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:49:37.276228 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m10:49:37.276795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:49:37.277110 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:49:37.279403 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:49:37.280070 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:49:37.282446 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:49:37.283087 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:37.283382 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:49:37.283653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:37.284537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.284834 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:37.285080 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:49:37.287479 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:37.288669 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:37.289099 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:49:37.290377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.291527 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:37.291857 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:49:37.293119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.296064 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:37.296481 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:49:37.297585 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.301210 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:37.301643 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:49:37.302724 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.303908 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:49:37.304283 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:37.304547 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:49:37.313130 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:49:37.315295 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:49:37.315674 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:49:37.323734 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:49:37.325054 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:49:37.325667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5329f23f0>]}
[0m10:49:37.326145 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.05s]
[0m10:49:37.326582 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:49:37.328156 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:49:37.328545 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m10:49:37.328953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m10:49:37.329217 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:49:37.331596 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:49:37.332192 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:49:37.334271 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:49:37.334768 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:37.335023 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:49:37.335244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:37.336321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.336785 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:37.337124 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
)

select * from join_players
    );
  
  
[0m10:49:37.346388 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:49:37.347495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:37.347773 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:49:37.348716 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.349671 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:37.349939 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:49:37.351245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.353861 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:37.354284 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:49:37.355186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:37.357470 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:37.357791 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:49:37.358502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:49:37.359468 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:49:37.359765 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:37.359990 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:49:37.367540 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:49:37.369258 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:49:37.369543 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:49:37.374871 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:37.376415 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:49:37.378250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8069374c-f44e-4aa6-ba82-2fa73333e46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a54a5eb9e0>]}
[0m10:49:37.378748 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.05s]
[0m10:49:37.379274 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:49:37.381018 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:37.381431 [debug] [MainThread]: On master: BEGIN
[0m10:49:37.381745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:49:37.383320 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:37.383822 [debug] [MainThread]: On master: COMMIT
[0m10:49:37.384032 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:37.384213 [debug] [MainThread]: On master: COMMIT
[0m10:49:37.384870 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:49:37.385306 [debug] [MainThread]: On master: Close
[0m10:49:37.385872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:37.386226 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:49:37.386512 [info ] [MainThread]: 
[0m10:49:37.386785 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m10:49:37.387973 [debug] [MainThread]: Command end result
[0m10:49:37.401037 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:49:37.402538 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:49:37.407076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:49:37.407388 [info ] [MainThread]: 
[0m10:49:37.407688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:37.407947 [info ] [MainThread]: 
[0m10:49:37.408215 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m10:49:37.408969 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.535281, "process_in_blocks": "0", "process_kernel_time": 0.239423, "process_mem_max_rss": "168296", "process_out_blocks": "4176", "process_user_time": 2.864376}
[0m10:49:37.409296 [debug] [MainThread]: Command `dbt build` succeeded at 10:49:37.409225 after 1.54 seconds
[0m10:49:37.409556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a54a6000b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a554cd5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a554cd6cc0>]}
[0m10:49:37.409848 [debug] [MainThread]: Flushing usage events
[0m10:49:37.940427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:57.112113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70308e988b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70308e10ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70308eb545f0>]}


============================== 10:51:57.116470 | 497d493e-c954-45c2-a770-cf946bbd7a32 ==============================
[0m10:51:57.116470 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:51:57.116932 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt build', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None'}
[0m10:51:57.329098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70308da130e0>]}
[0m10:51:57.386258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70308db3b230>]}
[0m10:51:57.390075 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:51:57.443929 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:51:57.537169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:51:57.537653 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:51:57.797365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7030809ed760>]}
[0m10:51:57.836956 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:51:57.839010 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:51:57.908389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7030839eddc0>]}
[0m10:51:57.908771 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m10:51:57.910375 [info ] [MainThread]: 
[0m10:51:57.910681 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:57.910904 [info ] [MainThread]: 
[0m10:51:57.911305 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:51:57.915130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:51:57.942888 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:51:57.943292 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:51:57.943544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:57.968934 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m10:51:57.970119 [debug] [ThreadPool]: On list_analytics: Close
[0m10:51:57.972849 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:51:57.973147 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:51:57.973397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:57.974529 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:51:57.975308 [debug] [ThreadPool]: On list_analytics: Close
[0m10:51:57.976632 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:51:57.976908 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:51:57.977134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:57.978065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:51:57.978790 [debug] [ThreadPool]: On list_analytics: Close
[0m10:51:57.979399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m10:51:57.979726 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:51:57.983920 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:51:57.984170 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:51:57.984346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:57.985272 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:51:57.986079 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:51:57.986280 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:51:57.986703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:57.986890 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:51:57.987044 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:51:57.987423 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:57.987970 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:51:57.988179 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:51:57.988373 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:51:57.988778 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:57.988989 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:51:57.989438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m10:51:57.989761 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:51:57.990839 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:51:57.991146 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:51:57.991531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:57.992317 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:51:57.993084 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:51:57.993288 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:51:57.993687 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:57.993878 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:51:57.994037 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:51:57.994473 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:57.994981 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:51:57.995164 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:51:57.995316 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:51:57.995839 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:57.996047 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:51:57.996454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m10:51:57.996754 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:51:57.997709 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:51:57.997934 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:51:57.998146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:57.998957 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:51:57.999817 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:51:58.000013 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:51:58.000388 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:58.000568 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:51:58.000709 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:51:58.001075 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:58.001564 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:51:58.001739 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:51:58.001879 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:51:58.002230 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:58.002429 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:51:58.003830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m10:51:58.006930 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:51:58.007182 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:51:58.007457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:58.008101 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:51:58.008298 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:51:58.008457 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:51:58.015954 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m10:51:58.017090 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:51:58.018593 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:51:58.018833 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:51:58.019344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m10:51:58.021192 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:51:58.021429 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:51:58.021597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:58.022142 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:51:58.022336 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:51:58.022498 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:51:58.025686 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:51:58.026970 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:51:58.027802 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:51:58.028074 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:51:58.028526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m10:51:58.030129 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:51:58.030344 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:51:58.030505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:58.031020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:51:58.031234 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:51:58.031419 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:51:58.033926 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:51:58.034842 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:51:58.035377 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:51:58.035590 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:51:58.036330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7030839e1b80>]}
[0m10:51:58.036620 [debug] [MainThread]: Using duckdb connection "master"
[0m10:51:58.036798 [debug] [MainThread]: On master: BEGIN
[0m10:51:58.036946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:58.037424 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:51:58.037607 [debug] [MainThread]: On master: COMMIT
[0m10:51:58.037764 [debug] [MainThread]: Using duckdb connection "master"
[0m10:51:58.037968 [debug] [MainThread]: On master: COMMIT
[0m10:51:58.038347 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:51:58.038544 [debug] [MainThread]: On master: Close
[0m10:51:58.041892 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:51:58.042295 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:51:58.042661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m10:51:58.042896 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:51:58.048014 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.048535 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:51:58.069943 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.070514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.070795 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:51:58.070999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:58.071847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.072082 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.072266 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:51:58.075878 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:51:58.080615 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.080946 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:51:58.081864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.082739 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.082979 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:51:58.084068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.088158 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.088398 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:51:58.089781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.091406 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.091675 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:51:58.092156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.101206 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:51:58.101493 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.101691 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:51:58.108680 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:51:58.112310 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:51:58.112570 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:51:58.117441 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:51:58.119150 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:51:58.120842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7030902aee70>]}
[0m10:51:58.121292 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m10:51:58.121691 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:51:58.121959 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:51:58.122283 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m10:51:58.122676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:51:58.123308 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:51:58.125812 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:51:58.126415 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:51:58.128554 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:51:58.129037 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:51:58.129276 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:51:58.129473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:58.130192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.130415 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:51:58.130675 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:51:58.138190 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:51:58.139083 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:51:58.139419 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:51:58.140265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.141027 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:51:58.141259 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:51:58.142464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.144545 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:51:58.144816 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:51:58.145400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.147026 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:51:58.147260 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:51:58.147988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.148803 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:51:58.149060 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:51:58.149265 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:51:58.156132 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:51:58.157768 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:51:58.158039 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:51:58.162911 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:51:58.164114 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:51:58.164762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7030805aec30>]}
[0m10:51:58.165212 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m10:51:58.165609 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:51:58.165883 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:51:58.166666 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m10:51:58.167124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:51:58.167372 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:51:58.169289 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:51:58.169719 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:51:58.172633 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:51:58.173074 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:51:58.173333 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:51:58.173537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:58.174442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.174789 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:51:58.175012 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:51:58.177103 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:51:58.177898 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:51:58.178134 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:51:58.178855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.179799 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:51:58.180045 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:51:58.180967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.182881 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:51:58.183122 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:51:58.183826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.185428 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:51:58.185645 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:51:58.186144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.186935 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:51:58.187180 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:51:58.187373 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:51:58.192750 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:51:58.194368 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:51:58.194632 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:51:58.199671 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:51:58.200739 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:51:58.201304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70308054e900>]}
[0m10:51:58.201731 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.03s]
[0m10:51:58.202141 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:51:58.202410 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:51:58.202721 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m10:51:58.203069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:51:58.203543 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:51:58.205387 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:51:58.205817 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:51:58.207663 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:51:58.208126 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:51:58.208388 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:51:58.208577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:58.209259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.209498 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:51:58.209682 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:51:58.211938 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:51:58.213037 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:51:58.213528 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:51:58.214572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.215604 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:51:58.215867 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:51:58.217308 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.219979 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:51:58.220219 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:51:58.221035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.222878 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:51:58.223111 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:51:58.223768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.224550 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:51:58.224791 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:51:58.224973 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:51:58.230504 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:51:58.232396 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:51:58.232686 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:51:58.237239 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:51:58.238438 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:51:58.239201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7030808fabd0>]}
[0m10:51:58.239713 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m10:51:58.240134 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:51:58.240400 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:51:58.240702 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m10:51:58.241063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:51:58.241495 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:51:58.243297 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:51:58.243741 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:51:58.246742 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:51:58.247312 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:51:58.247637 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:51:58.247839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:58.248530 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.248782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:51:58.249001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:51:58.251250 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:51:58.252038 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:51:58.252304 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:51:58.253000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.253860 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:51:58.254122 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:51:58.255271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.257510 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:51:58.257756 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:51:58.258307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.259949 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:51:58.260191 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:51:58.260688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.261559 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:51:58.261794 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:51:58.261989 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:51:58.267948 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:51:58.269538 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:51:58.269829 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:51:58.277544 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:51:58.278600 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:51:58.279201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703080556900>]}
[0m10:51:58.279701 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m10:51:58.280093 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:51:58.280353 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:51:58.280666 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:51:58.281039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m10:51:58.281305 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:51:58.283099 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:51:58.283857 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:51:58.285649 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:51:58.286065 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:51:58.286308 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:51:58.286489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:58.287180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.287470 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:51:58.287712 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:51:58.288847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.289485 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:51:58.289685 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:51:58.290310 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.291080 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:51:58.291303 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:51:58.292273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.294446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:51:58.294731 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:51:58.295578 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.297205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:51:58.297427 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:51:58.297948 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.298706 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:51:58.298923 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:51:58.299097 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:51:58.304976 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:51:58.306637 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:51:58.306899 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:51:58.312503 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:51:58.313966 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:51:58.314722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7030806d7110>]}
[0m10:51:58.315342 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m10:51:58.316052 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:51:58.316352 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:51:58.316679 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m10:51:58.317225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m10:51:58.317476 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:51:58.319335 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:51:58.320214 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:51:58.322105 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:51:58.322516 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:51:58.322742 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:51:58.322979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:58.323653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.323894 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:51:58.324132 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

derive as (
    select
        player_id,
        display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored / expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted / expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m10:51:58.333609 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

derive as (
    select
        player_id,
        display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored / expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted / expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from null_values
)



select * from derive
    );
  
  
[0m10:51:58.334105 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:51:58.334446 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m10:51:58.340455 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m10:51:58.340774 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:51:58.342513 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name null_values does not exist!
  Did you mean "duckdb_tables"?
  
  LINE 72:     from null_values
                    ^
[0m10:51:58.342877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703080591e20>]}
[0m10:51:58.343363 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model intermediate.int_players ................ [[31mERROR[0m in 0.03s]
[0m10:51:58.343832 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:51:58.344108 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:51:58.344445 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:51:58.344904 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name null_values does not exist!
  Did you mean "duckdb_tables"?
  
  LINE 72:     from null_values
                    ^.
[0m10:51:58.345243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m10:51:58.345868 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:51:58.348931 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:51:58.349403 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:51:58.351134 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:51:58.351648 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:51:58.351880 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:51:58.352082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:58.352780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.353001 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:51:58.353213 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:51:58.354437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.355093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:51:58.355334 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:51:58.356365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.357498 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:51:58.357776 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:51:58.358982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.360954 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:51:58.361198 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:51:58.361945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.364310 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:51:58.364605 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:51:58.365281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.366160 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:51:58.366409 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:51:58.366612 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:51:58.371847 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:51:58.373413 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:51:58.373727 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:51:58.378524 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:51:58.380049 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:51:58.380618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7030806bbbf0>]}
[0m10:51:58.381061 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m10:51:58.381489 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:51:58.381769 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:51:58.382094 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m10:51:58.382486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:51:58.382843 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:51:58.384508 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:51:58.384981 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:51:58.386737 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:51:58.387172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:51:58.387414 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:51:58.387734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:58.388466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.388734 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:51:58.388927 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:51:58.390416 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.391282 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:51:58.391557 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:51:58.392525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.393796 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:51:58.394173 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:51:58.395598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:51:58.397606 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:51:58.397889 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:51:58.398597 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.400351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:51:58.400602 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:51:58.401154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:51:58.401978 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:51:58.402212 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:51:58.402402 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:51:58.410539 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:51:58.412394 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:51:58.412688 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:51:58.417881 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:51:58.419293 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:51:58.420029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '497d493e-c954-45c2-a770-cf946bbd7a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70308057b8f0>]}
[0m10:51:58.420465 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m10:51:58.420875 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:51:58.421920 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:51:58.422209 [info ] [Thread-1 (]: 10 of 10 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m10:51:58.422505 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:51:58.422876 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m10:51:58.424065 [debug] [MainThread]: Using duckdb connection "master"
[0m10:51:58.424331 [debug] [MainThread]: On master: BEGIN
[0m10:51:58.424514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:58.425159 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:51:58.425382 [debug] [MainThread]: On master: COMMIT
[0m10:51:58.425600 [debug] [MainThread]: Using duckdb connection "master"
[0m10:51:58.425764 [debug] [MainThread]: On master: COMMIT
[0m10:51:58.426360 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:51:58.426709 [debug] [MainThread]: On master: Close
[0m10:51:58.427208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:58.427554 [debug] [MainThread]: Connection 'model.fpl_analytics.int_teams' was properly closed.
[0m10:51:58.427839 [info ] [MainThread]: 
[0m10:51:58.428086 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m10:51:58.429526 [debug] [MainThread]: Command end result
[0m10:51:58.441244 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:51:58.442701 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:51:58.446811 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:51:58.447106 [info ] [MainThread]: 
[0m10:51:58.447388 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:51:58.447688 [info ] [MainThread]: 
[0m10:51:58.447975 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m10:51:58.448258 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Catalog Error: Table with name null_values does not exist!
  Did you mean "duckdb_tables"?
  
  LINE 72:     from null_values
                    ^
[0m10:51:58.448510 [info ] [MainThread]: 
[0m10:51:58.448764 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m10:51:58.448965 [info ] [MainThread]: 
[0m10:51:58.449192 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=10
[0m10:51:58.450622 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.3884323, "process_in_blocks": "110176", "process_kernel_time": 0.236512, "process_mem_max_rss": "166924", "process_out_blocks": "3600", "process_user_time": 2.544697}
[0m10:51:58.450941 [debug] [MainThread]: Command `dbt build` failed at 10:51:58.450875 after 1.39 seconds
[0m10:51:58.451266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7030902736e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703090270a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703090271400>]}
[0m10:51:58.451532 [debug] [MainThread]: Flushing usage events
[0m10:51:59.018427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:12.345132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cfce81790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cfac31bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cfb42de50>]}


============================== 10:52:12.347752 | d4956596-85ac-46a6-b087-2e04e261e16e ==============================
[0m10:52:12.347752 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:52:12.348173 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'empty': 'False', 'no_print': 'None', 'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True'}
[0m10:52:12.529360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cfa234bf0>]}
[0m10:52:12.587464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cf9f9f4d0>]}
[0m10:52:12.588643 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:52:12.637696 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:52:12.704150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:52:12.704632 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:52:12.976345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cee7e1850>]}
[0m10:52:13.017240 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:52:13.018556 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:52:13.081502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cf00e72c0>]}
[0m10:52:13.081882 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m10:52:13.083567 [info ] [MainThread]: 
[0m10:52:13.083955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:13.084221 [info ] [MainThread]: 
[0m10:52:13.084645 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:52:13.088909 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:52:13.110957 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:52:13.111301 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:52:13.111517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:13.129461 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:52:13.130609 [debug] [ThreadPool]: On list_analytics: Close
[0m10:52:13.133487 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:52:13.133816 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:52:13.134055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:13.135160 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:13.136029 [debug] [ThreadPool]: On list_analytics: Close
[0m10:52:13.137583 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:52:13.138004 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:52:13.138222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:13.139355 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:13.140180 [debug] [ThreadPool]: On list_analytics: Close
[0m10:52:13.140839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m10:52:13.141209 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:52:13.145697 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:52:13.145987 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:52:13.146185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:13.147337 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:13.148228 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:52:13.148480 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:52:13.148954 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:13.149194 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:52:13.149363 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:52:13.149794 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:13.150364 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:52:13.150597 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:52:13.150772 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:52:13.151167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:13.151363 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:52:13.151839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m10:52:13.152356 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:52:13.153679 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:52:13.154014 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:52:13.154210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:13.155271 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:13.156130 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:52:13.156336 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:52:13.156730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:13.157001 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:52:13.157195 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:52:13.157602 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:13.158106 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:52:13.158292 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:52:13.158437 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:52:13.158817 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:13.159002 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:52:13.159422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m10:52:13.159737 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:52:13.160796 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:52:13.161129 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:52:13.161312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:13.162157 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:13.162942 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:52:13.163133 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:52:13.163510 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:13.163699 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:52:13.163844 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:52:13.164232 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:13.164771 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:52:13.164957 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:52:13.165185 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:52:13.165567 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:13.165777 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:52:13.167199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m10:52:13.170843 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:52:13.171169 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:52:13.171393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:13.172085 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:13.172290 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:52:13.172465 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:52:13.180505 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m10:52:13.181545 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:52:13.182282 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:52:13.182525 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:52:13.183004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m10:52:13.184669 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:52:13.184903 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:52:13.185122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:13.186073 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:13.186442 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:52:13.186731 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:52:13.189836 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:52:13.190842 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:52:13.191453 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:52:13.191657 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:52:13.192132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m10:52:13.193407 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:52:13.193661 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:52:13.194094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:13.194651 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:13.194851 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:52:13.195019 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:52:13.198201 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:52:13.199251 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:52:13.199834 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:52:13.200039 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:52:13.201247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cecec1160>]}
[0m10:52:13.201647 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:13.201900 [debug] [MainThread]: On master: BEGIN
[0m10:52:13.202075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:52:13.202677 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:52:13.202928 [debug] [MainThread]: On master: COMMIT
[0m10:52:13.203121 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:13.203284 [debug] [MainThread]: On master: COMMIT
[0m10:52:13.203878 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:52:13.204110 [debug] [MainThread]: On master: Close
[0m10:52:13.206089 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:52:13.206489 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:52:13.206860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_gameweeks)
[0m10:52:13.207102 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:52:13.212415 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.213012 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:52:13.236209 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.236793 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.237206 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:52:13.237420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.238193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.238441 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.238648 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:52:13.240154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.243764 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.244039 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:52:13.244789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.245728 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.245971 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:52:13.247091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.252068 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.252393 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:52:13.253275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.255033 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.255284 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:52:13.255837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.265912 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:52:13.266316 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.266556 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:52:13.271708 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.275542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:52:13.275847 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:52:13.280914 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.283110 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:52:13.284681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cf01cf680>]}
[0m10:52:13.285255 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m10:52:13.285689 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:52:13.285980 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:52:13.286324 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m10:52:13.287169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:52:13.287457 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:52:13.289575 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:52:13.290130 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:52:13.292005 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:52:13.292486 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:52:13.292745 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:52:13.292954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.293708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.293968 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:52:13.294219 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:52:13.301494 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:52:13.302455 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:52:13.302712 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:52:13.303536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.304391 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:52:13.304632 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:52:13.305569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.307542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:52:13.307848 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:52:13.308690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.310606 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:52:13.310920 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:52:13.311739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.312682 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:52:13.312945 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:52:13.313253 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:52:13.319584 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:52:13.321323 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:52:13.321596 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:52:13.327333 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.328927 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:52:13.329781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cf00f1d00>]}
[0m10:52:13.330243 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m10:52:13.330707 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:52:13.331033 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:52:13.331420 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m10:52:13.331855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:52:13.332138 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:52:13.334169 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:52:13.334873 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:52:13.337803 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:52:13.338307 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:52:13.338571 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:52:13.338792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.340056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.340390 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:52:13.340617 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:52:13.342267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.343090 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:52:13.343341 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:52:13.344046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.344907 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:52:13.345202 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:52:13.346257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.348329 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:52:13.348610 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:52:13.349399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.351160 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:52:13.351405 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:52:13.352298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.353485 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:52:13.353777 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:52:13.353976 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:52:13.359569 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.361889 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:52:13.362294 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:52:13.367227 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:52:13.368683 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:52:13.369233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cec4ad700>]}
[0m10:52:13.369721 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m10:52:13.370138 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:52:13.370417 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:52:13.370772 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m10:52:13.371175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:52:13.371513 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:52:13.373999 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:52:13.374518 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:52:13.376293 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:52:13.376715 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:52:13.377017 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:52:13.377248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.377946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.378184 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:52:13.378382 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:52:13.380094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.381111 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:52:13.381397 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:52:13.382296 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.383187 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:52:13.383436 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:52:13.384704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.386872 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:52:13.387135 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:52:13.387888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.390018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:52:13.390313 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:52:13.390951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.391839 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:52:13.392078 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:52:13.392273 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:52:13.397144 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.398899 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:52:13.399166 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:52:13.403893 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:52:13.405096 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:52:13.406206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cec4b8230>]}
[0m10:52:13.406686 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m10:52:13.407109 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:52:13.407399 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:52:13.407725 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m10:52:13.408113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:52:13.408473 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:52:13.410455 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:52:13.410916 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:52:13.414014 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:52:13.414536 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:52:13.414790 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:52:13.414992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.415699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.415953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:52:13.416158 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:52:13.418195 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:52:13.419275 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:52:13.419647 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:52:13.420753 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.421907 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:52:13.422180 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:52:13.423137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.425255 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:52:13.425535 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:52:13.426218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.428018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:52:13.428263 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:52:13.428907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.429859 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:52:13.430105 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:52:13.430300 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:52:13.435254 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.436899 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:52:13.437233 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:52:13.442556 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.443908 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:52:13.444677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cec47d2e0>]}
[0m10:52:13.445317 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m10:52:13.445776 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:52:13.446064 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:52:13.446393 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:52:13.447206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m10:52:13.447464 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:52:13.449335 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:52:13.449759 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:52:13.451520 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:52:13.452010 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:52:13.452298 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:52:13.452553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.453763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.454101 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:52:13.454342 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:52:13.455617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.456415 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:52:13.456655 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:52:13.457638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.458921 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:52:13.459365 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:52:13.460309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.462490 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:52:13.462766 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:52:13.463444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.465155 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:52:13.465406 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:52:13.466197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.467519 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:52:13.467792 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:52:13.468011 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:52:13.472882 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:52:13.474784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:52:13.475112 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:52:13.480375 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.481897 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:52:13.482488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cec4c4440>]}
[0m10:52:13.482951 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m10:52:13.483360 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:52:13.483654 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:52:13.484248 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m10:52:13.484707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m10:52:13.485044 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:52:13.487172 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:52:13.487727 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:52:13.489772 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:52:13.490228 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:52:13.490474 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:52:13.490688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.491438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.491702 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:52:13.491947 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

derive as (
    select
        player_id,
        display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored / expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted / expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
)



select * from derive
    );
  
  
[0m10:52:13.498809 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:52:13.499794 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:52:13.500122 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:52:13.501211 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.502540 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:52:13.502893 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:52:13.504029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.507208 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:52:13.507540 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:52:13.508348 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.510318 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:52:13.510599 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:52:13.511319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.512251 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:52:13.512502 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:52:13.512705 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:52:13.518971 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:52:13.520779 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:52:13.521112 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:52:13.526273 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.527844 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:52:13.529139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cec4e15b0>]}
[0m10:52:13.529706 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.04s]
[0m10:52:13.530129 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:52:13.530411 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:52:13.530733 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:52:13.531440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m10:52:13.531722 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:52:13.533771 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:52:13.534327 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:52:13.536345 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:52:13.536793 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:52:13.537106 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:52:13.537313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.538187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.538435 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:52:13.538642 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:52:13.539915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.540801 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:52:13.541131 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:52:13.542259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.543603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:52:13.543908 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:52:13.544910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.546849 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:52:13.547109 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:52:13.547796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.549467 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:52:13.549767 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:52:13.550494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.551406 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:52:13.551662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:52:13.551867 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:52:13.557647 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.559351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:52:13.559603 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:52:13.565359 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.566676 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:52:13.567349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cf00f0e00>]}
[0m10:52:13.567832 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m10:52:13.568249 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:52:13.568530 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:52:13.569159 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m10:52:13.569581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:52:13.569843 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:52:13.571795 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:52:13.572275 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:52:13.574570 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:52:13.575195 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:52:13.575458 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:52:13.575658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.576393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.576670 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:52:13.576892 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:52:13.578273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.579045 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:52:13.579270 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:52:13.579996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.580804 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:52:13.581141 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:52:13.582205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.584457 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:52:13.584708 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:52:13.585405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.588282 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:52:13.588562 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:52:13.589519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.590654 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:52:13.590936 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:52:13.591185 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:52:13.596410 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.598237 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:52:13.598559 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:52:13.603729 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.605136 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:52:13.605800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cec4f2a50>]}
[0m10:52:13.606286 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m10:52:13.606701 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:52:13.607738 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:52:13.608130 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m10:52:13.608521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m10:52:13.608774 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:52:13.611092 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:52:13.612620 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:52:13.614804 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:52:13.615339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:52:13.615623 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:52:13.615864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:13.616743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.617028 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:52:13.617270 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
)

select * from join_players
    );
  
  
[0m10:52:13.624078 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:52:13.625112 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:52:13.625453 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:52:13.626369 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.627268 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:52:13.627539 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:52:13.628483 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.630541 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:52:13.630879 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:52:13.631656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:13.633566 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:52:13.633820 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:52:13.634587 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:13.635677 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:52:13.636056 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:52:13.636287 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:52:13.643339 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:52:13.645089 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:52:13.645359 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:52:13.650828 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:52:13.652399 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:52:13.653824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4956596-85ac-46a6-b087-2e04e261e16e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cececc2c0>]}
[0m10:52:13.654353 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.05s]
[0m10:52:13.654809 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:52:13.656489 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:13.656804 [debug] [MainThread]: On master: BEGIN
[0m10:52:13.657062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:52:13.658082 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:52:13.658486 [debug] [MainThread]: On master: COMMIT
[0m10:52:13.658819 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:13.659128 [debug] [MainThread]: On master: COMMIT
[0m10:52:13.659855 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:52:13.660097 [debug] [MainThread]: On master: Close
[0m10:52:13.660439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:13.660627 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:52:13.660875 [info ] [MainThread]: 
[0m10:52:13.661177 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m10:52:13.662479 [debug] [MainThread]: Command end result
[0m10:52:13.675281 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:52:13.676719 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:52:13.681293 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:52:13.681667 [info ] [MainThread]: 
[0m10:52:13.681976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:13.682220 [info ] [MainThread]: 
[0m10:52:13.682483 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m10:52:13.683261 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.386911, "process_in_blocks": "1288", "process_kernel_time": 0.260041, "process_mem_max_rss": "168632", "process_out_blocks": "4160", "process_user_time": 2.422921}
[0m10:52:13.683582 [debug] [MainThread]: Command `dbt build` succeeded at 10:52:13.683514 after 1.39 seconds
[0m10:52:13.683818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cfb233770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cf00046b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765cfa195ca0>]}
[0m10:52:13.684079 [debug] [MainThread]: Flushing usage events
[0m10:52:14.283051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:03.167798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a593b3382f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a593cf796a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a593afdbbc0>]}


============================== 11:07:03.173528 | 81429520-5720-4bcd-8e4a-f0efa42f3f83 ==============================
[0m11:07:03.173528 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:07:03.174090 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'profiles_dir': '/home/robgriffin247/fpl', 'target_path': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True'}
[0m11:07:03.400914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a593a2f3fe0>]}
[0m11:07:03.463031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a593adc3ce0>]}
[0m11:07:03.467328 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:07:03.520245 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:07:03.624289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:07:03.624938 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.sql
[0m11:07:03.904420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a59291ed8b0>]}
[0m11:07:03.948206 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:07:03.950770 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:07:04.025796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a59301ce060>]}
[0m11:07:04.026163 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m11:07:04.027696 [info ] [MainThread]: 
[0m11:07:04.028003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:07:04.028240 [info ] [MainThread]: 
[0m11:07:04.028600 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:07:04.032308 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:07:04.060102 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:07:04.060482 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:07:04.060731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:04.079677 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m11:07:04.080657 [debug] [ThreadPool]: On list_analytics: Close
[0m11:07:04.083349 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:07:04.083819 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:07:04.084067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:04.085177 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:07:04.086258 [debug] [ThreadPool]: On list_analytics: Close
[0m11:07:04.087819 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:07:04.088078 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:07:04.088343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:04.089760 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:07:04.090850 [debug] [ThreadPool]: On list_analytics: Close
[0m11:07:04.091733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m11:07:04.092051 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:07:04.096100 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:07:04.096318 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:07:04.096478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:04.097398 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:07:04.098215 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:07:04.098422 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:07:04.099593 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:07:04.100000 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:07:04.100257 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:07:04.100896 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:07:04.101649 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:07:04.101919 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:07:04.102077 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:07:04.102554 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:07:04.102824 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:07:04.103363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m11:07:04.103637 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:07:04.104876 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:07:04.105218 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:07:04.105508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:04.106752 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:07:04.107720 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:07:04.107915 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:07:04.108317 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:07:04.108505 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:07:04.108650 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:07:04.109062 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:07:04.109633 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:07:04.109814 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:07:04.109962 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:07:04.110308 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:07:04.110491 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:07:04.110924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m11:07:04.111229 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:07:04.112268 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:07:04.112506 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:07:04.112728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:04.113930 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:07:04.115172 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:07:04.115532 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:07:04.116117 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:07:04.116327 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:07:04.116488 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:07:04.116977 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:07:04.117621 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:07:04.117823 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:07:04.117972 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:07:04.118345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:07:04.118534 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:07:04.119958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m11:07:04.123286 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:07:04.123552 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:07:04.123765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:04.124368 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:07:04.124567 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:07:04.124736 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:07:04.133473 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:07:04.134730 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:07:04.136484 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:07:04.136771 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:07:04.137380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m11:07:04.138932 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:07:04.139210 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:07:04.139387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:04.140001 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:07:04.140236 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:07:04.140418 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:07:04.143937 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:07:04.145061 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:07:04.145663 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:07:04.145884 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:07:04.146390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m11:07:04.147601 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:07:04.148415 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:07:04.148620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:04.149192 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:07:04.149411 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:07:04.149572 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:07:04.152164 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:07:04.153122 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:07:04.153689 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:07:04.153876 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:07:04.154841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a59286b8320>]}
[0m11:07:04.155164 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:04.155353 [debug] [MainThread]: On master: BEGIN
[0m11:07:04.155497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:04.156236 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:07:04.156475 [debug] [MainThread]: On master: COMMIT
[0m11:07:04.156652 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:04.156807 [debug] [MainThread]: On master: COMMIT
[0m11:07:04.157249 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:07:04.157520 [debug] [MainThread]: On master: Close
[0m11:07:04.160349 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:07:04.160711 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:07:04.161082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m11:07:04.161338 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:07:04.166593 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.167151 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:07:04.189541 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.190124 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.190373 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:07:04.190558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.191269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.191494 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.191670 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:07:04.195512 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:07:04.199213 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.199609 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:07:04.200539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.201728 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.202081 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:07:04.203640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.208646 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.208993 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:07:04.211006 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:07:04.212968 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.213338 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:07:04.214070 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:07:04.223711 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:07:04.224046 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.224256 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:07:04.232327 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:07:04.236464 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:07:04.236778 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:07:04.241903 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:07:04.243923 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:07:04.245826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a59302e9130>]}
[0m11:07:04.246455 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m11:07:04.246929 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:07:04.247247 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:07:04.247644 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m11:07:04.248070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:07:04.248602 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:07:04.251244 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:07:04.251916 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:07:04.254054 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:07:04.254646 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:07:04.254926 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:07:04.255118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.256039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.256380 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:07:04.256668 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:07:04.264874 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:07:04.266202 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:07:04.266603 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:07:04.267827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.269178 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:07:04.269509 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:07:04.270875 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.273513 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:07:04.273908 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:07:04.275254 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.277723 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:07:04.278105 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:07:04.279233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.280707 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:07:04.281172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:07:04.281444 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:07:04.288205 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:07:04.290550 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:07:04.291058 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:07:04.297624 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:07:04.299049 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:07:04.299959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5928596c00>]}
[0m11:07:04.300595 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m11:07:04.301118 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:07:04.301462 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:07:04.301806 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m11:07:04.302203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:07:04.302444 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:07:04.304732 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:07:04.306162 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:07:04.310223 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:07:04.311358 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:07:04.311672 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:07:04.311882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.312824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.313198 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:07:04.313740 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:07:04.316850 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:07:04.317810 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:07:04.318073 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:07:04.319160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.320388 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:07:04.320759 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:07:04.323063 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:07:04.326289 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:07:04.326670 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:07:04.327724 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.329880 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:07:04.330170 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:07:04.330958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.331853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:07:04.332096 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:07:04.332292 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:07:04.338205 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:07:04.340120 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:07:04.340491 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:07:04.346530 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:07:04.347850 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:07:04.348684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5928560d70>]}
[0m11:07:04.349184 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.05s]
[0m11:07:04.349622 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:07:04.349904 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:07:04.350232 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m11:07:04.350608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:07:04.350847 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:07:04.353246 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:07:04.354691 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:07:04.357571 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:07:04.358208 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:07:04.358481 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:07:04.358705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.359482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.359794 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:07:04.360004 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:07:04.362969 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:07:04.363995 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:07:04.364316 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:07:04.365278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.366332 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:07:04.366607 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:07:04.368060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.371253 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:07:04.371660 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:07:04.372767 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.375370 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:07:04.375687 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:07:04.376603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.377627 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:07:04.377922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:07:04.378138 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:07:04.383146 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:07:04.385369 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:07:04.385711 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:07:04.391167 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:07:04.392352 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:07:04.392981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5928537320>]}
[0m11:07:04.393498 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:07:04.394024 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:07:04.394361 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:07:04.394958 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m11:07:04.395353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:07:04.395636 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:07:04.397740 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:07:04.398356 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:07:04.402687 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:07:04.403793 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:07:04.404368 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:07:04.404808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.406044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.406687 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:07:04.407141 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:07:04.410931 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:07:04.412699 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:07:04.414588 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:07:04.416573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.418289 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:07:04.418691 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:07:04.420448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.423348 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:07:04.423732 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:07:04.424848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.426925 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:07:04.427205 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:07:04.427893 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:07:04.428783 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:07:04.429057 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:07:04.429285 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:07:04.435948 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:07:04.438112 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:07:04.438473 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:07:04.444105 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:07:04.445439 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:07:04.446140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a592867f260>]}
[0m11:07:04.446760 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.05s]
[0m11:07:04.447298 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:07:04.447646 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:07:04.448024 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:07:04.448468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m11:07:04.449091 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:07:04.451428 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:07:04.452089 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:07:04.454303 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:07:04.454929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:07:04.455218 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:07:04.455455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.456205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.456469 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:07:04.456645 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:07:04.458022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.458845 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:07:04.459082 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:07:04.459847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.460878 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:07:04.461357 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:07:04.462965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.465818 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:07:04.466218 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:07:04.467129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.469137 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:07:04.469520 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:07:04.470466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.471518 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:07:04.471832 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:07:04.472068 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:07:04.478247 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:07:04.480430 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:07:04.480794 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:07:04.487446 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:07:04.489034 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:07:04.490071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a59301b1400>]}
[0m11:07:04.490627 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:07:04.491049 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:07:04.491349 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:07:04.491746 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m11:07:04.492263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m11:07:04.492979 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:07:04.496184 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:07:04.496895 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:07:04.499347 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:07:04.499980 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:07:04.500270 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:07:04.500710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.501939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.502223 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:07:04.502497 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

derive as (
    select
        player_id,
        display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored / expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted / expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
)



select * from derive
    );
  
  
[0m11:07:04.509579 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:07:04.511055 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:07:04.511432 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:07:04.512543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.513675 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:07:04.514024 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:07:04.515817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.519822 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:07:04.520228 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:07:04.521107 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.523112 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:07:04.523426 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:07:04.524555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.525945 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:07:04.526540 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:07:04.526777 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:07:04.533633 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:07:04.535483 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:07:04.535788 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:07:04.541450 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:07:04.542936 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:07:04.543656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a59285bd700>]}
[0m11:07:04.544145 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.05s]
[0m11:07:04.544586 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:07:04.544872 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:07:04.545248 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:07:04.545909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m11:07:04.546217 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:07:04.548664 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:07:04.549618 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:07:04.551639 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:07:04.552113 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:07:04.552350 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:07:04.552537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.553479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.553749 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:07:04.554098 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:07:04.556905 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:07:04.558724 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:07:04.559207 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:07:04.560281 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.561477 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:07:04.561755 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:07:04.563109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.565123 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:07:04.565415 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:07:04.566191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:07:04.567881 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:07:04.568118 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:07:04.568997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.569999 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:07:04.570287 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:07:04.570595 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:07:04.576603 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:07:04.578425 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:07:04.578706 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:07:04.583748 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:07:04.585244 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:07:04.586026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a592869be90>]}
[0m11:07:04.586544 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m11:07:04.587021 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:07:04.587387 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:07:04.587817 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m11:07:04.588991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:07:04.589521 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:07:04.591695 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:07:04.592363 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:07:04.594467 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:07:04.595109 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:07:04.595431 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:07:04.595615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.596761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:07:04.597069 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:07:04.597404 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        case when team_abbreviation='NFO' then 'Nottingham Forest' else team as team
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:07:04.597985 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        case when team_abbreviation='NFO' then 'Nottingham Forest' else team as team
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:07:04.598287 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:07:04.598589 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: ROLLBACK
[0m11:07:04.608236 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_teams'
[0m11:07:04.608614 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:07:04.610413 [debug] [Thread-1 (]: Runtime Error in model int_teams (fpl_analytics/models/intermediate/int_teams.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14: ... team_abbreviation='NFO' then 'Nottingham Forest' else team as team
                                                                          ^
[0m11:07:04.610786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81429520-5720-4bcd-8e4a-f0efa42f3f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a592853ddf0>]}
[0m11:07:04.611249 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model intermediate.int_teams .................. [[31mERROR[0m in 0.02s]
[0m11:07:04.611771 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:07:04.612409 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model int_teams (fpl_analytics/models/intermediate/int_teams.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14: ... team_abbreviation='NFO' then 'Nottingham Forest' else team as team
                                                                          ^.
[0m11:07:04.613834 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:07:04.614166 [info ] [Thread-1 (]: 10 of 10 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m11:07:04.614499 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:07:04.614866 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m11:07:04.616142 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:04.616386 [debug] [MainThread]: On master: BEGIN
[0m11:07:04.616567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:04.617405 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:07:04.617769 [debug] [MainThread]: On master: COMMIT
[0m11:07:04.617986 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:04.618168 [debug] [MainThread]: On master: COMMIT
[0m11:07:04.619012 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:07:04.619420 [debug] [MainThread]: On master: Close
[0m11:07:04.619919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:04.620168 [debug] [MainThread]: Connection 'model.fpl_analytics.int_teams' was properly closed.
[0m11:07:04.620604 [info ] [MainThread]: 
[0m11:07:04.620983 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m11:07:04.622183 [debug] [MainThread]: Command end result
[0m11:07:04.635086 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:07:04.636650 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:07:04.640907 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:07:04.641174 [info ] [MainThread]: 
[0m11:07:04.641510 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:07:04.641775 [info ] [MainThread]: 
[0m11:07:04.642059 [error] [MainThread]: [31mFailure in model int_teams (fpl_analytics/models/intermediate/int_teams.sql)[0m
[0m11:07:04.642325 [error] [MainThread]:   Runtime Error in model int_teams (fpl_analytics/models/intermediate/int_teams.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 14: ... team_abbreviation='NFO' then 'Nottingham Forest' else team as team
                                                                          ^
[0m11:07:04.642520 [info ] [MainThread]: 
[0m11:07:04.642754 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_teams.sql
[0m11:07:04.642947 [info ] [MainThread]: 
[0m11:07:04.643184 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=10
[0m11:07:04.644739 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5344727, "process_in_blocks": "103272", "process_kernel_time": 0.361, "process_mem_max_rss": "166860", "process_out_blocks": "3840", "process_user_time": 2.694611}
[0m11:07:04.645157 [debug] [MainThread]: Command `dbt build` failed at 11:07:04.645074 after 1.54 seconds
[0m11:07:04.645466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a593bf30950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a59304b4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a593afdbbc0>]}
[0m11:07:04.645688 [debug] [MainThread]: Flushing usage events
[0m11:07:05.188129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:08:15.292473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729abc660650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729abd28a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729abc1c10d0>]}


============================== 11:08:15.297683 | e4fc2b74-533d-423d-bed6-cd2eb7d72265 ==============================
[0m11:08:15.297683 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:08:15.298308 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'debug': 'False', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager'}
[0m11:08:15.515436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729abb4e8d10>]}
[0m11:08:15.575078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729abb61bbc0>]}
[0m11:08:15.578291 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:08:15.628418 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:08:15.723610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:08:15.724080 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_teams.sql
[0m11:08:16.013858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729ab13ed910>]}
[0m11:08:16.059426 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:08:16.061268 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:08:16.145186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729ab12f95e0>]}
[0m11:08:16.145616 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m11:08:16.147633 [info ] [MainThread]: 
[0m11:08:16.148022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:16.148272 [info ] [MainThread]: 
[0m11:08:16.148683 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:08:16.152512 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:08:16.181265 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:08:16.181629 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:08:16.181868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:16.206965 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m11:08:16.208261 [debug] [ThreadPool]: On list_analytics: Close
[0m11:08:16.212101 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:08:16.212542 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:08:16.212778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:16.214414 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:08:16.215332 [debug] [ThreadPool]: On list_analytics: Close
[0m11:08:16.216678 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:08:16.216933 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:08:16.217152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:16.218180 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:08:16.218890 [debug] [ThreadPool]: On list_analytics: Close
[0m11:08:16.219583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m11:08:16.219877 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:08:16.224266 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:08:16.224648 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:08:16.224850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:16.227141 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:08:16.228651 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:08:16.228879 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:08:16.229312 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:08:16.229497 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:08:16.229678 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:08:16.230379 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:08:16.231198 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:08:16.231513 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:08:16.231777 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:08:16.232491 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:08:16.232700 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:08:16.233132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m11:08:16.233438 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:08:16.234641 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:08:16.234907 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:08:16.235067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:16.235849 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:08:16.236587 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:08:16.236824 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:08:16.237199 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:08:16.237396 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:08:16.237570 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:08:16.237998 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:08:16.238521 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:08:16.238705 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:08:16.238918 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:08:16.239289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:08:16.239463 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:08:16.239868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m11:08:16.240176 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:08:16.241169 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:08:16.241401 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:08:16.241620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:16.242629 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:08:16.243527 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:08:16.243750 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:08:16.244248 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:08:16.244494 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:08:16.244653 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:08:16.245368 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:08:16.246114 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:08:16.246356 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:08:16.246521 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:08:16.247014 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:08:16.247269 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:08:16.248833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m11:08:16.252704 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:08:16.253152 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:08:16.253367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:16.254192 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:08:16.254434 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:08:16.254616 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:08:16.262637 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:08:16.263562 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:08:16.266495 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:08:16.266708 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:08:16.267201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m11:08:16.268303 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:08:16.268547 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:08:16.268744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:16.269866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:08:16.270075 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:08:16.270237 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:08:16.272593 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:08:16.273374 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:08:16.273964 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:08:16.274150 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:08:16.274558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m11:08:16.275587 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:08:16.275827 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:08:16.276027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:16.276958 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:08:16.277155 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:08:16.277320 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:08:16.279675 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:08:16.280519 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:08:16.281003 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:08:16.281169 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:08:16.282235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729ab14e8230>]}
[0m11:08:16.282543 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:16.282711 [debug] [MainThread]: On master: BEGIN
[0m11:08:16.282860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:08:16.283292 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:08:16.283476 [debug] [MainThread]: On master: COMMIT
[0m11:08:16.283623 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:16.283759 [debug] [MainThread]: On master: COMMIT
[0m11:08:16.284355 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:08:16.284837 [debug] [MainThread]: On master: Close
[0m11:08:16.288474 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:08:16.288854 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:08:16.289200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_gameweeks)
[0m11:08:16.289449 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:08:16.294256 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.294690 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:08:16.316213 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.316774 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.317024 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:08:16.317233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.317913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.318152 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.318332 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:08:16.321409 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:08:16.324866 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.325142 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:08:16.326133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.327339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.327745 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:08:16.329206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.333309 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.333585 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:08:16.334908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.336454 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.336688 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:08:16.337205 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.346154 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:08:16.346404 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.346603 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:08:16.352806 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:08:16.356449 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:08:16.356720 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:08:16.361620 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:08:16.363635 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:08:16.365484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729abde12d20>]}
[0m11:08:16.366002 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m11:08:16.366408 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:08:16.366704 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:08:16.367028 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m11:08:16.367384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:08:16.367636 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:08:16.369547 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:08:16.370444 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:08:16.372347 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:08:16.372774 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:08:16.373003 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:08:16.373188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.373959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.374185 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:08:16.374419 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:08:16.381792 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:08:16.382621 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:08:16.382855 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:08:16.383631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.384407 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:08:16.384620 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:08:16.385538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.387423 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:08:16.387672 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:08:16.388207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.389760 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:08:16.390002 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:08:16.390502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.391264 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:08:16.391474 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:08:16.391646 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:08:16.397768 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:08:16.399408 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:08:16.399663 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:08:16.405526 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:08:16.406681 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:08:16.407301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729a81ba3740>]}
[0m11:08:16.407715 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m11:08:16.408097 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:08:16.408383 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:08:16.408688 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m11:08:16.409083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:08:16.409354 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:08:16.411580 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:08:16.412073 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:08:16.414971 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:08:16.415401 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:08:16.415629 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:08:16.415810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.416482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.416802 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:08:16.417009 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:08:16.419021 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:08:16.419778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:08:16.420010 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:08:16.420686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.421539 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:08:16.421833 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:08:16.422715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.424524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:08:16.424744 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:08:16.425494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.427369 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:08:16.427626 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:08:16.428213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.428971 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:08:16.429209 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:08:16.429456 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:08:16.434454 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:08:16.435785 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:08:16.436050 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:08:16.440574 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:08:16.441802 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:08:16.442375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729a81ab9dc0>]}
[0m11:08:16.442837 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.03s]
[0m11:08:16.443231 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:08:16.443498 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:08:16.444115 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m11:08:16.444610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:08:16.444855 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:08:16.446606 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:08:16.447017 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:08:16.448736 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:08:16.449128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:08:16.449343 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:08:16.449532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.450606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.450989 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:08:16.451357 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:08:16.455055 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:08:16.455830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:08:16.456106 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:08:16.457079 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.458167 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:08:16.458482 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:08:16.459639 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.461376 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:08:16.461616 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:08:16.462152 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.463617 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:08:16.463832 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:08:16.464318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.465079 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:08:16.465329 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:08:16.465524 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:08:16.471575 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:08:16.473259 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:08:16.473540 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:08:16.478252 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:08:16.479565 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:08:16.480534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729ab1306a20>]}
[0m11:08:16.481108 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:08:16.481822 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:08:16.482122 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:08:16.482517 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m11:08:16.482834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:08:16.483049 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:08:16.484766 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:08:16.485171 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:08:16.488089 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:08:16.488510 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:08:16.488733 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:08:16.488916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.489599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.489870 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:08:16.490065 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:08:16.492362 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:08:16.493093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:08:16.493404 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:08:16.494187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.495010 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:08:16.495238 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:08:16.496226 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.498697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:08:16.498969 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:08:16.499526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.501109 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:08:16.501382 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:08:16.501966 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.502801 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:08:16.503031 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:08:16.503219 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:08:16.509377 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:08:16.511000 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:08:16.511271 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:08:16.516419 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:08:16.517323 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:08:16.517844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729a81acca70>]}
[0m11:08:16.518248 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.03s]
[0m11:08:16.518609 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:08:16.518860 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:08:16.519168 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:08:16.519677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m11:08:16.519981 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:08:16.521841 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:08:16.522553 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:08:16.524493 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:08:16.524922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:08:16.525155 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:08:16.525345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.526303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.526697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:08:16.527036 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:08:16.528576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.529601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:08:16.530000 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:08:16.530711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.531565 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:08:16.531789 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:08:16.532803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.534929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:08:16.535222 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:08:16.535784 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.537401 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:08:16.537668 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:08:16.538258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.539068 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:08:16.539328 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:08:16.539524 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:08:16.544596 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:08:16.546014 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:08:16.546273 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:08:16.550702 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:08:16.552062 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:08:16.552561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729a81a86780>]}
[0m11:08:16.552963 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m11:08:16.553337 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:08:16.553611 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:08:16.553975 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m11:08:16.554385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m11:08:16.554596 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:08:16.556330 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:08:16.556726 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:08:16.558615 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:08:16.559018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:08:16.559238 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:08:16.559422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.560136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.560367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:08:16.560598 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

derive as (
    select
        player_id,
        display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored / expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted / expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
)



select * from derive
    );
  
  
[0m11:08:16.568592 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:08:16.569438 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:08:16.569687 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:08:16.570453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.571327 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:08:16.571560 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:08:16.572564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.575493 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:08:16.575736 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:08:16.576537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.578972 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:08:16.579358 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:08:16.580502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.581899 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:08:16.582153 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:08:16.582347 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:08:16.588410 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:08:16.590036 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:08:16.590309 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:08:16.594806 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:08:16.595724 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:08:16.596606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729a81ae94c0>]}
[0m11:08:16.597020 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.04s]
[0m11:08:16.597395 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:08:16.597653 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:08:16.598090 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:08:16.598402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m11:08:16.598618 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:08:16.600334 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:08:16.600758 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:08:16.602605 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:08:16.603010 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:08:16.603234 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:08:16.603442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.604109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.604318 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:08:16.604499 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:08:16.605736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.606445 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:08:16.606667 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:08:16.607399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.608260 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:08:16.608470 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:08:16.609376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.611070 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:08:16.611295 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:08:16.612119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.614565 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:08:16.614830 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:08:16.615740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.616624 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:08:16.616850 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:08:16.617025 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:08:16.622825 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:08:16.624144 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:08:16.624365 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:08:16.629042 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:08:16.630296 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:08:16.630809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729ab131c230>]}
[0m11:08:16.631223 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.03s]
[0m11:08:16.631611 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:08:16.631863 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:08:16.632260 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m11:08:16.632585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:08:16.632817 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:08:16.634515 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:08:16.634933 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:08:16.636867 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:08:16.637269 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:08:16.637512 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:08:16.637754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.638460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.638694 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:08:16.638898 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        case when team_abbreviation='NFO' then 'Nottingham Forest' else team end as team
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:08:16.640447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.641477 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:08:16.641944 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:08:16.642650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.643474 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:08:16.643719 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:08:16.644639 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.646558 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:08:16.646880 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:08:16.647798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.651658 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:08:16.652194 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:08:16.652765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.653570 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:08:16.653834 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:08:16.654013 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:08:16.659858 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:08:16.661370 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:08:16.661640 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:08:16.666589 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:08:16.667632 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:08:16.668144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729a800fa990>]}
[0m11:08:16.668581 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.04s]
[0m11:08:16.668969 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:08:16.669604 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:08:16.670070 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m11:08:16.670388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m11:08:16.670624 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:08:16.672593 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:08:16.673005 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:08:16.674870 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:08:16.675300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:08:16.675530 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:08:16.675728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:16.676496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.676748 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:08:16.676946 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
)

select * from join_players
    );
  
  
[0m11:08:16.686004 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:08:16.686993 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:08:16.687276 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:08:16.688079 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.688954 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:08:16.689194 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:08:16.690180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.692140 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:08:16.692414 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:08:16.693021 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:08:16.694904 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:08:16.695228 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:08:16.696074 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:08:16.697428 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:08:16.697791 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:08:16.698133 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:08:16.705111 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:08:16.706891 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:08:16.707193 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:08:16.712509 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:08:16.713865 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:08:16.715065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4fc2b74-533d-423d-bed6-cd2eb7d72265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729a81bc0e30>]}
[0m11:08:16.715529 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m11:08:16.715931 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:08:16.717110 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:16.717363 [debug] [MainThread]: On master: BEGIN
[0m11:08:16.717540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:08:16.718417 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:08:16.718770 [debug] [MainThread]: On master: COMMIT
[0m11:08:16.719059 [debug] [MainThread]: Using duckdb connection "master"
[0m11:08:16.719361 [debug] [MainThread]: On master: COMMIT
[0m11:08:16.719949 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:08:16.720349 [debug] [MainThread]: On master: Close
[0m11:08:16.720826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:16.721168 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:08:16.721454 [info ] [MainThread]: 
[0m11:08:16.721797 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m11:08:16.722987 [debug] [MainThread]: Command end result
[0m11:08:16.735760 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:08:16.737344 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:08:16.741542 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:08:16.741932 [info ] [MainThread]: 
[0m11:08:16.742231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:16.742452 [info ] [MainThread]: 
[0m11:08:16.742698 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m11:08:16.744966 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.506418, "process_in_blocks": "105648", "process_kernel_time": 0.377753, "process_mem_max_rss": "168120", "process_out_blocks": "4168", "process_user_time": 2.571162}
[0m11:08:16.745550 [debug] [MainThread]: Command `dbt build` succeeded at 11:08:16.745398 after 1.51 seconds
[0m11:08:16.745920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729a81ab1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729abb6cc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729abb6cc650>]}
[0m11:08:16.746193 [debug] [MainThread]: Flushing usage events
[0m11:08:17.253871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:27.620455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401e857a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401dd45970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401de06f30>]}


============================== 11:12:27.624108 | 1f7b15f0-1fc7-4d22-8199-54b78e4d429a ==============================
[0m11:12:27.624108 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:12:27.624511 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/home/robgriffin247/fpl/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'fail_fast': 'False', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build'}
[0m11:12:27.821766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401d8b1730>]}
[0m11:12:27.878378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401e2d5bb0>]}
[0m11:12:27.881537 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:12:27.932521 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:12:28.023113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:12:28.023564 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m11:12:28.270120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4013cced20>]}
[0m11:12:28.309285 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:12:28.310992 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:12:28.375783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40138e3dd0>]}
[0m11:12:28.376171 [info ] [MainThread]: Found 10 models, 5 sources, 445 macros
[0m11:12:28.377669 [info ] [MainThread]: 
[0m11:12:28.377988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:12:28.378227 [info ] [MainThread]: 
[0m11:12:28.378589 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:12:28.382519 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:12:28.409542 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:12:28.409873 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:12:28.410071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:28.427600 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m11:12:28.428623 [debug] [ThreadPool]: On list_analytics: Close
[0m11:12:28.431349 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:12:28.431639 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:12:28.431871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:28.432873 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:12:28.433615 [debug] [ThreadPool]: On list_analytics: Close
[0m11:12:28.434801 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:12:28.435045 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:12:28.435272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:28.436297 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:12:28.436987 [debug] [ThreadPool]: On list_analytics: Close
[0m11:12:28.437626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m11:12:28.437901 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:12:28.441811 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:12:28.442030 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:12:28.442178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:28.443042 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:12:28.443886 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:12:28.444073 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:12:28.444667 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:12:28.444859 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:12:28.445030 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:12:28.445438 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:12:28.445912 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:12:28.446087 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:12:28.446231 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:12:28.446570 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:12:28.446804 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:12:28.447308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m11:12:28.447595 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:12:28.448509 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:12:28.448792 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:12:28.448994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:28.449739 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:12:28.450398 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:12:28.450612 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:12:28.451210 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:12:28.451408 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:12:28.451563 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:12:28.452084 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:12:28.452826 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:12:28.453122 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:12:28.453376 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:12:28.454069 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:12:28.454277 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:12:28.454648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m11:12:28.455283 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:12:28.456225 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:12:28.456411 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:12:28.456566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:28.457314 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:12:28.458002 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:12:28.458176 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:12:28.458957 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:12:28.459262 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:12:28.459420 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:12:28.459790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:12:28.460249 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:12:28.460423 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:12:28.460562 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:12:28.460890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:12:28.461071 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:12:28.462498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_intermediate)
[0m11:12:28.465623 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:12:28.465861 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:12:28.466056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:28.466651 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:12:28.466865 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:12:28.467020 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:12:28.474813 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:12:28.475956 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:12:28.477871 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:12:28.478102 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:12:28.478556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m11:12:28.479714 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:12:28.479955 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:12:28.480668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:28.481406 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:12:28.481719 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:12:28.481988 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:12:28.484778 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:12:28.485588 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:12:28.486073 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:12:28.486238 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:12:28.486659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m11:12:28.487793 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:12:28.488011 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:12:28.488212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:28.489636 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:12:28.489870 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:12:28.490078 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:12:28.492527 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:12:28.493414 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:12:28.493898 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:12:28.494059 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:12:28.494974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40138f3cb0>]}
[0m11:12:28.495371 [debug] [MainThread]: Using duckdb connection "master"
[0m11:12:28.495538 [debug] [MainThread]: On master: BEGIN
[0m11:12:28.495676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:28.496110 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:12:28.496282 [debug] [MainThread]: On master: COMMIT
[0m11:12:28.496424 [debug] [MainThread]: Using duckdb connection "master"
[0m11:12:28.496583 [debug] [MainThread]: On master: COMMIT
[0m11:12:28.496923 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:12:28.497097 [debug] [MainThread]: On master: Close
[0m11:12:28.500927 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:12:28.501314 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:12:28.501644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_gameweeks)
[0m11:12:28.501852 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:12:28.506578 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.507050 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:12:28.527724 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.528786 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.529056 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:12:28.529245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.530291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.530560 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.530768 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:12:28.533119 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:12:28.536655 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.536937 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:12:28.537735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.538578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.538811 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:12:28.539727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.543564 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.543804 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:12:28.545556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.547471 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.547748 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:12:28.548599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.557470 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:12:28.557812 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.558001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:12:28.565097 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:12:28.568719 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:12:28.568984 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:12:28.574014 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:12:28.576057 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:12:28.577797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4020256c90>]}
[0m11:12:28.578218 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m11:12:28.578604 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:12:28.578854 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:12:28.579190 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.stg_players .............................. [RUN]
[0m11:12:28.579760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:12:28.580335 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:12:28.582325 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:12:28.582782 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:12:28.584513 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:12:28.584983 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:12:28.585206 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:12:28.585387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.586057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.586259 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:12:28.586476 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:12:28.594332 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:12:28.595388 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:12:28.595701 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:12:28.596503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.597323 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:12:28.597547 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:12:28.598381 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.600219 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:12:28.600436 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:12:28.600997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.602474 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:12:28.602699 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:12:28.603569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.604455 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:12:28.604697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:12:28.604889 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:12:28.611695 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:12:28.613830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:12:28.614090 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:12:28.619433 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:12:28.620558 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:12:28.621148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401045d760>]}
[0m11:12:28.621572 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m11:12:28.621936 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:12:28.622187 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:12:28.622493 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.stg_positions ............................ [RUN]
[0m11:12:28.622833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:12:28.623396 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:12:28.625439 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:12:28.625889 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:12:28.628682 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:12:28.629092 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:12:28.629314 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:12:28.629504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.630180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.630490 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:12:28.630701 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:12:28.632743 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:12:28.633481 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:12:28.633709 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:12:28.634640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.635578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:12:28.635812 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:12:28.636930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.638776 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:12:28.639027 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:12:28.639674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.641386 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:12:28.641633 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:12:28.642141 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.642945 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:12:28.643221 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:12:28.643416 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:12:28.648993 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:12:28.650689 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:12:28.650996 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:12:28.655536 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:12:28.656568 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:12:28.657087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401049fa40>]}
[0m11:12:28.657508 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.03s]
[0m11:12:28.657885 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:12:28.658136 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:12:28.658427 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.stg_stats ................................ [RUN]
[0m11:12:28.658762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:12:28.659011 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:12:28.661399 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:12:28.661808 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:12:28.663501 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:12:28.663905 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:12:28.664125 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:12:28.664308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.665351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.665619 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:12:28.665824 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:12:28.667868 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:12:28.668730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:12:28.669015 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:12:28.669876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.670957 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:12:28.671226 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:12:28.672402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.674268 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:12:28.674496 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:12:28.675207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.676754 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:12:28.676975 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:12:28.677440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.678217 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:12:28.678455 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:12:28.678649 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:12:28.684336 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:12:28.686006 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:12:28.686274 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:12:28.690815 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:12:28.691939 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:12:28.692696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40104600e0>]}
[0m11:12:28.693132 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.03s]
[0m11:12:28.693504 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:12:28.693760 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:12:28.694059 [info ] [Thread-1 (]: 5 of 10 START sql table model staging.stg_teams ................................ [RUN]
[0m11:12:28.694569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:12:28.694892 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:12:28.696650 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:12:28.697030 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:12:28.699929 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:12:28.700513 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:12:28.700776 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:12:28.700971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.701844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.702088 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:12:28.702261 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:12:28.704102 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:12:28.705131 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:12:28.705482 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:12:28.706557 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.707328 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:12:28.707548 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:12:28.708561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.710751 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:12:28.711001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:12:28.711631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.713006 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:12:28.713222 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:12:28.713687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.714495 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:12:28.714744 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:12:28.714939 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:12:28.720849 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:12:28.722378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:12:28.722626 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:12:28.727030 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:12:28.728033 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:12:28.728555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40104698b0>]}
[0m11:12:28.728955 [info ] [Thread-1 (]: 5 of 10 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.03s]
[0m11:12:28.729335 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:12:28.729599 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:12:28.729892 [info ] [Thread-1 (]: 6 of 10 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:12:28.730223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_gameweeks)
[0m11:12:28.730485 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:12:28.732579 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:12:28.732994 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:12:28.734638 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:12:28.735025 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:12:28.735293 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:12:28.735505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.736155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.736386 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:12:28.736591 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:12:28.737773 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.738473 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:12:28.738685 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:12:28.739413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.740262 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:12:28.740522 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:12:28.741672 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.743547 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:12:28.743806 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:12:28.744648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.746418 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:12:28.746647 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:12:28.747307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.748080 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:12:28.748305 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:12:28.748496 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:12:28.752922 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:12:28.754334 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:12:28.754568 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:12:28.759159 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:12:28.760239 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:12:28.760904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40105a7860>]}
[0m11:12:28.761359 [info ] [Thread-1 (]: 6 of 10 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m11:12:28.761815 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:12:28.762070 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:12:28.762380 [info ] [Thread-1 (]: 7 of 10 START sql table model intermediate.int_players ......................... [RUN]
[0m11:12:28.762757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_players)
[0m11:12:28.763076 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:12:28.764810 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:12:28.765190 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:12:28.766880 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:12:28.767305 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:12:28.767559 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:12:28.767748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.768504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.768725 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:12:28.768977 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        minutes_played,
        total_points,
        gameweek_points,
        points_per_game,
        total_points / minutes_played as points_per_minute_played,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        ict_index,
        selection_rate,
        gameweek_transfers_in,
        gameweek_transfers_out,
        gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        goals_scored,
        expected_goals_scored,
        goals_scored / expected_goals_scored as goals_scored_differential,
        goals_assisted,
        expected_goals_assisted,
        goals_assisted / expected_goals_assisted as goals_assisted_differential,
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_differential,
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
)



select * from derive
    );
  
  
[0m11:12:28.776046 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:12:28.776998 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:12:28.777270 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:12:28.778084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.778915 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:12:28.779190 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:12:28.780149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.783830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:12:28.784085 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:12:28.784721 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.786364 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:12:28.786593 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:12:28.787206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.788011 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:12:28.788244 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:12:28.788433 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:12:28.794128 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:12:28.795759 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:12:28.796013 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:12:28.800324 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:12:28.801380 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:12:28.802165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40104cd790>]}
[0m11:12:28.802574 [info ] [Thread-1 (]: 7 of 10 OK created sql table model intermediate.int_players .................... [[32mOK[0m in 0.04s]
[0m11:12:28.802991 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:12:28.803269 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:12:28.803606 [info ] [Thread-1 (]: 8 of 10 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:12:28.804163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.int_positions)
[0m11:12:28.804420 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:12:28.806211 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:12:28.806614 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:12:28.808396 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:12:28.808803 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:12:28.809023 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:12:28.809220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.809887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.810091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:12:28.810267 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:12:28.811535 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.812183 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:12:28.812408 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:12:28.813880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.815364 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:12:28.815646 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:12:28.816611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.819019 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:12:28.819367 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:12:28.820192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.821841 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:12:28.822080 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:12:28.822687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.823637 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:12:28.823869 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:12:28.824044 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:12:28.829713 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:12:28.831335 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:12:28.831586 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:12:28.836539 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:12:28.837557 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:12:28.838087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40104436e0>]}
[0m11:12:28.838497 [info ] [Thread-1 (]: 8 of 10 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.03s]
[0m11:12:28.838887 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:12:28.839176 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:12:28.839648 [info ] [Thread-1 (]: 9 of 10 START sql table model intermediate.int_teams ........................... [RUN]
[0m11:12:28.839991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:12:28.840221 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:12:28.841822 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:12:28.842200 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:12:28.843877 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:12:28.844256 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:12:28.844470 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:12:28.844664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.845407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.845680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:12:28.845903 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        case when team_abbreviation='NFO' then 'Nottingham Forest' else team end as team
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:12:28.847134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.847777 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:12:28.847981 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:12:28.848595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.849478 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:12:28.849705 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:12:28.850813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.852735 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:12:28.852977 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:12:28.853504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.856119 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:12:28.856351 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:12:28.856861 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.857604 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:12:28.857857 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:12:28.858046 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:12:28.863379 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:12:28.864887 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:12:28.865164 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:12:28.869689 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:12:28.870957 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:12:28.871722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40104dea20>]}
[0m11:12:28.872280 [info ] [Thread-1 (]: 9 of 10 OK created sql table model intermediate.int_teams ...................... [[32mOK[0m in 0.03s]
[0m11:12:28.872859 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:12:28.873779 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:12:28.874116 [info ] [Thread-1 (]: 10 of 10 START sql table model core.obt_players ................................ [RUN]
[0m11:12:28.874426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.obt_players)
[0m11:12:28.874638 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:12:28.876628 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:12:28.877440 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:12:28.879235 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:12:28.879693 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:12:28.879946 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:12:28.880137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:28.880916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.881154 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:12:28.881352 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
)

select * from join_players
    );
  
  
[0m11:12:28.888348 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:12:28.889738 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:12:28.890058 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:12:28.891040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.891913 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:12:28.892131 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:12:28.893054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:12:28.894860 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:12:28.895136 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:12:28.895800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.897406 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:12:28.897636 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:12:28.898155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:12:28.898976 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:12:28.899211 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:12:28.899394 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:12:28.905190 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:12:28.906761 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:12:28.907008 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:12:28.911438 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:12:28.912846 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:12:28.914423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f7b15f0-1fc7-4d22-8199-54b78e4d429a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401045e9c0>]}
[0m11:12:28.915045 [info ] [Thread-1 (]: 10 of 10 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.04s]
[0m11:12:28.915656 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:12:28.917000 [debug] [MainThread]: Using duckdb connection "master"
[0m11:12:28.917244 [debug] [MainThread]: On master: BEGIN
[0m11:12:28.917414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:28.918064 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:12:28.918299 [debug] [MainThread]: On master: COMMIT
[0m11:12:28.918481 [debug] [MainThread]: Using duckdb connection "master"
[0m11:12:28.918635 [debug] [MainThread]: On master: COMMIT
[0m11:12:28.919236 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:12:28.919455 [debug] [MainThread]: On master: Close
[0m11:12:28.919771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:28.919956 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:12:28.920183 [info ] [MainThread]: 
[0m11:12:28.920421 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m11:12:28.921403 [debug] [MainThread]: Command end result
[0m11:12:28.932717 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:12:28.933886 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:12:28.937704 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:12:28.937960 [info ] [MainThread]: 
[0m11:12:28.938234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:28.938480 [info ] [MainThread]: 
[0m11:12:28.938722 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m11:12:28.940183 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3679312, "process_in_blocks": "97936", "process_kernel_time": 0.273624, "process_mem_max_rss": "168540", "process_out_blocks": "4168", "process_user_time": 2.583731}
[0m11:12:28.940565 [debug] [MainThread]: Command `dbt build` succeeded at 11:12:28.940486 after 1.37 seconds
[0m11:12:28.940803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401e6915e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4013bca2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e401dda3560>]}
[0m11:12:28.941039 [debug] [MainThread]: Flushing usage events
[0m11:12:29.522708 [debug] [MainThread]: An error was encountered while trying to flush usage events
