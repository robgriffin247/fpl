[0m10:21:49.211933 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:21:49.213486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:49.216161 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:21:49.216586 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:21:49.217200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:21:49.218113 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:21:49.218420 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:21:49.218650 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:21:49.223840 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:21:49.225730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:21:49.226074 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:21:49.230993 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:21:49.232317 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:21:49.233878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f0cc519-650f-4d25-95bb-1a5728b3acf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d261329b800>]}
[0m10:21:49.234415 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m10:21:49.234908 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:21:49.235224 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:21:49.235754 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:21:49.236197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:21:49.236511 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:21:49.239177 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:21:49.239878 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:21:49.242240 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:21:49.242830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:21:49.243099 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:21:49.243299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:49.244146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:49.244443 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:21:49.244690 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        case when points_per_90 is null then points_per_90 else 0 end as points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        coalesce(goals_scored_per_90, 0) as goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:21:49.252571 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:21:49.253658 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:21:49.254016 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:21:49.255315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:49.256856 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:21:49.257185 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:21:49.258397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:49.260764 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:21:49.261095 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:21:49.262126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:49.264383 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:21:49.264739 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:21:49.265715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:21:49.266834 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:21:49.267116 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:21:49.267357 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:21:49.274143 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:21:49.276006 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:21:49.276382 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:21:49.281794 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:21:49.283496 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:21:49.284877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f0cc519-650f-4d25-95bb-1a5728b3acf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2613681e50>]}
[0m10:21:49.285451 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.05s]
[0m10:21:49.285894 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:21:49.287384 [debug] [MainThread]: Using duckdb connection "master"
[0m10:21:49.287857 [debug] [MainThread]: On master: BEGIN
[0m10:21:49.288116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:49.289054 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:21:49.289370 [debug] [MainThread]: On master: COMMIT
[0m10:21:49.289597 [debug] [MainThread]: Using duckdb connection "master"
[0m10:21:49.289777 [debug] [MainThread]: On master: COMMIT
[0m10:21:49.290370 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:21:49.290630 [debug] [MainThread]: On master: Close
[0m10:21:49.291023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:49.291236 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:21:49.291531 [info ] [MainThread]: 
[0m10:21:49.291818 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m10:21:49.293270 [debug] [MainThread]: Command end result
[0m10:21:49.307865 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:21:49.309495 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:21:49.314393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:21:49.314771 [info ] [MainThread]: 
[0m10:21:49.315126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:49.315397 [info ] [MainThread]: 
[0m10:21:49.315650 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:21:49.316568 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5958198, "process_in_blocks": "208", "process_kernel_time": 0.295901, "process_mem_max_rss": "175728", "process_out_blocks": "4640", "process_user_time": 2.546306}
[0m10:21:49.316999 [debug] [MainThread]: Command `dbt build` succeeded at 10:21:49.316914 after 1.60 seconds
[0m10:21:49.317280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26614cdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2661b59670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2661b5a9f0>]}
[0m10:21:49.317541 [debug] [MainThread]: Flushing usage events
[0m10:21:50.000862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:21:59.321064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73895e505670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73895c181a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73895b8a8800>]}


============================== 10:21:59.323669 | 6e920160-1c79-4d96-95cf-a49e631dcdeb ==============================
[0m10:21:59.323669 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:21:59.324097 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build', 'empty': 'False', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error': 'None', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True'}
[0m10:21:59.533041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738951c266f0>]}
[0m10:21:59.600160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73895b7f7da0>]}
[0m10:21:59.601542 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:21:59.652455 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:21:59.724557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:21:59.725111 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m10:22:00.038432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389515f3da0>]}
[0m10:22:00.087203 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:22:00.088654 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:22:00.160566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738951c45010>]}
[0m10:22:00.161007 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:22:00.163110 [info ] [MainThread]: 
[0m10:22:00.163488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:22:00.163763 [info ] [MainThread]: 
[0m10:22:00.164184 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:22:00.168605 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:22:00.197768 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:22:00.198189 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:22:00.198562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:00.221571 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m10:22:00.222999 [debug] [ThreadPool]: On list_analytics: Close
[0m10:22:00.225127 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:22:00.225590 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:22:00.225869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:00.227683 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:22:00.229004 [debug] [ThreadPool]: On list_analytics: Close
[0m10:22:00.230820 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:22:00.231138 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:22:00.231466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:00.232941 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:22:00.233927 [debug] [ThreadPool]: On list_analytics: Close
[0m10:22:00.234670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m10:22:00.235101 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:22:00.240674 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:22:00.241232 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:22:00.241476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:00.242830 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:22:00.244149 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:22:00.244534 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:22:00.245292 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:00.245719 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:22:00.246065 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:22:00.247113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:22:00.247857 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:22:00.248115 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:22:00.248409 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:22:00.249097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:00.249377 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:22:00.250005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m10:22:00.250417 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:22:00.251824 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:22:00.252130 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:22:00.252692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:00.254065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:22:00.255243 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:22:00.255562 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:22:00.256108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:00.256411 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:22:00.256657 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:22:00.257236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:00.257948 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:22:00.258201 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:22:00.258417 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:22:00.258943 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:00.259203 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:22:00.259837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m10:22:00.260252 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:22:00.261685 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:22:00.262015 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:22:00.262288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:00.263452 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:22:00.264577 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:22:00.264854 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:22:00.265358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:00.265627 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:22:00.265837 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:22:00.266350 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:00.267038 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:22:00.267307 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:22:00.267521 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:22:00.268022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:00.268288 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:22:00.270188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m10:22:00.274694 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:22:00.275035 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:22:00.275308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:00.276466 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:22:00.276775 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:22:00.276999 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:22:00.287972 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:22:00.289446 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:22:00.290392 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:22:00.290710 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:22:00.291356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m10:22:00.294954 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:22:00.295283 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:22:00.295510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:00.296254 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:22:00.296541 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:22:00.296796 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:22:00.300331 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:22:00.301870 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:22:00.302670 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:22:00.302983 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:22:00.303667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m10:22:00.305303 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:22:00.305653 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:22:00.305924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:00.307383 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:22:00.307726 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:22:00.307982 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:22:00.311699 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:22:00.313236 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:22:00.313987 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:22:00.314246 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:22:00.316052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73893810b6b0>]}
[0m10:22:00.316583 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:00.316844 [debug] [MainThread]: On master: BEGIN
[0m10:22:00.317064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:00.317723 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:22:00.318014 [debug] [MainThread]: On master: COMMIT
[0m10:22:00.318235 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:00.318439 [debug] [MainThread]: On master: COMMIT
[0m10:22:00.319043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:22:00.319312 [debug] [MainThread]: On master: Close
[0m10:22:00.321837 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:22:00.322354 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:22:00.323013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_fixtures)
[0m10:22:00.323352 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:22:00.329908 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:22:00.330556 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:22:00.359994 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:22:00.360836 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:22:00.361211 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:22:00.361478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.362536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.362924 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:22:00.363209 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:22:00.365549 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.370688 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:22:00.371064 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:22:00.372065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.373277 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:22:00.373638 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:22:00.374916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.380749 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:22:00.381132 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:22:00.382341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.385659 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:22:00.386042 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:22:00.386879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:00.400940 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:22:00.401354 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:22:00.401646 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:22:00.408933 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:00.414186 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:22:00.414612 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:22:00.420406 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:22:00.422841 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:22:00.424854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73895e02ac00>]}
[0m10:22:00.425480 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.10s]
[0m10:22:00.426053 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:22:00.426460 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:22:00.426894 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:22:00.427374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:22:00.427743 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:22:00.430476 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.431485 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:22:00.435430 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.436030 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.436372 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:22:00.436661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.437597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.437900 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.438185 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:22:00.440031 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.441065 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.441441 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:22:00.442671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.443853 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.444168 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:22:00.445423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.448131 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.448592 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:22:00.449401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:22:00.451714 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.452076 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:22:00.452968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.454323 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:22:00.454710 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.455017 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:22:00.461345 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:22:00.463944 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:22:00.464451 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:22:00.470325 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:22:00.472050 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:22:00.473277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73895c640140>]}
[0m10:22:00.474030 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.05s]
[0m10:22:00.474589 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:22:00.474983 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:22:00.475476 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:22:00.476057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:22:00.476782 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:22:00.480223 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:22:00.481180 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:22:00.484122 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:22:00.485003 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:22:00.485377 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:22:00.485661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.486686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.487097 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:22:00.487478 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:22:00.499145 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:22:00.500645 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:22:00.501142 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:22:00.503366 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.505273 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:22:00.505803 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:22:00.508430 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.512351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:22:00.512932 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:22:00.514177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.517265 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:22:00.517768 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:22:00.519020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.520777 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:22:00.521268 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:22:00.521595 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:22:00.530554 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:22:00.533403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:22:00.533908 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:22:00.541867 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:00.543707 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:22:00.545061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73893810b920>]}
[0m10:22:00.545852 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.07s]
[0m10:22:00.546503 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:22:00.546934 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:22:00.547499 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:22:00.548053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:22:00.548508 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:22:00.551467 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:22:00.552367 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:22:00.555174 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:22:00.555882 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:22:00.556331 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:22:00.556673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.557712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.558145 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:22:00.558484 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:22:00.561072 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.562412 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:22:00.562880 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:22:00.564046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.567123 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:22:00.567533 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:22:00.569429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.572531 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:22:00.572958 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:22:00.574127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.576909 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:22:00.577398 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:22:00.578660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.580201 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:22:00.580661 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:22:00.581001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:22:00.587957 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:22:00.590708 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:22:00.591167 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:22:00.599104 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:00.601267 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:22:00.602295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73893810b7a0>]}
[0m10:22:00.603173 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.05s]
[0m10:22:00.603909 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:22:00.604424 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:22:00.605041 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:22:00.605706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:22:00.606148 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:22:00.609608 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:22:00.611390 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:22:00.615062 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:22:00.615960 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:22:00.616453 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:22:00.616841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.618425 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.619172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:22:00.619651 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:22:00.622594 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.624337 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:22:00.624944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:22:00.626779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.628526 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:22:00.629074 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:22:00.630982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.635045 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:22:00.635890 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:22:00.637865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.641323 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:22:00.642006 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:22:00.643623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.645745 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:22:00.646319 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:22:00.646815 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:22:00.654794 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:00.657843 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:22:00.658367 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:22:00.666492 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:00.668806 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:22:00.670287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73893810bb90>]}
[0m10:22:00.671313 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.06s]
[0m10:22:00.672104 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:22:00.672695 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:22:00.673343 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:22:00.674057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:22:00.674586 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:22:00.678313 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:22:00.679658 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:22:00.683303 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:22:00.684157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:22:00.684666 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:22:00.685020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.686232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.686664 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:22:00.687035 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:22:00.689936 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.691407 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:22:00.691947 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:22:00.693333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.694936 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:22:00.695463 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:22:00.697545 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.703415 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:22:00.704022 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:22:00.705570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.709056 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:22:00.709578 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:22:00.710764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.712552 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:22:00.713105 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:22:00.713514 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:22:00.721262 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:00.724480 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:22:00.725027 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:22:00.732835 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:00.735212 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:22:00.736752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389381af050>]}
[0m10:22:00.737730 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.06s]
[0m10:22:00.738539 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:22:00.739103 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:22:00.739926 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:22:00.741494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:22:00.742066 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:22:00.745696 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:22:00.746480 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:22:00.750094 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:22:00.750951 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:22:00.751454 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:22:00.751820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.753132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.753606 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:22:00.754044 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:22:00.757926 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:22:00.759542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:22:00.760010 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:22:00.761453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.763140 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:22:00.763620 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:22:00.765660 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.769597 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:22:00.770142 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:22:00.771377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.774706 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:22:00.775219 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:22:00.776456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.778105 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:22:00.778652 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:22:00.779045 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:22:00.787173 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:22:00.790594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:22:00.791235 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:22:00.799978 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:22:00.802447 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:22:00.803881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738939b71280>]}
[0m10:22:00.804795 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.06s]
[0m10:22:00.805486 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:22:00.805975 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:22:00.806595 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:22:00.807897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:22:00.808583 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:22:00.811703 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:22:00.812478 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:22:00.815837 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:22:00.816804 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:22:00.817280 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:22:00.817706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.818782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.819162 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:22:00.819553 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:22:00.821567 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.823220 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:22:00.823785 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:22:00.825673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.827480 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:22:00.827976 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:22:00.829738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.833850 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:22:00.834599 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:22:00.835955 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.841499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:22:00.842176 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:22:00.843838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.845740 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:22:00.846309 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:22:00.846748 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:22:00.854466 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:00.857712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:22:00.858228 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:22:00.864593 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:22:00.866609 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:22:00.867644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389381887a0>]}
[0m10:22:00.868526 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.06s]
[0m10:22:00.869256 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:22:00.869819 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:22:00.870473 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:22:00.871201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:22:00.872208 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:22:00.876006 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:22:00.877060 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:22:00.880670 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:22:00.881509 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:22:00.882023 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:22:00.882433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.884065 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.884688 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:22:00.885195 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:22:00.887879 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.889486 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:22:00.889949 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:22:00.891601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.893530 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:22:00.894105 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:22:00.896113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.899917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:22:00.900487 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:22:00.901966 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.905125 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:22:00.905716 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:22:00.907023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.908732 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:22:00.909234 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:22:00.909591 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:22:00.916897 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:00.919776 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:22:00.920355 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:22:00.926576 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:22:00.928775 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:22:00.930057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738938121970>]}
[0m10:22:00.930783 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.06s]
[0m10:22:00.931597 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:22:00.932153 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:22:00.933043 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:22:00.933778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:22:00.934260 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:22:00.937700 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:22:00.938471 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:22:00.941811 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:22:00.942614 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:22:00.943101 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:22:00.943588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:00.945391 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:00.946322 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:22:00.946983 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:22:00.950203 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:22:00.952308 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:22:00.953021 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:22:00.954513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.956132 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:22:00.956708 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:22:00.958473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.962516 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:22:00.963092 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:22:00.964954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.969579 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:22:00.970102 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:22:00.971402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:00.973170 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:22:00.973646 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:22:00.974012 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:22:00.980619 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:22:00.985762 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:22:00.986309 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:22:00.993203 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:22:00.995325 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:22:00.996442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389381d0a40>]}
[0m10:22:00.997322 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.06s]
[0m10:22:00.998004 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:22:00.998464 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:22:00.999089 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:22:00.999846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:22:01.000841 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:22:01.004335 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.005219 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:22:01.008822 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.009648 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.010098 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:22:01.010462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:01.011953 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.012448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.012854 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:22:01.015237 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:01.016730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.017224 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:22:01.018736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.020422 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.020922 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:22:01.022709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.026727 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.027184 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:22:01.028597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.031897 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.032510 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:22:01.033734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.035502 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:22:01.035954 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.036343 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:22:01.043630 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:01.046576 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:22:01.047148 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:22:01.053256 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:22:01.055892 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:22:01.057484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738939c41b80>]}
[0m10:22:01.058368 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.06s]
[0m10:22:01.059118 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:22:01.059668 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:22:01.060293 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:22:01.061200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:22:01.061636 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:22:01.066030 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:22:01.066960 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:22:01.070437 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:22:01.071295 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:22:01.071769 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:22:01.072186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:01.073641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.074138 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:22:01.074672 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
)




select * from convert_cost_category
    );
  
  
[0m10:22:01.105640 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m10:22:01.107537 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:22:01.108075 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:22:01.109766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.111815 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:22:01.112454 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:22:01.114499 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:01.118411 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:22:01.118976 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:22:01.120539 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.124408 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:22:01.124935 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:22:01.126309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.128077 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:22:01.128612 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:22:01.128986 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:22:01.138985 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:22:01.144078 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:22:01.144711 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:22:01.152614 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:22:01.154642 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:22:01.157807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738939bdfbf0>]}
[0m10:22:01.158679 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.10s]
[0m10:22:01.159433 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:22:01.159978 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:22:01.160927 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:22:01.161924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:22:01.162453 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:22:01.166651 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:22:01.167621 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:22:01.171514 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:22:01.172454 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:22:01.172976 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:22:01.173340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:01.174814 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.175462 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:22:01.176257 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:22:01.184777 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:22:01.186500 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:22:01.187005 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:22:01.188825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.190475 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:22:01.190947 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:22:01.193239 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:01.197273 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:22:01.197786 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:22:01.199215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.202584 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:22:01.203165 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:22:01.204459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.206199 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:22:01.206670 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:22:01.207105 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:22:01.215525 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:22:01.218634 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:22:01.219141 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:22:01.228012 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:22:01.230047 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:22:01.231311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738939bee9f0>]}
[0m10:22:01.232207 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.07s]
[0m10:22:01.232967 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:22:01.233468 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:22:01.234078 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:22:01.235029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:22:01.235572 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:22:01.239899 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:22:01.240826 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:22:01.244303 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:22:01.245226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:22:01.245693 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:22:01.246030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:01.247742 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:01.248238 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:22:01.248748 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        case when points_per_90 is not null then points_per_90 else 0 end as points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        coalesce(goals_scored_per_90, 0) as goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:22:01.261756 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:22:01.263660 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:22:01.264181 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:22:01.265841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.267519 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:22:01.267986 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:22:01.269674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.273633 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:22:01.274159 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:22:01.275438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.278655 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:22:01.279120 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:22:01.280448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:01.282250 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:22:01.282791 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:22:01.283158 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:22:01.295273 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:22:01.298508 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:22:01.299099 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:22:01.306068 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:22:01.308006 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:22:01.310389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e920160-1c79-4d96-95cf-a49e631dcdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738939bee450>]}
[0m10:22:01.311243 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.08s]
[0m10:22:01.312037 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:22:01.314754 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:01.315238 [debug] [MainThread]: On master: BEGIN
[0m10:22:01.315562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:01.317245 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:22:01.317723 [debug] [MainThread]: On master: COMMIT
[0m10:22:01.318103 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:01.318439 [debug] [MainThread]: On master: COMMIT
[0m10:22:01.319360 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:22:01.319793 [debug] [MainThread]: On master: Close
[0m10:22:01.320482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:01.320924 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:22:01.321502 [info ] [MainThread]: 
[0m10:22:01.322084 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m10:22:01.324908 [debug] [MainThread]: Command end result
[0m10:22:01.349934 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:22:01.352747 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:22:01.361232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:22:01.361698 [info ] [MainThread]: 
[0m10:22:01.362200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:01.362726 [info ] [MainThread]: 
[0m10:22:01.363200 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:22:01.364591 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.1018746, "process_in_blocks": "0", "process_kernel_time": 0.311657, "process_mem_max_rss": "175904", "process_out_blocks": "4624", "process_user_time": 3.069237}
[0m10:22:01.365371 [debug] [MainThread]: Command `dbt build` succeeded at 10:22:01.365216 after 2.10 seconds
[0m10:22:01.365987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73895c2a7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389381973b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73895bf39ee0>]}
[0m10:22:01.366556 [debug] [MainThread]: Flushing usage events
[0m10:22:02.021677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:33.592011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788598532420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78859a3f5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78859a7ab920>]}


============================== 10:28:33.598158 | 29149583-9ca1-4643-8e98-9ba5678e6624 ==============================
[0m10:28:33.598158 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:28:33.598681 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build'}
[0m10:28:33.899434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788597f49a30>]}
[0m10:28:33.961319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788597c33620>]}
[0m10:28:33.963577 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:28:34.018575 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:28:34.124001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:28:34.124552 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m10:28:34.124869 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:28:34.422861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78858650a870>]}
[0m10:28:34.467838 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:28:34.469593 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:28:34.549023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78858d5edcd0>]}
[0m10:28:34.549418 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:28:34.551427 [info ] [MainThread]: 
[0m10:28:34.551905 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:34.552168 [info ] [MainThread]: 
[0m10:28:34.552608 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:28:34.556741 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:28:34.587060 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:28:34.587447 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:28:34.587670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:34.629407 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m10:28:34.631021 [debug] [ThreadPool]: On list_analytics: Close
[0m10:28:34.632721 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:28:34.633006 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:28:34.633256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:34.634397 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:34.635237 [debug] [ThreadPool]: On list_analytics: Close
[0m10:28:34.636685 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:28:34.636975 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:28:34.637223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:34.638292 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:34.639126 [debug] [ThreadPool]: On list_analytics: Close
[0m10:28:34.639766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m10:28:34.640097 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:28:34.644777 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:28:34.645091 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:28:34.645284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:34.646580 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:34.647678 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:28:34.647912 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:28:34.648372 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:28:34.648593 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:28:34.648768 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:28:34.649236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:28:34.649799 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:28:34.650018 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:28:34.650191 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:28:34.650621 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:28:34.650836 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:28:34.651348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m10:28:34.651700 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:28:34.652921 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:28:34.653144 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:28:34.653323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:34.654571 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:34.655475 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:28:34.655686 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:28:34.656155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:28:34.656371 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:28:34.656544 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:28:34.657005 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:28:34.657556 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:28:34.657770 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:28:34.657942 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:28:34.658396 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:28:34.658649 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:28:34.659153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m10:28:34.659652 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:28:34.661032 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:28:34.661283 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:28:34.661469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:34.662551 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:34.663484 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:28:34.663707 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:28:34.664158 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:28:34.664376 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:28:34.664552 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:28:34.665251 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:34.665851 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:28:34.666066 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:28:34.666238 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:28:34.666916 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:28:34.667296 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:28:34.669329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m10:28:34.673308 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:28:34.673647 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:28:34.673895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:34.674938 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:34.675169 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:28:34.675399 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:28:34.687326 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:28:34.688549 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:28:34.690418 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:28:34.690764 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:28:34.691326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m10:28:34.693359 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:28:34.693627 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:28:34.693856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:34.696028 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:28:34.696307 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:28:34.696503 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:28:34.699428 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:28:34.700418 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:28:34.701013 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:28:34.701242 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:28:34.701872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m10:28:34.703134 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:28:34.703401 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:28:34.704112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:34.704911 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:34.705262 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:28:34.705613 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:28:34.708453 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:28:34.709436 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:28:34.709975 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:28:34.710170 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:28:34.711936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78858d5ef050>]}
[0m10:28:34.712367 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:34.712577 [debug] [MainThread]: On master: BEGIN
[0m10:28:34.712756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:34.713341 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:28:34.713640 [debug] [MainThread]: On master: COMMIT
[0m10:28:34.713857 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:34.714014 [debug] [MainThread]: On master: COMMIT
[0m10:28:34.714480 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:28:34.714721 [debug] [MainThread]: On master: Close
[0m10:28:34.717460 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:28:34.717884 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:28:34.718430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_fixtures)
[0m10:28:34.718773 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:28:34.723990 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:28:34.725366 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:28:34.749475 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:28:34.750078 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:28:34.750350 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:28:34.750627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:34.751420 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.751664 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:28:34.751868 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:28:34.755954 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:28:34.761034 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:28:34.761433 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:28:34.762654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.763664 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:28:34.763928 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:28:34.767288 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:28:34.772469 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:28:34.772809 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:28:34.773585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:34.775620 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:28:34.775899 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:28:34.776555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:34.787429 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:28:34.787801 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:28:34.788019 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:28:34.794597 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:34.798757 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:28:34.799094 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:28:34.803978 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:34.806775 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:28:34.809147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78859854c080>]}
[0m10:28:34.809675 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m10:28:34.810106 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:28:34.810459 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:28:34.810844 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:28:34.811276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:28:34.811559 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:28:34.813572 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.814585 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:28:34.818137 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.818678 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.818944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:28:34.819149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:34.820002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.820266 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.820478 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:28:34.822684 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:28:34.823528 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.823777 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:28:34.824536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.825498 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.825754 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:28:34.827182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.830168 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.830465 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:28:34.831478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.833578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.833922 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:28:34.834736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.835827 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:28:34.836109 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.836325 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:28:34.842436 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:34.844273 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:28:34.844577 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:28:34.849676 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:34.850971 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:28:34.851610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788544517110>]}
[0m10:28:34.852151 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m10:28:34.852573 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:28:34.852858 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:28:34.853182 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:28:34.853577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:28:34.853864 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:28:34.856026 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:28:34.856908 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:28:34.859549 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:28:34.860074 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:28:34.860375 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:28:34.860637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:34.861717 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.861964 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:28:34.862198 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:28:34.870998 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:28:34.872026 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:28:34.872298 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:28:34.873176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.874080 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:28:34.874343 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:28:34.875408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.877436 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:28:34.877708 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:28:34.878754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.880487 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:28:34.880740 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:28:34.881301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:34.882279 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:28:34.882582 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:28:34.882868 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:28:34.889868 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:28:34.891675 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:28:34.892020 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:28:34.897157 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:34.898331 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:28:34.899123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7885444ff770>]}
[0m10:28:34.899591 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m10:28:34.900013 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:28:34.900317 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:28:34.900656 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:28:34.901241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:28:34.901548 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:28:34.903605 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:28:34.904083 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:28:34.906038 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:28:34.906509 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:28:34.906750 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:28:34.906988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:34.907719 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.907952 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:28:34.908140 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:28:34.910662 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:28:34.911571 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:28:34.911836 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:28:34.912934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.915341 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:28:34.915667 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:28:34.916822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.919085 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:28:34.919390 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:28:34.920506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.923189 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:28:34.923473 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:28:34.924201 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:34.925081 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:28:34.925316 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:28:34.925532 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:28:34.932384 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:28:34.934346 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:28:34.934700 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:28:34.940968 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:34.942787 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:28:34.943783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78854450cbc0>]}
[0m10:28:34.944251 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m10:28:34.944712 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:28:34.945001 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:28:34.945349 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:28:34.946321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:28:34.946896 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:28:34.949298 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:28:34.949877 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:28:34.952086 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:28:34.952645 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:28:34.952976 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:28:34.953183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:34.954131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.954524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:28:34.954758 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:28:34.957516 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:28:34.958905 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:28:34.959206 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:28:34.960125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.960980 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:28:34.961229 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:28:34.962389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.964849 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:28:34.965163 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:28:34.966117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.968248 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:28:34.968545 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:28:34.969388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.970835 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:28:34.971146 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:28:34.971343 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:28:34.977640 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:34.979530 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:28:34.979885 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:28:34.986551 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:34.987982 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:28:34.988616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78854450bad0>]}
[0m10:28:34.989134 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m10:28:34.989569 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:28:34.990052 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:28:34.990512 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:28:34.991362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:28:34.991676 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:28:34.993734 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:28:34.994212 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:28:34.996320 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:28:34.996769 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:28:34.997062 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:28:34.997291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:34.998158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:34.998510 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:28:34.998745 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:28:35.001756 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:28:35.002680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:28:35.002951 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:28:35.004040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.005035 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:28:35.005369 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:28:35.006646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.009909 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:28:35.010181 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:28:35.010902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:35.012535 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:28:35.012762 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:28:35.013306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:35.014097 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:28:35.014419 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:28:35.014669 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:28:35.021493 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:35.023440 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:28:35.023733 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:28:35.029490 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:35.030977 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:28:35.031594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7885445ab140>]}
[0m10:28:35.032052 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m10:28:35.032510 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:28:35.032850 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:28:35.033243 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:28:35.034033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:28:35.034402 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:28:35.036490 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:28:35.037068 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:28:35.039209 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:28:35.039740 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:28:35.040003 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:28:35.040220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:35.040956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.041194 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:28:35.041420 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:28:35.044355 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:28:35.045266 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:28:35.045535 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:28:35.046336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.047279 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:28:35.047526 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:28:35.048606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.050606 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:28:35.050853 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:28:35.051686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.053841 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:28:35.054080 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:28:35.054976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.056109 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:28:35.056380 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:28:35.056586 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:28:35.062972 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:35.064711 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:28:35.064995 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:28:35.071576 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:35.073438 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:28:35.074407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788585a76a20>]}
[0m10:28:35.075012 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m10:28:35.075526 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:28:35.075845 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:28:35.076219 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:28:35.076918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:28:35.077198 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:28:35.079373 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:28:35.079937 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:28:35.082160 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:28:35.082781 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:28:35.083088 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:28:35.083323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:35.084350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.084869 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:28:35.085360 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:28:35.086784 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.087636 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:28:35.087923 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:28:35.088896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.089953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:28:35.090238 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:28:35.091628 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.094757 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:28:35.095044 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:28:35.095858 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.098427 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:28:35.098746 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:28:35.099332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:35.100193 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:28:35.100456 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:28:35.100696 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:28:35.107489 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:35.109393 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:28:35.109686 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:28:35.114674 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:35.116144 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:28:35.116928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788544586c30>]}
[0m10:28:35.117577 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m10:28:35.118222 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:28:35.118612 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:28:35.118990 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:28:35.119403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:28:35.119707 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:28:35.121718 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:28:35.122693 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:28:35.125023 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:28:35.125559 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:28:35.125881 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:28:35.126124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:35.127174 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.127611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:28:35.127976 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:28:35.129674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.130514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:28:35.130819 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:28:35.131605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.132639 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:28:35.132878 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:28:35.133827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.135887 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:28:35.136171 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:28:35.137034 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:35.138932 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:28:35.139198 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:28:35.139956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:35.140949 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:28:35.141217 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:28:35.141423 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:28:35.147369 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:35.148979 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:28:35.149270 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:28:35.154746 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:35.156009 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:28:35.156684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788585a5e930>]}
[0m10:28:35.157214 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m10:28:35.157683 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:28:35.158001 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:28:35.158620 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:28:35.159043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:28:35.159323 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:28:35.161362 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:28:35.161845 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:28:35.163934 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:28:35.164389 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:28:35.164665 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:28:35.164862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:35.165611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.165835 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:28:35.166030 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:28:35.167564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.168375 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:28:35.168617 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:28:35.169506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.171544 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:28:35.171893 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:28:35.173310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.175674 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:28:35.175982 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:28:35.176981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.179410 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:28:35.179715 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:28:35.180598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.181528 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:28:35.181797 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:28:35.182038 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:28:35.187454 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:35.190397 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:28:35.190754 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:28:35.196658 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:35.198352 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:28:35.199394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7885445d1790>]}
[0m10:28:35.199963 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m10:28:35.200391 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:28:35.200720 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:28:35.201131 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:28:35.201758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:28:35.202074 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:28:35.204101 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.204729 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:28:35.207110 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.207617 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.207902 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:28:35.208109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:35.208896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.209172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.209398 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:28:35.210862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.211685 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.211957 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:28:35.212743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.213620 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.213850 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:28:35.214790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.216953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.217216 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:28:35.218094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.220662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.220978 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:28:35.221840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.222871 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:28:35.223161 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.223356 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:28:35.230027 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:35.232136 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:28:35.232472 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:28:35.238174 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:35.239557 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:28:35.240184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7885445ea000>]}
[0m10:28:35.240659 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m10:28:35.241125 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:28:35.241448 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:28:35.241814 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:28:35.242486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:28:35.242804 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:28:35.245353 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:28:35.245973 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:28:35.248124 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:28:35.248669 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:28:35.248924 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:28:35.249119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:35.249909 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.250182 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:28:35.250547 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),

        coalesce(points_per_90, 0) as points_per_90,

        coalesce(goals_scored_per_90, 0) as goals_scored_per_90,
        coalesce(goals_scored_xdifferential, 0) as goals_scored_xdifferential,
        coalesce(expected_goals_scored_per_90, 0) as expected_goals_scored_per_90,

        coalesce(goals_assisted_per_90, 0) as goals_assisted_per_90,
        coalesce(goals_assisted_xdifferential, 0) as goals_assisted_xdifferential,
        coalesce(expected_goals_assisted_per_90, 0) as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from convert_cost_category
    );
  
  
[0m10:28:35.280867 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m10:28:35.281918 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:28:35.282214 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:28:35.283188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.284307 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:28:35.284573 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:28:35.285732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.288082 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:28:35.288411 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:28:35.289443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.291379 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:28:35.291646 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:28:35.292408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:35.293498 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:28:35.293825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:28:35.294046 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:28:35.301848 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:28:35.304750 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:28:35.305051 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:28:35.310546 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:35.312239 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:28:35.314517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78854457a240>]}
[0m10:28:35.315070 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.07s]
[0m10:28:35.315513 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:28:35.315832 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:28:35.316163 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:28:35.316574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:28:35.316852 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:28:35.319258 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:28:35.320086 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:28:35.322053 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:28:35.322565 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:28:35.322832 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:28:35.323021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:35.323800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.324077 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:28:35.324334 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:28:35.330782 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:35.331798 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:28:35.332080 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:28:35.333046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.333927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:28:35.334159 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:28:35.335429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.337716 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:28:35.337991 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:28:35.338696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:35.340385 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:28:35.340641 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:28:35.341259 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:28:35.342205 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:28:35.342532 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:28:35.342796 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:28:35.349799 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:28:35.351860 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:28:35.352167 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:28:35.357907 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:28:35.359310 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:28:35.360192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78854455b800>]}
[0m10:28:35.360698 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m10:28:35.361143 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:28:35.361454 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:28:35.361864 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:28:35.362307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:28:35.362653 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:28:35.365551 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:28:35.367428 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:28:35.370142 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:28:35.370930 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:28:35.371252 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:28:35.371468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:35.372276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.372553 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:28:35.372862 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:28:35.382060 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:28:35.383157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:28:35.383451 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:28:35.384633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.385854 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:28:35.386182 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:28:35.387413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.389699 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:28:35.390016 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:28:35.391021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.394388 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:28:35.394889 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:28:35.396049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:35.397294 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:28:35.397658 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:28:35.397938 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:28:35.405309 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:28:35.407593 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:28:35.408109 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:28:35.415299 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:28:35.416684 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:28:35.418291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29149583-9ca1-4643-8e98-9ba5678e6624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7885444fe840>]}
[0m10:28:35.418903 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.06s]
[0m10:28:35.419391 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:28:35.421323 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:35.421807 [debug] [MainThread]: On master: BEGIN
[0m10:28:35.422173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:35.423072 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:28:35.423330 [debug] [MainThread]: On master: COMMIT
[0m10:28:35.423533 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:35.423716 [debug] [MainThread]: On master: COMMIT
[0m10:28:35.424218 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:28:35.424433 [debug] [MainThread]: On master: Close
[0m10:28:35.424772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:35.424976 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:28:35.425287 [info ] [MainThread]: 
[0m10:28:35.425599 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m10:28:35.427040 [debug] [MainThread]: Command end result
[0m10:28:35.442494 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:28:35.444042 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:28:35.449193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:28:35.449607 [info ] [MainThread]: 
[0m10:28:35.449961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:28:35.450240 [info ] [MainThread]: 
[0m10:28:35.450698 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:28:35.452878 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.9159591, "process_in_blocks": "180376", "process_kernel_time": 0.439489, "process_mem_max_rss": "176144", "process_out_blocks": "4656", "process_user_time": 2.691387}
[0m10:28:35.453256 [debug] [MainThread]: Command `dbt build` succeeded at 10:28:35.453176 after 1.92 seconds
[0m10:28:35.453556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78859854ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78859854ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788597b27530>]}
[0m10:28:35.453818 [debug] [MainThread]: Flushing usage events
[0m10:28:36.028083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:56.914070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c5a3dc1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c5a0e79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c5ab90e90>]}


============================== 10:35:56.921629 | 618bc973-d09e-41f7-896b-4e1742e54ef8 ==============================
[0m10:35:56.921629 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:35:56.922901 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'log_cache_events': 'False', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/robgriffin247/fpl'}
[0m10:35:57.418073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c59b9b770>]}
[0m10:35:57.529023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c5c2326c0>]}
[0m10:35:57.535048 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:35:57.666205 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:35:57.940619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:35:57.941509 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:35:58.574031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c4cbeff80>]}
[0m10:35:58.658496 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:35:58.661840 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:35:58.822143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c501b52b0>]}
[0m10:35:58.824036 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:35:58.828634 [info ] [MainThread]: 
[0m10:35:58.829495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:58.830131 [info ] [MainThread]: 
[0m10:35:58.831036 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:35:58.839194 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:35:58.891625 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:35:58.892205 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:35:58.892596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:58.938043 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m10:35:58.939759 [debug] [ThreadPool]: On list_analytics: Close
[0m10:35:58.942325 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:35:58.942823 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:35:58.943181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:58.944907 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:35:58.946295 [debug] [ThreadPool]: On list_analytics: Close
[0m10:35:58.948704 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:35:58.949635 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:35:58.951511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:58.955400 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:35:58.957816 [debug] [ThreadPool]: On list_analytics: Close
[0m10:35:58.959585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m10:35:58.960161 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:35:58.968071 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:35:58.968628 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:35:58.968946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:58.971491 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:35:58.974002 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:35:58.974502 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:35:58.975821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:58.976858 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:35:58.977217 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:35:58.978165 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:58.979868 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:35:58.980522 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:35:58.981123 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:35:58.982821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:58.983253 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:35:58.984109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m10:35:58.984701 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:35:58.987278 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:35:58.988052 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:35:58.988408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:58.990032 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:35:58.993276 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:35:58.993848 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:35:58.995589 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:58.996629 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:35:58.997014 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:35:58.998299 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:58.999345 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:35:58.999691 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:35:59.000021 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:35:59.001188 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:59.001715 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:35:59.002835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m10:35:59.003492 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:35:59.005913 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:35:59.006514 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:35:59.006852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:59.008471 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:35:59.009888 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:35:59.010240 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:35:59.011378 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:59.011746 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:35:59.012195 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:35:59.013079 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:35:59.014146 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:35:59.014631 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:35:59.014962 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:35:59.015798 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:59.016202 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:35:59.019901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_intermediate)
[0m10:35:59.027761 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:35:59.028231 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:35:59.028518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:59.030068 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:59.030620 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:35:59.031078 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:35:59.052954 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m10:35:59.055678 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:35:59.058304 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:35:59.058885 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:35:59.060028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m10:35:59.065124 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:35:59.065682 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:35:59.066141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:59.068288 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:35:59.068696 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:35:59.068997 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:35:59.076553 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m10:35:59.078524 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:35:59.079514 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:35:59.079840 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:35:59.080831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m10:35:59.085053 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:35:59.085722 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:35:59.086123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:59.089464 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:35:59.089922 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:35:59.090314 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:35:59.095602 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:35:59.097248 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:35:59.098173 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:35:59.098588 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:35:59.101497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2befffcfb0>]}
[0m10:35:59.103489 [debug] [MainThread]: Using duckdb connection "master"
[0m10:35:59.104086 [debug] [MainThread]: On master: BEGIN
[0m10:35:59.104716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:59.106520 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:35:59.107349 [debug] [MainThread]: On master: COMMIT
[0m10:35:59.107819 [debug] [MainThread]: Using duckdb connection "master"
[0m10:35:59.108307 [debug] [MainThread]: On master: COMMIT
[0m10:35:59.110837 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:35:59.112296 [debug] [MainThread]: On master: Close
[0m10:35:59.124731 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:35:59.125548 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:35:59.126786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_fixtures)
[0m10:35:59.127249 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:35:59.139635 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:35:59.140802 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:35:59.184501 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:35:59.185399 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:35:59.185853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:35:59.186249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:59.187698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.188282 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:35:59.188757 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:35:59.195582 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:35:59.201888 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:35:59.202488 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:35:59.204117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.205659 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:35:59.206196 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:35:59.211821 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:35:59.221652 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:35:59.222637 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:35:59.225907 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:35:59.230578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:35:59.231189 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:35:59.232347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.256445 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:35:59.257180 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:35:59.257575 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:35:59.271017 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:35:59.280134 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:35:59.280711 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:35:59.289225 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:35:59.294575 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:35:59.298733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c5ab60cb0>]}
[0m10:35:59.299611 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.17s]
[0m10:35:59.300601 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:35:59.301136 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:35:59.302683 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:35:59.303649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:35:59.304161 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:35:59.307360 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.308143 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:35:59.314976 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.315871 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.316313 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:35:59.316648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:59.318620 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.319283 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.319816 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:35:59.323522 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:35:59.324919 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.325374 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:35:59.327172 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.332238 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.333642 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:35:59.337430 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:35:59.342047 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.342851 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:35:59.344651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.351076 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.351687 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:35:59.353370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.355447 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:35:59.356139 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.356590 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:35:59.368996 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:35:59.372848 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:35:59.373404 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:35:59.383647 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:35:59.385639 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:35:59.386713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2beffeb800>]}
[0m10:35:59.387569 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m10:35:59.388277 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:35:59.388763 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:35:59.389564 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:35:59.390519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:35:59.391534 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:35:59.395945 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:35:59.400327 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:35:59.406248 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:35:59.407758 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:35:59.408286 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:35:59.408641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:59.410183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.411028 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:35:59.411670 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:35:59.429132 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:35:59.430751 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:35:59.431202 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:35:59.432700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.434553 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:35:59.435148 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:35:59.437833 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.441558 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:35:59.442182 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:35:59.443491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.446608 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:35:59.447060 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:35:59.448647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.450554 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:35:59.451117 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:35:59.451497 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:35:59.460909 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:35:59.463697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:35:59.464180 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:35:59.473455 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:35:59.475482 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:35:59.477288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2befffe420>]}
[0m10:35:59.478115 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.09s]
[0m10:35:59.479232 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:35:59.480477 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:35:59.481530 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:35:59.483748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:35:59.484884 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:35:59.491869 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:35:59.493793 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:35:59.498757 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:35:59.499963 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:35:59.500857 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:35:59.501449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:59.505045 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.506537 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:35:59.507368 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:35:59.512492 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:35:59.514018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:35:59.514605 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:35:59.517952 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.525667 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:35:59.527050 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:35:59.529894 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.534789 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:35:59.535489 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:35:59.538133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.543517 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:35:59.544197 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:35:59.545544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.547177 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:35:59.547629 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:35:59.548020 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:35:59.558200 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:35:59.561335 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:35:59.561828 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:35:59.570616 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:35:59.574257 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:35:59.576484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2bec1177d0>]}
[0m10:35:59.577423 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.09s]
[0m10:35:59.578204 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:35:59.578731 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:35:59.579275 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:35:59.580171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:35:59.581049 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:35:59.585240 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:35:59.587019 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:35:59.591491 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:35:59.593018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:35:59.593609 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:35:59.593929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:59.595202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.595733 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:35:59.596069 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:35:59.602545 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:35:59.604333 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:35:59.604852 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:35:59.607816 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.611935 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:35:59.612575 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:35:59.614870 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.619209 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:35:59.619944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:35:59.621143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.626084 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:35:59.626997 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:35:59.628708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.631004 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:35:59.631514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:35:59.631885 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:35:59.639164 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:35:59.643351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:35:59.644749 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:35:59.652416 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:35:59.654510 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:35:59.655738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2bec0a6e70>]}
[0m10:35:59.656728 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.08s]
[0m10:35:59.657571 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:35:59.658335 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:35:59.660457 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:35:59.662521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:35:59.663289 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:35:59.667041 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:35:59.667796 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:35:59.673848 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:35:59.674900 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:35:59.675377 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:35:59.675737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:59.678773 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.681132 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:35:59.683398 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:35:59.697274 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:35:59.699179 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:35:59.699990 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:35:59.701895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.703751 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:35:59.704395 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:35:59.706624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.712627 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:35:59.713327 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:35:59.715023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.718680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:35:59.719165 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:35:59.721365 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.723807 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:35:59.724385 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:35:59.724976 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:35:59.732531 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:35:59.735402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:35:59.735899 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:35:59.744119 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:35:59.746546 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:35:59.748837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2bec1309e0>]}
[0m10:35:59.750060 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.09s]
[0m10:35:59.751150 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:35:59.751908 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:35:59.753981 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:35:59.754692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:35:59.755096 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:35:59.758414 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:35:59.759135 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:35:59.762060 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:35:59.762934 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:35:59.763375 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:35:59.763701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:59.766395 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.767197 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:35:59.767699 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:35:59.774442 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:35:59.776149 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:35:59.776917 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:35:59.778405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.779916 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:35:59.780501 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:35:59.782035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.786767 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:35:59.787774 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:35:59.789287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.792437 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:35:59.792887 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:35:59.794488 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.796318 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:35:59.796807 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:35:59.797394 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:35:59.804950 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:35:59.808245 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:35:59.808756 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:35:59.816919 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:35:59.820061 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:35:59.823702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2beff48f20>]}
[0m10:35:59.825842 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.07s]
[0m10:35:59.827806 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:35:59.829526 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:35:59.832363 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:35:59.835161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:35:59.837813 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:35:59.843173 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:35:59.844310 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:35:59.852304 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:35:59.854525 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:35:59.855460 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:35:59.855817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:59.857010 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.857627 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:35:59.858010 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:35:59.859685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.861343 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:35:59.861751 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:35:59.863456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.865239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:35:59.865734 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:35:59.870790 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:35:59.876324 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:35:59.876864 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:35:59.878893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.884466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:35:59.885200 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:35:59.888388 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.891425 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:35:59.892124 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:35:59.892691 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:35:59.899851 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:35:59.903640 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:35:59.904692 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:35:59.915771 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:35:59.917800 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:35:59.918720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2bec10a150>]}
[0m10:35:59.919474 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.08s]
[0m10:35:59.920209 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:35:59.920687 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:35:59.923072 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:35:59.924423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:35:59.924981 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:35:59.928178 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:35:59.929111 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:35:59.932987 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:35:59.934000 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:35:59.936388 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:35:59.937251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:59.938589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.939316 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:35:59.939746 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:35:59.942403 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:59.944258 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:35:59.944702 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:35:59.946269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.948041 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:35:59.948467 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:35:59.950295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.953940 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:35:59.954523 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:35:59.955830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.960563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:35:59.961075 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:35:59.962742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:59.964436 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:35:59.964875 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:35:59.965241 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:35:59.975310 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:35:59.977911 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:35:59.978457 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:35:59.985744 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:35:59.987662 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:35:59.988969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2bec08bf50>]}
[0m10:35:59.990104 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.06s]
[0m10:35:59.990912 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:35:59.991469 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:35:59.992493 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:35:59.994330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:35:59.995001 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:35:59.998059 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:35:59.998851 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:36:00.003169 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:36:00.004103 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:36:00.004551 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:36:00.004898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:00.005960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.006436 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:36:00.006781 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:36:00.010082 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:00.011647 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:36:00.012085 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:36:00.013404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.015201 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:36:00.015660 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:36:00.017398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.022828 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:36:00.023396 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:36:00.025072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.029293 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:36:00.029894 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:36:00.031862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.033524 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:36:00.033990 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:36:00.034586 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:36:00.044063 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:36:00.048538 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:36:00.049012 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:36:00.056036 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:36:00.057956 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:36:00.058979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2bec150950>]}
[0m10:36:00.059838 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.06s]
[0m10:36:00.060969 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:36:00.061982 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:36:00.063963 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:36:00.064655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:36:00.065091 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:36:00.068313 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.069078 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:36:00.072436 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.073205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.073611 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:36:00.073973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:00.075119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.075546 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.075893 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:36:00.078227 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:36:00.080351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.080867 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:36:00.082824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.085956 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.086542 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:36:00.091326 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:36:00.096002 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.096539 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:36:00.098412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.102768 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.103406 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:36:00.104594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.106082 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:36:00.106522 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.106855 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:36:00.115631 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:36:00.119236 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:36:00.119731 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:36:00.128338 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:36:00.130141 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:36:00.132001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2bec0c9700>]}
[0m10:36:00.133084 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.07s]
[0m10:36:00.133819 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:36:00.134343 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:36:00.134982 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:36:00.135720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:36:00.136125 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:36:00.140824 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:36:00.141733 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:36:00.144866 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:36:00.145736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:36:00.146191 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:36:00.146587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:00.147697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.148121 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:36:00.151070 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),

        coalesce(points_per_90, 0) as points_per_90,

        coalesce(goals_scored_per_90, 0) as goals_scored_per_90,
        coalesce(goals_scored_xdifferential, 0) as goals_scored_xdifferential,
        coalesce(expected_goals_scored_per_90, 0) as expected_goals_scored_per_90,

        coalesce(goals_assisted_per_90, 0) as goals_assisted_per_90,
        coalesce(goals_assisted_xdifferential, 0) as goals_assisted_xdifferential,
        coalesce(expected_goals_assisted_per_90, 0) as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m10:36:00.212032 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m10:36:00.213541 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:36:00.214022 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:36:00.215445 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.217261 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:36:00.217694 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:36:00.220048 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.223406 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:36:00.223882 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:36:00.225175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.227947 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:36:00.228447 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:36:00.230458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.232166 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:36:00.232852 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:36:00.233281 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:36:00.244502 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:36:00.250122 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:36:00.250808 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:36:00.260559 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:36:00.262761 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:36:00.266530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2bec0fa270>]}
[0m10:36:00.267465 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.13s]
[0m10:36:00.268193 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:36:00.268763 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:36:00.269444 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:36:00.271041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:36:00.273966 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:36:00.283212 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:36:00.284975 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:36:00.289762 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:36:00.290756 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:36:00.291223 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:36:00.291671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:00.293209 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:36:00.293620 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:36:00.294016 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:36:00.301600 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:36:00.303146 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:36:00.303603 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:36:00.305040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.306574 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:36:00.307119 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:36:00.309082 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.312437 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:36:00.312928 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:36:00.314022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.317112 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:36:00.317546 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:36:00.318625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.320111 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:36:00.320571 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:36:00.320924 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:36:00.328853 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:36:00.332015 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:36:00.332523 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:36:00.339312 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:36:00.341439 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:36:00.342889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2befffd640>]}
[0m10:36:00.343621 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.07s]
[0m10:36:00.344361 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:36:00.344847 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:36:00.345405 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:36:00.346417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:36:00.346870 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:36:00.351290 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:36:00.353051 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:36:00.356835 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:36:00.357784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:36:00.358256 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:36:00.358648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:00.360384 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:36:00.361066 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:36:00.361646 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:36:00.378705 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:36:00.382683 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:36:00.383256 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:36:00.385043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.386640 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:36:00.387109 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:36:00.388758 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.393912 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:36:00.395273 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:36:00.397766 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:36:00.402254 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:36:00.404309 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:36:00.405735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:00.407453 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:36:00.407886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:36:00.408258 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:36:00.420800 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:36:00.425576 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:36:00.426661 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:36:00.436944 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:36:00.439638 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:36:00.441920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618bc973-d09e-41f7-896b-4e1742e54ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2befffcf80>]}
[0m10:36:00.442889 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.10s]
[0m10:36:00.443610 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:36:00.449529 [debug] [MainThread]: Using duckdb connection "master"
[0m10:36:00.450062 [debug] [MainThread]: On master: BEGIN
[0m10:36:00.450553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:36:00.451671 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:36:00.452077 [debug] [MainThread]: On master: COMMIT
[0m10:36:00.452413 [debug] [MainThread]: Using duckdb connection "master"
[0m10:36:00.453001 [debug] [MainThread]: On master: COMMIT
[0m10:36:00.454414 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:36:00.454927 [debug] [MainThread]: On master: Close
[0m10:36:00.455564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:00.456200 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:36:00.456649 [info ] [MainThread]: 
[0m10:36:00.457102 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m10:36:00.465652 [debug] [MainThread]: Command end result
[0m10:36:00.492994 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:36:00.495545 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:36:00.503279 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:36:00.503765 [info ] [MainThread]: 
[0m10:36:00.504192 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:00.504577 [info ] [MainThread]: 
[0m10:36:00.504984 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:36:00.510396 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.7093647, "process_in_blocks": "108320", "process_kernel_time": 0.818654, "process_mem_max_rss": "177144", "process_out_blocks": "4648", "process_user_time": 5.916458}
[0m10:36:00.511425 [debug] [MainThread]: Command `dbt build` succeeded at 10:36:00.511238 after 3.71 seconds
[0m10:36:00.511945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c5c93d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2c5a61bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2bec0f4e00>]}
[0m10:36:00.512397 [debug] [MainThread]: Flushing usage events
[0m10:36:01.175172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:29.022349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797f4ee1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797f54c6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797f4ea4b00>]}


============================== 10:38:29.030151 | b5ec8d78-116d-4e18-a10f-04497b85ab80 ==============================
[0m10:38:29.030151 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:38:29.030897 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'log_format': 'default', 'log_path': '/home/robgriffin247/fpl/logs', 'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'invocation_command': 'dbt build', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True'}
[0m10:38:29.498662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797f4882690>]}
[0m10:38:29.643324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797f49ee0f0>]}
[0m10:38:29.648538 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:38:29.763318 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:38:30.034102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:30.035257 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:38:30.691758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797e92ce5a0>]}
[0m10:38:30.796053 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:38:30.802071 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:38:30.964529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797f76e9e20>]}
[0m10:38:30.966511 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:38:30.969669 [info ] [MainThread]: 
[0m10:38:30.970455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:38:30.970955 [info ] [MainThread]: 
[0m10:38:30.971942 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:38:30.980116 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:38:31.040260 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:38:31.040772 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:38:31.041118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:31.093536 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m10:38:31.095236 [debug] [ThreadPool]: On list_analytics: Close
[0m10:38:31.098871 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:38:31.100636 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:38:31.102196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:31.104851 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:38:31.106345 [debug] [ThreadPool]: On list_analytics: Close
[0m10:38:31.108707 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:38:31.109131 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:38:31.109808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:31.111853 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:38:31.114531 [debug] [ThreadPool]: On list_analytics: Close
[0m10:38:31.116873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m10:38:31.120576 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:38:31.132192 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:38:31.132760 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:38:31.133215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:31.139169 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:38:31.142095 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:38:31.142551 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:38:31.143392 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:38:31.143807 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:38:31.144097 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:38:31.145266 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:38:31.146290 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:38:31.146658 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:38:31.146982 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:38:31.148432 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:38:31.149040 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:38:31.150255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m10:38:31.151279 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:38:31.156088 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:38:31.156796 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:38:31.157121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:31.159064 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:38:31.160623 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:38:31.160979 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:38:31.161802 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:38:31.162144 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:38:31.162414 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:38:31.163103 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:38:31.164074 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:38:31.164445 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:38:31.164728 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:38:31.165919 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:38:31.166270 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:38:31.167226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m10:38:31.167814 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:38:31.170870 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:38:31.171885 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:38:31.172284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:31.174848 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:38:31.177076 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:38:31.177893 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:38:31.178898 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:38:31.179265 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:38:31.179549 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:38:31.180692 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:38:31.182120 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:38:31.182499 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:38:31.182819 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:38:31.183477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:38:31.183808 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:38:31.188423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m10:38:31.196199 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:38:31.196674 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:38:31.196973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:31.198084 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:38:31.198472 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:38:31.198756 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:38:31.215065 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:38:31.216795 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:38:31.219738 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:38:31.220234 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:38:31.221488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m10:38:31.226429 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:38:31.226853 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:38:31.227152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:31.228391 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:38:31.228757 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:38:31.229051 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:38:31.234928 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:38:31.236597 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:38:31.237767 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:38:31.238166 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:38:31.239732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m10:38:31.242908 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:38:31.243381 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:38:31.243671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:31.244600 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:38:31.244949 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:38:31.245284 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:38:31.250649 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:38:31.252815 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:38:31.254089 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:38:31.254858 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:38:31.257558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d0078dd0>]}
[0m10:38:31.258141 [debug] [MainThread]: Using duckdb connection "master"
[0m10:38:31.258475 [debug] [MainThread]: On master: BEGIN
[0m10:38:31.258753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:31.259750 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:38:31.260112 [debug] [MainThread]: On master: COMMIT
[0m10:38:31.260418 [debug] [MainThread]: Using duckdb connection "master"
[0m10:38:31.260686 [debug] [MainThread]: On master: COMMIT
[0m10:38:31.261370 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:38:31.261779 [debug] [MainThread]: On master: Close
[0m10:38:31.266856 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:38:31.267497 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:38:31.268416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m10:38:31.268829 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:38:31.280590 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:38:31.281636 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:38:31.327696 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:38:31.328627 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:38:31.329064 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:38:31.329386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:31.331082 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.331758 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:38:31.332461 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:38:31.337902 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:38:31.348251 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:38:31.348854 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:38:31.350515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.352105 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:38:31.352541 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:38:31.358262 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:38:31.368012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:38:31.368550 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:38:31.370845 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.373985 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:38:31.374864 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:38:31.376630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.394887 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:38:31.395535 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:38:31.395907 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:38:31.404264 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:31.411827 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:38:31.412443 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:38:31.420508 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:31.423546 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:38:31.429140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797e9105b20>]}
[0m10:38:31.430436 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.16s]
[0m10:38:31.431191 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:38:31.431692 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:38:31.432277 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:38:31.432905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:38:31.433389 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:38:31.438675 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.440959 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:38:31.450521 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.451437 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.451904 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:38:31.452290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:31.453683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.454840 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.455248 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:38:31.458732 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:31.464456 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.465093 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:38:31.468485 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.470820 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.471347 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:38:31.473023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.476374 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.476877 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:38:31.479733 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.485786 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.486302 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:38:31.487503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.489038 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:38:31.489502 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.489887 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:38:31.500078 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:38:31.503427 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:38:31.503945 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:38:31.511237 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:38:31.515992 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:38:31.517139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d2dce9c0>]}
[0m10:38:31.517929 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m10:38:31.518638 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:38:31.519086 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:38:31.520271 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:38:31.520915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:38:31.521401 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:38:31.524985 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:38:31.526196 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:38:31.533387 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:38:31.534506 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:38:31.535046 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:38:31.535481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:31.537285 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.537830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:38:31.538273 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:38:31.555914 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:38:31.557419 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:38:31.558071 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:38:31.559921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.561390 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:38:31.561909 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:38:31.564371 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.570304 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:38:31.570858 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:38:31.572743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.575830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:38:31.576264 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:38:31.577290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.578804 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:38:31.579238 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:38:31.579584 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:38:31.587976 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:31.591411 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:38:31.591857 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:38:31.600420 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:31.603049 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:38:31.604800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d007a420>]}
[0m10:38:31.605572 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.08s]
[0m10:38:31.606324 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:38:31.606799 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:38:31.607357 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:38:31.607995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:38:31.608414 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:38:31.611974 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:38:31.612917 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:38:31.619157 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:38:31.620571 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:38:31.621355 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:38:31.621856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:31.623442 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.623880 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:38:31.624245 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:38:31.627949 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:31.629441 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:38:31.630005 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:38:31.631359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.638163 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:38:31.638755 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:38:31.641723 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.645962 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:38:31.646475 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:38:31.647857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.654226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:38:31.654808 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:38:31.656108 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.657692 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:38:31.658119 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:38:31.658436 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:38:31.668518 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:38:31.671781 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:38:31.672510 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:38:31.681236 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:31.683061 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:38:31.685559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d0113ec0>]}
[0m10:38:31.687312 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.08s]
[0m10:38:31.688092 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:38:31.688611 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:38:31.689172 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:38:31.690929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:38:31.691447 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:38:31.694589 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:38:31.695345 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:38:31.698810 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:38:31.699520 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:38:31.699961 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:38:31.700298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:31.702539 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.704435 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:38:31.704868 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:38:31.710949 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:38:31.712805 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:38:31.713481 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:38:31.715263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.717248 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:38:31.718092 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:38:31.722651 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:31.727286 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:38:31.727945 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:38:31.729064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.732078 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:38:31.732703 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:38:31.733855 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.736967 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:38:31.738405 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:38:31.738909 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:38:31.746094 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:38:31.749032 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:38:31.749504 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:38:31.758501 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:31.760301 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:38:31.761404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d2ce13a0>]}
[0m10:38:31.762241 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.07s]
[0m10:38:31.762902 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:38:31.763344 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:38:31.764246 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:38:31.765101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:38:31.766046 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:38:31.771423 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:38:31.774048 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:38:31.778686 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:38:31.779499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:38:31.779942 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:38:31.780272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:31.781306 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.781700 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:38:31.782073 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:38:31.785240 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:31.787530 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:38:31.788914 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:38:31.791031 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.792752 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:38:31.793182 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:38:31.795574 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.801665 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:38:31.802151 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:38:31.804310 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.808993 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:38:31.809534 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:38:31.811177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.812730 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:38:31.813177 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:38:31.813517 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:38:31.825180 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:38:31.827802 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:38:31.828242 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:38:31.836392 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:38:31.839860 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:38:31.842030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d012b290>]}
[0m10:38:31.842834 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.08s]
[0m10:38:31.843518 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:38:31.844001 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:38:31.844541 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:38:31.845218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:38:31.845702 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:38:31.849420 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:38:31.850899 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:38:31.854172 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:38:31.855411 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:38:31.858522 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:38:31.859635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:31.860768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.861488 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:38:31.862162 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:38:31.866426 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:38:31.867757 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:38:31.868227 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:38:31.869662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.871785 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:38:31.873519 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:38:31.878459 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:31.882163 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:38:31.882626 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:38:31.884284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.888531 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:38:31.889070 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:38:31.894472 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:31.897222 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:38:31.897840 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:38:31.898499 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:38:31.909689 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:38:31.913495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:38:31.914058 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:38:31.922198 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:31.926877 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:38:31.928842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d0087e00>]}
[0m10:38:31.929837 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.08s]
[0m10:38:31.930850 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:38:31.931411 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:38:31.932265 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:38:31.933410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:38:31.935020 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:38:31.938390 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:38:31.940627 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:38:31.948519 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:38:31.949491 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:38:31.950146 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:38:31.950718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:31.952222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.952632 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:38:31.952965 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:38:31.955020 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.956286 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:38:31.956737 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:38:31.958037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.961700 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:38:31.962399 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:38:31.966160 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:31.969615 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:38:31.970068 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:38:31.971509 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:31.979447 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:38:31.980388 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:38:31.982825 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:31.984767 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:38:31.985424 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:38:31.985886 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:38:31.992871 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:38:32.003819 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:38:32.004882 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:38:32.016860 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:38:32.020867 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:38:32.021889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d00ef4a0>]}
[0m10:38:32.023251 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.09s]
[0m10:38:32.024068 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:38:32.024544 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:38:32.025133 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:38:32.027852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:38:32.029713 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:38:32.039921 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:38:32.041041 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:38:32.047678 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:38:32.049237 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:38:32.050089 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:38:32.050485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:32.053396 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.054869 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:38:32.055300 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:38:32.058705 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:32.060339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:38:32.061007 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:38:32.064313 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.067083 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:38:32.067679 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:38:32.070094 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.073690 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:38:32.074195 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:38:32.075573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.080122 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:38:32.081949 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:38:32.084892 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.087142 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:38:32.087927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:38:32.088313 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:38:32.098786 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:38:32.102683 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:38:32.103293 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:38:32.112733 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:32.117858 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:38:32.119611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d007acf0>]}
[0m10:38:32.120446 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.09s]
[0m10:38:32.121175 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:38:32.121670 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:38:32.122242 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:38:32.122831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:38:32.123254 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:38:32.132963 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:38:32.137133 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:38:32.141468 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:38:32.143303 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:38:32.144444 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:38:32.145512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:32.149409 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:32.151445 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:38:32.152112 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:38:32.156700 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:38:32.159740 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:38:32.160416 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:38:32.162081 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.164499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:38:32.166506 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:38:32.171646 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:38:32.176082 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:38:32.176750 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:38:32.178873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.186477 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:38:32.187304 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:38:32.189172 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.190958 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:38:32.191401 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:38:32.191743 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:38:32.202150 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:38:32.206608 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:38:32.207070 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:38:32.215309 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:38:32.219389 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:38:32.220941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d014c7a0>]}
[0m10:38:32.221858 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.10s]
[0m10:38:32.222541 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:38:32.223198 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:38:32.223717 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:38:32.224756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:38:32.225285 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:38:32.229408 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.231113 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:38:32.236580 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.237751 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.238210 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:38:32.238656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:32.240409 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.241389 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.241830 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:38:32.244564 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.245915 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.246412 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:38:32.247948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.252307 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.253902 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:38:32.257297 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.261619 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.262101 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:38:32.263983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.267414 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.268016 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:38:32.270692 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.272445 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:38:32.272917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.273267 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:38:32.279274 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:38:32.282314 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:38:32.282777 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:38:32.291247 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:32.293059 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:38:32.293989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d014de50>]}
[0m10:38:32.294698 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.07s]
[0m10:38:32.295370 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:38:32.295834 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:38:32.296400 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:38:32.297277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:38:32.297776 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:38:32.303752 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:38:32.306385 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:38:32.310270 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:38:32.311537 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:38:32.311954 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:38:32.312510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:32.313854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.314340 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:38:32.315071 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),

        coalesce(points_per_90, 0) as points_per_90,

        case when goals_scored_per_90>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        coalesce(goals_scored_xdifferential, 0) as goals_scored_xdifferential,
        coalesce(expected_goals_scored_per_90, 0) as expected_goals_scored_per_90,

        coalesce(goals_assisted_per_90, 0) as goals_assisted_per_90,
        coalesce(goals_assisted_xdifferential, 0) as goals_assisted_xdifferential,
        coalesce(expected_goals_assisted_per_90, 0) as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m10:38:32.385067 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m10:38:32.386591 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:38:32.387047 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:38:32.390612 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.393302 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:38:32.394051 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:38:32.396963 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:38:32.400582 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:38:32.401007 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:38:32.402318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.405788 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:38:32.406513 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:38:32.408324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.409955 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:38:32.410443 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:38:32.410793 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:38:32.422106 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:38:32.429627 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:38:32.430345 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:38:32.439925 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:38:32.442759 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:38:32.446007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d0103ce0>]}
[0m10:38:32.446856 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.15s]
[0m10:38:32.447549 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:38:32.448045 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:38:32.448563 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:38:32.449160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:38:32.449556 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:38:32.455351 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:38:32.457888 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:38:32.463355 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:38:32.464355 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:38:32.464805 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:38:32.465227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:32.466358 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.466826 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:38:32.467217 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:38:32.476345 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:38:32.477944 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:38:32.478549 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:38:32.480267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.481951 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:38:32.482445 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:38:32.484276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.487710 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:38:32.488246 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:38:32.489351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.495491 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:38:32.496320 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:38:32.498103 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.500231 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:38:32.500683 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:38:32.501022 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:38:32.511498 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:38:32.514478 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:38:32.515084 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:38:32.523709 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:32.529963 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:38:32.531413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d009dbe0>]}
[0m10:38:32.532264 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.08s]
[0m10:38:32.533023 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:38:32.533513 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:38:32.534104 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:38:32.535019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:38:32.535527 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:38:32.539553 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:38:32.541308 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:38:32.548894 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:38:32.550293 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:38:32.550850 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:38:32.551187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:32.552283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.552768 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:38:32.553204 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:38:32.569419 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:38:32.571140 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:38:32.571575 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:38:32.573364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.575081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:38:32.575542 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:38:32.577749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.582205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:38:32.582764 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:38:32.584305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.587395 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:38:32.587830 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:38:32.589178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:38:32.591284 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:38:32.591716 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:38:32.592050 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:38:32.602934 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:38:32.605923 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:38:32.606367 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:38:32.615298 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:38:32.617088 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:38:32.620075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ec8d78-116d-4e18-a10f-04497b85ab80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797d00d8e30>]}
[0m10:38:32.620922 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.08s]
[0m10:38:32.621690 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:38:32.624538 [debug] [MainThread]: Using duckdb connection "master"
[0m10:38:32.624956 [debug] [MainThread]: On master: BEGIN
[0m10:38:32.625261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:32.626907 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:38:32.627591 [debug] [MainThread]: On master: COMMIT
[0m10:38:32.628080 [debug] [MainThread]: Using duckdb connection "master"
[0m10:38:32.628743 [debug] [MainThread]: On master: COMMIT
[0m10:38:32.631361 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:38:32.632002 [debug] [MainThread]: On master: Close
[0m10:38:32.632659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:32.633007 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:38:32.633437 [info ] [MainThread]: 
[0m10:38:32.633913 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m10:38:32.636504 [debug] [MainThread]: Command end result
[0m10:38:32.666049 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:38:32.668428 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:38:32.676071 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:38:32.676546 [info ] [MainThread]: 
[0m10:38:32.677033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:32.677425 [info ] [MainThread]: 
[0m10:38:32.677859 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:38:32.681855 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.7721674, "process_in_blocks": "109232", "process_kernel_time": 0.796279, "process_mem_max_rss": "176816", "process_out_blocks": "4648", "process_user_time": 6.275161}
[0m10:38:32.682988 [debug] [MainThread]: Command `dbt build` succeeded at 10:38:32.682803 after 3.77 seconds
[0m10:38:32.684019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797f52e6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797f5866d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7797f5865d30>]}
[0m10:38:32.684549 [debug] [MainThread]: Flushing usage events
[0m10:38:33.296499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:39:41.982281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6640a9d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6642d795e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6642bba5a0>]}


============================== 10:39:41.988827 | 5b2bf434-59a3-4b95-a4d7-53f8024859de ==============================
[0m10:39:41.988827 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:39:41.989812 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'invocation_command': 'dbt build', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'debug': 'False', 'warn_error': 'None', 'target_path': 'None'}
[0m10:39:42.557924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66365420c0>]}
[0m10:39:42.701755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663ffbc8c0>]}
[0m10:39:42.705247 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:39:42.832080 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:39:43.132631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:39:43.133588 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:39:43.828308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66341fbdd0>]}
[0m10:39:43.918752 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:39:43.921696 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:39:44.097593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6634aeec60>]}
[0m10:39:44.098173 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:39:44.101693 [info ] [MainThread]: 
[0m10:39:44.102633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:39:44.103754 [info ] [MainThread]: 
[0m10:39:44.105439 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:39:44.114665 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:39:44.178211 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:39:44.178872 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:39:44.179264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:44.240003 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m10:39:44.245976 [debug] [ThreadPool]: On list_analytics: Close
[0m10:39:44.248981 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:39:44.249642 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:39:44.249985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:44.252138 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:39:44.253495 [debug] [ThreadPool]: On list_analytics: Close
[0m10:39:44.256695 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:39:44.258640 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:39:44.259597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:44.261782 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:39:44.263111 [debug] [ThreadPool]: On list_analytics: Close
[0m10:39:44.264486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m10:39:44.265239 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:39:44.272335 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:39:44.272834 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:39:44.273187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:44.275448 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:39:44.278421 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:39:44.278905 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:39:44.280113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:39:44.280504 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:39:44.280794 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:39:44.281740 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:39:44.282701 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:39:44.283061 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:39:44.283349 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:39:44.285224 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:39:44.285648 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:39:44.286703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m10:39:44.287487 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:39:44.289923 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:39:44.290363 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:39:44.290732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:44.292489 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:39:44.295590 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:39:44.296521 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:39:44.297920 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:39:44.299061 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:39:44.300842 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:39:44.302852 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:39:44.304454 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:39:44.305833 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:39:44.306349 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:39:44.307477 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:39:44.307882 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:39:44.310063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m10:39:44.311242 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:39:44.315750 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:39:44.316987 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:39:44.317400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:44.320662 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:39:44.323249 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:39:44.323992 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:39:44.325104 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:39:44.326368 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:39:44.327040 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:39:44.328988 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:39:44.330261 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:39:44.330701 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:39:44.330997 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:39:44.332178 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:39:44.333109 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:39:44.338249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m10:39:44.348091 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:39:44.348800 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:39:44.349544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:44.351337 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:39:44.351696 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:39:44.351973 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:39:44.371171 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m10:39:44.372958 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:39:44.375414 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:39:44.375835 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:39:44.376755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m10:39:44.382053 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:39:44.382676 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:39:44.383130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:44.386062 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:39:44.386700 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:39:44.387045 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:39:44.392905 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:39:44.394548 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:39:44.395516 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:39:44.395833 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:39:44.396677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m10:39:44.399680 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:39:44.400047 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:39:44.400326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:44.402018 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:39:44.402384 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:39:44.402671 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:39:44.407967 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:39:44.410207 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:39:44.411386 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:39:44.411919 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:39:44.414884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66341e65a0>]}
[0m10:39:44.415491 [debug] [MainThread]: Using duckdb connection "master"
[0m10:39:44.415851 [debug] [MainThread]: On master: BEGIN
[0m10:39:44.416134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:39:44.417533 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:39:44.418253 [debug] [MainThread]: On master: COMMIT
[0m10:39:44.418558 [debug] [MainThread]: Using duckdb connection "master"
[0m10:39:44.418818 [debug] [MainThread]: On master: COMMIT
[0m10:39:44.419657 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:39:44.420004 [debug] [MainThread]: On master: Close
[0m10:39:44.425144 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:39:44.425886 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:39:44.426804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m10:39:44.427227 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:39:44.452120 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:39:44.455136 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:39:44.507275 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:39:44.508297 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:39:44.508721 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:39:44.509082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:44.510302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.510713 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:39:44.511058 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:39:44.520309 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:39:44.528148 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:39:44.528747 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:39:44.530345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.532699 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:39:44.533477 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:39:44.538657 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:39:44.546883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:39:44.547456 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:39:44.550043 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:44.554701 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:39:44.555268 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:39:44.557082 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.578878 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:39:44.579437 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:39:44.579799 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:39:44.590170 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:39:44.597863 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:39:44.598618 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:39:44.607756 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:44.611922 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:39:44.615861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66349d1a00>]}
[0m10:39:44.617417 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.19s]
[0m10:39:44.618490 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:39:44.619144 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:39:44.619938 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:39:44.620776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:39:44.622198 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:39:44.626839 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.627925 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:39:44.632640 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.633522 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.633928 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:39:44.634246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:44.635573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.636175 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.636562 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:39:44.641671 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:39:44.644431 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.645558 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:39:44.647828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.650201 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.650707 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:39:44.653777 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:39:44.658956 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.659881 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:39:44.661181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.664416 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.664921 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:39:44.666102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.667633 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:39:44.668129 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.668474 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:39:44.677620 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:39:44.680793 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:39:44.681307 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:39:44.689569 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:44.691625 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:39:44.692539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65cf754260>]}
[0m10:39:44.693348 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.07s]
[0m10:39:44.694020 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:39:44.694470 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:39:44.694978 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:39:44.695561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:39:44.695945 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:39:44.699095 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:39:44.700571 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:39:44.703878 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:39:44.705847 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:39:44.707089 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:39:44.707557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:44.709429 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:44.709918 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:39:44.710346 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:39:44.725417 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:39:44.727699 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:39:44.728455 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:39:44.730386 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.732465 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:39:44.733074 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:39:44.735110 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:44.739754 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:39:44.740357 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:39:44.742028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.745154 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:39:44.745632 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:39:44.747109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.748718 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:39:44.749296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:39:44.749634 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:39:44.759082 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:39:44.762563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:39:44.763064 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:39:44.771098 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:44.773243 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:39:44.776811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65cf70ce30>]}
[0m10:39:44.778042 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.08s]
[0m10:39:44.779204 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:39:44.780065 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:39:44.780940 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:39:44.782091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:39:44.782699 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:39:44.786865 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:39:44.788394 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:39:44.795463 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:39:44.797026 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:39:44.797514 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:39:44.797880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:44.798960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.799361 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:39:44.799719 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:39:44.805103 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:39:44.806613 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:39:44.807063 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:39:44.809014 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.813127 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:39:44.813951 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:39:44.816196 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:44.819628 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:39:44.820177 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:39:44.821900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.825092 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:39:44.825576 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:39:44.827259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.829039 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:39:44.829755 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:39:44.830136 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:39:44.838936 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:44.843874 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:39:44.844835 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:39:44.852898 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:39:44.854986 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:39:44.855803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66063eb620>]}
[0m10:39:44.856540 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.07s]
[0m10:39:44.857293 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:39:44.857999 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:39:44.858802 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:39:44.859483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:39:44.859897 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:39:44.863886 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:39:44.866142 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:39:44.869603 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:39:44.870472 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:39:44.870874 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:39:44.871201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:44.872317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.872701 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:39:44.873053 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:39:44.876570 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:39:44.878747 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:39:44.879234 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:39:44.881236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.882680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:39:44.883131 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:39:44.885737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:44.889726 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:39:44.890222 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:39:44.891340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.895308 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:39:44.896270 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:39:44.897698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.899395 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:39:44.899868 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:39:44.900225 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:39:44.909170 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:44.912152 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:39:44.913067 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:39:44.920691 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:39:44.922752 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:39:44.924171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66063e88c0>]}
[0m10:39:44.925104 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.06s]
[0m10:39:44.925985 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:39:44.926561 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:39:44.927545 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:39:44.928744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:39:44.929814 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:39:44.934570 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:39:44.935585 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:39:44.939447 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:39:44.940210 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:39:44.940662 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:39:44.941034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:44.942022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.942393 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:39:44.942944 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:39:44.949027 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:39:44.950502 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:39:44.950932 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:39:44.952660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.954672 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:39:44.955319 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:39:44.957863 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:44.964023 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:39:44.965004 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:39:44.967046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.970055 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:39:44.970515 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:39:44.971772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:44.973418 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:39:44.974151 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:39:44.974535 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:39:44.983566 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:44.987194 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:39:44.987637 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:39:44.994545 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:39:44.997099 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:39:44.998381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65cf7bb3e0>]}
[0m10:39:44.999291 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.07s]
[0m10:39:45.000012 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:39:45.001473 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:39:45.002228 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:39:45.002935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:39:45.003406 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:39:45.008046 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:39:45.009861 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:39:45.016840 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:39:45.020170 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:39:45.021268 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:39:45.022202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:45.024698 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.025612 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:39:45.026674 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:39:45.037873 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:39:45.040378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:39:45.041296 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:39:45.043447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.045372 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:39:45.046029 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:39:45.049995 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:39:45.054455 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:39:45.054966 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:39:45.056615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.060928 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:39:45.061416 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:39:45.062675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.064324 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:39:45.064938 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:39:45.065334 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:39:45.074029 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:45.077049 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:39:45.077541 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:39:45.086442 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:45.089042 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:39:45.090630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6634133680>]}
[0m10:39:45.091513 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.09s]
[0m10:39:45.092530 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:39:45.093049 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:39:45.093620 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:39:45.094286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:39:45.094749 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:39:45.098068 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:39:45.099491 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:39:45.104084 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:39:45.105076 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:39:45.105554 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:39:45.105888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:45.106948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.107603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:39:45.108025 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:39:45.110584 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.112463 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:39:45.112937 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:39:45.114201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.115691 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:39:45.116187 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:39:45.119089 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.122566 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:39:45.123082 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:39:45.124496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.129040 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:39:45.129564 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:39:45.130905 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.133162 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:39:45.133954 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:39:45.134340 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:39:45.142762 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:45.146094 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:39:45.146610 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:39:45.153732 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:39:45.155736 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:39:45.156550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65cf73fbf0>]}
[0m10:39:45.157378 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.06s]
[0m10:39:45.158190 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:39:45.158652 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:39:45.159552 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:39:45.161590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:39:45.162034 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:39:45.165515 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:39:45.166371 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:39:45.173427 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:39:45.174808 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:39:45.175330 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:39:45.175676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:45.177014 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.177526 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:39:45.177921 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:39:45.180032 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.181307 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:39:45.181772 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:39:45.182890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.184501 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:39:45.185053 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:39:45.190084 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:39:45.196809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:39:45.198164 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:39:45.203222 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.213522 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:39:45.214743 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:39:45.218303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.221647 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:39:45.222826 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:39:45.223350 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:39:45.237012 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:39:45.241114 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:39:45.241800 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:39:45.252399 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:39:45.257919 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:39:45.260221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66063212b0>]}
[0m10:39:45.261683 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.10s]
[0m10:39:45.263453 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:39:45.264806 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:39:45.266433 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:39:45.269186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:39:45.274564 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:39:45.281058 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:39:45.282395 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:39:45.295500 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:39:45.297458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:39:45.298131 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:39:45.298542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:45.300043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.300594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:39:45.301103 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:39:45.307558 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:39:45.310503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:39:45.311599 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:39:45.315058 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.318790 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:39:45.319849 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:39:45.323294 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:39:45.329505 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:39:45.330226 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:39:45.331800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.339765 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:39:45.342156 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:39:45.344204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.347171 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:39:45.348098 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:39:45.348819 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:39:45.357252 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:45.365821 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:39:45.366537 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:39:45.374765 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:45.379030 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:39:45.381107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65cf7e32f0>]}
[0m10:39:45.382212 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.11s]
[0m10:39:45.383223 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:39:45.383801 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:39:45.384389 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:39:45.385215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:39:45.385701 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:39:45.388631 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.391179 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:39:45.399335 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.400575 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.401681 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:39:45.402098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:45.403221 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.403675 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.404184 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:39:45.406188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.410853 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.413215 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:39:45.416464 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.419589 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.420139 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:39:45.422134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.426607 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.428570 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:39:45.430827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.434067 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.434608 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:39:45.435968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.437851 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:39:45.438627 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.439020 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:39:45.447903 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:39:45.451484 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:39:45.452518 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:39:45.465420 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:39:45.467425 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:39:45.468360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65cf7567e0>]}
[0m10:39:45.469165 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.08s]
[0m10:39:45.469840 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:39:45.470319 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:39:45.470863 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:39:45.471502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:39:45.471913 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:39:45.475795 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:39:45.476783 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:39:45.484306 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:39:45.485464 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:39:45.485951 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:39:45.486269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:45.487451 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.487896 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:39:45.488378 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),

        coalesce(points_per_90, 0) as points_per_90,

        case when not goals_scored_per_90<=0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        coalesce(goals_scored_xdifferential, 0) as goals_scored_xdifferential,
        coalesce(expected_goals_scored_per_90, 0) as expected_goals_scored_per_90,

        coalesce(goals_assisted_per_90, 0) as goals_assisted_per_90,
        coalesce(goals_assisted_xdifferential, 0) as goals_assisted_xdifferential,
        coalesce(expected_goals_assisted_per_90, 0) as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m10:39:45.558016 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m10:39:45.559581 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:39:45.560018 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:39:45.561733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.564150 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:39:45.565238 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:39:45.568145 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.571850 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:39:45.572736 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:39:45.574827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.578387 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:39:45.579039 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:39:45.580772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.584499 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:39:45.585252 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:39:45.585701 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:39:45.593934 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:39:45.600503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:39:45.601433 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:39:45.611591 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:39:45.614243 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:39:45.620594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65cf784d70>]}
[0m10:39:45.622358 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.15s]
[0m10:39:45.624167 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:39:45.624811 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:39:45.625857 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:39:45.626678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:39:45.627233 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:39:45.631078 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:39:45.635955 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:39:45.641661 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:39:45.642636 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:39:45.643107 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:39:45.643531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:45.644696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.645282 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:39:45.645756 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:39:45.658911 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:39:45.660791 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:39:45.661472 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:39:45.663480 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.666083 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:39:45.666892 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:39:45.670999 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:39:45.675165 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:39:45.675741 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:39:45.677171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.681079 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:39:45.681724 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:39:45.683213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.685971 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:39:45.687290 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:39:45.687951 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:39:45.695301 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:39:45.698616 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:39:45.700420 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:39:45.709415 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:39:45.711477 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:39:45.712699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65cf73d730>]}
[0m10:39:45.713659 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.09s]
[0m10:39:45.714518 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:39:45.715068 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:39:45.715662 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:39:45.717871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:39:45.718910 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:39:45.724128 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:39:45.725182 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:39:45.729165 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:39:45.729973 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:39:45.730399 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:39:45.730775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:45.732651 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.733579 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:39:45.734614 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:39:45.764297 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m10:39:45.766021 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:39:45.766475 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:39:45.770155 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:39:45.774481 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:39:45.775028 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:39:45.778441 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:39:45.783468 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:39:45.784196 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:39:45.786638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.791740 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:39:45.792346 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:39:45.794387 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:39:45.796399 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:39:45.796940 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:39:45.797332 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:39:45.810639 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:39:45.814770 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:39:45.815342 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:39:45.824415 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:39:45.826716 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:39:45.834091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b2bf434-59a3-4b95-a4d7-53f8024859de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65cf747dd0>]}
[0m10:39:45.835148 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.11s]
[0m10:39:45.836222 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:39:45.841851 [debug] [MainThread]: Using duckdb connection "master"
[0m10:39:45.843475 [debug] [MainThread]: On master: BEGIN
[0m10:39:45.844205 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:39:45.846738 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:39:45.847423 [debug] [MainThread]: On master: COMMIT
[0m10:39:45.847853 [debug] [MainThread]: Using duckdb connection "master"
[0m10:39:45.848170 [debug] [MainThread]: On master: COMMIT
[0m10:39:45.850237 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:39:45.851694 [debug] [MainThread]: On master: Close
[0m10:39:45.852451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:45.853100 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:39:45.853881 [info ] [MainThread]: 
[0m10:39:45.854597 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m10:39:45.857570 [debug] [MainThread]: Command end result
[0m10:39:45.880963 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:39:45.883268 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:39:45.891214 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:39:45.891748 [info ] [MainThread]: 
[0m10:39:45.892432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:39:45.893009 [info ] [MainThread]: 
[0m10:39:45.893452 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:39:45.896420 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.0716944, "process_in_blocks": "111736", "process_kernel_time": 1.003052, "process_mem_max_rss": "176308", "process_out_blocks": "4648", "process_user_time": 6.910354}
[0m10:39:45.897098 [debug] [MainThread]: Command `dbt build` succeeded at 10:39:45.896956 after 4.07 seconds
[0m10:39:45.897528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6634111370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663483b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6606365bb0>]}
[0m10:39:45.897988 [debug] [MainThread]: Flushing usage events
[0m10:39:46.520931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:40.907408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e59d1f84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e59c35e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e59cbed3a0>]}


============================== 10:40:40.911264 | e1f38461-31f8-44d2-bbce-57d946dcdf1e ==============================
[0m10:40:40.911264 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:40:40.911937 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt build', 'fail_fast': 'False', 'partial_parse': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'version_check': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None'}
[0m10:40:41.395813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e59bfa1be0>]}
[0m10:40:41.527806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e59ca72780>]}
[0m10:40:41.529908 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:40:41.644824 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:40:41.774855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:40:41.777731 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:40:42.377041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e59bf55310>]}
[0m10:40:42.469676 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:40:42.471971 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:40:42.612786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5923bcb30>]}
[0m10:40:42.614245 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:40:42.619003 [info ] [MainThread]: 
[0m10:40:42.619791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:42.620223 [info ] [MainThread]: 
[0m10:40:42.620874 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:40:42.628054 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:40:42.681065 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:40:42.681794 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:40:42.682163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:42.727722 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m10:40:42.730334 [debug] [ThreadPool]: On list_analytics: Close
[0m10:40:42.733339 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:40:42.733989 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:40:42.734489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:42.738448 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:40:42.740834 [debug] [ThreadPool]: On list_analytics: Close
[0m10:40:42.743812 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:40:42.744445 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:40:42.744801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:42.746906 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:40:42.748588 [debug] [ThreadPool]: On list_analytics: Close
[0m10:40:42.750151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m10:40:42.750899 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:40:42.760472 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:40:42.761091 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:40:42.761466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:42.763973 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:40:42.765804 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:40:42.766692 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:40:42.768378 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:40:42.768855 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:40:42.769191 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:40:42.771454 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:40:42.773057 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:40:42.773483 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:40:42.773794 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:40:42.774939 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:40:42.775352 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:40:42.776168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m10:40:42.776982 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:40:42.780077 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:40:42.781250 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:40:42.781862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:42.783644 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:40:42.785522 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:40:42.785937 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:40:42.786930 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:40:42.787415 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:40:42.787721 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:40:42.789299 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:40:42.791102 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:40:42.791758 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:40:42.792433 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:40:42.793426 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:40:42.793826 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:40:42.794937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m10:40:42.795651 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:40:42.798569 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:40:42.799157 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:40:42.799699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:42.801872 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:40:42.805387 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:40:42.806597 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:40:42.807947 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:40:42.808398 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:40:42.808749 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:40:42.810272 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:40:42.811390 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:40:42.812078 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:40:42.813346 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:40:42.815211 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:40:42.815662 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:40:42.818821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m10:40:42.828257 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:40:42.828967 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:40:42.829339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:42.831335 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:40:42.831837 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:40:42.832171 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:40:42.854981 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m10:40:42.857552 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:40:42.859929 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:40:42.860694 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:40:42.863177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m10:40:42.868103 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:40:42.868563 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:40:42.869473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:42.872514 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:40:42.873204 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:40:42.874052 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:40:42.880227 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:40:42.882527 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:40:42.883835 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:40:42.884280 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:40:42.885504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m10:40:42.888829 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:40:42.889341 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:40:42.889646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:42.892425 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:40:42.892947 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:40:42.893287 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:40:42.900287 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:40:42.903186 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:40:42.905406 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:40:42.907074 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:40:42.911642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5907ab170>]}
[0m10:40:42.912373 [debug] [MainThread]: Using duckdb connection "master"
[0m10:40:42.912763 [debug] [MainThread]: On master: BEGIN
[0m10:40:42.913063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:40:42.915121 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:40:42.915643 [debug] [MainThread]: On master: COMMIT
[0m10:40:42.916200 [debug] [MainThread]: Using duckdb connection "master"
[0m10:40:42.916497 [debug] [MainThread]: On master: COMMIT
[0m10:40:42.917346 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:40:42.917734 [debug] [MainThread]: On master: Close
[0m10:40:42.923386 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:40:42.925801 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:40:42.927841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_fixtures)
[0m10:40:42.928364 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:40:42.938287 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:40:42.939415 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:40:42.993582 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:40:42.995969 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:40:42.996603 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:40:42.997034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:42.999933 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:40:43.000578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:40:43.000993 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:40:43.006482 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:40:43.017117 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:40:43.017737 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:40:43.019339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.021044 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:40:43.021497 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:40:43.023247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.033678 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:40:43.034792 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:40:43.036580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.040186 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:40:43.040669 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:40:43.041870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.068471 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:40:43.069205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:40:43.069670 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:40:43.083732 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:40:43.098687 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:40:43.099462 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:40:43.109752 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:40:43.117037 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:40:43.121218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e590155fa0>]}
[0m10:40:43.122508 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.19s]
[0m10:40:43.123670 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:40:43.124199 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:40:43.124788 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:40:43.125495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:40:43.125983 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:40:43.134751 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.136765 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:40:43.144299 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.145362 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.146020 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:40:43.146431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.148411 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.149385 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.149986 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:40:43.153202 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:40:43.154734 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.155231 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:40:43.156591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.158157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.158685 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:40:43.161450 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.165496 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.166225 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:40:43.167775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.171051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.171598 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:40:43.173050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.175452 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:40:43.176058 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.176433 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:40:43.186585 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:40:43.189499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:40:43.190080 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:40:43.198249 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:40:43.200566 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:40:43.201797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5661f38c0>]}
[0m10:40:43.203257 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m10:40:43.204003 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:40:43.204554 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:40:43.205155 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:40:43.205864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:40:43.207091 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:40:43.211577 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:40:43.213066 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:40:43.217318 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:40:43.218562 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:40:43.219305 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:40:43.219828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.221421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.222587 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:40:43.223341 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:40:43.237523 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:40:43.239421 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:40:43.239961 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:40:43.241779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.244296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:40:43.244840 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:40:43.247038 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.250999 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:40:43.251738 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:40:43.253282 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.257158 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:40:43.257794 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:40:43.259589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.261692 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:40:43.262516 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:40:43.262905 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:40:43.275282 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:40:43.278514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:40:43.279083 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:40:43.288051 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:40:43.290019 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:40:43.291589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5661d1880>]}
[0m10:40:43.292420 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.09s]
[0m10:40:43.293105 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:40:43.293576 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:40:43.294104 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:40:43.294796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:40:43.295273 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:40:43.298572 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:40:43.299501 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:40:43.303018 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:40:43.304049 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:40:43.304504 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:40:43.305303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.307229 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.307792 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:40:43.308177 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:40:43.310944 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.312511 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:40:43.312951 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:40:43.314810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.319540 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:40:43.320418 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:40:43.323195 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.326738 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:40:43.327271 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:40:43.328664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.331549 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:40:43.331976 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:40:43.333351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.335502 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:40:43.336229 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:40:43.336717 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:40:43.345198 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:40:43.350575 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:40:43.352624 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:40:43.366216 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:40:43.370612 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:40:43.372165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5640fb440>]}
[0m10:40:43.373366 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.08s]
[0m10:40:43.374950 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:40:43.376276 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:40:43.378947 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:40:43.381556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:40:43.382494 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:40:43.387464 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:40:43.388832 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:40:43.393165 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:40:43.394229 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:40:43.394872 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:40:43.395448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.398574 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.399941 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:40:43.400449 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:40:43.405292 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:40:43.410705 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:40:43.412691 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:40:43.416601 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.421767 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:40:43.422767 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:40:43.426503 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:40:43.433017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:40:43.433722 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:40:43.435371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.442046 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:40:43.442842 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:40:43.444448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.446569 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:40:43.447190 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:40:43.447652 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:40:43.457156 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:40:43.462895 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:40:43.463758 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:40:43.472509 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:40:43.475229 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:40:43.477015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5661dad80>]}
[0m10:40:43.479823 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.10s]
[0m10:40:43.481834 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:40:43.482892 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:40:43.483644 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:40:43.485546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:40:43.486264 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:40:43.492140 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:40:43.493431 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:40:43.498156 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:40:43.500010 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:40:43.501203 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:40:43.501864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.503129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.503602 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:40:43.503985 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:40:43.507834 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:40:43.510974 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:40:43.511947 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:40:43.514089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.516166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:40:43.516760 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:40:43.519452 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.526946 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:40:43.527976 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:40:43.530126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.534017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:40:43.534619 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:40:43.535903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.537607 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:40:43.538113 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:40:43.538571 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:40:43.546820 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:40:43.549784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:40:43.550452 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:40:43.557720 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:40:43.560102 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:40:43.561596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e56410a0c0>]}
[0m10:40:43.562551 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.08s]
[0m10:40:43.563356 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:40:43.563863 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:40:43.564460 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:40:43.565567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:40:43.566017 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:40:43.569271 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:40:43.570135 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:40:43.574812 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:40:43.576206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:40:43.577141 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:40:43.577875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.580383 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.581698 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:40:43.582154 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:40:43.586470 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:40:43.587931 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:40:43.588384 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:40:43.590065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.592210 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:40:43.592979 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:40:43.596064 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.600453 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:40:43.602156 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:40:43.604522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.609228 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:40:43.609875 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:40:43.611782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.616920 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:40:43.618694 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:40:43.619240 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:40:43.638310 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:40:43.641231 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:40:43.643094 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:40:43.656119 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:40:43.658518 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:40:43.660205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e56615edb0>]}
[0m10:40:43.661269 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.09s]
[0m10:40:43.662223 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:40:43.663055 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:40:43.665599 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:40:43.666653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:40:43.667464 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:40:43.670526 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:40:43.671330 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:40:43.675356 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:40:43.676466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:40:43.677000 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:40:43.677571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.679345 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.680162 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:40:43.680850 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:40:43.684012 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.686474 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:40:43.687283 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:40:43.689920 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.691815 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:40:43.692379 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:40:43.694993 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.699668 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:40:43.700277 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:40:43.701610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.706625 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:40:43.707216 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:40:43.708396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.709969 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:40:43.710507 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:40:43.710911 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:40:43.718889 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:40:43.722329 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:40:43.722929 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:40:43.730662 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:40:43.733505 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:40:43.735070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5640ec2f0>]}
[0m10:40:43.736400 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.07s]
[0m10:40:43.737225 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:40:43.737740 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:40:43.738428 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:40:43.739204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:40:43.739701 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:40:43.742938 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:40:43.744474 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:40:43.748828 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:40:43.750281 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:40:43.750981 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:40:43.751411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.753473 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.754137 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:40:43.754678 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:40:43.758006 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:40:43.760224 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:40:43.760749 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:40:43.762867 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.765987 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:40:43.767579 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:40:43.770798 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.774580 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:40:43.775176 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:40:43.776815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.780021 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:40:43.780534 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:40:43.781958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.783864 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:40:43.784356 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:40:43.784720 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:40:43.792503 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:40:43.795199 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:40:43.795636 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:40:43.803652 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:40:43.806517 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:40:43.807809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5640b2c00>]}
[0m10:40:43.808563 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.07s]
[0m10:40:43.809244 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:40:43.809728 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:40:43.810292 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:40:43.811508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:40:43.812122 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:40:43.815433 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:40:43.816216 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:40:43.821210 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:40:43.822167 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:40:43.822803 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:40:43.823426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.824586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.825012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:40:43.825337 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:40:43.829503 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:40:43.830964 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:40:43.831821 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:40:43.834025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.836403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:40:43.837066 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:40:43.842001 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:40:43.847583 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:40:43.848095 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:40:43.852005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.856439 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:40:43.856915 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:40:43.858951 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.861270 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:40:43.861917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:40:43.862329 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:40:43.871290 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:40:43.878442 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:40:43.879157 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:40:43.888749 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:40:43.891851 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:40:43.893175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e56413ef30>]}
[0m10:40:43.894112 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.08s]
[0m10:40:43.895011 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:40:43.895547 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:40:43.896133 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:40:43.897618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:40:43.898231 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:40:43.901699 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.902785 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:40:43.906412 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.907196 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.907683 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:40:43.908031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.909236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.909730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.910240 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:40:43.912441 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:43.913881 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.914376 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:40:43.915740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.917386 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.917861 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:40:43.919965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.924458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.925015 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:40:43.926376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.929296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.929783 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:40:43.930977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.933267 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:40:43.933932 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.934414 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:40:43.944863 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:40:43.947568 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:40:43.948078 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:40:43.956168 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:40:43.958324 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:40:43.959619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e564138320>]}
[0m10:40:43.960336 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.06s]
[0m10:40:43.961082 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:40:43.961571 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:40:43.962361 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:40:43.963069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:40:43.963641 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:40:43.967473 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:40:43.969518 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:40:43.973139 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:40:43.974029 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:40:43.974549 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:40:43.974894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.976446 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:43.976886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:40:43.977392 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),

        coalesce(points_per_90, 0) as points_per_90,

        case when not minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        coalesce(goals_scored_xdifferential, 0) as goals_scored_xdifferential,
        coalesce(expected_goals_scored_per_90, 0) as expected_goals_scored_per_90,

        coalesce(goals_assisted_per_90, 0) as goals_assisted_per_90,
        coalesce(goals_assisted_xdifferential, 0) as goals_assisted_xdifferential,
        coalesce(expected_goals_assisted_per_90, 0) as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m10:40:44.009493 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m10:40:44.011074 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:40:44.011523 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:40:44.013434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.015344 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:40:44.015836 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:40:44.018267 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:44.021615 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:40:44.022106 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:40:44.024534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.027809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:40:44.028327 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:40:44.029715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.031333 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:40:44.031892 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:40:44.032466 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:40:44.042506 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:40:44.046881 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:40:44.047346 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:40:44.055014 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:40:44.056857 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:40:44.061749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5661c1ac0>]}
[0m10:40:44.062599 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.10s]
[0m10:40:44.063347 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:40:44.063802 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:40:44.064484 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:40:44.065288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:40:44.065859 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:40:44.070456 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:40:44.071727 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:40:44.077464 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:40:44.078503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:40:44.079004 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:40:44.079354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:44.080567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.080953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:40:44.081355 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:40:44.093378 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:40:44.095401 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:40:44.096689 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:40:44.098447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.100809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:40:44.101323 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:40:44.103411 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:44.108060 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:40:44.108576 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:40:44.109868 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.113008 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:40:44.113449 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:40:44.114615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.116406 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:40:44.117128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:40:44.117479 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:40:44.124947 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:40:44.127633 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:40:44.128089 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:40:44.135575 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:40:44.138942 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:40:44.142758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5661d9190>]}
[0m10:40:44.143891 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.08s]
[0m10:40:44.144622 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:40:44.145112 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:40:44.145730 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:40:44.146798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:40:44.147321 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:40:44.152475 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:40:44.155048 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:40:44.163967 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:40:44.165203 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:40:44.165980 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:40:44.166915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:44.170488 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:40:44.171890 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:40:44.172436 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:40:44.196057 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m10:40:44.198124 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:40:44.198827 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:40:44.201174 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:40:44.203039 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:40:44.203528 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:40:44.205413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.209481 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:40:44.210136 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:40:44.211893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.218507 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:40:44.219242 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:40:44.220817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:40:44.222508 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:40:44.222943 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:40:44.223284 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:40:44.235817 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:40:44.238601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:40:44.239278 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:40:44.249541 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:40:44.251629 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:40:44.253530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f38461-31f8-44d2-bbce-57d946dcdf1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5661e7d70>]}
[0m10:40:44.254326 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.11s]
[0m10:40:44.255095 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:40:44.258818 [debug] [MainThread]: Using duckdb connection "master"
[0m10:40:44.259329 [debug] [MainThread]: On master: BEGIN
[0m10:40:44.259912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:40:44.261339 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:40:44.261801 [debug] [MainThread]: On master: COMMIT
[0m10:40:44.262439 [debug] [MainThread]: Using duckdb connection "master"
[0m10:40:44.262770 [debug] [MainThread]: On master: COMMIT
[0m10:40:44.264174 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:40:44.265151 [debug] [MainThread]: On master: Close
[0m10:40:44.266022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:44.266428 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:40:44.266977 [info ] [MainThread]: 
[0m10:40:44.267512 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m10:40:44.270160 [debug] [MainThread]: Command end result
[0m10:40:44.296087 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:40:44.298915 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:40:44.309564 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:40:44.310078 [info ] [MainThread]: 
[0m10:40:44.310585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:40:44.311006 [info ] [MainThread]: 
[0m10:40:44.312382 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:40:44.313965 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.4999118, "process_in_blocks": "0", "process_kernel_time": 0.573029, "process_mem_max_rss": "175564", "process_out_blocks": "4656", "process_user_time": 5.67182}
[0m10:40:44.314684 [debug] [MainThread]: Command `dbt build` succeeded at 10:40:44.314537 after 3.50 seconds
[0m10:40:44.315167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e59bec1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e5906093a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e59cbed3a0>]}
[0m10:40:44.315657 [debug] [MainThread]: Flushing usage events
[0m10:40:44.943548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:32.077119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dcab788e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dcab04ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dcab04c710>]}


============================== 10:41:32.080978 | 91e1a9fa-a757-4ce1-9a5d-a0ad42980a44 ==============================
[0m10:41:32.080978 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:41:32.081656 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'fail_fast': 'False', 'static_parser': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None'}
[0m10:41:32.453318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dcaa913bf0>]}
[0m10:41:32.571844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dcaa93a660>]}
[0m10:41:32.573639 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:41:32.669866 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:41:31.868698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:41:31.869735 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:41:32.430350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc859f3ad0>]}
[0m10:41:32.506034 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:41:32.508219 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:41:32.628755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc873c4530>]}
[0m10:41:32.629863 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:41:32.637803 [info ] [MainThread]: 
[0m10:41:32.639400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:41:32.642218 [info ] [MainThread]: 
[0m10:41:32.644412 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:41:32.660249 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:41:32.718168 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:41:32.719951 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:41:32.721615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:32.759323 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m10:41:32.761387 [debug] [ThreadPool]: On list_analytics: Close
[0m10:41:32.764746 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:41:32.765333 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:41:32.765819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:32.767938 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:41:32.770335 [debug] [ThreadPool]: On list_analytics: Close
[0m10:41:32.773076 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:41:32.773623 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:41:32.774111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:32.775744 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:41:32.777112 [debug] [ThreadPool]: On list_analytics: Close
[0m10:41:32.778829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m10:41:32.779429 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:41:32.789019 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:41:32.789655 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:41:32.790031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:32.792264 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:41:32.794262 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:41:32.794953 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:41:32.795720 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:32.796111 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:41:32.796441 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:41:32.797198 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:32.798158 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:41:32.798528 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:41:32.798814 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:41:32.799985 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:32.800530 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:41:32.801809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m10:41:32.802473 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:41:32.804614 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:41:32.805268 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:41:32.805766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:32.807526 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:41:32.808910 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:41:32.809312 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:41:32.810077 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:32.810398 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:41:32.810868 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:41:32.811758 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:32.812852 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:41:32.813409 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:41:32.813771 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:41:32.814766 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:32.815409 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:41:32.817370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m10:41:32.818074 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:41:32.819987 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:41:32.820363 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:41:32.820650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:32.823116 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:41:32.825134 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:41:32.825614 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:41:32.827008 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:32.827572 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:41:32.827894 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:41:32.829102 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:32.830241 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:41:32.830627 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:41:32.830976 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:41:32.832015 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:41:32.832834 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:41:32.837796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m10:41:32.846324 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:41:32.846862 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:41:32.847167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:32.848566 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:32.849000 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:41:32.849327 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:41:32.865667 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:41:32.867360 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:41:32.868575 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:41:32.868964 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:41:32.870058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m10:41:32.873211 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:41:32.873705 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:41:32.874781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:32.875751 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:32.876083 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:41:32.876364 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:41:32.881651 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:41:32.883537 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:41:32.884807 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:41:32.885136 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:41:32.886243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m10:41:32.889566 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:41:32.889999 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:41:32.890312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:32.891367 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:32.891796 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:41:32.892092 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:41:32.898947 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:41:32.900780 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:41:32.901851 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:41:32.902214 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:41:32.904665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc85846a80>]}
[0m10:41:32.905294 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:32.905776 [debug] [MainThread]: On master: BEGIN
[0m10:41:32.906075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:32.907390 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:41:32.907834 [debug] [MainThread]: On master: COMMIT
[0m10:41:32.908171 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:32.908455 [debug] [MainThread]: On master: COMMIT
[0m10:41:32.909220 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:41:32.909673 [debug] [MainThread]: On master: Close
[0m10:41:32.912617 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:41:32.913671 [info ] [Thread-1 (]: 1 of 14 START sql table model intermediate.int_players ......................... [RUN]
[0m10:41:32.914959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.int_players)
[0m10:41:32.915468 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:41:32.941695 [debug] [Thread-1 (]: Compilation Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  dbt was unable to infer all dependencies for the model "int_players".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "int_players":
  
  -- depends_on: {{ ref('stg_players') }}
[0m10:41:32.943876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc87222690>]}
[0m10:41:32.945007 [error] [Thread-1 (]: 1 of 14 ERROR creating sql table model intermediate.int_players ................ [[31mERROR[0m in 0.03s]
[0m10:41:32.945839 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:41:32.946323 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:41:32.948268 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Compilation Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  dbt was unable to infer all dependencies for the model "int_players".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "int_players":
  
  -- depends_on: {{ ref('stg_players') }}.
[0m10:41:32.947086 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:41:32.950268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.stg_fixtures)
[0m10:41:32.950793 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:41:32.954027 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:41:32.956359 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:41:33.006823 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:41:33.007986 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:41:33.008478 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:41:33.008811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.010410 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.011150 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:41:33.011546 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:41:33.014923 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.024391 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:41:33.025328 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:41:33.027148 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.029217 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:41:33.029726 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:41:33.031654 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.038850 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:41:33.039354 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:41:33.041047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.046150 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:41:33.046725 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:41:33.047917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.067710 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:41:33.068264 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:41:33.068621 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:41:33.078686 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:41:33.085825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:41:33.086361 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:41:33.094309 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:41:33.097485 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:41:33.099637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dcad07ec30>]}
[0m10:41:33.100972 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.15s]
[0m10:41:33.102448 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:41:33.103110 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:41:33.103707 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:41:33.106842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:41:33.107392 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:41:33.116220 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.117273 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:41:33.120778 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.121773 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.122230 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:41:33.122568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.123883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.124296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.124638 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:41:33.128797 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:41:33.132151 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.132647 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:41:33.137055 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:41:33.139732 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.140274 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:41:33.142920 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.149625 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.150626 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:41:33.153966 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.159085 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.159690 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:41:33.162935 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.165010 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:41:33.165514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.166087 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:41:33.176886 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:41:33.182904 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:41:33.184597 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:41:33.194530 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:41:33.197894 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:41:33.199114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc84e581d0>]}
[0m10:41:33.199976 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.09s]
[0m10:41:33.200751 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:41:33.201272 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:41:33.202101 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:41:33.203169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:41:33.204496 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:41:33.212153 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:41:33.215199 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:41:33.220478 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:41:33.221363 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:41:33.221946 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:41:33.222299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.223421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.224121 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:41:33.224629 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:41:33.238792 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:41:33.240264 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:41:33.240715 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:41:33.242152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.243769 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:41:33.244287 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:41:33.247266 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.253304 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:41:33.254050 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:41:33.255348 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.258639 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:41:33.259102 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:41:33.260300 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.262022 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:41:33.262478 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:41:33.262828 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:41:33.274425 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:41:33.277300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:41:33.277913 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:41:33.287791 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:41:33.290361 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:41:33.291627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc84091ac0>]}
[0m10:41:33.292378 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.09s]
[0m10:41:33.293114 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:41:33.293676 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:41:33.294265 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:41:33.295746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:41:33.296495 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:41:33.300723 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:41:33.301988 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:41:33.308936 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:41:33.311088 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:41:33.312144 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:41:33.312566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.313787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.314251 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:41:33.314768 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:41:33.322492 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:41:33.324069 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:41:33.324576 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:41:33.327514 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.331043 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:41:33.331595 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:41:33.334899 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.339308 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:41:33.339852 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:41:33.341245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.344604 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:41:33.345093 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:41:33.346626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.349103 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:41:33.350205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:41:33.350939 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:41:33.358297 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:41:33.361695 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:41:33.362398 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:41:33.369606 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:41:33.372055 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:41:33.373550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc52730da0>]}
[0m10:41:33.374506 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.08s]
[0m10:41:33.375664 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:41:33.376521 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:41:33.377545 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:41:33.379178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:41:33.380119 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:41:33.383431 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:41:33.386257 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:41:33.393651 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:41:33.394679 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:41:33.395250 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:41:33.395620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.397787 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.398275 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:41:33.398656 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:41:33.401679 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.403233 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:41:33.403719 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:41:33.405197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.406984 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:41:33.407531 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:41:33.410745 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.414700 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:41:33.415206 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:41:33.416432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.421821 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:41:33.422804 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:41:33.426030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.427990 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:41:33.428472 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:41:33.428962 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:41:33.437308 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:41:33.441252 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:41:33.441886 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:41:33.449277 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:41:33.451209 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:41:33.452237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc84e4e5d0>]}
[0m10:41:33.454203 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.07s]
[0m10:41:33.455071 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:41:33.456112 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:41:33.458414 [info ] [Thread-1 (]: 7 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:41:33.459621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:41:33.460653 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:41:33.464829 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:41:33.466046 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:41:33.473270 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:41:33.474726 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:41:33.475635 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:41:33.476092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.477305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.477874 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:41:33.478284 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:41:33.483771 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:41:33.485264 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:41:33.485842 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:41:33.487311 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.489291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:41:33.489847 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:41:33.493287 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.501201 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:41:33.501909 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:41:33.503602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.507482 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:41:33.507969 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:41:33.509088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.510630 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:41:33.511259 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:41:33.512668 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:41:33.522920 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:41:33.526012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:41:33.526729 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:41:33.534165 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:41:33.537041 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:41:33.538742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc52708bf0>]}
[0m10:41:33.539999 [info ] [Thread-1 (]: 7 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.08s]
[0m10:41:33.540895 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:41:33.541377 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:41:33.542273 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:41:33.543706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:41:33.544559 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:41:33.547863 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:41:33.549222 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:41:33.552820 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:41:33.555983 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:41:33.557031 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:41:33.557597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.560281 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.560862 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:41:33.561333 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:41:33.564693 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.566806 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:41:33.567386 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:41:33.569150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.571035 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:41:33.571502 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:41:33.576298 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:41:33.581020 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:41:33.581673 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:41:33.583285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.587317 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:41:33.588089 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:41:33.589439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.591036 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:41:33.591484 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:41:33.591967 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:41:33.600950 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:41:33.604952 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:41:33.605953 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:41:33.614782 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:41:33.617087 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:41:33.618769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc84e73590>]}
[0m10:41:33.619574 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.08s]
[0m10:41:33.620384 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:41:33.620870 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:41:33.621455 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:41:33.622736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:41:33.623222 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:41:33.626620 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:41:33.627473 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:41:33.631048 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:41:33.631884 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:41:33.632345 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:41:33.633319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.637078 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.637817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:41:33.638199 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:41:33.642357 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.644078 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:41:33.644564 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:41:33.647543 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.649826 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:41:33.650524 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:41:33.652552 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.659455 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:41:33.660129 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:41:33.662161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.667474 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:41:33.668077 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:41:33.669440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.671247 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:41:33.671715 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:41:33.672058 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:41:33.680220 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:41:33.686490 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:41:33.687505 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:41:33.698120 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:41:33.700259 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:41:33.702045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc52753980>]}
[0m10:41:33.702899 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.08s]
[0m10:41:33.703828 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:41:33.704494 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:41:33.705389 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_positions ...................... [RUN]
[0m10:41:33.707303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:41:33.709301 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:41:33.714908 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:41:33.716335 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:41:33.720854 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:41:33.721817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:41:33.722513 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:41:33.723015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.724754 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.725261 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:41:33.725711 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:41:33.728958 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.731491 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:41:33.732155 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:41:33.735108 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.737622 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:41:33.738199 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:41:33.741655 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.750025 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:41:33.750931 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:41:33.753206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.756779 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:41:33.757250 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:41:33.759283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.762819 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:41:33.764456 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:41:33.765878 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:41:33.772772 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:41:33.775765 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:41:33.776313 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:41:33.785579 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:41:33.787709 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:41:33.788617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc8407cda0>]}
[0m10:41:33.789650 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_positions ................. [[32mOK[0m in 0.08s]
[0m10:41:33.791002 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:41:33.792000 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:41:33.793926 [info ] [Thread-1 (]: 11 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:41:33.795566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:41:33.796509 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:41:33.800923 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:41:33.802345 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:41:33.806532 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:41:33.807357 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:41:33.807768 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:41:33.808089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.809382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.809871 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:41:33.810288 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:41:33.813399 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.815561 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:41:33.816058 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:41:33.818044 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.819711 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:41:33.820185 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:41:33.822231 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.826047 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:41:33.826584 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:41:33.827811 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.833257 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:41:33.833875 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:41:33.835058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.836583 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:41:33.837059 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:41:33.837436 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:41:33.845102 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:41:33.848837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:41:33.849590 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:41:33.859433 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:41:33.861442 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:41:33.862777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc527647d0>]}
[0m10:41:33.863551 [info ] [Thread-1 (]: 11 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.07s]
[0m10:41:33.864544 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:41:33.865480 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:41:33.869009 [info ] [Thread-1 (]: 12 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:41:33.871110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:41:33.875340 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:41:33.879874 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.880720 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:41:33.888917 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.890292 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.890777 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:41:33.891148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.893099 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.893717 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.894185 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:41:33.896635 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.898691 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.900301 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:41:33.902071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.909282 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.910642 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:41:33.914876 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:41:33.922359 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.922950 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:41:33.925384 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:33.929761 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.930298 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:41:33.931715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.933702 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:41:33.934367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.934903 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:41:33.943039 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:41:33.946744 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:41:33.947241 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:41:33.955917 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:41:33.958021 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:41:33.958967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc84e71220>]}
[0m10:41:33.960041 [info ] [Thread-1 (]: 12 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.09s]
[0m10:41:33.960754 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:41:33.961207 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:41:33.961932 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:41:33.962899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.fact_fixtures)
[0m10:41:33.963410 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:41:33.967429 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:41:33.969603 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:41:33.974847 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:41:33.976086 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:41:33.976566 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:41:33.977149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:33.978259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:33.978820 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:41:33.979311 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:41:33.994298 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:41:33.998370 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:41:34.000808 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:41:34.005791 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:34.009346 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:41:34.010115 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:41:34.012671 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:34.017809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:41:34.018454 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:41:34.021179 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:34.025397 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:41:34.025989 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:41:34.027639 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:34.032067 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:41:34.032656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:41:34.033022 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:41:34.040532 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:41:34.043326 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:41:34.043815 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:41:34.049965 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:41:34.052337 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:41:34.054636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e1a9fa-a757-4ce1-9a5d-a0ad42980a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc527050a0>]}
[0m10:41:34.055605 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.09s]
[0m10:41:34.056509 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:41:34.057181 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:41:34.058234 [info ] [Thread-1 (]: 14 of 14 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m10:41:34.059294 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:41:34.060214 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m10:41:34.065841 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:34.066775 [debug] [MainThread]: On master: BEGIN
[0m10:41:34.067116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:34.069111 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:41:34.069802 [debug] [MainThread]: On master: COMMIT
[0m10:41:34.070280 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:34.071004 [debug] [MainThread]: On master: COMMIT
[0m10:41:34.072207 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:41:34.073015 [debug] [MainThread]: On master: Close
[0m10:41:34.073916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:34.074474 [debug] [MainThread]: Connection 'model.fpl_analytics.fact_fixtures' was properly closed.
[0m10:41:34.075004 [info ] [MainThread]: 
[0m10:41:34.075457 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m10:41:34.077756 [debug] [MainThread]: Command end result
[0m10:41:34.101904 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:41:34.104364 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:41:34.112442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:41:34.112994 [info ] [MainThread]: 
[0m10:41:34.113497 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:41:34.114000 [info ] [MainThread]: 
[0m10:41:34.114503 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m10:41:34.115151 [error] [MainThread]:   Compilation Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  dbt was unable to infer all dependencies for the model "int_players".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "int_players":
  
  -- depends_on: {{ ref('stg_players') }}
[0m10:41:34.115638 [info ] [MainThread]: 
[0m10:41:34.116120 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m10:41:34.117599 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.0737684, "process_in_blocks": "1312", "process_kernel_time": 0.58596, "process_mem_max_rss": "167748", "process_out_blocks": "3992", "process_user_time": 5.136004}
[0m10:41:34.118238 [debug] [MainThread]: Command `dbt build` failed at 10:41:34.118109 after 3.07 seconds
[0m10:41:34.118762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dcab04c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dc84f5bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71dcab788e90>]}
[0m10:41:34.119239 [debug] [MainThread]: Flushing usage events
[0m10:41:34.832640 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:42:11.092960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d1078fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d106f9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d10a04320>]}


============================== 10:42:11.096741 | ac05fb49-45f3-4e41-9527-597f353ae3be ==============================
[0m10:42:11.096741 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:42:11.097512 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'static_parser': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt build', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False'}
[0m10:42:11.473446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0652a8a0>]}
[0m10:42:11.581771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d101b42f0>]}
[0m10:42:11.583680 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:42:11.674864 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:42:11.794796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:11.795255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:11.841092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d04af3f80>]}
[0m10:42:11.918544 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:42:11.920858 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:42:11.953904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d064ba450>]}
[0m10:42:11.954496 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:42:11.957951 [info ] [MainThread]: 
[0m10:42:11.959287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:42:11.959709 [info ] [MainThread]: 
[0m10:42:11.960473 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:42:11.969325 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:42:12.011261 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:42:12.011755 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:42:12.012127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:12.042939 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m10:42:12.044917 [debug] [ThreadPool]: On list_analytics: Close
[0m10:42:12.048295 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:42:12.049412 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:42:12.050011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.052085 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:42:12.053501 [debug] [ThreadPool]: On list_analytics: Close
[0m10:42:12.055831 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:42:12.056287 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:42:12.056644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.058734 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:42:12.060432 [debug] [ThreadPool]: On list_analytics: Close
[0m10:42:12.062564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m10:42:12.063167 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:42:12.070249 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:42:12.070729 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:42:12.071050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.072609 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:42:12.074237 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:42:12.074664 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:42:12.075409 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:12.075720 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:42:12.075975 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:42:12.076910 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:12.077903 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:42:12.078575 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:42:12.079150 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:42:12.080489 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:12.080859 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:42:12.081732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m10:42:12.082404 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:42:12.084234 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:42:12.084637 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:42:12.085001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.086821 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:42:12.088350 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:42:12.088744 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:42:12.089893 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:12.090245 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:42:12.090507 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:42:12.091281 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:12.092286 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:42:12.092666 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:42:12.093198 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:42:12.094017 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:12.094364 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:42:12.095188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m10:42:12.096404 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:42:12.098462 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:42:12.098855 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:42:12.099193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.101259 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:42:12.102652 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:42:12.103052 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:42:12.103725 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:12.104069 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:42:12.104344 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:42:12.105056 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:12.106151 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:42:12.106502 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:42:12.106777 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:42:12.107663 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:42:12.108231 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:42:12.110837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m10:42:12.118202 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:42:12.118718 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:42:12.119026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.120273 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:12.120652 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:42:12.121308 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:42:12.136387 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m10:42:12.138128 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:42:12.139383 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:42:12.139769 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:42:12.140634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m10:42:12.142438 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:42:12.142839 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:42:12.143154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.145258 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:42:12.145613 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:42:12.145903 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:42:12.151369 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:42:12.152924 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:42:12.153966 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:42:12.154318 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:42:12.155158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m10:42:12.160779 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:42:12.161648 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:42:12.162248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:12.163333 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:42:12.163691 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:42:12.164007 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:42:12.170339 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:42:12.172035 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:42:12.172988 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:42:12.173407 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:42:12.175154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d06471730>]}
[0m10:42:12.175677 [debug] [MainThread]: Using duckdb connection "master"
[0m10:42:12.175971 [debug] [MainThread]: On master: BEGIN
[0m10:42:12.176231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:12.177374 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:42:12.177945 [debug] [MainThread]: On master: COMMIT
[0m10:42:12.178344 [debug] [MainThread]: Using duckdb connection "master"
[0m10:42:12.178657 [debug] [MainThread]: On master: COMMIT
[0m10:42:12.179686 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:42:12.180329 [debug] [MainThread]: On master: Close
[0m10:42:12.185365 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:42:12.186111 [info ] [Thread-1 (]: 1 of 14 START sql table model intermediate.int_players ......................... [RUN]
[0m10:42:12.186753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.int_players)
[0m10:42:12.187164 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:42:12.199222 [debug] [Thread-1 (]: Compilation Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  dbt was unable to infer all dependencies for the model "int_players".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "int_players":
  
  -- depends_on: {{ ref('stg_players') }}
[0m10:42:12.202374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d044653a0>]}
[0m10:42:12.203664 [error] [Thread-1 (]: 1 of 14 ERROR creating sql table model intermediate.int_players ................ [[31mERROR[0m in 0.01s]
[0m10:42:12.204402 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:42:12.204871 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:42:12.205869 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Compilation Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  dbt was unable to infer all dependencies for the model "int_players".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "int_players":
  
  -- depends_on: {{ ref('stg_players') }}.
[0m10:42:12.207024 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:42:12.208310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.stg_fixtures)
[0m10:42:12.208690 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:42:12.212199 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:42:12.212935 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:42:12.258621 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:42:12.259680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:42:12.260123 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:42:12.260431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.261514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.261930 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:42:12.262252 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:42:12.265772 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:42:12.272163 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:42:12.272640 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:42:12.274395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.275798 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:42:12.276227 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:42:12.277677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.284278 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:42:12.284904 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:42:12.286090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.288990 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:42:12.289428 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:42:12.290428 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.309501 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:42:12.310039 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:42:12.310443 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:42:12.317911 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.325556 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:42:12.326115 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:42:12.333152 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.336464 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:42:12.337624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d12b26b40>]}
[0m10:42:12.338368 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.13s]
[0m10:42:12.339018 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:42:12.339448 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:42:12.339959 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:42:12.340545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:42:12.341186 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:42:12.345312 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.346222 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:42:12.351297 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.352704 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.353269 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:42:12.353635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.355759 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.356666 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.357295 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:42:12.359892 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.361196 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.361640 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:42:12.362884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.364226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.364655 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:42:12.366656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.436152 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.436681 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:42:12.437878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.441247 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.441752 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:42:12.442915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.444574 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:42:12.445135 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.445516 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:42:12.454471 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:42:12.458128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:42:12.458962 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:42:12.466944 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.468750 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:42:12.470241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d10f4ce60>]}
[0m10:42:12.471538 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.13s]
[0m10:42:12.472361 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:42:12.472825 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:42:12.473430 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:42:12.474810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:42:12.475318 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:42:12.478457 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:42:12.479367 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:42:12.482302 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:42:12.483019 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.483418 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:42:12.483738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.484885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.485320 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.485744 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:42:12.496165 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:42:12.497663 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.498124 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:42:12.499631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.501011 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.501480 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:42:12.503466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.507896 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.508748 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:42:12.510066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.512948 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.513388 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:42:12.514312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.515833 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:42:12.516230 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.516586 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:42:12.524769 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:42:12.527909 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:42:12.528384 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:42:12.536019 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.538013 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:42:12.538970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d040802c0>]}
[0m10:42:12.539680 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.06s]
[0m10:42:12.541486 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:42:12.542147 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:42:12.542791 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:42:12.543792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:42:12.545482 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:42:12.548378 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:42:12.549023 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:42:12.551990 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:42:12.553268 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.553963 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:42:12.554441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.555531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.556046 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.556750 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:42:12.560628 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:42:12.562723 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.563247 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:42:12.564695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.566605 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.567541 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:42:12.569708 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.574538 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.575027 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:42:12.576613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.580612 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.581280 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:42:12.582795 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.584248 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:42:12.584742 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.585089 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:42:12.591327 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.593981 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:42:12.594452 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:42:12.601428 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.603194 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:42:12.604344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d040afd10>]}
[0m10:42:12.605068 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.06s]
[0m10:42:12.605757 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:42:12.606183 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:42:12.606670 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:42:12.607245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:42:12.608158 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:42:12.611805 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:42:12.612478 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:42:12.615527 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:42:12.616207 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.616583 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:42:12.616887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.617921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.618319 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.618648 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:42:12.621203 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.622429 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.622868 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:42:12.624442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.626252 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.626692 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:42:12.629110 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.634148 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.634626 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:42:12.635724 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.638514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.638911 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:42:12.639960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.641418 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:42:12.641863 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.642249 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:42:12.649922 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.652415 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:42:12.652855 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:42:12.659102 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.661196 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:42:12.662537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d044563c0>]}
[0m10:42:12.663805 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.06s]
[0m10:42:12.665189 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:42:12.665748 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:42:12.666322 [info ] [Thread-1 (]: 7 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:42:12.666982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:42:12.667451 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:42:12.670444 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:42:12.671331 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:42:12.674498 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:42:12.675167 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.675545 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:42:12.675850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.676882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.677263 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.677604 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:42:12.680228 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.682398 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.683146 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:42:12.685491 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.688914 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.689482 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:42:12.691596 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.694595 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.695051 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:42:12.696343 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.701629 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.702411 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:42:12.703742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.705612 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:42:12.706077 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.706423 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:42:12.713652 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.716128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:42:12.716554 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:42:12.723047 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.724653 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:42:12.725785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d040e88f0>]}
[0m10:42:12.726805 [info ] [Thread-1 (]: 7 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.06s]
[0m10:42:12.727645 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:42:12.728114 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:42:12.728660 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:42:12.730291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:42:12.731023 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:42:12.735493 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:42:12.736262 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:42:12.739337 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:42:12.740062 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:42:12.740453 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:42:12.740769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.742417 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.742890 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:42:12.743441 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:42:12.747684 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:42:12.749385 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:42:12.749836 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:42:12.751202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.752639 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:42:12.753037 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:42:12.754478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.757615 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:42:12.758061 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:42:12.758953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:42:12.762288 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:42:12.763155 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:42:12.765727 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.767763 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:42:12.768273 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:42:12.768626 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:42:12.776562 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.779331 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:42:12.779818 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:42:12.787991 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:42:12.789789 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:42:12.790631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d04476cc0>]}
[0m10:42:12.791385 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.06s]
[0m10:42:12.792282 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:42:12.792737 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:42:12.793642 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:42:12.794566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:42:12.795082 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:42:12.798812 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:42:12.799967 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:42:12.803358 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:42:12.804162 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.804556 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:42:12.804866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.806108 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.806653 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.807192 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:42:12.809671 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.810980 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.811464 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:42:12.813739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.816234 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.816815 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:42:12.818920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.822441 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.822880 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:42:12.824325 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.830373 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.830952 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:42:12.832103 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.834345 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:42:12.834821 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.835463 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:42:12.843075 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.845631 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:42:12.846382 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:42:12.853218 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.854921 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:42:12.855967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d04454fb0>]}
[0m10:42:12.856611 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.06s]
[0m10:42:12.857281 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:42:12.857728 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:42:12.858221 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_positions ...................... [RUN]
[0m10:42:12.859300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:42:12.859808 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:42:12.863038 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:42:12.864347 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:42:12.869616 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:42:12.871502 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.872273 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:42:12.872643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.873992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.874441 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.874809 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:42:12.877213 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.878848 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.879438 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:42:12.881124 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.882692 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.883159 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:42:12.885025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.888985 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.889483 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:42:12.891065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.894089 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.894524 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:42:12.895764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.897250 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:42:12.897712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.898070 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:42:12.905323 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.907951 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:42:12.908371 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:42:12.915346 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.917266 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:42:12.918081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d04897470>]}
[0m10:42:12.918791 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_positions ................. [[32mOK[0m in 0.06s]
[0m10:42:12.920126 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:42:12.920641 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:42:12.921213 [info ] [Thread-1 (]: 11 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:42:12.922036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:42:12.922425 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:42:12.925041 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:42:12.925820 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:42:12.928830 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:42:12.929552 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.929978 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:42:12.930559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.932839 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:12.933816 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.934823 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:42:12.938024 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:42:12.939502 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.939968 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:42:12.941643 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.943098 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.943543 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:42:12.945265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.948838 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.949508 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:42:12.952026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.955403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.955917 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:42:12.957078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.958574 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:42:12.958976 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.959296 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:42:12.965816 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:12.970959 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:42:12.971493 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:42:12.979231 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:12.981035 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:42:12.982108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d100b1dc0>]}
[0m10:42:12.982814 [info ] [Thread-1 (]: 11 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.06s]
[0m10:42:12.983447 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:42:12.983876 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:42:12.984413 [info ] [Thread-1 (]: 12 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:42:12.985547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:42:12.986382 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:42:12.990474 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:42:12.991773 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:42:12.994733 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:42:12.995618 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:42:12.996144 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:42:12.996474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:12.997710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:12.998250 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:42:12.998620 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:42:13.000717 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:13.002135 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:42:13.002813 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:42:13.004509 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:13.006470 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:42:13.007394 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:42:13.010224 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:13.014765 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:42:13.015325 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:42:13.016884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:13.020435 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:42:13.020976 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:42:13.022960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:13.024865 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:42:13.025361 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:42:13.025706 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:42:13.031625 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:42:13.036200 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:42:13.036807 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:42:13.043490 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:42:13.045294 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:42:13.046161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d044648f0>]}
[0m10:42:13.046878 [info ] [Thread-1 (]: 12 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.06s]
[0m10:42:13.047572 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:42:13.047999 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:42:13.050098 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:42:13.053496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.fact_fixtures)
[0m10:42:13.055671 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:42:13.059770 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:42:13.060583 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:42:13.063626 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:42:13.064478 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:42:13.064893 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:42:13.065535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:13.067242 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:42:13.067823 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:42:13.068278 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:42:13.079217 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:42:13.080662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:42:13.081092 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:42:13.082400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:13.083830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:42:13.084226 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:42:13.085977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:13.089448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:42:13.089934 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:42:13.091052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:13.094027 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:42:13.094448 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:42:13.095831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:42:13.097566 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:42:13.097999 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:42:13.098328 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:42:13.107955 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:42:13.111114 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:42:13.111603 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:42:13.119179 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:42:13.122798 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:42:13.124256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05fb49-45f3-4e41-9527-597f353ae3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d04127680>]}
[0m10:42:13.125014 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.07s]
[0m10:42:13.125702 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:42:13.126125 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:42:13.126532 [info ] [Thread-1 (]: 14 of 14 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m10:42:13.127033 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:42:13.127693 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m10:42:13.131116 [debug] [MainThread]: Using duckdb connection "master"
[0m10:42:13.132162 [debug] [MainThread]: On master: BEGIN
[0m10:42:13.132615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:13.133916 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:42:13.134312 [debug] [MainThread]: On master: COMMIT
[0m10:42:13.134613 [debug] [MainThread]: Using duckdb connection "master"
[0m10:42:13.134994 [debug] [MainThread]: On master: COMMIT
[0m10:42:13.135799 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:42:13.136197 [debug] [MainThread]: On master: Close
[0m10:42:13.136772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:13.137092 [debug] [MainThread]: Connection 'model.fpl_analytics.fact_fixtures' was properly closed.
[0m10:42:13.137621 [info ] [MainThread]: 
[0m10:42:13.138039 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m10:42:13.140124 [debug] [MainThread]: Command end result
[0m10:42:13.163946 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:42:13.167986 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:42:13.179333 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:42:13.179820 [info ] [MainThread]: 
[0m10:42:13.180523 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:42:13.181990 [info ] [MainThread]: 
[0m10:42:13.183451 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m10:42:13.184008 [error] [MainThread]:   Compilation Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  dbt was unable to infer all dependencies for the model "int_players".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "int_players":
  
  -- depends_on: {{ ref('stg_players') }}
[0m10:42:13.184995 [info ] [MainThread]: 
[0m10:42:13.185465 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m10:42:13.186649 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.189459, "process_in_blocks": "8", "process_kernel_time": 0.428057, "process_mem_max_rss": "165004", "process_out_blocks": "2984", "process_user_time": 4.103851}
[0m10:42:13.187153 [debug] [MainThread]: Command `dbt build` failed at 10:42:13.187041 after 2.19 seconds
[0m10:42:13.187595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0652ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d10f4edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0411b5f0>]}
[0m10:42:13.188052 [debug] [MainThread]: Flushing usage events
[0m10:42:13.798010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:43:06.143939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41ed590b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41ece520f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41ece52930>]}


============================== 10:43:06.148555 | 4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5 ==============================
[0m10:43:06.148555 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:43:06.149704 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error': 'None', 'debug': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'invocation_command': 'dbt build', 'indirect_selection': 'eager', 'version_check': 'True', 'fail_fast': 'False', 'quiet': 'False', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'empty': 'False', 'printer_width': '80'}
[0m10:43:06.511510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41ec5bdcd0>]}
[0m10:43:06.623472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41ec5bdcd0>]}
[0m10:43:06.625468 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:43:05.783644 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:43:05.916604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:43:05.917565 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:43:06.477872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41e0ce7c20>]}
[0m10:43:06.554489 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:43:06.556988 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:43:06.658062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41e0bf3740>]}
[0m10:43:06.658653 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:43:06.662471 [info ] [MainThread]: 
[0m10:43:06.663387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:06.664073 [info ] [MainThread]: 
[0m10:43:06.665003 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:43:06.674112 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:43:06.718348 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:43:06.718844 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:43:06.719270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:06.752368 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m10:43:06.754118 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:06.757201 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:43:06.757765 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:43:06.758138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:06.760241 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:06.761889 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:06.764580 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:43:06.765063 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:43:06.765534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:06.767198 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:06.768441 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:06.769515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m10:43:06.770107 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:43:06.777894 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:06.778384 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:43:06.778684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:06.780263 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:06.781894 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:06.782273 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:43:06.783243 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.783557 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:06.783811 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:43:06.785194 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.786134 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:43:06.786465 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:06.786765 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:43:06.787616 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.787957 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:43:06.789037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m10:43:06.789720 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:43:06.791534 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:06.791881 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:43:06.792154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:06.793447 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.794868 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:06.795214 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:43:06.795890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:06.796200 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:06.796459 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:43:06.797381 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.798338 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:43:06.798690 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:06.799001 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:43:06.799983 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.800391 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:43:06.801451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m10:43:06.802304 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:43:06.804621 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:06.804980 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:43:06.805479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:06.807492 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:06.809087 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:06.809466 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:43:06.810582 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.810954 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:06.811251 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:43:06.811975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:06.813212 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:43:06.813579 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:06.813976 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:43:06.815155 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.815606 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:43:06.818707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m10:43:06.826566 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:43:06.827263 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:43:06.827603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:06.829421 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:06.829861 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:43:06.830184 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:43:06.843532 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m10:43:06.845886 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:43:06.847279 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:43:06.847635 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:43:06.848709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m10:43:06.851647 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:43:06.853047 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:43:06.853423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:06.854609 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.855245 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:43:06.855550 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:43:06.860778 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:43:06.862646 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:43:06.863730 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:43:06.864065 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:43:06.864882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m10:43:06.867922 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:43:06.868331 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:43:06.868629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:06.869979 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:06.870475 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:43:06.870884 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:43:06.875640 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:43:06.877363 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:43:06.878262 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:43:06.878579 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:43:06.881018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41e27e8380>]}
[0m10:43:06.881613 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:06.881944 [debug] [MainThread]: On master: BEGIN
[0m10:43:06.882215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:06.883206 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:06.883549 [debug] [MainThread]: On master: COMMIT
[0m10:43:06.883822 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:06.884067 [debug] [MainThread]: On master: COMMIT
[0m10:43:06.885930 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:06.886582 [debug] [MainThread]: On master: Close
[0m10:43:06.890630 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:43:06.891289 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:43:06.892215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m10:43:06.892656 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:43:06.901012 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:43:06.902308 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:43:06.943178 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:43:06.944040 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:06.944454 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:43:06.944776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:06.945869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:06.946249 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:06.946568 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:43:06.949473 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:06.955502 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:06.956012 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:43:06.957980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:06.959424 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:06.959815 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:43:06.962499 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:06.971837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:06.972892 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:43:06.975047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:06.978551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:06.979045 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:43:06.980363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:06.999482 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:43:07.000048 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:07.000403 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:43:07.007520 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.014278 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:07.014791 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:43:07.025951 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:43:07.030391 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:43:07.033797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41eeeb6ba0>]}
[0m10:43:07.034861 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.14s]
[0m10:43:07.035614 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:43:07.036088 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:43:07.037422 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:43:07.038227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:43:07.038720 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:43:07.042341 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.043172 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:43:07.050671 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.051750 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.052174 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:43:07.052492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.054506 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.055162 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.055540 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:43:07.057751 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.059232 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.059768 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:43:07.063360 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.065972 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.066862 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:43:07.069839 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.073712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.074192 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:43:07.076858 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.082482 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.083225 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:43:07.084533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.088210 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:43:07.089091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.089489 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:43:07.098672 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:43:07.101533 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:07.102014 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:43:07.110296 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.112819 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:43:07.114089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41e02d43b0>]}
[0m10:43:07.114990 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.08s]
[0m10:43:07.115697 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:43:07.116441 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:43:07.117785 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:43:07.118486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:43:07.118964 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:43:07.122377 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:43:07.123809 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:43:07.128369 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:43:07.129467 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:07.129889 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:43:07.130311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.131430 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.132220 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:07.132768 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:43:07.148424 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m10:43:07.150600 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:07.151115 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:43:07.152984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.154963 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:07.155729 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:43:07.158143 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.161782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:07.162303 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:43:07.163826 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.168743 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:07.169451 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:43:07.170683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.172396 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:43:07.172818 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:07.173233 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:43:07.181137 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.183762 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:07.184213 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:43:07.192168 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.194195 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:43:07.196030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41c81924b0>]}
[0m10:43:07.196772 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.08s]
[0m10:43:07.197669 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:43:07.198110 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:43:07.198996 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:43:07.200117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:43:07.200546 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:43:07.203713 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:43:07.204632 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:43:07.208195 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:43:07.209161 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:07.209751 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:43:07.210420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.211477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.211835 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:07.212190 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:43:07.215332 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:07.216650 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:07.217146 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:43:07.218583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.222072 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:07.222537 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:43:07.224216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.228526 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:07.229117 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:43:07.230877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.233774 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:07.234220 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:43:07.238227 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:07.239931 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:43:07.240393 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:07.240734 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:43:07.247911 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.250561 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:07.250993 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:43:07.257867 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:07.259804 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:43:07.260886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41e01e5bb0>]}
[0m10:43:07.261696 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.06s]
[0m10:43:07.262374 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:43:07.262813 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:43:07.263571 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:43:07.264298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:43:07.264764 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:43:07.268025 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:43:07.268744 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:43:07.271824 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:43:07.272559 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:07.272942 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:43:07.273296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.274371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.274767 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:07.275100 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:43:07.278350 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:07.279576 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:07.280029 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:43:07.281550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.283020 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:07.283550 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:43:07.285660 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.289939 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:07.290380 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:43:07.291903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.295097 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:07.295590 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:43:07.297070 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.299596 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:43:07.300389 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:07.300966 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:43:07.308764 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.312230 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:07.312691 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:43:07.319416 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:07.321254 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:43:07.322403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41e01e5880>]}
[0m10:43:07.323119 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.06s]
[0m10:43:07.323772 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:43:07.324224 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:43:07.325118 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:43:07.325981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:43:07.326456 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:43:07.330153 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:43:07.331246 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:43:07.335734 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:43:07.336651 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:07.337142 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:43:07.337568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.339021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.339499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:07.339866 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:43:07.344152 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:43:07.345728 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:07.346199 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:43:07.347770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.349806 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:07.350356 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:43:07.352395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.358966 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:07.359587 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:43:07.361444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.367163 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:07.369243 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:43:07.372494 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.376823 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:43:07.377768 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:07.378181 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:43:07.386727 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:43:07.389619 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:07.390094 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:43:07.397809 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.399567 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:43:07.400577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41c823f3b0>]}
[0m10:43:07.401708 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.07s]
[0m10:43:07.403259 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:43:07.404079 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:43:07.404646 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:43:07.406000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:43:07.406506 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:43:07.409584 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:43:07.411814 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:43:07.415817 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:43:07.416616 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:07.417090 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:43:07.417445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.418569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.419010 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:07.419392 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:43:07.423080 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:07.424676 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:07.425193 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:43:07.426647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.428300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:07.428709 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:43:07.430379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.434640 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:07.435319 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:43:07.436636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.439914 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:07.440360 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:43:07.441607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.443339 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:43:07.443809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:07.444141 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:43:07.451204 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.454081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:07.454571 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:43:07.462449 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.464433 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:43:07.465654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41e2aadd30>]}
[0m10:43:07.466416 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.06s]
[0m10:43:07.467058 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:43:07.467492 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:43:07.468019 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:43:07.469240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:43:07.469734 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:43:07.473379 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:43:07.474505 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:43:07.478921 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:43:07.479733 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:07.480194 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:43:07.480505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.481830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.482488 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:07.482849 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:43:07.485317 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.486692 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:07.487199 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:43:07.488449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.489826 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:07.490237 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:43:07.492192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.500255 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:07.500798 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:43:07.502224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.507294 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:07.507787 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:43:07.509087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.510712 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:43:07.511202 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:07.511549 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:43:07.517940 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:07.520469 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:07.520917 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:43:07.529011 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.530814 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:43:07.531640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41c8219d60>]}
[0m10:43:07.532312 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.06s]
[0m10:43:07.532995 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:43:07.533473 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:43:07.534051 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:43:07.536726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:43:07.537322 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:43:07.541400 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:43:07.542319 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:43:07.546214 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:43:07.546988 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:07.547615 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:43:07.547970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.549721 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.550158 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:07.550504 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:43:07.552410 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.553616 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:07.554119 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:43:07.556126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.558646 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:07.559255 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:43:07.561876 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.565180 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:07.565656 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:43:07.567189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.570472 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:07.571111 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:43:07.572552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.574188 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:43:07.574623 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:07.575180 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:43:07.583331 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:43:07.586075 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:07.586510 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:43:07.593266 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:07.594941 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:43:07.596010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41e011e2a0>]}
[0m10:43:07.596698 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.06s]
[0m10:43:07.597421 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:43:07.597850 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:43:07.598367 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:43:07.599694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:43:07.600107 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:43:07.603006 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:43:07.603784 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:43:07.607691 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:43:07.609047 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:07.609481 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:43:07.609796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.611917 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.612473 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:07.612903 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:43:07.615625 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.616876 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:07.617365 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:43:07.619085 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.620719 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:07.621563 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:43:07.623422 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.626957 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:07.627545 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:43:07.628857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.632586 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:07.633002 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:43:07.634032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.635588 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:43:07.636088 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:07.636491 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:43:07.645118 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:43:07.649763 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:07.650267 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:43:07.657667 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.660424 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:43:07.661452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41c8264a10>]}
[0m10:43:07.662216 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.06s]
[0m10:43:07.663600 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:43:07.664855 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:43:07.665961 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:43:07.666585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:43:07.667008 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:43:07.670497 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.671472 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:43:07.674916 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.675614 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.676045 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:43:07.676462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.678555 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.679116 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.679498 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:43:07.681733 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.683568 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.684124 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:43:07.685549 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.687030 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.687439 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:43:07.689540 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:07.692748 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.693269 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:43:07.694389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.697082 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.697505 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:43:07.698763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.701097 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:43:07.701591 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.701952 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:43:07.711062 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:43:07.714653 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:07.715142 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:43:07.722830 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.724887 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:43:07.726084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41c82660f0>]}
[0m10:43:07.726818 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.06s]
[0m10:43:07.727529 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:43:07.728096 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:43:07.729108 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:43:07.730063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:43:07.730873 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:43:07.735079 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:43:07.735869 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:43:07.738745 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:43:07.739506 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:07.739886 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:43:07.740202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.741359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.741757 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:07.742272 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),

        coalesce(points_per_90, 0) as points_per_90,

        case minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        coalesce(goals_scored_xdifferential, 0) as goals_scored_xdifferential,
        coalesce(expected_goals_scored_per_90, 0) as expected_goals_scored_per_90,

        coalesce(goals_assisted_per_90, 0) as goals_assisted_per_90,
        coalesce(goals_assisted_xdifferential, 0) as goals_assisted_xdifferential,
        coalesce(expected_goals_assisted_per_90, 0) as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m10:43:07.757518 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),

        coalesce(points_per_90, 0) as points_per_90,

        case minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        coalesce(goals_scored_xdifferential, 0) as goals_scored_xdifferential,
        coalesce(expected_goals_scored_per_90, 0) as expected_goals_scored_per_90,

        coalesce(goals_assisted_per_90, 0) as goals_assisted_per_90,
        coalesce(goals_assisted_xdifferential, 0) as goals_assisted_xdifferential,
        coalesce(expected_goals_assisted_per_90, 0) as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m10:43:07.758334 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:43:07.758848 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m10:43:07.770413 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m10:43:07.771143 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:43:07.774180 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "then"
  
  LINE 116:         case minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
                                          ^
[0m10:43:07.775013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41c81b1970>]}
[0m10:43:07.775800 [error] [Thread-1 (]: 12 of 14 ERROR creating sql table model intermediate.int_players ............... [[31mERROR[0m in 0.04s]
[0m10:43:07.776701 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:43:07.777193 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:43:07.777813 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "then"
  
  LINE 116:         case minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
                                          ^.
[0m10:43:07.778568 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:43:07.780272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:43:07.780908 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:43:07.785792 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:43:07.786699 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:43:07.790744 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:43:07.791532 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:07.791949 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:43:07.792268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:07.793564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.793994 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:07.794598 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:43:07.803971 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:43:07.805988 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:07.806825 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:43:07.808547 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.810150 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:07.810587 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:43:07.812165 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.818233 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:07.818919 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:43:07.820104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.823567 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:07.824033 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:43:07.825070 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:07.826575 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:43:07.826980 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:07.827312 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:43:07.834598 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:07.837194 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:07.837669 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:43:07.844407 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:07.846515 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:43:07.849541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0e93ff-16d6-4240-b5ca-9ad5bc681bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41c81c74a0>]}
[0m10:43:07.850420 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.07s]
[0m10:43:07.851515 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:43:07.852532 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:43:07.853316 [info ] [Thread-1 (]: 14 of 14 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m10:43:07.854289 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:43:07.854968 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m10:43:07.857709 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:07.858321 [debug] [MainThread]: On master: BEGIN
[0m10:43:07.858628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:07.859602 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:07.859963 [debug] [MainThread]: On master: COMMIT
[0m10:43:07.860258 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:07.860523 [debug] [MainThread]: On master: COMMIT
[0m10:43:07.861334 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:43:07.861723 [debug] [MainThread]: On master: Close
[0m10:43:07.862259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:07.862583 [debug] [MainThread]: Connection 'model.fpl_analytics.fact_fixtures' was properly closed.
[0m10:43:07.863203 [info ] [MainThread]: 
[0m10:43:07.863632 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m10:43:07.865839 [debug] [MainThread]: Command end result
[0m10:43:07.889830 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:43:07.891838 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:43:07.899405 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:43:07.899935 [info ] [MainThread]: 
[0m10:43:07.900383 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:43:07.900763 [info ] [MainThread]: 
[0m10:43:07.901265 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m10:43:07.901729 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Parser Error: syntax error at or near "then"
  
  LINE 116:         case minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
                                          ^
[0m10:43:07.902099 [info ] [MainThread]: 
[0m10:43:07.902474 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m10:43:07.902793 [info ] [MainThread]: 
[0m10:43:07.903140 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m10:43:07.904333 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.7775643, "process_in_blocks": "5752", "process_kernel_time": 0.601353, "process_mem_max_rss": "169432", "process_out_blocks": "4048", "process_user_time": 4.615582}
[0m10:43:07.904869 [debug] [MainThread]: Command `dbt build` failed at 10:43:07.904760 after 2.78 seconds
[0m10:43:07.905320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41ec76b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41ed562c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e41ed562330>]}
[0m10:43:07.905703 [debug] [MainThread]: Flushing usage events
[0m10:43:08.584763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:43:33.752100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae1462c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae13beda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae13e11a30>]}


============================== 10:43:33.757146 | cb45fa7f-497f-48ec-96e4-0e29b1651cd7 ==============================
[0m10:43:33.757146 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:43:33.758341 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'target_path': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'write_json': 'True'}
[0m10:43:34.147794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae137a3770>]}
[0m10:43:34.261692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae13cdb020>]}
[0m10:43:34.264030 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:43:34.363774 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:43:34.488745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:43:34.489605 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:43:35.028501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ade22f3b90>]}
[0m10:43:35.111414 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:43:35.113420 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:43:35.218206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae0974b9e0>]}
[0m10:43:35.218795 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:43:35.222999 [info ] [MainThread]: 
[0m10:43:35.223588 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:35.225718 [info ] [MainThread]: 
[0m10:43:35.226458 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:43:35.233868 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:43:35.279887 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:43:35.280441 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:43:35.280793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:35.318295 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m10:43:35.319970 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:35.322540 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:43:35.323012 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:43:35.323747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:35.325408 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:35.326866 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:35.329693 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:43:35.330375 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:43:35.330763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:35.332678 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:35.334469 [debug] [ThreadPool]: On list_analytics: Close
[0m10:43:35.336344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m10:43:35.336938 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:43:35.345458 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:35.345992 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:43:35.346370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:35.348571 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:35.350361 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:35.350768 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:43:35.351980 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.352375 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:35.352724 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:43:35.353665 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.354636 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:43:35.355001 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:43:35.355323 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:43:35.356028 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:43:35.356393 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:43:35.357232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m10:43:35.357777 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:43:35.359658 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:35.360064 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:43:35.360416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:35.362007 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:35.363535 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:35.363930 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:43:35.365136 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.365908 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:35.366242 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:43:35.367066 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.368381 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:43:35.369859 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:43:35.370290 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:43:35.371114 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.371487 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:43:35.372239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m10:43:35.372784 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:43:35.374747 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:35.375268 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:43:35.375587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:35.377104 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.378575 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:35.378931 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:43:35.380019 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.380387 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:35.380681 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:43:35.381601 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.382597 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:43:35.382949 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:43:35.383251 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:43:35.384207 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.384584 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:43:35.387916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m10:43:35.394402 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:43:35.394851 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:43:35.395140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:35.396457 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.396844 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:43:35.397304 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:43:35.413724 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:43:35.415894 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:43:35.417395 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:43:35.417843 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:43:35.418874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m10:43:35.422347 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:43:35.423771 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:43:35.424102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:35.425501 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.425879 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:43:35.426204 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:43:35.433165 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m10:43:35.434879 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:43:35.436009 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:43:35.436357 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:43:35.437521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m10:43:35.439654 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:43:35.441460 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:43:35.441753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:35.442628 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:35.442968 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:43:35.443299 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:43:35.449166 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:43:35.451053 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:43:35.452291 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:43:35.452654 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:43:35.455001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae097499d0>]}
[0m10:43:35.455615 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:35.456115 [debug] [MainThread]: On master: BEGIN
[0m10:43:35.456421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:35.457624 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:35.458033 [debug] [MainThread]: On master: COMMIT
[0m10:43:35.458542 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:35.458808 [debug] [MainThread]: On master: COMMIT
[0m10:43:35.459897 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:35.460302 [debug] [MainThread]: On master: Close
[0m10:43:35.464997 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:43:35.465921 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:43:35.467466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m10:43:35.468224 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:43:35.477567 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:43:35.478769 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:43:35.520953 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:43:35.521933 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:35.522445 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:43:35.522834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:35.524443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.525407 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:35.525890 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:43:35.528706 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.536349 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:35.537165 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:43:35.538892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.540735 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:35.541157 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:43:35.543263 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.550939 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:35.551417 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:43:35.552603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.556259 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:35.556740 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:43:35.558097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.576168 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:43:35.576769 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:35.577171 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:43:35.584020 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:35.590974 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:43:35.591799 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:43:35.599040 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:35.602095 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:43:35.604561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ade17e5eb0>]}
[0m10:43:35.605561 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.14s]
[0m10:43:35.606450 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:43:35.606949 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:43:35.608926 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:43:35.609785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:43:35.610225 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:43:35.613927 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.614632 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:43:35.619491 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.620418 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.620828 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:43:35.621189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:35.622497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.622933 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.623326 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:43:35.626129 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.627506 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.627936 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:43:35.629823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.631902 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.632613 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:43:35.634422 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.638526 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.639053 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:43:35.640271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.643403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.643846 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:43:35.645447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.647740 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:43:35.648249 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.648607 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:43:35.655071 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:35.658346 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:43:35.658846 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:43:35.666187 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:35.668007 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:43:35.668883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ada412acc0>]}
[0m10:43:35.669737 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.06s]
[0m10:43:35.670394 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:43:35.670839 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:43:35.671547 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:43:35.672467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:43:35.673133 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:43:35.677998 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:43:35.679480 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:43:35.683333 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:43:35.684162 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:35.684569 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:43:35.684891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:35.686652 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.687067 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:35.687483 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:43:35.700650 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:43:35.702238 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:35.702757 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:43:35.705240 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.706811 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:35.707253 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:43:35.709004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.712374 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:35.712849 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:43:35.714940 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.718526 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:35.719199 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:43:35.720465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.722183 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:43:35.722642 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:35.722999 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:43:35.733572 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:43:35.736142 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:43:35.736592 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:43:35.746186 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:43:35.750753 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:43:35.752650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ade17e6990>]}
[0m10:43:35.753654 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.08s]
[0m10:43:35.754435 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:43:35.754938 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:43:35.755974 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:43:35.757874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:43:35.758934 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:43:35.763301 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:43:35.764238 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:43:35.769969 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:43:35.770864 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:35.771338 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:43:35.771650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:35.772690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.773134 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:35.773481 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:43:35.776990 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:35.778599 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:35.779087 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:43:35.781585 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.786897 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:35.787440 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:43:35.790171 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.793545 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:35.794045 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:43:35.795362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.798456 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:35.798962 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:43:35.800658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.802378 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:43:35.802874 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:35.803223 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:43:35.810355 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:35.813446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:43:35.814194 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:43:35.823782 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:43:35.825651 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:43:35.826680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ada4187950>]}
[0m10:43:35.827440 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.07s]
[0m10:43:35.828081 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:43:35.828908 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:43:35.830678 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:43:35.832649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:43:35.833316 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:43:35.836579 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:43:35.838835 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:43:35.842691 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:43:35.843463 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:35.843928 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:43:35.844267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:35.845345 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.845776 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:35.846112 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:43:35.852116 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:43:35.853820 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:35.854292 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:43:35.856018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.857862 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:35.858337 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:43:35.860505 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.865362 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:35.865963 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:43:35.867275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.870641 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:35.871092 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:43:35.872140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.873678 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:43:35.874105 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:35.874498 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:43:35.882144 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:35.886638 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:43:35.887252 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:43:35.894804 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:35.898793 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:43:35.900375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ade17cd970>]}
[0m10:43:35.901254 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.07s]
[0m10:43:35.901983 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:43:35.902535 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:43:35.903797 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:43:35.904964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:43:35.905601 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:43:35.908601 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:43:35.909490 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:43:35.914275 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:43:35.916865 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:35.917425 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:43:35.917897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:35.921126 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.921868 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:35.922513 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:43:35.925874 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:35.927213 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:35.927632 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:43:35.930024 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.934877 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:35.935518 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:43:35.937658 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:35.943277 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:35.943887 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:43:35.945292 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.948354 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:35.948763 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:43:35.951087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.954149 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:43:35.954809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:35.955211 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:43:35.962171 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:35.964823 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:43:35.965366 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:43:35.975921 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:43:35.978158 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:43:35.979177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ada41a02c0>]}
[0m10:43:35.979953 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.07s]
[0m10:43:35.980724 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:43:35.981404 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:43:35.982150 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:43:35.983957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:43:35.986919 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:43:35.992535 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:43:35.993544 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:43:35.996838 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:43:35.997671 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:35.998066 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:43:35.998387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:35.999400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:35.999830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:36.000207 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:43:36.007681 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:36.009651 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:36.010223 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:43:36.011779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.013362 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:36.013764 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:43:36.015332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.019585 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:36.020149 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:43:36.021492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.026730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:36.027293 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:43:36.028702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.030361 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:43:36.030800 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:36.031136 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:43:36.039465 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:43:36.042837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:43:36.043496 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:43:36.051348 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:36.053883 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:43:36.056292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ade1731970>]}
[0m10:43:36.057553 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.07s]
[0m10:43:36.058596 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:43:36.059223 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:43:36.059794 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:43:36.060835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:43:36.061369 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:43:36.064109 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:43:36.064811 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:43:36.068021 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:43:36.068771 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:36.070891 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:43:36.071956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:36.073218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.074378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:36.074803 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:43:36.077616 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:36.078950 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:36.079410 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:43:36.080593 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.082051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:36.082465 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:43:36.084040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.088955 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:36.089766 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:43:36.091300 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.096623 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:36.097175 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:43:36.098371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.099850 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:43:36.100260 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:36.100651 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:43:36.107492 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:36.110570 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:43:36.111132 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:43:36.118332 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:36.120641 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:43:36.121866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ada416aae0>]}
[0m10:43:36.122869 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.06s]
[0m10:43:36.124289 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:43:36.125277 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:43:36.127652 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:43:36.128680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:43:36.129251 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:43:36.132043 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:43:36.132811 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:43:36.135941 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:43:36.136677 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:36.137107 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:43:36.137447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:36.140965 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:36.141697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:36.142088 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:43:36.145185 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:36.146707 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:36.147165 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:43:36.148803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.150550 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:36.150971 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:43:36.153311 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:36.159567 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:36.160491 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:43:36.163280 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:36.166378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:36.166838 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:43:36.168317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.169984 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:43:36.170411 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:36.170747 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:43:36.180365 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:43:36.183348 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:43:36.183773 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:43:36.191172 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:36.193798 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:43:36.195041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ada40ffc20>]}
[0m10:43:36.195863 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.07s]
[0m10:43:36.196534 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:43:36.196980 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:43:36.197653 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:43:36.198763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:43:36.199194 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:43:36.202124 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:43:36.203507 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:43:36.207882 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:43:36.208819 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:36.209737 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:43:36.210113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:36.211705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.212242 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:36.212927 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:43:36.216614 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:36.217968 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:36.218650 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:43:36.220364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.222002 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:36.222435 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:43:36.224999 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:36.229313 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:36.229894 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:43:36.231289 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.234687 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:36.235205 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:43:36.236531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.238120 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:43:36.238562 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:36.238899 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:43:36.247632 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:43:36.254172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:43:36.254874 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:43:36.263473 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:43:36.265782 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:43:36.266656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ada41c4800>]}
[0m10:43:36.267379 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.07s]
[0m10:43:36.268168 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:43:36.268850 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:43:36.269504 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:43:36.271032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:43:36.271495 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:43:36.274197 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.274924 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:43:36.279281 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.280276 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.280786 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:43:36.281336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:36.282669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.283064 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.283391 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:43:36.285676 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:36.287005 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.287468 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:43:36.288879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.290514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.290935 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:43:36.292936 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:36.296584 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.297141 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:43:36.298556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.302607 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.303261 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:43:36.304586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.306192 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:43:36.306642 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.306984 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:43:36.314518 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:36.318980 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:43:36.319574 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:43:36.327807 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:43:36.329667 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:43:36.330771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ada41c5f40>]}
[0m10:43:36.331502 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.06s]
[0m10:43:36.332332 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:43:36.333332 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:43:36.334117 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:43:36.334918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:43:36.335721 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:43:36.342295 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:43:36.343378 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:43:36.346630 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:43:36.347416 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:36.348606 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:43:36.349533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:36.350662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.351082 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:36.351661 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),

        coalesce(points_per_90, 0) as points_per_90,

        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        coalesce(goals_scored_xdifferential, 0) as goals_scored_xdifferential,
        coalesce(expected_goals_scored_per_90, 0) as expected_goals_scored_per_90,

        coalesce(goals_assisted_per_90, 0) as goals_assisted_per_90,
        coalesce(goals_assisted_xdifferential, 0) as goals_assisted_xdifferential,
        coalesce(expected_goals_assisted_per_90, 0) as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m10:43:36.383350 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m10:43:36.385320 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:36.385825 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:43:36.387756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.389498 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:36.389922 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:43:36.391989 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.395626 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:36.396086 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:43:36.397523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.400424 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:36.400896 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:43:36.402339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.403839 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:43:36.404377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:36.404784 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:43:36.414511 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:43:36.419613 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:43:36.420129 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:43:36.427956 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:36.430264 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:43:36.433303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ada416eea0>]}
[0m10:43:36.434136 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.10s]
[0m10:43:36.434869 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:43:36.435382 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:43:36.436355 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:43:36.437129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:43:36.438198 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:43:36.442057 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:43:36.443484 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:43:36.447200 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:43:36.448465 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:36.448879 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:43:36.449446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:36.450846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.451283 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:36.451699 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:43:36.459261 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:43:36.460761 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:36.461891 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:43:36.463484 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.465157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:36.465595 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:43:36.467236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.470949 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:36.471472 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:43:36.472570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.475536 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:36.475973 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:43:36.477090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.478798 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:43:36.479295 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:36.479716 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:43:36.488548 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:43:36.491754 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:43:36.492183 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:43:36.498512 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:43:36.500710 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:43:36.502133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ade1707e30>]}
[0m10:43:36.502841 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.07s]
[0m10:43:36.503529 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:43:36.503970 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:43:36.504816 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:43:36.505850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:43:36.506958 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:43:36.513367 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:43:36.514218 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:43:36.517598 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:43:36.518387 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:36.518794 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:43:36.519131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:36.520511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.520953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:36.521387 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:43:36.535497 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:43:36.537093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:36.537727 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:43:36.539111 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.540634 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:36.541109 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:43:36.543753 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:36.547756 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:36.548619 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:43:36.550541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.554597 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:36.555283 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:43:36.556507 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:36.558751 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:43:36.560703 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:36.561244 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:43:36.573262 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:43:36.576609 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:43:36.577514 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:43:36.588214 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:43:36.592170 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:43:36.596062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45fa7f-497f-48ec-96e4-0e29b1651cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ade17e7110>]}
[0m10:43:36.597066 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.09s]
[0m10:43:36.597866 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:43:36.603853 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:36.605511 [debug] [MainThread]: On master: BEGIN
[0m10:43:36.607030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:36.611070 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:43:36.611976 [debug] [MainThread]: On master: COMMIT
[0m10:43:36.612348 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:36.612659 [debug] [MainThread]: On master: COMMIT
[0m10:43:36.614510 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:36.615510 [debug] [MainThread]: On master: Close
[0m10:43:36.616628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:36.616983 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:43:36.617546 [info ] [MainThread]: 
[0m10:43:36.618271 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m10:43:36.628263 [debug] [MainThread]: Command end result
[0m10:43:36.664329 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:43:36.670056 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:43:36.680282 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:43:36.681231 [info ] [MainThread]: 
[0m10:43:36.682284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:36.683191 [info ] [MainThread]: 
[0m10:43:36.684114 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:43:36.687528 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.0424824, "process_in_blocks": "0", "process_kernel_time": 0.56568, "process_mem_max_rss": "175512", "process_out_blocks": "4648", "process_user_time": 5.346466}
[0m10:43:36.690593 [debug] [MainThread]: Command `dbt build` succeeded at 10:43:36.690078 after 3.05 seconds
[0m10:43:36.692510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae13c4ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae14258860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ae1425ade0>]}
[0m10:43:36.694471 [debug] [MainThread]: Flushing usage events
[0m10:43:37.310767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:46:59.886793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789efb304830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789efb02b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789efb5739b0>]}


============================== 10:46:59.891506 | 11375923-ed70-4e43-a41e-5860bffc1e6d ==============================
[0m10:46:59.891506 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:46:59.892570 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt build', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'write_json': 'True'}
[0m10:47:00.296581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789efab8f110>]}
[0m10:47:00.424973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ef693f5c0>]}
[0m10:47:00.427315 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:47:00.514480 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:47:00.644762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:47:00.645587 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m10:47:01.165501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ec9aebd70>]}
[0m10:47:01.253167 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:47:01.255360 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:47:01.362893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ec9ad4a10>]}
[0m10:47:01.363535 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:47:01.366825 [info ] [MainThread]: 
[0m10:47:01.367461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:47:01.367842 [info ] [MainThread]: 
[0m10:47:01.368712 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:47:01.376305 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:47:01.432299 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:47:01.434286 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:47:01.434983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:01.472504 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m10:47:01.474208 [debug] [ThreadPool]: On list_analytics: Close
[0m10:47:01.476893 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:47:01.478130 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:47:01.479507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:01.482145 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:47:01.485046 [debug] [ThreadPool]: On list_analytics: Close
[0m10:47:01.487550 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:47:01.488056 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:47:01.488462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:01.491117 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:47:01.492777 [debug] [ThreadPool]: On list_analytics: Close
[0m10:47:01.495581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m10:47:01.496320 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:47:01.508983 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:47:01.509730 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:47:01.510175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:01.512889 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:47:01.515153 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:47:01.516124 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:47:01.517405 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:47:01.517858 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:47:01.518460 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:47:01.520646 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:47:01.522093 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:47:01.522899 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:47:01.523228 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:47:01.524799 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:47:01.525258 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:47:01.526094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m10:47:01.526649 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:47:01.529049 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:47:01.529783 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:47:01.530242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:01.532055 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:47:01.534101 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:47:01.535309 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:47:01.537029 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:47:01.537458 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:47:01.537766 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:47:01.538508 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:47:01.539785 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:47:01.540425 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:47:01.540771 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:47:01.542001 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:47:01.542624 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:47:01.544270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m10:47:01.544975 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:47:01.547237 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:47:01.547669 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:47:01.548325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:01.550313 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:47:01.552344 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:47:01.552725 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:47:01.554258 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:47:01.554652 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:47:01.555002 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:47:01.555876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:47:01.559002 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:47:01.559491 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:47:01.559869 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:47:01.561498 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:47:01.562180 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:47:01.566088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_intermediate)
[0m10:47:01.572991 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:47:01.573490 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:47:01.573800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:01.576328 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:47:01.577901 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:47:01.578369 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:47:01.609136 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m10:47:01.612023 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:47:01.614049 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:47:01.614476 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:47:01.615803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m10:47:01.619655 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:47:01.621320 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:47:01.621812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:01.623627 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:47:01.624275 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:47:01.624667 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:47:01.630351 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:47:01.632436 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:47:01.633681 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:47:01.634049 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:47:01.635072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m10:47:01.637400 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:47:01.637971 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:47:01.638344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:01.640330 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:47:01.640715 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:47:01.641028 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:47:01.647323 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:47:01.649587 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:47:01.650573 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:47:01.650897 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:47:01.652745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789efbabf5c0>]}
[0m10:47:01.653314 [debug] [MainThread]: Using duckdb connection "master"
[0m10:47:01.653658 [debug] [MainThread]: On master: BEGIN
[0m10:47:01.653939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:01.655103 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:47:01.655458 [debug] [MainThread]: On master: COMMIT
[0m10:47:01.655746 [debug] [MainThread]: Using duckdb connection "master"
[0m10:47:01.656144 [debug] [MainThread]: On master: COMMIT
[0m10:47:01.657012 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:47:01.657351 [debug] [MainThread]: On master: Close
[0m10:47:01.662935 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:47:01.663738 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:47:01.664950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_fixtures)
[0m10:47:01.665412 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:47:01.673756 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:47:01.674612 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:47:01.718364 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:47:01.719306 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:47:01.719758 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:47:01.720137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:01.721429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.721836 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:47:01.722179 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:47:01.725171 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:47:01.731641 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:47:01.732282 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:47:01.734357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.736825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:47:01.737307 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:47:01.739348 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:01.748674 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:47:01.749306 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:47:01.750605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.754009 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:47:01.754463 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:47:01.755668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.773176 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:47:01.773745 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:47:01.774164 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:47:01.782330 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:01.788907 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:47:01.789469 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:47:01.798127 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:01.802809 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:47:01.805948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789efd38aab0>]}
[0m10:47:01.806858 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.14s]
[0m10:47:01.807585 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:47:01.808121 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:47:01.808707 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:47:01.809360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:47:01.809803 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:47:01.813186 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.815520 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:47:01.822874 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.823872 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.824495 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:47:01.824887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:01.826035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.826459 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.826805 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:47:01.829542 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:01.830883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.833046 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:47:01.834878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.836589 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.837293 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:47:01.840039 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:01.844257 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.844742 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:47:01.845998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.850088 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.850768 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:47:01.852426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.854989 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:47:01.855642 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.856108 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:47:01.863207 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:01.867583 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:47:01.868448 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:47:01.877016 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:01.878943 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:47:01.879928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789eb00a96d0>]}
[0m10:47:01.880774 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.07s]
[0m10:47:01.881481 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:47:01.881938 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:47:01.884635 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:47:01.886234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:47:01.886723 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:47:01.890656 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:47:01.892115 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:47:01.896052 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:47:01.896825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:47:01.897235 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:47:01.897558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:01.898640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.899090 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:47:01.900508 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:47:01.913646 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:47:01.915141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:47:01.915617 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:47:01.917137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.919818 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:47:01.920434 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:47:01.922602 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:01.926296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:47:01.926770 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:47:01.928204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.931210 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:47:01.931638 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:47:01.933049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.936516 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:47:01.937103 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:47:01.937472 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:47:01.948693 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:47:01.953377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:47:01.954109 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:47:01.962703 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:01.964682 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:47:01.966123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ec8fe6930>]}
[0m10:47:01.966899 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.08s]
[0m10:47:01.967583 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:47:01.968064 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:47:01.968814 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:47:01.969961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:47:01.970801 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:47:01.974381 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:47:01.975562 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:47:01.979175 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:47:01.979883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:47:01.980306 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:47:01.980626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:01.981668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.982053 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:47:01.982381 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:47:01.985595 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:01.987548 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:47:01.988272 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:47:01.989798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:01.993356 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:47:01.993936 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:47:01.995970 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:01.999157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:47:01.999643 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:47:02.001599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.006629 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:47:02.007149 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:47:02.008626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.010356 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:47:02.010923 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:47:02.011522 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:47:02.020761 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:02.023863 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:47:02.024574 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:47:02.032705 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.034668 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:47:02.035550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789eb00efbf0>]}
[0m10:47:02.036459 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.07s]
[0m10:47:02.039282 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:47:02.040012 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:47:02.040716 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:47:02.041876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:47:02.042483 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:47:02.046933 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:47:02.048094 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:47:02.052351 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:47:02.053604 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:47:02.056166 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:47:02.056671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.058357 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:02.058835 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:47:02.059216 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:47:02.062908 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:47:02.064448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:47:02.064977 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:47:02.066357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.067796 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:47:02.068353 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:47:02.070134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.073672 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:47:02.074197 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:47:02.075259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.078211 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:47:02.078701 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:47:02.079885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.081607 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:47:02.082055 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:47:02.082419 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:47:02.090129 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.093276 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:47:02.093852 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:47:02.107874 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:47:02.109625 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:47:02.110722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ec8fcaf90>]}
[0m10:47:02.111462 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.07s]
[0m10:47:02.112132 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:47:02.112600 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:47:02.113507 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:47:02.114272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:47:02.114673 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:47:02.117849 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:47:02.118608 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:47:02.122488 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:47:02.123223 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:47:02.123669 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:47:02.124071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.125284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.125747 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:47:02.126157 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:47:02.131169 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:47:02.132838 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:47:02.133357 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:47:02.134700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.136216 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:47:02.136893 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:47:02.138701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.144967 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:47:02.145500 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:47:02.146963 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.150717 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:47:02.151226 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:47:02.152437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.153988 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:47:02.154465 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:47:02.154827 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:47:02.162729 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.165951 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:47:02.166447 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:47:02.174842 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:02.176801 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:47:02.177703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789eb0107530>]}
[0m10:47:02.178468 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.06s]
[0m10:47:02.179148 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:47:02.179594 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:47:02.180133 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:47:02.181238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:47:02.181716 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:47:02.185599 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:47:02.187617 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:47:02.191692 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:47:02.194051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:47:02.195734 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:47:02.197732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.201167 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:47:02.202063 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:47:02.202514 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:47:02.207114 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:47:02.208716 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:47:02.209255 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:47:02.210606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.212094 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:47:02.212515 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:47:02.214035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.217499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:47:02.218037 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:47:02.219274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.222419 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:47:02.222869 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:47:02.224614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.226355 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:47:02.226845 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:47:02.227234 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:47:02.235701 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:02.238440 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:47:02.238868 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:47:02.246341 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.249080 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:47:02.250361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ec9021d00>]}
[0m10:47:02.251105 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.07s]
[0m10:47:02.251764 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:47:02.252254 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:47:02.252846 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:47:02.253847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:47:02.254235 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:47:02.257261 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:47:02.258026 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:47:02.262502 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:47:02.263539 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:47:02.263988 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:47:02.264737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.266188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.266638 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:47:02.267038 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:47:02.269402 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:02.270968 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:47:02.271381 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:47:02.272640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.274153 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:47:02.274559 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:47:02.276392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.280547 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:47:02.281100 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:47:02.282296 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.287309 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:47:02.287995 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:47:02.289388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.291037 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:47:02.291505 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:47:02.291930 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:47:02.299579 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.303416 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:47:02.304002 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:47:02.311530 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.314128 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:47:02.314979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789eb008d370>]}
[0m10:47:02.315714 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.06s]
[0m10:47:02.316421 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:47:02.317192 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:47:02.319052 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:47:02.319737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:47:02.320248 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:47:02.323458 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:47:02.324242 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:47:02.327261 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:47:02.328068 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:47:02.328470 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:47:02.328788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.329974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.330390 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:47:02.330739 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:47:02.332919 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:02.334799 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:47:02.335235 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:47:02.337154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.339258 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:47:02.339695 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:47:02.341542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.345592 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:47:02.346062 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:47:02.348047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.350811 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:47:02.351494 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:47:02.353098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.355032 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:47:02.355496 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:47:02.355871 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:47:02.363549 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.366188 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:47:02.366607 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:47:02.373951 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.375788 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:47:02.376999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ec8f44470>]}
[0m10:47:02.377762 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.06s]
[0m10:47:02.378436 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:47:02.378895 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:47:02.379444 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:47:02.380833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:47:02.381332 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:47:02.384395 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:47:02.385122 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:47:02.388205 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:47:02.388944 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:47:02.389361 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:47:02.389669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.390727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.391099 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:47:02.391419 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:47:02.393877 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:02.395135 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:47:02.395599 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:47:02.396794 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.398269 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:47:02.398717 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:47:02.400616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.404073 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:47:02.404586 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:47:02.406275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.410091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:47:02.410551 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:47:02.411521 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.413027 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:47:02.413442 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:47:02.413769 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:47:02.422277 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:02.428241 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:47:02.428784 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:47:02.436440 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.438399 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:47:02.439370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789eb012ccb0>]}
[0m10:47:02.440381 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.06s]
[0m10:47:02.441384 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:47:02.441916 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:47:02.442545 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:47:02.444641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:47:02.445105 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:47:02.450498 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.451710 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:47:02.456953 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.457990 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.458482 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:47:02.458847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.460190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.460734 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.461164 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:47:02.464574 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:47:02.465952 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.466463 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:47:02.467878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.469424 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.469836 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:47:02.472222 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:02.476040 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.476546 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:47:02.477660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.480810 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.481265 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:47:02.482532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.484454 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:47:02.484934 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.485293 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:47:02.494253 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:02.497289 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:47:02.497971 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:47:02.506667 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:02.509309 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:47:02.510728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789eb012c860>]}
[0m10:47:02.511687 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.07s]
[0m10:47:02.512512 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:47:02.513166 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:47:02.513723 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:47:02.515239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:47:02.516070 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:47:02.520613 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:47:02.521673 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:47:02.527308 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:47:02.528456 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:47:02.529227 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:47:02.529827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.531146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.531763 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:47:02.532346 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),


        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m10:47:02.568709 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m10:47:02.570121 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:47:02.570588 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:47:02.571916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.573561 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:47:02.573968 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:47:02.576334 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:02.579871 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:47:02.580387 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:47:02.582245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.585464 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:47:02.586054 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:47:02.587522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.589267 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:47:02.589782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:47:02.590160 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:47:02.600241 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:47:02.604600 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:47:02.605115 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:47:02.612922 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.615469 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:47:02.618824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789eb0140080>]}
[0m10:47:02.619595 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.10s]
[0m10:47:02.620549 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:47:02.621177 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:47:02.621972 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:47:02.622736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:47:02.623150 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:47:02.627166 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:47:02.628573 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:47:02.632476 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:47:02.633620 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:47:02.634296 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:47:02.634648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.636586 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.637100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:47:02.637624 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:47:02.645525 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.647186 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:47:02.647668 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:47:02.649759 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:02.651277 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:47:02.651712 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:47:02.653776 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:02.657160 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:47:02.657652 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:47:02.658750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.661743 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:47:02.662182 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:47:02.663878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.665775 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:47:02.666286 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:47:02.666647 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:47:02.674644 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.677371 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:47:02.677850 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:47:02.684001 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:47:02.685738 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:47:02.686930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ec8f18200>]}
[0m10:47:02.688252 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.06s]
[0m10:47:02.688998 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:47:02.689484 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:47:02.690559 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:47:02.691654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:47:02.694384 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:47:02.701577 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:47:02.702560 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:47:02.707217 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:47:02.708784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:47:02.709227 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:47:02.709601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:02.710643 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.711128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:47:02.711577 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:47:02.726666 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:47:02.728232 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:47:02.728699 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:47:02.730882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.733166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:47:02.733647 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:47:02.736472 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:02.740068 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:47:02.740555 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:47:02.742497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.747262 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:47:02.747744 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:47:02.749600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:02.753950 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:47:02.754505 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:47:02.756038 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:47:02.765390 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:02.768890 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:47:02.769388 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:47:02.777422 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:02.779200 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:47:02.781750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11375923-ed70-4e43-a41e-5860bffc1e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ec8f18140>]}
[0m10:47:02.782742 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.09s]
[0m10:47:02.783663 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:47:02.786597 [debug] [MainThread]: Using duckdb connection "master"
[0m10:47:02.787670 [debug] [MainThread]: On master: BEGIN
[0m10:47:02.788409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:02.790018 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:47:02.790414 [debug] [MainThread]: On master: COMMIT
[0m10:47:02.790731 [debug] [MainThread]: Using duckdb connection "master"
[0m10:47:02.791011 [debug] [MainThread]: On master: COMMIT
[0m10:47:02.791889 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:47:02.792329 [debug] [MainThread]: On master: Close
[0m10:47:02.793013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:02.793358 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:47:02.793841 [info ] [MainThread]: 
[0m10:47:02.794286 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m10:47:02.797278 [debug] [MainThread]: Command end result
[0m10:47:02.824462 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:47:02.826778 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:47:02.834350 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:47:02.834933 [info ] [MainThread]: 
[0m10:47:02.835413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:47:02.835794 [info ] [MainThread]: 
[0m10:47:02.836263 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:47:02.839088 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.1129797, "process_in_blocks": "232", "process_kernel_time": 0.680837, "process_mem_max_rss": "176848", "process_out_blocks": "4664", "process_user_time": 5.357215}
[0m10:47:02.839779 [debug] [MainThread]: Command `dbt build` succeeded at 10:47:02.839627 after 3.11 seconds
[0m10:47:02.840297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789efb5739b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789efafdef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789ecb30f860>]}
[0m10:47:02.840704 [debug] [MainThread]: Flushing usage events
[0m10:47:03.430877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:00.783582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec20304e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec202ce7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2024ccd40>]}


============================== 10:58:00.789148 | 1f510b0b-1ca4-4ed7-862f-811c8d08f31c ==============================
[0m10:58:00.789148 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:58:00.789862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt build', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'quiet': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True'}
[0m10:58:01.201122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2023475f0>]}
[0m10:58:01.319012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec202ce7110>]}
[0m10:58:01.322574 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:58:01.426729 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:58:01.631404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:58:01.632361 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m10:58:02.175096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1e52f3cb0>]}
[0m10:58:02.252920 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:58:02.256766 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:58:02.392976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1e6deb710>]}
[0m10:58:02.393832 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m10:58:02.397628 [info ] [MainThread]: 
[0m10:58:02.398217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:02.398610 [info ] [MainThread]: 
[0m10:58:02.399670 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:58:02.407247 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m10:58:02.460033 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:58:02.461186 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:58:02.461574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:02.516673 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m10:58:02.518547 [debug] [ThreadPool]: On list_analytics: Close
[0m10:58:02.521220 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:58:02.521742 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:58:02.522621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:02.525347 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:58:02.527002 [debug] [ThreadPool]: On list_analytics: Close
[0m10:58:02.529768 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m10:58:02.530384 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m10:58:02.530794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:02.532951 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:58:02.534503 [debug] [ThreadPool]: On list_analytics: Close
[0m10:58:02.535640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m10:58:02.536209 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m10:58:02.544616 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:58:02.545176 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:58:02.545529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:02.547156 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:58:02.549254 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:58:02.549698 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m10:58:02.550857 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:58:02.551302 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:58:02.551610 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m10:58:02.552372 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:02.553324 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:58:02.553693 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m10:58:02.554031 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m10:58:02.555686 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:58:02.556093 [debug] [ThreadPool]: On create_analytics_core: Close
[0m10:58:02.556928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m10:58:02.557456 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m10:58:02.559417 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:58:02.559926 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:58:02.560274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:02.561745 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:58:02.563245 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:58:02.563606 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m10:58:02.564803 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:58:02.565157 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:58:02.565436 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m10:58:02.566469 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:58:02.567438 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:58:02.567758 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m10:58:02.568015 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m10:58:02.568831 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:02.569331 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m10:58:02.570185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m10:58:02.570884 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m10:58:02.573393 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:58:02.573897 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m10:58:02.574312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:02.576271 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:58:02.577874 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:58:02.578316 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m10:58:02.579401 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:58:02.580164 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:58:02.580513 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m10:58:02.581213 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:02.582200 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:58:02.582589 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m10:58:02.582866 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m10:58:02.583788 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:58:02.584311 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m10:58:02.588488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m10:58:02.596404 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:58:02.597159 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m10:58:02.597468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:02.599492 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:58:02.600137 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m10:58:02.600527 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m10:58:02.619118 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:58:02.620809 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m10:58:02.623237 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m10:58:02.623782 [debug] [ThreadPool]: On list_analytics_core: Close
[0m10:58:02.624842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m10:58:02.629318 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:58:02.630570 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:58:02.631407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:02.633488 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:58:02.634183 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m10:58:02.634717 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m10:58:02.640614 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:58:02.642301 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:58:02.643235 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m10:58:02.643545 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:58:02.644336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m10:58:02.646391 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:58:02.646847 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m10:58:02.647200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:02.649137 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:58:02.649542 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m10:58:02.649867 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m10:58:02.656170 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:58:02.658000 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m10:58:02.659029 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m10:58:02.659356 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m10:58:02.661816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1e52d6000>]}
[0m10:58:02.662511 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:02.662856 [debug] [MainThread]: On master: BEGIN
[0m10:58:02.663131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:02.664085 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:58:02.664463 [debug] [MainThread]: On master: COMMIT
[0m10:58:02.664763 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:02.665028 [debug] [MainThread]: On master: COMMIT
[0m10:58:02.665795 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:58:02.666293 [debug] [MainThread]: On master: Close
[0m10:58:02.677481 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m10:58:02.678507 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m10:58:02.679645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_fixtures)
[0m10:58:02.680675 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m10:58:02.690278 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m10:58:02.691585 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m10:58:02.729870 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m10:58:02.730833 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:58:02.731275 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m10:58:02.731609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:02.732765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.733186 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:58:02.733578 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m10:58:02.740032 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:02.746741 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:58:02.747280 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:58:02.749479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.751731 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:58:02.752564 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m10:58:02.758578 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:58:02.768658 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:58:02.769436 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m10:58:02.772019 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:02.778482 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:58:02.779537 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m10:58:02.784299 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:02.815988 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:58:02.817100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:58:02.817623 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m10:58:02.831113 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:58:02.841907 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m10:58:02.842545 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m10:58:02.849740 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:02.853230 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m10:58:02.856831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec204c0e9f0>]}
[0m10:58:02.858107 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.18s]
[0m10:58:02.859170 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m10:58:02.859707 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m10:58:02.860389 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m10:58:02.861113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m10:58:02.861583 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m10:58:02.865121 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.867334 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m10:58:02.872516 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.873446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.873896 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m10:58:02.874290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:02.875951 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:02.876391 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.876786 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m10:58:02.879910 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:02.881320 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.882079 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:58:02.884062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.885598 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.886056 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m10:58:02.887811 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.891592 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.892189 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m10:58:02.893469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.896661 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.897084 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m10:58:02.898500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.900161 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:58:02.900600 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.900946 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m10:58:02.907804 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:02.910549 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m10:58:02.911028 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m10:58:02.919176 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:58:02.921057 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m10:58:02.922000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec204c0e9f0>]}
[0m10:58:02.922924 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.06s]
[0m10:58:02.923627 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m10:58:02.924085 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m10:58:02.924637 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m10:58:02.925765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m10:58:02.928155 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m10:58:02.932147 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m10:58:02.933424 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m10:58:02.937239 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m10:58:02.938782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:58:02.940179 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m10:58:02.940785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:02.942622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.943060 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:58:02.943829 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m10:58:02.961807 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:58:02.963377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:58:02.963982 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:58:02.965595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.967300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:58:02.967722 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m10:58:02.969863 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:02.973304 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:58:02.973866 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m10:58:02.975213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.980914 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:58:02.981461 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m10:58:02.983329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:02.985679 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:58:02.986382 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:58:02.986733 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m10:58:02.996734 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:58:03.000056 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m10:58:03.000585 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m10:58:03.008876 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:58:03.010812 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m10:58:03.012196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a407f200>]}
[0m10:58:03.013148 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.09s]
[0m10:58:03.013827 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m10:58:03.014310 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m10:58:03.015053 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m10:58:03.016393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m10:58:03.017235 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m10:58:03.021334 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m10:58:03.022341 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m10:58:03.026198 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m10:58:03.027588 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:58:03.028331 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m10:58:03.030157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.032151 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.032689 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:58:03.033074 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m10:58:03.039099 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.040832 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:58:03.041687 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:58:03.047946 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:58:03.054175 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:58:03.054914 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m10:58:03.057465 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.065756 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:58:03.066842 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m10:58:03.070210 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.074241 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:58:03.074839 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m10:58:03.076758 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.078987 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:58:03.079709 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:58:03.080119 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m10:58:03.087747 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:58:03.091404 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m10:58:03.091896 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m10:58:03.098816 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.100642 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m10:58:03.101518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a4113320>]}
[0m10:58:03.102351 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.09s]
[0m10:58:03.103058 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m10:58:03.103514 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m10:58:03.104282 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m10:58:03.105763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m10:58:03.106967 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m10:58:03.110965 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m10:58:03.113132 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m10:58:03.116667 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m10:58:03.117444 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:58:03.117894 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m10:58:03.118508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.119834 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.120260 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:58:03.120631 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m10:58:03.124386 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:03.125780 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:58:03.126305 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:58:03.128352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.130128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:58:03.130615 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m10:58:03.133166 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.137031 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:58:03.137533 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m10:58:03.139059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.141931 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:58:03.142436 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m10:58:03.143474 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.145037 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:58:03.145546 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:58:03.145999 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m10:58:03.153568 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:58:03.156674 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m10:58:03.157172 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m10:58:03.163655 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.165440 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m10:58:03.167117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a407d970>]}
[0m10:58:03.168202 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.06s]
[0m10:58:03.168890 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m10:58:03.169373 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m10:58:03.169927 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m10:58:03.170784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m10:58:03.171589 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m10:58:03.175633 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m10:58:03.176809 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m10:58:03.183283 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m10:58:03.184892 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:58:03.185817 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m10:58:03.186224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.187933 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.188510 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:58:03.188908 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m10:58:03.195611 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.197111 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:58:03.197711 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:58:03.199395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.201703 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:58:03.202511 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m10:58:03.205575 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.212712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:58:03.213276 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m10:58:03.214824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.218646 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:58:03.219133 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m10:58:03.220601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.222695 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:58:03.223155 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:58:03.223695 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m10:58:03.231118 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:58:03.235861 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m10:58:03.238065 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m10:58:03.246369 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:58:03.248784 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m10:58:03.249719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a412bb00>]}
[0m10:58:03.250566 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.08s]
[0m10:58:03.251391 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m10:58:03.252192 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m10:58:03.253319 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m10:58:03.254916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m10:58:03.255716 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m10:58:03.259039 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m10:58:03.260650 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m10:58:03.263614 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m10:58:03.264351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:58:03.264765 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m10:58:03.265404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.269332 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:03.270835 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:58:03.271445 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m10:58:03.276477 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:58:03.278057 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:58:03.278538 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:58:03.279975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.281551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:58:03.281992 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m10:58:03.285779 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:03.291589 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:58:03.292147 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m10:58:03.293400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.296428 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:58:03.296880 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m10:58:03.298294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.300403 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:58:03.300870 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:58:03.301265 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m10:58:03.310781 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:58:03.313935 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m10:58:03.314500 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m10:58:03.323089 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:58:03.325682 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m10:58:03.327171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a407cdd0>]}
[0m10:58:03.328395 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.07s]
[0m10:58:03.329488 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m10:58:03.330379 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m10:58:03.332090 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m10:58:03.332908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m10:58:03.333377 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m10:58:03.336328 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m10:58:03.337031 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m10:58:03.341543 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m10:58:03.342404 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:58:03.342806 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m10:58:03.343122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.344162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.344530 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:58:03.344849 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m10:58:03.346864 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.348066 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:58:03.348526 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:58:03.349667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.352296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:58:03.353126 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m10:58:03.356810 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:03.360533 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:58:03.361012 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m10:58:03.362052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.366541 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:58:03.367023 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m10:58:03.368221 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.369865 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:58:03.370395 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:58:03.370748 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m10:58:03.379612 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:58:03.382331 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m10:58:03.382787 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m10:58:03.389674 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.391873 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m10:58:03.393250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a4104470>]}
[0m10:58:03.394279 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.06s]
[0m10:58:03.394994 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m10:58:03.395454 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m10:58:03.396900 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m10:58:03.397721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m10:58:03.398369 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m10:58:03.401418 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m10:58:03.402332 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m10:58:03.405749 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m10:58:03.406615 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:58:03.407121 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m10:58:03.407503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.408598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.409025 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:58:03.409386 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m10:58:03.412762 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:03.414294 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:58:03.414753 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:58:03.415991 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.418548 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:58:03.419300 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m10:58:03.422892 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:03.427024 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:58:03.427546 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m10:58:03.429151 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.432008 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:58:03.432421 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m10:58:03.433692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.435299 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:58:03.435719 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:58:03.436096 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m10:58:03.443818 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:58:03.446945 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m10:58:03.447378 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m10:58:03.454400 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.456283 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m10:58:03.457443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1e473ec00>]}
[0m10:58:03.458575 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.06s]
[0m10:58:03.459816 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m10:58:03.460526 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m10:58:03.461286 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m10:58:03.461997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m10:58:03.463603 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m10:58:03.466686 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m10:58:03.467380 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m10:58:03.470490 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m10:58:03.471349 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:58:03.471774 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m10:58:03.472112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.473332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.474045 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:58:03.474607 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m10:58:03.479221 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:58:03.480741 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:58:03.481286 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:58:03.482936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.484602 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:58:03.485023 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m10:58:03.486468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.490610 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:58:03.491357 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m10:58:03.493550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.497521 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:58:03.498071 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m10:58:03.499283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.500883 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:58:03.501335 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:58:03.501748 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m10:58:03.509873 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:58:03.515924 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m10:58:03.516438 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m10:58:03.523495 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.525612 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m10:58:03.526730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a414af00>]}
[0m10:58:03.527519 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.06s]
[0m10:58:03.528203 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m10:58:03.529126 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m10:58:03.529746 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m10:58:03.530621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m10:58:03.531498 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m10:58:03.535124 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.536941 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m10:58:03.541937 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.542926 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.543448 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m10:58:03.543880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.546419 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.547130 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.547536 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m10:58:03.550004 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.552008 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.552505 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:58:03.554595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.556505 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.556963 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m10:58:03.559552 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.564407 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.564964 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m10:58:03.566423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.569413 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.569841 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m10:58:03.571102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.572970 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:58:03.573578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.573962 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m10:58:03.583025 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:58:03.586314 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m10:58:03.586809 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m10:58:03.594097 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.595968 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m10:58:03.597089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a414bfb0>]}
[0m10:58:03.597899 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.07s]
[0m10:58:03.598657 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m10:58:03.599149 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m10:58:03.599734 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m10:58:03.600443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m10:58:03.600872 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m10:58:03.604596 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m10:58:03.605469 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m10:58:03.609760 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m10:58:03.611085 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:58:03.611688 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m10:58:03.612041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.613496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.614123 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:58:03.614873 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),


        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,

    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m10:58:03.661894 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m10:58:03.663771 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:58:03.664265 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:58:03.666421 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.668242 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:58:03.668674 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m10:58:03.670514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.673519 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:58:03.674204 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m10:58:03.675931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.679589 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:58:03.680063 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m10:58:03.681393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.683144 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:58:03.683630 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:58:03.683972 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m10:58:03.692312 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:58:03.697531 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m10:58:03.698388 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m10:58:03.710157 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:58:03.712518 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m10:58:03.717281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a4170350>]}
[0m10:58:03.718625 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.12s]
[0m10:58:03.719681 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m10:58:03.721026 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m10:58:03.723055 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m10:58:03.724432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m10:58:03.724954 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m10:58:03.730032 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m10:58:03.731761 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m10:58:03.735044 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m10:58:03.735995 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:58:03.736407 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m10:58:03.736864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.738373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.738788 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:58:03.739366 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m10:58:03.748638 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:58:03.750512 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:58:03.751075 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:58:03.752622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.754167 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:58:03.754650 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m10:58:03.756408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.760285 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:58:03.760709 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m10:58:03.763459 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.766834 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:58:03.767341 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m10:58:03.768503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.770076 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:58:03.770553 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:58:03.770896 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m10:58:03.778872 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:58:03.781682 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m10:58:03.782210 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m10:58:03.789101 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.791626 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m10:58:03.793066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1e47113a0>]}
[0m10:58:03.793856 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.07s]
[0m10:58:03.794971 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m10:58:03.797833 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m10:58:03.800767 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m10:58:03.803079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m10:58:03.804261 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m10:58:03.808179 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m10:58:03.811621 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m10:58:03.816565 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m10:58:03.817506 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:58:03.817925 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m10:58:03.818582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:03.821480 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:58:03.822052 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:58:03.822548 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

join_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_players
)

select * from select_cols
    );
  
  
[0m10:58:03.837643 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:58:03.839456 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:58:03.840079 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:58:03.842288 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:03.844581 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:58:03.845031 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m10:58:03.846787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.851261 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:58:03.852037 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m10:58:03.853886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.857004 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:58:03.857455 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m10:58:03.858570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:03.860661 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:58:03.861103 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:58:03.861442 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m10:58:03.870936 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:58:03.873606 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m10:58:03.874068 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m10:58:03.881142 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:03.882992 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m10:58:03.884851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f510b0b-1ca4-4ed7-862f-811c8d08f31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a407cfe0>]}
[0m10:58:03.885588 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.08s]
[0m10:58:03.886271 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m10:58:03.889258 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:03.889777 [debug] [MainThread]: On master: BEGIN
[0m10:58:03.890497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:03.892385 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:58:03.892796 [debug] [MainThread]: On master: COMMIT
[0m10:58:03.893130 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:03.893420 [debug] [MainThread]: On master: COMMIT
[0m10:58:03.894328 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:58:03.894700 [debug] [MainThread]: On master: Close
[0m10:58:03.895243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:03.895545 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m10:58:03.895974 [info ] [MainThread]: 
[0m10:58:03.896421 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m10:58:03.898669 [debug] [MainThread]: Command end result
[0m10:58:03.920710 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m10:58:03.923607 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m10:58:03.930607 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m10:58:03.931040 [info ] [MainThread]: 
[0m10:58:03.931521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:58:03.931904 [info ] [MainThread]: 
[0m10:58:03.932440 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m10:58:03.935943 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.2496333, "process_in_blocks": "109616", "process_kernel_time": 0.741742, "process_mem_max_rss": "176672", "process_out_blocks": "4672", "process_user_time": 5.126523}
[0m10:58:03.936566 [debug] [MainThread]: Command `dbt build` succeeded at 10:58:03.936442 after 3.25 seconds
[0m10:58:03.936961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec202b560f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec1a412b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec203261f40>]}
[0m10:58:03.937402 [debug] [MainThread]: Flushing usage events
[0m10:58:04.587573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:23.355467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77054cc2baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77054a4a3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77054a61f050>]}


============================== 11:32:23.360468 | 167be95e-bc54-4c09-9cca-a5aba0826332 ==============================
[0m11:32:23.360468 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:32:23.360909 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'empty': 'False', 'log_format': 'default', 'printer_width': '80'}
[0m11:32:23.659669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770549d4e2a0>]}
[0m11:32:23.721872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77054a515e20>]}
[0m11:32:23.725820 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:32:23.781316 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:32:23.894007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:32:23.894633 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m11:32:23.894947 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/intermediate/int_players.sql
[0m11:32:24.181460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77053fca1370>]}
[0m11:32:24.225296 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:32:24.227612 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:32:24.304951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77053fbb25a0>]}
[0m11:32:24.305360 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m11:32:24.307339 [info ] [MainThread]: 
[0m11:32:24.307730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:32:24.308001 [info ] [MainThread]: 
[0m11:32:24.308409 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:32:24.312711 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:32:24.348051 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:32:24.348423 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:32:24.348666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:24.393463 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m11:32:24.394837 [debug] [ThreadPool]: On list_analytics: Close
[0m11:32:24.396547 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:32:24.396833 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:32:24.397081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:24.398173 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:32:24.398991 [debug] [ThreadPool]: On list_analytics: Close
[0m11:32:24.400403 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:32:24.400676 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:32:24.400929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:24.401908 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:32:24.402734 [debug] [ThreadPool]: On list_analytics: Close
[0m11:32:24.403407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m11:32:24.403738 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:32:24.408355 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:32:24.408618 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:32:24.408797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:24.409810 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:32:24.411063 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:32:24.411346 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:32:24.411890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.412109 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:32:24.412280 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:32:24.412961 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.413567 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:32:24.413814 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:32:24.414072 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:32:24.414670 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.414902 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:32:24.415412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m11:32:24.415763 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:32:24.417134 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:32:24.417367 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:32:24.417555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:24.418642 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:32:24.419541 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:32:24.419775 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:32:24.420226 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.420441 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:32:24.420620 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:32:24.421058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.421636 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:32:24.421856 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:32:24.422111 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:32:24.422518 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.422724 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:32:24.423189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m11:32:24.423526 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:32:24.424800 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:32:24.425031 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:32:24.425214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:24.426375 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:32:24.427331 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:32:24.427557 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:32:24.428060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.428268 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:32:24.428435 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:32:24.428901 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.429493 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:32:24.429727 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:32:24.429954 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:32:24.430420 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.430633 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:32:24.432311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m11:32:24.436322 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:32:24.436602 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:32:24.436791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:24.437433 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:32:24.437655 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:32:24.437831 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:32:24.448603 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:32:24.449779 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:32:24.451219 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:32:24.451473 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:32:24.452027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m11:32:24.454659 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:32:24.454928 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:32:24.455134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:24.455742 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:32:24.455967 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:32:24.456154 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:32:24.459004 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:32:24.459978 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:32:24.460575 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:32:24.460798 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:32:24.461290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m11:32:24.462986 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:32:24.463197 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:32:24.463363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:24.463883 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:32:24.464073 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:32:24.464241 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:32:24.466782 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:32:24.467757 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:32:24.468318 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:32:24.468500 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:32:24.469963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77054c5b2480>]}
[0m11:32:24.470315 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:24.470520 [debug] [MainThread]: On master: BEGIN
[0m11:32:24.470685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:24.471271 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:32:24.471478 [debug] [MainThread]: On master: COMMIT
[0m11:32:24.471661 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:24.471849 [debug] [MainThread]: On master: COMMIT
[0m11:32:24.472280 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:32:24.472486 [debug] [MainThread]: On master: Close
[0m11:32:24.476288 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m11:32:24.476788 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m11:32:24.477421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m11:32:24.477681 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m11:32:24.483123 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m11:32:24.484391 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m11:32:24.506795 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m11:32:24.507408 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:32:24.507673 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m11:32:24.507876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.508641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.508886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:32:24.509077 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m11:32:24.515030 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:24.518845 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:32:24.519146 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:32:24.520265 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.521717 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:32:24.522389 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:32:24.525244 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:32:24.529909 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:32:24.530253 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m11:32:24.531109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.533008 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:32:24.533274 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m11:32:24.533941 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.544047 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:32:24.544396 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:32:24.544611 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:32:24.553242 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:32:24.557389 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:32:24.557720 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m11:32:24.563805 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:24.566153 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m11:32:24.568117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77054c4eaae0>]}
[0m11:32:24.568676 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m11:32:24.569115 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m11:32:24.569412 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:32:24.569771 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:32:24.570256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m11:32:24.570546 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:32:24.572653 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.573899 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:32:24.577050 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.577565 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.577818 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:32:24.578058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.578867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.579080 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.579266 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:32:24.582164 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:32:24.583177 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.583432 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:32:24.584354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.585311 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.585564 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:32:24.587039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.589016 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.589272 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:32:24.590042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.591789 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.592029 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:32:24.592605 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.593460 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:32:24.593688 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.593914 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:32:24.600483 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:24.602226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:32:24.602485 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:32:24.608467 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:24.610310 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:32:24.611161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77054ad2c410>]}
[0m11:32:24.611648 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m11:32:24.612103 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:32:24.612413 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:32:24.612865 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m11:32:24.613287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:32:24.613804 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:32:24.616107 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:32:24.616587 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:32:24.618686 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:32:24.619202 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:32:24.619455 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:32:24.619663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.620387 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.620632 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:32:24.620901 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:32:24.629707 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:32:24.630785 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:32:24.631080 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:32:24.631933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.632937 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:32:24.633205 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:32:24.634252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.636292 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:32:24.636530 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:32:24.637385 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.639696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:32:24.640015 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:32:24.640907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.641878 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:32:24.642224 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:32:24.642424 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:32:24.649060 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:24.650991 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:32:24.651274 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:32:24.656572 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:32:24.658180 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:32:24.658872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704dbf451f0>]}
[0m11:32:24.659312 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m11:32:24.659743 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:32:24.660053 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:32:24.660377 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m11:32:24.660767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:32:24.661146 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:32:24.663175 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:32:24.663683 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:32:24.665818 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:32:24.666554 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:32:24.666848 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:32:24.667087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.667858 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.668100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:32:24.668301 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:32:24.670570 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:32:24.671379 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:32:24.671644 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:32:24.672384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.674954 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:32:24.675365 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:32:24.677078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.679206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:32:24.679470 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:32:24.680433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.682205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:32:24.682450 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:32:24.683128 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.683997 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:32:24.684253 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:32:24.684445 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:32:24.691637 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:24.693656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:32:24.694009 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:32:24.700549 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:24.702305 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:32:24.702936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704d42b1e50>]}
[0m11:32:24.703385 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m11:32:24.703824 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:32:24.704143 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:32:24.704522 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m11:32:24.705264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:32:24.705518 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:32:24.707378 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:32:24.707926 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:32:24.710061 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:32:24.710583 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:32:24.710833 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:32:24.711049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.711780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.712004 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:32:24.712196 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:32:24.715506 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:32:24.716474 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:32:24.716742 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:32:24.717785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.718733 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:32:24.718968 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:32:24.720049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.721996 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:32:24.722267 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:32:24.722835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.724624 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:32:24.724894 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:32:24.725838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.727018 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:32:24.727331 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:32:24.727524 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:32:24.734334 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:24.736080 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:32:24.736344 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:32:24.743121 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:24.744810 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:32:24.746378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704dbfcc0b0>]}
[0m11:32:24.746902 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:32:24.747303 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:32:24.747636 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:32:24.748010 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m11:32:24.749167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:32:24.749508 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:32:24.751616 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:32:24.752143 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:32:24.754191 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:32:24.754636 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:32:24.754864 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:32:24.755102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.755903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.756157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:32:24.756354 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:32:24.759784 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:32:24.761014 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:32:24.761274 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:32:24.762106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.763188 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:32:24.763435 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:32:24.764858 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.768174 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:32:24.768447 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:32:24.769347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.771237 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:32:24.771481 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:32:24.772075 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.772964 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:32:24.773232 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:32:24.773439 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:32:24.780644 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:24.782534 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:32:24.782826 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:32:24.789246 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:24.790431 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:32:24.791025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704d4303050>]}
[0m11:32:24.791451 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m11:32:24.791867 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:32:24.792192 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m11:32:24.792607 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m11:32:24.793104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m11:32:24.793446 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m11:32:24.795539 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m11:32:24.796476 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m11:32:24.798654 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m11:32:24.799144 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:32:24.799402 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m11:32:24.799604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.800700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.801170 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:32:24.801621 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m11:32:24.805578 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:32:24.806603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:32:24.806927 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:32:24.807786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.808601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:32:24.808843 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:32:24.809843 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.812119 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:32:24.812372 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m11:32:24.813310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.815527 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:32:24.815790 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m11:32:24.816376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.817186 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:32:24.817415 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:32:24.817601 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:32:24.825265 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:24.827394 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:32:24.827727 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m11:32:24.834780 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:24.836573 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m11:32:24.837398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704dbf2f170>]}
[0m11:32:24.838115 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m11:32:24.838817 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m11:32:24.839136 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:32:24.839491 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:32:24.840393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m11:32:24.840681 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:32:24.842658 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:32:24.843183 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:32:24.845458 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:32:24.846100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:32:24.846440 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:32:24.846646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.847435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.847660 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:32:24.847842 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:32:24.849112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.850396 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:32:24.850906 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:32:24.852288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.853125 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:32:24.853352 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:32:24.854545 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.857551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:32:24.858158 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:32:24.859154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.863300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:32:24.863668 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:32:24.864684 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.865605 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:32:24.865845 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:32:24.866073 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:32:24.873270 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:24.875126 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:32:24.875431 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:32:24.881288 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:32:24.882891 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:32:24.883656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704d4276cf0>]}
[0m11:32:24.884124 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:32:24.884539 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:32:24.884866 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:32:24.885203 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:32:24.885587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m11:32:24.886188 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:32:24.888175 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:32:24.888618 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:32:24.890638 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:32:24.891165 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:32:24.891412 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:32:24.891613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.892364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.892602 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:32:24.892878 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:32:24.894079 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.894893 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:32:24.895117 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:32:24.895850 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.897192 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:32:24.897451 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:32:24.898985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.901006 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:32:24.901262 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:32:24.902438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.904094 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:32:24.904335 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:32:24.905017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.906084 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:32:24.906441 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:32:24.906635 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:32:24.913498 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:24.915196 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:32:24.915475 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:32:24.921525 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:24.922817 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:32:24.923399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704dbfcf230>]}
[0m11:32:24.923834 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m11:32:24.924225 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:32:24.924503 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:32:24.924850 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m11:32:24.925224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:32:24.925513 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:32:24.927359 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:32:24.927978 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:32:24.929860 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:32:24.930516 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:32:24.930878 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:32:24.931135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.931917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.932130 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:32:24.932307 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:32:24.933973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.934813 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:32:24.935051 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:32:24.935764 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.936612 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:32:24.936836 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:32:24.938104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.940570 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:32:24.940955 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:32:24.941926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.944158 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:32:24.944452 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:32:24.945491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.946940 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:32:24.947244 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:32:24.947484 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:32:24.954558 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:24.957581 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:32:24.957859 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:32:24.965399 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:24.967043 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:32:24.967645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704d4328d10>]}
[0m11:32:24.968105 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m11:32:24.968529 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:32:24.968836 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m11:32:24.969187 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m11:32:24.970164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m11:32:24.970443 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m11:32:24.972287 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m11:32:24.972745 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m11:32:24.974851 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m11:32:24.975286 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:32:24.975526 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m11:32:24.975722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:24.976469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.976676 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:32:24.976871 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m11:32:24.978074 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.978878 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:32:24.979118 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:32:24.979949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.980949 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:32:24.981214 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:32:24.982815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.985127 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:32:24.985401 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m11:32:24.986444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:24.989122 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:32:24.989408 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m11:32:24.990133 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:24.991056 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:32:24.991286 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:32:24.991473 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:32:24.998546 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:32:25.000366 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:32:25.000630 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m11:32:25.007479 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:25.009105 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m11:32:25.010392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704d429cd70>]}
[0m11:32:25.010877 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m11:32:25.011331 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m11:32:25.011680 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:32:25.012032 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m11:32:25.012442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m11:32:25.012733 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:32:25.015200 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:32:25.016195 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:32:25.018587 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:32:25.019122 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:32:25.019377 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:32:25.019575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:25.020349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.020579 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:32:25.020904 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m11:32:25.051359 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m11:32:25.052402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:32:25.052724 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:32:25.053650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.054787 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:32:25.055053 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:32:25.056182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.058254 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:32:25.058517 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:32:25.059300 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:25.061016 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:32:25.061273 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:32:25.061912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:32:25.062846 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:32:25.063091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:32:25.063293 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:32:25.071800 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:32:25.074643 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:32:25.074939 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:32:25.081258 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:25.082748 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:32:25.084047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704d43136e0>]}
[0m11:32:25.084469 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.07s]
[0m11:32:25.084935 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:32:25.085258 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m11:32:25.085587 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m11:32:25.085993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m11:32:25.086310 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m11:32:25.088502 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m11:32:25.089505 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m11:32:25.091610 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m11:32:25.092056 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:32:25.092289 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m11:32:25.092491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:25.093256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.093478 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:32:25.093696 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m11:32:25.099245 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:32:25.100891 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:32:25.101242 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:32:25.102607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.103648 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:32:25.103904 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:32:25.105182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.107743 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:32:25.108029 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m11:32:25.108994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.111228 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:32:25.111481 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m11:32:25.112307 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.113693 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:32:25.114204 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:32:25.114603 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:32:25.123615 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m11:32:25.125295 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:32:25.125558 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m11:32:25.131622 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:25.133248 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m11:32:25.134930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704dbfd1100>]}
[0m11:32:25.135447 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.05s]
[0m11:32:25.135913 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m11:32:25.136213 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:32:25.136581 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m11:32:25.137192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m11:32:25.137466 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:32:25.139864 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:32:25.141148 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:32:25.143190 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:32:25.143632 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:32:25.143875 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:32:25.144060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:25.144813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.145021 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:32:25.145259 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek in ((select * from gameweeks), (select * from gameweeks)+1, (select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon) over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.defending_biases,
        aggregate_fixtures.attacking_biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:32:25.164833 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m11:32:25.165910 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:32:25.166282 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:32:25.167086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.167994 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:32:25.168246 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:32:25.169143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.171430 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:32:25.171714 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:32:25.172496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.174313 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:32:25.174568 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:32:25.175429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:25.176982 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:32:25.177542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:32:25.177971 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:32:25.187005 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:32:25.189075 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:32:25.189400 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:32:25.196110 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:32:25.197292 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:32:25.199025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167be95e-bc54-4c09-9cca-a5aba0826332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704d429d7f0>]}
[0m11:32:25.199464 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.06s]
[0m11:32:25.199904 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:32:25.202218 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:25.202578 [debug] [MainThread]: On master: BEGIN
[0m11:32:25.202769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:25.203720 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:32:25.204271 [debug] [MainThread]: On master: COMMIT
[0m11:32:25.204530 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:25.204716 [debug] [MainThread]: On master: COMMIT
[0m11:32:25.205217 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:32:25.205428 [debug] [MainThread]: On master: Close
[0m11:32:25.205780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:25.206019 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:32:25.206317 [info ] [MainThread]: 
[0m11:32:25.206580 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m11:32:25.208057 [debug] [MainThread]: Command end result
[0m11:32:25.221916 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:32:25.223606 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:32:25.227908 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:32:25.228166 [info ] [MainThread]: 
[0m11:32:25.228447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:32:25.228715 [info ] [MainThread]: 
[0m11:32:25.228986 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m11:32:25.232058 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.929273, "process_in_blocks": "183808", "process_kernel_time": 0.456751, "process_mem_max_rss": "179428", "process_out_blocks": "4704", "process_user_time": 2.740507}
[0m11:32:25.232519 [debug] [MainThread]: Command `dbt build` succeeded at 11:32:25.232426 after 1.93 seconds
[0m11:32:25.232809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77054a0b4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77054a582540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77053fc406b0>]}
[0m11:32:25.233090 [debug] [MainThread]: Flushing usage events
[0m11:32:25.801608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:29.177480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4607d3d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4605feecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4605fefef0>]}


============================== 11:33:29.181454 | ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f ==============================
[0m11:33:29.181454 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:33:29.181926 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'fail_fast': 'False', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt build', 'profiles_dir': '/home/robgriffin247/fpl', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'use_colors': 'True'}
[0m11:33:29.404972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45fbb88fe0>]}
[0m11:33:29.466565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4605591730>]}
[0m11:33:29.470146 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:33:29.529896 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:33:29.634690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:29.635281 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m11:33:29.913682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f85efce0>]}
[0m11:33:29.955787 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:33:29.957596 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:33:30.038385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45fb5fc320>]}
[0m11:33:30.038786 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m11:33:30.040746 [info ] [MainThread]: 
[0m11:33:30.041214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:33:30.041478 [info ] [MainThread]: 
[0m11:33:30.041914 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:30.046475 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:33:30.077806 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:33:30.078207 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:33:30.078429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:30.113357 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m11:33:30.114545 [debug] [ThreadPool]: On list_analytics: Close
[0m11:33:30.116204 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:33:30.116498 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:33:30.116813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:30.117823 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:30.118622 [debug] [ThreadPool]: On list_analytics: Close
[0m11:33:30.120022 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:33:30.120294 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:33:30.120534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:30.121531 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:30.122375 [debug] [ThreadPool]: On list_analytics: Close
[0m11:33:30.123009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m11:33:30.123343 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:33:30.127832 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:33:30.128082 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:33:30.128267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:30.129199 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:30.130162 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:33:30.130379 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:33:30.130942 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:30.131146 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:33:30.131310 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:33:30.131759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:30.132334 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:33:30.132541 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:33:30.132713 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:33:30.133772 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:30.134013 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:33:30.134487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m11:33:30.134814 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:33:30.135884 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:33:30.136133 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:33:30.136357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:30.137231 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:30.138041 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:33:30.138239 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:33:30.138622 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:30.138846 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:33:30.139022 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:33:30.139444 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:30.139996 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:33:30.140213 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:33:30.140376 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:33:30.140742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:30.140944 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:33:30.141432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m11:33:30.141761 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:33:30.142772 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:33:30.143011 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:33:30.143227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:30.144159 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:30.144996 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:33:30.145280 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:33:30.145733 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:30.145952 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:33:30.146125 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:33:30.146564 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:30.147123 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:33:30.147332 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:33:30.147511 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:33:30.147927 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:30.148134 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:33:30.149610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_core)
[0m11:33:30.153398 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:33:30.153639 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:33:30.153843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:30.154413 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:30.154622 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:33:30.154796 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:33:30.164210 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m11:33:30.165313 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:33:30.166614 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:33:30.166876 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:33:30.167401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m11:33:30.169515 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:33:30.169799 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:33:30.170486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:30.171065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:30.171271 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:33:30.171449 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:33:30.174884 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:33:30.176244 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:33:30.177157 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:33:30.177544 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:33:30.178045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m11:33:30.179204 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:33:30.179457 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:33:30.180398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:30.180985 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:30.181201 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:33:30.181412 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:33:30.184543 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:33:30.185937 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:33:30.186565 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:33:30.186768 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:33:30.188294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4607fea210>]}
[0m11:33:30.188627 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:30.188806 [debug] [MainThread]: On master: BEGIN
[0m11:33:30.188961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:30.189557 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:33:30.189777 [debug] [MainThread]: On master: COMMIT
[0m11:33:30.189964 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:30.190169 [debug] [MainThread]: On master: COMMIT
[0m11:33:30.190570 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:30.190799 [debug] [MainThread]: On master: Close
[0m11:33:30.194409 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m11:33:30.194853 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m11:33:30.195433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_fixtures)
[0m11:33:30.195704 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m11:33:30.200884 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m11:33:30.201789 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m11:33:30.224110 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m11:33:30.224707 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:33:30.224981 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m11:33:30.225267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.225957 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.226192 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:33:30.226395 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m11:33:30.230943 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:33:30.234740 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:33:30.235021 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:33:30.235769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.236595 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:33:30.236820 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:33:30.240129 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:33:30.245018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:33:30.245350 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m11:33:30.247465 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:33:30.249547 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:33:30.249818 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m11:33:30.250356 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.260125 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:33:30.260382 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:33:30.260633 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:33:30.268058 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.271974 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:33:30.272293 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m11:33:30.277337 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:33:30.280119 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m11:33:30.282327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4608126930>]}
[0m11:33:30.282821 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m11:33:30.283261 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m11:33:30.283559 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:33:30.283895 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:33:30.284308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m11:33:30.284894 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:33:30.287655 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.288201 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:33:30.291206 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.291656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.291898 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:33:30.292099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.292833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.293063 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.293302 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:33:30.295410 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:33:30.296162 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.296396 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:33:30.297110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.297949 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.298179 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:33:30.299461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.302067 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.302326 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:33:30.302868 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.304514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.304737 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:33:30.305268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.306061 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:33:30.306294 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.306486 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:33:30.312114 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:33:30.314089 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:33:30.314387 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:33:30.319733 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:33:30.320821 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:33:30.321630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45fb6def30>]}
[0m11:33:30.322116 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m11:33:30.322532 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:33:30.322827 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:33:30.323154 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m11:33:30.323798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:33:30.324067 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:33:30.326069 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:33:30.326497 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:33:30.328381 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:33:30.328889 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:33:30.329190 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:33:30.329425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.330552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.330975 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:33:30.331286 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:33:30.339074 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.340058 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:33:30.340338 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:33:30.341130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.342040 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:33:30.342306 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:33:30.343156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.345172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:33:30.345503 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:33:30.346519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.348483 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:33:30.348747 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:33:30.349427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.350401 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:33:30.350655 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:33:30.350860 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:33:30.358471 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.360151 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:33:30.360411 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:33:30.366192 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:33:30.367568 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:33:30.368546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f83af4a0>]}
[0m11:33:30.369064 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m11:33:30.369519 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:33:30.369815 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:33:30.370209 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m11:33:30.370879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:33:30.371190 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:33:30.373271 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:33:30.373738 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:33:30.375754 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:33:30.376182 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:33:30.376433 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:33:30.376651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.377409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.377665 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:33:30.377878 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:33:30.380276 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:33:30.381278 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:33:30.381571 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:33:30.382645 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.385359 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:33:30.385691 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:33:30.387016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.389913 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:33:30.390332 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:33:30.391343 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.392916 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:33:30.393178 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:33:30.393838 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.394634 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:33:30.394879 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:33:30.395084 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:33:30.401876 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.403563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:33:30.403829 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:33:30.409927 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.411325 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:33:30.412112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f82d7830>]}
[0m11:33:30.412765 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m11:33:30.413423 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:33:30.413733 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:33:30.414072 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m11:33:30.414434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:33:30.414948 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:33:30.416850 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:33:30.417367 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:33:30.419309 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:33:30.419752 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:33:30.419999 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:33:30.420241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.420975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.421247 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:33:30.421468 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:33:30.423542 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:33:30.424331 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:33:30.424581 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:33:30.425286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.426170 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:33:30.426418 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:33:30.427654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.429742 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:33:30.430005 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:33:30.430542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.432446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:33:30.432725 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:33:30.433466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.434465 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:33:30.434719 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:33:30.434925 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:33:30.441182 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.442718 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:33:30.442976 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:33:30.449375 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.450563 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:33:30.451365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f80fa8a0>]}
[0m11:33:30.451829 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:33:30.452240 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:33:30.452528 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:33:30.452874 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m11:33:30.453268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:33:30.453542 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:33:30.455727 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:33:30.456166 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:33:30.458233 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:33:30.458665 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:33:30.458902 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:33:30.459096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.459820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.460073 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:33:30.460292 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:33:30.462785 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:33:30.463549 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:33:30.463782 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:33:30.464479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.465424 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:33:30.465710 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:33:30.467162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.470662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:33:30.470942 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:33:30.471780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.474113 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:33:30.474370 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:33:30.474928 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.475756 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:33:30.475985 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:33:30.476171 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:33:30.483386 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.485301 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:33:30.485587 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:33:30.491790 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.493367 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:33:30.493983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f81845f0>]}
[0m11:33:30.494413 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m11:33:30.494856 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:33:30.495170 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m11:33:30.495499 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m11:33:30.495882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m11:33:30.496161 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m11:33:30.498040 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m11:33:30.498981 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m11:33:30.501530 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m11:33:30.502234 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:33:30.502557 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m11:33:30.502802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.503566 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.503819 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:33:30.504060 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m11:33:30.507042 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:33:30.508284 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:33:30.508729 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:33:30.509798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.510676 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:33:30.510926 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:33:30.511994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.514494 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:33:30.514745 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m11:33:30.515553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.517868 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:33:30.518185 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m11:33:30.519296 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.520301 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:33:30.520555 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:33:30.520758 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:33:30.527513 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.529173 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:33:30.529439 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m11:33:30.535116 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:33:30.536536 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m11:33:30.537122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f81fbdd0>]}
[0m11:33:30.537673 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m11:33:30.538082 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m11:33:30.538400 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:33:30.538729 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:33:30.539116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m11:33:30.539405 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:33:30.541298 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:33:30.542036 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:33:30.544050 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:33:30.544481 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:33:30.544730 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:33:30.544931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.545992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.546407 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:33:30.546765 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:33:30.548084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.548894 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:33:30.549197 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:33:30.550095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.551046 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:33:30.551303 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:33:30.552886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.555313 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:33:30.555611 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:33:30.556272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.559166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:33:30.559436 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:33:30.560278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.561678 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:33:30.562138 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:33:30.562500 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:33:30.568824 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.570712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:33:30.570980 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:33:30.576844 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.578273 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:33:30.579016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f815cf80>]}
[0m11:33:30.579524 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:33:30.579944 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:33:30.580234 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:33:30.580576 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:33:30.581238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m11:33:30.581605 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:33:30.583458 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:33:30.584063 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:33:30.586092 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:33:30.586859 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:33:30.587132 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:33:30.587356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.588213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.588503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:33:30.588701 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:33:30.590137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.591277 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:33:30.591705 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:33:30.592810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.593778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:33:30.594048 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:33:30.595263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.597898 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:33:30.598188 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:33:30.599282 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.601814 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:33:30.602060 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:33:30.602740 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.603738 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:33:30.603998 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:33:30.604213 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:33:30.611309 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.612830 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:33:30.613067 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:33:30.620096 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.621400 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:33:30.621956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f810a240>]}
[0m11:33:30.622411 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m11:33:30.622822 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:33:30.623108 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:33:30.623449 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m11:33:30.623804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:33:30.624076 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:33:30.626027 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:33:30.626793 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:33:30.628694 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:33:30.629160 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:33:30.629432 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:33:30.629628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.630442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.630696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:33:30.630897 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:33:30.634052 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:33:30.635036 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:33:30.635336 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:33:30.636186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.637102 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:33:30.637441 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:33:30.638762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.640913 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:33:30.641182 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:33:30.641837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.643557 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:33:30.643789 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:33:30.644311 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.645162 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:33:30.645400 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:33:30.645586 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:33:30.652546 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.655603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:33:30.655909 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:33:30.662155 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.663693 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:33:30.664332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f81b6ed0>]}
[0m11:33:30.664829 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m11:33:30.665322 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:33:30.665656 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m11:33:30.666011 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m11:33:30.666431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m11:33:30.666731 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m11:33:30.668764 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.669957 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m11:33:30.672645 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.673388 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.673702 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m11:33:30.673918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.674726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.674989 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.675184 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m11:33:30.676484 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.677809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.678149 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:33:30.679128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.680184 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.680465 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:33:30.682031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.684278 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.684576 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m11:33:30.685390 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.687320 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.687581 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m11:33:30.688566 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.689878 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:33:30.690242 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.690466 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:33:30.697511 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.699495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:33:30.699817 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m11:33:30.705983 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.707223 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m11:33:30.707988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f81c36b0>]}
[0m11:33:30.708429 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m11:33:30.708888 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m11:33:30.709251 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:33:30.709612 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m11:33:30.710024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m11:33:30.710312 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:33:30.713005 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:33:30.713943 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:33:30.716174 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:33:30.716792 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:33:30.717076 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:33:30.717389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.718191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.718436 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:33:30.718737 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m11:33:30.749503 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m11:33:30.750593 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:33:30.750946 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:33:30.752015 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.753140 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:33:30.753486 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:33:30.754529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.756559 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:33:30.756847 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:33:30.757914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.759810 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:33:30.760106 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:33:30.761075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.762297 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:33:30.762586 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:33:30.762796 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:33:30.771250 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:33:30.774289 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:33:30.774693 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:33:30.781336 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:33:30.782473 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:33:30.783683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f815b470>]}
[0m11:33:30.784117 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.07s]
[0m11:33:30.784539 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:33:30.784861 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m11:33:30.785193 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m11:33:30.785555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m11:33:30.785800 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m11:33:30.787899 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m11:33:30.788819 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m11:33:30.790778 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m11:33:30.791257 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:33:30.791509 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m11:33:30.791728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.792644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.792868 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:33:30.793101 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m11:33:30.797649 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:33:30.798537 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:33:30.798789 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:33:30.799583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.800421 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:33:30.800649 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:33:30.801704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.804637 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:33:30.805076 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m11:33:30.805895 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.807419 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:33:30.807675 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m11:33:30.808196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.809013 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:33:30.809264 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:33:30.809494 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:33:30.816970 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.818750 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:33:30.819021 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m11:33:30.824619 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:33:30.825607 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m11:33:30.827312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f82e38c0>]}
[0m11:33:30.827834 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m11:33:30.828283 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m11:33:30.828617 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:33:30.828953 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m11:33:30.829608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m11:33:30.829919 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:33:30.832515 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:33:30.833814 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:33:30.835822 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:33:30.836300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:33:30.836547 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:33:30.836746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.837824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.838239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:33:30.838699 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek in ((select * from gameweeks), (select * from gameweeks)+1, (select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon) over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.defending_biases,
        aggregate_fixtures.attacking_biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        defending_biases,
        attacking_biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:33:30.860566 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m11:33:30.861724 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:33:30.862067 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:33:30.862941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.863855 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:33:30.864135 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:33:30.865132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:30.867356 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:33:30.867610 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:33:30.868190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.869846 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:33:30.870076 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:33:30.870600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:30.871433 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:33:30.871660 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:33:30.871843 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:33:30.878804 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:33:30.880580 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:33:30.880860 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:33:30.886024 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:33:30.887461 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:33:30.890146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca84d9a0-d98f-4949-8a47-de8ab5c6ef8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f82e3590>]}
[0m11:33:30.890620 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.06s]
[0m11:33:30.891058 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:33:30.892646 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:30.892912 [debug] [MainThread]: On master: BEGIN
[0m11:33:30.893183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:30.893882 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:33:30.894148 [debug] [MainThread]: On master: COMMIT
[0m11:33:30.894363 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:30.894533 [debug] [MainThread]: On master: COMMIT
[0m11:33:30.895203 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:30.895606 [debug] [MainThread]: On master: Close
[0m11:33:30.896115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:30.896348 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:33:30.896621 [info ] [MainThread]: 
[0m11:33:30.896898 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m11:33:30.898321 [debug] [MainThread]: Command end result
[0m11:33:30.911268 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:33:30.912762 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:33:30.916932 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:33:30.917272 [info ] [MainThread]: 
[0m11:33:30.917561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:30.917803 [info ] [MainThread]: 
[0m11:33:30.918083 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m11:33:30.919335 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7974867, "process_in_blocks": "112760", "process_kernel_time": 0.278389, "process_mem_max_rss": "181260", "process_out_blocks": "4792", "process_user_time": 2.772294}
[0m11:33:30.919680 [debug] [MainThread]: Command `dbt build` succeeded at 11:33:30.919607 after 1.80 seconds
[0m11:33:30.919937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46063cfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4605bb0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c45f817baa0>]}
[0m11:33:30.920189 [debug] [MainThread]: Flushing usage events
[0m11:33:31.600538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:14.719124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471331214c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471326ef380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747134dce810>]}


============================== 11:35:14.723020 | b6fe19d2-16c8-4975-80d3-06259f073641 ==============================
[0m11:35:14.723020 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:35:14.723464 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'quiet': 'False'}
[0m11:35:14.939921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747132199310>]}
[0m11:35:15.001053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747134253c20>]}
[0m11:35:15.003769 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:35:15.059713 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:35:15.162615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:35:15.163227 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m11:35:15.440541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471211f3a40>]}
[0m11:35:15.481865 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:35:15.484095 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:35:15.595322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471281e38c0>]}
[0m11:35:15.596127 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m11:35:15.599158 [info ] [MainThread]: 
[0m11:35:15.599758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:35:15.600056 [info ] [MainThread]: 
[0m11:35:15.600533 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:35:15.604884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:35:15.643104 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:35:15.643506 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:35:15.643721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:15.680291 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m11:35:15.682004 [debug] [ThreadPool]: On list_analytics: Close
[0m11:35:15.684422 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:35:15.685246 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:35:15.685534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:15.687127 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:35:15.688540 [debug] [ThreadPool]: On list_analytics: Close
[0m11:35:15.690304 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:35:15.690742 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:35:15.690964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:15.691912 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.692835 [debug] [ThreadPool]: On list_analytics: Close
[0m11:35:15.693699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m11:35:15.694095 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:35:15.699587 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:35:15.700085 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:35:15.700293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:15.702013 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:35:15.703425 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:35:15.703690 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:35:15.704412 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:15.705000 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:35:15.705306 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:35:15.705930 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:15.706543 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:35:15.706745 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:35:15.706914 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:35:15.708001 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.708246 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:35:15.708815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m11:35:15.709205 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:35:15.710505 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:35:15.710786 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:35:15.711175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:15.712245 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.713338 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:35:15.713675 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:35:15.714311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:15.714581 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:35:15.714772 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:35:15.715738 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.717004 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:35:15.717465 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:35:15.717689 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:35:15.718673 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.719131 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:35:15.720048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m11:35:15.720510 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:35:15.721986 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:35:15.722343 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:35:15.722562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:15.723752 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.724674 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:35:15.724959 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:35:15.725715 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.725953 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:35:15.726146 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:35:15.726641 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:15.727290 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:35:15.727553 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:35:15.727728 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:35:15.728132 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:15.728358 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:35:15.730989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m11:35:15.736380 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:35:15.736758 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:35:15.737041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:15.737810 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.738065 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:35:15.738253 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:35:15.750215 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:35:15.752346 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:35:15.754071 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:35:15.754350 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:35:15.754969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m11:35:15.757213 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:35:15.757508 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:35:15.757734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:15.759126 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.759481 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:35:15.759683 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:35:15.762527 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:35:15.763614 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:35:15.764214 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:35:15.764440 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:35:15.765617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m11:35:15.767488 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:35:15.768634 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:35:15.768942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:15.769655 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:15.769862 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:35:15.770041 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:35:15.773450 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:35:15.775077 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:35:15.775687 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:35:15.775875 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:35:15.777058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74712113b7d0>]}
[0m11:35:15.777396 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:15.777579 [debug] [MainThread]: On master: BEGIN
[0m11:35:15.777732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:15.778304 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:35:15.778501 [debug] [MainThread]: On master: COMMIT
[0m11:35:15.778661 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:15.778834 [debug] [MainThread]: On master: COMMIT
[0m11:35:15.779271 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:35:15.779464 [debug] [MainThread]: On master: Close
[0m11:35:15.784689 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m11:35:15.785404 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m11:35:15.786187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_fixtures)
[0m11:35:15.786502 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m11:35:15.792219 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m11:35:15.793607 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m11:35:15.819056 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m11:35:15.819935 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:35:15.820245 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m11:35:15.820446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:15.821324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.821649 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:35:15.821890 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m11:35:15.826544 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:35:15.830708 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:35:15.831012 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:35:15.832084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.833864 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:35:15.834248 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:35:15.837830 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:35:15.843090 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:35:15.843406 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m11:35:15.845029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.847035 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:35:15.847315 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m11:35:15.847899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:15.859298 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:35:15.859701 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:35:15.859924 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:35:15.866856 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:35:15.871969 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:35:15.872423 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m11:35:15.878209 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:35:15.881045 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m11:35:15.883136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747134cdf050>]}
[0m11:35:15.883611 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.10s]
[0m11:35:15.884079 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m11:35:15.884440 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:35:15.884913 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:35:15.885822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m11:35:15.886170 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:35:15.888661 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.889768 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:35:15.893006 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.893563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.893859 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:35:15.894064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:15.894828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.895091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.895308 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:35:15.897527 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:35:15.898361 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.898644 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:35:15.899407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:15.900376 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.900641 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:35:15.902249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.905091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.905425 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:35:15.906284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.908126 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.908407 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:35:15.909035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:15.909975 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:35:15.910265 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.910478 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:35:15.915866 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:35:15.917530 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:35:15.917820 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:35:15.924388 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:15.925863 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:35:15.926503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471200c51c0>]}
[0m11:35:15.927054 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m11:35:15.927502 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:35:15.927803 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:35:15.928472 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m11:35:15.928953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:35:15.929234 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:35:15.931371 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:35:15.931844 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:35:15.933903 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:35:15.934399 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:35:15.934701 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:35:15.934928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:15.936129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.936471 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:35:15.936761 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:35:15.948291 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m11:35:15.949548 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:35:15.949840 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:35:15.950770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.951722 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:35:15.951977 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:35:15.953125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.955879 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:35:15.956260 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:35:15.957250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.959680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:35:15.960076 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:35:15.961155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.962209 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:35:15.962480 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:35:15.962679 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:35:15.969477 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:15.971685 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:35:15.972103 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:35:15.978615 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:15.980335 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:35:15.981088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471206e10d0>]}
[0m11:35:15.981554 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m11:35:15.981996 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:35:15.982280 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:35:15.982612 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m11:35:15.982960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:35:15.983234 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:35:15.985263 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:35:15.985878 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:35:15.988164 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:35:15.989113 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:35:15.989471 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:35:15.989708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:15.990847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:15.991353 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:35:15.991620 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:35:15.994875 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:35:15.996179 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:35:15.996628 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:35:15.997696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.000076 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:35:16.000388 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:35:16.001718 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.003842 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:35:16.004236 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:35:16.005487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.008153 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:35:16.008490 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:35:16.009580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.010659 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:35:16.010971 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:35:16.011191 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:35:16.018248 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:16.019851 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:35:16.020132 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:35:16.027086 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:35:16.028771 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:35:16.029966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471200e02c0>]}
[0m11:35:16.030459 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.05s]
[0m11:35:16.030920 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:35:16.031214 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:35:16.031591 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m11:35:16.032174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:35:16.032705 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:35:16.034915 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:35:16.035397 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:35:16.037434 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:35:16.037923 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:35:16.038216 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:35:16.038451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.039368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.039637 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:35:16.039861 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:35:16.043137 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:35:16.044299 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:35:16.044589 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:35:16.045853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.047446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:35:16.047894 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:35:16.049881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.052416 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:35:16.052712 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:35:16.053537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.055406 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:35:16.055739 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:35:16.056468 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:16.057851 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:35:16.058207 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:35:16.058449 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:35:16.065114 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:16.067046 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:35:16.067335 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:35:16.072260 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:35:16.074142 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:35:16.075043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471322149e0>]}
[0m11:35:16.075665 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:35:16.076173 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:35:16.076504 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:35:16.076877 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m11:35:16.077457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:35:16.077736 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:35:16.079827 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:35:16.080296 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:35:16.082408 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:35:16.082864 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:35:16.083130 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:35:16.083336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.084157 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.084399 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:35:16.084613 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:35:16.087164 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:35:16.087959 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:35:16.088202 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:35:16.089153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.090326 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:35:16.090619 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:35:16.092758 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:35:16.096959 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:35:16.097302 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:35:16.098131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.099828 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:35:16.100064 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:35:16.100615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:16.101510 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:35:16.101746 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:35:16.101934 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:35:16.109197 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:35:16.111226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:35:16.111525 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:35:16.117722 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:16.119233 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:35:16.120061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747120112e10>]}
[0m11:35:16.120697 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m11:35:16.121438 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:35:16.121748 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m11:35:16.122695 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m11:35:16.123108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m11:35:16.123383 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m11:35:16.125957 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m11:35:16.126602 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m11:35:16.128979 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m11:35:16.129658 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:35:16.129939 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m11:35:16.130146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.131139 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.131425 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:35:16.131681 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m11:35:16.134614 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:35:16.135459 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:35:16.135731 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:35:16.136493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.137416 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:35:16.137670 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:35:16.138857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.141943 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:35:16.142327 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m11:35:16.143548 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.145807 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:35:16.146119 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m11:35:16.146961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.147924 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:35:16.148179 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:35:16.148374 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:35:16.155373 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:35:16.157146 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:35:16.157433 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m11:35:16.164423 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:35:16.166041 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m11:35:16.166892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471200aeea0>]}
[0m11:35:16.167392 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m11:35:16.167816 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m11:35:16.168103 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:35:16.168556 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:35:16.168961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m11:35:16.169209 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:35:16.171045 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:35:16.171493 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:35:16.173663 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:35:16.174181 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:35:16.174486 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:35:16.174702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.175922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.176576 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:35:16.176937 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:35:16.179048 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:35:16.180027 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:35:16.180338 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:35:16.181207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.182121 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:35:16.182375 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:35:16.183433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.185551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:35:16.185827 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:35:16.186612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:16.190447 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:35:16.190768 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:35:16.191707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.192744 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:35:16.193021 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:35:16.193319 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:35:16.200396 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:16.202577 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:35:16.202888 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:35:16.208732 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:35:16.210108 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:35:16.211022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471200e7500>]}
[0m11:35:16.211638 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:35:16.212216 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:35:16.212537 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:35:16.212962 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:35:16.214012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m11:35:16.214392 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:35:16.216583 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:35:16.217164 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:35:16.219077 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:35:16.219522 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:35:16.219825 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:35:16.220033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.220765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.221040 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:35:16.221244 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:35:16.222606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.223433 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:35:16.223700 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:35:16.224602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.225787 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:35:16.226070 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:35:16.227799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.230450 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:35:16.230782 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:35:16.231756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.233600 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:35:16.233870 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:35:16.234559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:16.235495 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:35:16.235744 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:35:16.235954 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:35:16.241761 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:16.243468 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:35:16.243787 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:35:16.249711 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:35:16.251410 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:35:16.252204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747120603dd0>]}
[0m11:35:16.252911 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m11:35:16.253594 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:35:16.253891 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:35:16.254223 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m11:35:16.254665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:35:16.254907 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:35:16.256949 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:35:16.257426 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:35:16.259456 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:35:16.259947 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:35:16.260200 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:35:16.260439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.261689 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.262081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:35:16.262321 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:35:16.265238 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:35:16.266326 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:35:16.266624 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:35:16.267613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.268571 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:35:16.268835 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:35:16.270113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.272268 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:35:16.272533 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:35:16.273191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:16.275063 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:35:16.275319 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:35:16.276096 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.277103 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:35:16.277361 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:35:16.277574 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:35:16.283636 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:16.286846 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:35:16.287146 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:35:16.292974 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:35:16.294203 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:35:16.295085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747120139370>]}
[0m11:35:16.295549 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m11:35:16.296022 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:35:16.296534 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m11:35:16.297240 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m11:35:16.297850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m11:35:16.298106 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m11:35:16.300070 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.301207 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m11:35:16.303177 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.303618 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.303883 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m11:35:16.304076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.304800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.305085 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.305294 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m11:35:16.306670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.307466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.307799 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:35:16.308507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:16.309458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.309735 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:35:16.310831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.313700 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.314098 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m11:35:16.315039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.317418 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.317778 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m11:35:16.318632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.319643 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:35:16.319942 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.320163 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:35:16.325688 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:35:16.327353 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:35:16.327623 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m11:35:16.333904 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:16.335248 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m11:35:16.335924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74712014fbf0>]}
[0m11:35:16.336404 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m11:35:16.336878 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m11:35:16.337196 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:35:16.337540 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m11:35:16.338115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m11:35:16.338398 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:35:16.340842 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:35:16.341354 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:35:16.343222 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:35:16.343666 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:35:16.343942 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:35:16.344145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.344907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.345144 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:35:16.345453 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m11:35:16.373799 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m11:35:16.374822 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:35:16.375132 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:35:16.376037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.377091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:35:16.377383 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:35:16.378427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.380634 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:35:16.381119 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:35:16.382367 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.384448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:35:16.384749 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:35:16.385969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.387108 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:35:16.387387 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:35:16.387628 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:35:16.395697 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:35:16.399026 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:35:16.399456 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:35:16.405862 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:16.407548 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:35:16.410180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471200ea900>]}
[0m11:35:16.410701 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.07s]
[0m11:35:16.411148 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:35:16.411449 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m11:35:16.411789 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m11:35:16.412426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m11:35:16.412716 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m11:35:16.415105 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m11:35:16.416343 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m11:35:16.418750 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m11:35:16.419427 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:35:16.419706 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m11:35:16.419949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.420946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.421287 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:35:16.421542 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m11:35:16.426266 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:35:16.427241 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:35:16.427547 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:35:16.428464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.429420 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:35:16.429695 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:35:16.430806 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.433310 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:35:16.433652 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m11:35:16.434547 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.436656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:35:16.436978 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m11:35:16.437891 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.438876 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:35:16.439137 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:35:16.439346 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:35:16.447069 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:35:16.448977 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:35:16.449291 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m11:35:16.455311 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:35:16.456514 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m11:35:16.457397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747120644ec0>]}
[0m11:35:16.457873 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m11:35:16.458294 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m11:35:16.458599 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:35:16.459032 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m11:35:16.459370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m11:35:16.459595 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:35:16.462028 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:35:16.463039 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:35:16.465323 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:35:16.465849 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:35:16.466170 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:35:16.466385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.467240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.467533 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:35:16.467821 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek in ((select * from gameweeks), (select * from gameweeks)+1, (select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.defending_biases,
        aggregate_fixtures.attacking_biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        defending_biases,
        attacking_biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:35:16.488237 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m11:35:16.489331 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:35:16.489661 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:35:16.490545 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.491537 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:35:16.491802 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:35:16.493030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:16.495046 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:35:16.495282 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:35:16.495875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:16.497774 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:35:16.498049 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:35:16.498658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:16.499584 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:35:16.499864 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:35:16.500084 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:35:16.507069 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:35:16.509527 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:35:16.509835 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:35:16.514912 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:35:16.516428 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:35:16.519428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fe19d2-16c8-4975-80d3-06259f073641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471206ce6c0>]}
[0m11:35:16.520113 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.06s]
[0m11:35:16.520677 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:35:16.522574 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:16.522947 [debug] [MainThread]: On master: BEGIN
[0m11:35:16.523169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:16.523962 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:35:16.524240 [debug] [MainThread]: On master: COMMIT
[0m11:35:16.524448 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:16.524621 [debug] [MainThread]: On master: COMMIT
[0m11:35:16.525266 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:35:16.525645 [debug] [MainThread]: On master: Close
[0m11:35:16.526160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:16.526461 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:35:16.526841 [info ] [MainThread]: 
[0m11:35:16.527317 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m11:35:16.528731 [debug] [MainThread]: Command end result
[0m11:35:16.543655 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:35:16.545250 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:35:16.549612 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:35:16.549881 [info ] [MainThread]: 
[0m11:35:16.550187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:16.550442 [info ] [MainThread]: 
[0m11:35:16.550719 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m11:35:16.552742 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.8861209, "process_in_blocks": "113272", "process_kernel_time": 0.389054, "process_mem_max_rss": "181356", "process_out_blocks": "4792", "process_user_time": 2.742831}
[0m11:35:16.553294 [debug] [MainThread]: Command `dbt build` succeeded at 11:35:16.553188 after 1.89 seconds
[0m11:35:16.553693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747132276300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471322c5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7471322c6f60>]}
[0m11:35:16.554002 [debug] [MainThread]: Flushing usage events
[0m11:35:17.110107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:22.316491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753feed5ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753ff117d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753ff1106e10>]}


============================== 11:39:22.321813 | d3aaf94c-4472-48b3-8ae1-816261bca1d0 ==============================
[0m11:39:22.321813 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:39:22.322469 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'empty': 'False', 'write_json': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'invocation_command': 'dbt build', 'version_check': 'True'}
[0m11:39:22.553497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fee43a9f0>]}
[0m11:39:22.614128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753feeb0fe30>]}
[0m11:39:22.616720 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:39:22.673782 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:39:22.777044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:39:22.777635 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m11:39:23.061680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fd53f3b30>]}
[0m11:39:23.107842 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:39:23.109992 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:39:23.194681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fe43fed50>]}
[0m11:39:23.195068 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m11:39:23.196951 [info ] [MainThread]: 
[0m11:39:23.197285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:23.197518 [info ] [MainThread]: 
[0m11:39:23.197955 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:39:23.202186 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:39:23.233372 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:39:23.233785 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:39:23.234005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:23.266272 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m11:39:23.267464 [debug] [ThreadPool]: On list_analytics: Close
[0m11:39:23.269125 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:39:23.269426 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:39:23.269741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:23.270733 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:23.271534 [debug] [ThreadPool]: On list_analytics: Close
[0m11:39:23.272923 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:39:23.273203 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:39:23.273511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:23.274587 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:23.275398 [debug] [ThreadPool]: On list_analytics: Close
[0m11:39:23.276046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m11:39:23.276379 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:39:23.280960 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:39:23.281226 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:39:23.281441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:23.282540 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:23.283569 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:39:23.283791 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:39:23.284476 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:39:23.284828 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:39:23.285125 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:39:23.286095 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:23.286689 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:39:23.286884 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:39:23.287042 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:39:23.288384 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:23.288648 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:39:23.289182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m11:39:23.289525 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:39:23.290826 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:39:23.291092 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:39:23.291329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:23.292531 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:23.293832 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:39:23.294281 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:39:23.294989 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:39:23.295340 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:39:23.295632 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:39:23.296320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:39:23.296877 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:39:23.297081 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:39:23.297243 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:39:23.297717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:39:23.298095 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:39:23.298638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m11:39:23.298989 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:39:23.300205 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:39:23.300459 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:39:23.300679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:23.301839 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:23.302780 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:39:23.302989 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:39:23.303411 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:39:23.303603 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:39:23.303755 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:39:23.304169 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:39:23.304702 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:39:23.304891 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:39:23.305044 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:39:23.305408 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:39:23.305616 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:39:23.307486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m11:39:23.311737 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:39:23.312114 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:39:23.312361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:23.313380 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:23.313602 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:39:23.313777 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:39:23.324795 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:39:23.326008 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:39:23.328223 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:39:23.328460 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:39:23.328962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m11:39:23.331168 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:39:23.331465 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:39:23.331701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:23.333588 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:39:23.333838 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:39:23.334050 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:39:23.336789 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:39:23.337721 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:39:23.338298 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:39:23.338484 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:39:23.338960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m11:39:23.340130 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:39:23.340378 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:39:23.340584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:23.341703 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:39:23.342422 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:39:23.342683 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:39:23.345610 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:39:23.346743 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:39:23.347335 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:39:23.347533 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:39:23.349016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fee414da0>]}
[0m11:39:23.349396 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:23.349605 [debug] [MainThread]: On master: BEGIN
[0m11:39:23.349772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:23.350544 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:39:23.350843 [debug] [MainThread]: On master: COMMIT
[0m11:39:23.351027 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:23.351183 [debug] [MainThread]: On master: COMMIT
[0m11:39:23.351635 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:23.351862 [debug] [MainThread]: On master: Close
[0m11:39:23.355705 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m11:39:23.356173 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m11:39:23.356739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m11:39:23.357002 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m11:39:23.362304 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m11:39:23.363527 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m11:39:23.386737 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m11:39:23.387418 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:39:23.387733 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m11:39:23.387932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.388710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.388951 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:39:23.389153 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m11:39:23.395037 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:39:23.400317 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:39:23.400662 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:39:23.401719 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.402749 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:39:23.403006 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:39:23.406757 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:39:23.411447 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:39:23.411761 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m11:39:23.413737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:23.416208 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:39:23.416505 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m11:39:23.417171 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.427679 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:39:23.428054 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:39:23.428267 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:39:23.436665 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:39:23.440828 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:39:23.441143 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m11:39:23.447481 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.450354 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m11:39:23.452391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c4fdd60>]}
[0m11:39:23.452839 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m11:39:23.453262 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m11:39:23.453584 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:39:23.453937 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:39:23.454434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m11:39:23.454867 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:39:23.457265 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.458452 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:39:23.461690 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.462536 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.462842 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:39:23.463052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.463797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.464018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.464233 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:39:23.466463 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:23.467312 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.467561 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:39:23.468553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.469891 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.470406 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:39:23.471563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.474253 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.474544 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:39:23.475328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.477017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.477243 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:39:23.477777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.478712 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:39:23.478953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.479140 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:39:23.485466 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.487021 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:39:23.487265 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:39:23.493267 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.494818 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:39:23.495395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c566930>]}
[0m11:39:23.495852 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m11:39:23.496308 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:39:23.496615 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:39:23.496976 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m11:39:23.497448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:39:23.497756 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:39:23.500342 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:39:23.500901 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:39:23.503015 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:39:23.503457 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:39:23.503696 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:39:23.503927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.504667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.504896 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:39:23.505141 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:39:23.515689 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m11:39:23.516706 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:39:23.516987 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:39:23.518258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.519263 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:39:23.519514 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:39:23.520743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.522984 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:39:23.523260 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:39:23.524065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.525769 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:39:23.525999 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:39:23.526826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.527720 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:39:23.527963 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:39:23.528173 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:39:23.534896 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.536733 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:39:23.537001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:39:23.542304 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:39:23.543840 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:39:23.544499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c512120>]}
[0m11:39:23.544956 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m11:39:23.545384 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:39:23.545697 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:39:23.546057 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m11:39:23.546706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:39:23.547072 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:39:23.549146 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:39:23.549620 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:39:23.551709 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:39:23.552156 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:39:23.552395 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:39:23.552590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.553306 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.553527 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:39:23.553721 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:39:23.555917 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:23.556729 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:39:23.557001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:39:23.557734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.559991 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:39:23.560256 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:39:23.561234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.563154 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:39:23.563408 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:39:23.564108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.565916 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:39:23.566228 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:39:23.567322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.568175 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:39:23.568403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:39:23.568621 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:39:23.575413 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.577132 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:39:23.577386 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:39:23.583502 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.585092 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:39:23.586364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c5aba40>]}
[0m11:39:23.586862 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m11:39:23.587275 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:39:23.587566 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:39:23.587907 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m11:39:23.588620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:39:23.588952 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:39:23.591023 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:39:23.591462 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:39:23.593378 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:39:23.593815 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:39:23.594102 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:39:23.594348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.595061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.595314 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:39:23.595528 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:39:23.597459 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:23.598379 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:39:23.598737 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:39:23.599606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.600663 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:39:23.601033 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:39:23.602271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.604399 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:39:23.604656 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:39:23.605222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.607021 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:39:23.607273 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:39:23.607785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.608675 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:39:23.608925 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:39:23.609127 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:39:23.615092 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.616847 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:39:23.617110 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:39:23.622744 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:39:23.624287 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:39:23.625090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c4fef60>]}
[0m11:39:23.625753 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:39:23.626594 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:39:23.626895 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:39:23.627224 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m11:39:23.627614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:39:23.627879 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:39:23.630013 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:39:23.630448 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:39:23.632401 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:39:23.632916 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:39:23.633173 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:39:23.633367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.634420 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.634680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:39:23.634895 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:39:23.637627 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:23.638561 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:39:23.638834 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:39:23.639566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.640465 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:39:23.640735 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:39:23.641850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.645141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:39:23.645400 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:39:23.645966 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.647684 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:39:23.647925 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:39:23.648436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.649281 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:39:23.649529 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:39:23.649761 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:39:23.656592 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.658883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:39:23.659176 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:39:23.663969 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:39:23.665338 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:39:23.666226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c5c41d0>]}
[0m11:39:23.666724 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m11:39:23.667153 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:39:23.667455 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m11:39:23.667777 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m11:39:23.668557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m11:39:23.668874 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m11:39:23.671528 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m11:39:23.672026 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m11:39:23.673831 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m11:39:23.674357 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:39:23.674603 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m11:39:23.674803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.675505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.675734 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:39:23.675965 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m11:39:23.678700 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:23.679496 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:39:23.679731 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:39:23.680665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.681559 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:39:23.681796 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:39:23.682916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.685833 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:39:23.686185 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m11:39:23.686977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.688643 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:39:23.688898 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m11:39:23.689446 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.690389 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:39:23.690634 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:39:23.690855 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:39:23.697723 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:39:23.699320 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:39:23.699575 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m11:39:23.705717 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.707173 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m11:39:23.708015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fd488e570>]}
[0m11:39:23.708482 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m11:39:23.708928 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m11:39:23.709243 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:39:23.709595 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:39:23.710049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m11:39:23.710360 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:39:23.712261 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:39:23.713721 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:39:23.715887 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:39:23.716328 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:39:23.716564 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:39:23.716770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.717519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.717783 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:39:23.717997 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:39:23.719727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.720541 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:39:23.720768 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:39:23.721792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.723000 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:39:23.723298 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:39:23.724522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.726562 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:39:23.726804 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:39:23.727605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.731361 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:39:23.731645 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:39:23.732312 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.733151 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:39:23.733385 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:39:23.733572 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:39:23.740138 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.741902 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:39:23.742227 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:39:23.747546 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:39:23.748770 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:39:23.749307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c5ab380>]}
[0m11:39:23.749743 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:39:23.750203 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:39:23.750523 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:39:23.750859 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:39:23.751224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m11:39:23.751548 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:39:23.753434 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:39:23.754190 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:39:23.756843 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:39:23.757351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:39:23.757574 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:39:23.757768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.758786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.759205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:39:23.759569 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:39:23.761394 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.762565 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:39:23.763073 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:39:23.763890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.764856 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:39:23.765093 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:39:23.766020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.767811 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:39:23.768038 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:39:23.768691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.770451 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:39:23.770761 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:39:23.771453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.772302 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:39:23.772544 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:39:23.772732 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:39:23.779801 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:39:23.781524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:39:23.781789 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:39:23.787327 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:39:23.788455 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:39:23.789058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c51f620>]}
[0m11:39:23.789530 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m11:39:23.789950 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:39:23.790277 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:39:23.790873 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m11:39:23.791268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:39:23.791539 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:39:23.793541 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:39:23.794064 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:39:23.796167 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:39:23.796641 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:39:23.796879 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:39:23.797107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.797842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.798123 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:39:23.798348 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:39:23.800612 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:23.801450 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:39:23.801681 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:39:23.802510 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.803384 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:39:23.803635 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:39:23.804797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.806799 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:39:23.807038 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:39:23.807630 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.809435 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:39:23.809669 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:39:23.810201 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.811110 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:39:23.811359 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:39:23.811553 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:39:23.818125 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.820861 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:39:23.821133 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:39:23.826822 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:39:23.828014 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:39:23.828825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c5f3110>]}
[0m11:39:23.829293 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m11:39:23.829699 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:39:23.829972 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m11:39:23.830343 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m11:39:23.830723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m11:39:23.831139 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m11:39:23.833822 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.834826 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m11:39:23.836677 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.837125 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.837381 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m11:39:23.837602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.838902 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.839194 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.839412 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m11:39:23.840786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.841549 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.841775 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:39:23.842512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.843533 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.843787 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:39:23.844658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.846683 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.846924 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m11:39:23.847739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.850419 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.850828 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m11:39:23.851743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.852571 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:39:23.852792 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.852982 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:39:23.860387 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:39:23.862172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:39:23.862446 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m11:39:23.868188 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:39:23.869625 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m11:39:23.870551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c5e7a10>]}
[0m11:39:23.871415 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m11:39:23.871907 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m11:39:23.872215 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:39:23.872597 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m11:39:23.873254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m11:39:23.873670 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:39:23.876533 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:39:23.877046 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:39:23.878982 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:39:23.879433 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:39:23.879671 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:39:23.879876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.880613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.880827 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:39:23.881098 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m11:39:23.911662 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m11:39:23.912730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:39:23.913015 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:39:23.913957 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.915050 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:39:23.915334 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:39:23.916244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.918079 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:39:23.918340 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:39:23.919238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.921885 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:39:23.922198 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:39:23.922903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.923836 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:39:23.924130 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:39:23.924371 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:39:23.933387 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m11:39:23.936422 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:39:23.936735 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:39:23.943463 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:23.944386 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:39:23.946399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f7defd880>]}
[0m11:39:23.946859 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.07s]
[0m11:39:23.947312 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:39:23.947696 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m11:39:23.948330 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m11:39:23.948825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m11:39:23.949115 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m11:39:23.951322 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m11:39:23.952175 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m11:39:23.954054 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m11:39:23.954490 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:39:23.954738 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m11:39:23.954924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.956148 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.956697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:39:23.957169 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m11:39:23.963310 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:39:23.964329 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:39:23.964625 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:39:23.965544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.966541 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:39:23.966800 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:39:23.968015 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:23.969979 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:39:23.970297 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m11:39:23.971075 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.973134 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:39:23.973369 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m11:39:23.973918 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:23.974824 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:39:23.975061 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:39:23.975269 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:39:23.982806 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:39:23.984495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:39:23.984759 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m11:39:23.990473 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:39:23.991849 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m11:39:23.992621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c510c80>]}
[0m11:39:23.993115 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m11:39:23.993531 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m11:39:23.993817 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:39:23.994205 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m11:39:23.994631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m11:39:23.994946 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:39:23.997474 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:39:23.998693 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:39:24.000883 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:39:24.001364 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:39:24.001610 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:39:24.001805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:24.002863 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:24.003289 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:39:24.003743 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek in ((select * from gameweeks), (select * from gameweeks)+1, (select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:39:24.024831 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m11:39:24.025834 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:39:24.026251 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:39:24.027096 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:24.028047 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:39:24.028298 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:39:24.029447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:24.031735 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:39:24.032029 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:39:24.032723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:24.034453 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:39:24.034683 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:39:24.035239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:39:24.036128 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:39:24.036354 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:39:24.036533 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:39:24.044640 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:39:24.046350 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:39:24.046616 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:39:24.052963 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:39:24.054696 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:39:24.057278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3aaf94c-4472-48b3-8ae1-816261bca1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f8c513a10>]}
[0m11:39:24.057718 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.06s]
[0m11:39:24.058174 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:39:24.060278 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:24.060521 [debug] [MainThread]: On master: BEGIN
[0m11:39:24.060698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:24.061427 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:39:24.061646 [debug] [MainThread]: On master: COMMIT
[0m11:39:24.061855 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:24.062093 [debug] [MainThread]: On master: COMMIT
[0m11:39:24.062559 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:24.062789 [debug] [MainThread]: On master: Close
[0m11:39:24.063158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:24.063366 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:39:24.063650 [info ] [MainThread]: 
[0m11:39:24.063960 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m11:39:24.065386 [debug] [MainThread]: Command end result
[0m11:39:24.078651 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:39:24.080242 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:39:24.084453 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:39:24.084708 [info ] [MainThread]: 
[0m11:39:24.085018 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:24.085258 [info ] [MainThread]: 
[0m11:39:24.085522 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m11:39:24.087104 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.8230922, "process_in_blocks": "74936", "process_kernel_time": 0.37571, "process_mem_max_rss": "181588", "process_out_blocks": "4792", "process_user_time": 2.68534}
[0m11:39:24.087424 [debug] [MainThread]: Command `dbt build` succeeded at 11:39:24.087358 after 1.82 seconds
[0m11:39:24.087654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fee917110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fef361df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fef362e10>]}
[0m11:39:24.087878 [debug] [MainThread]: Flushing usage events
[0m11:39:24.679722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:58.564026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b60f7b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b612f7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b60f7a420>]}


============================== 11:41:58.568493 | 5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc ==============================
[0m11:41:58.568493 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:41:58.568965 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'version_check': 'True', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/home/robgriffin247/fpl', 'fail_fast': 'False', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'empty': 'False'}
[0m11:41:58.812981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b604d1430>]}
[0m11:41:58.879037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b61265a60>]}
[0m11:41:58.881402 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:41:58.939154 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:41:59.045711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:59.046307 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m11:41:59.352190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b371f7fb0>]}
[0m11:41:59.398434 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:41:59.401009 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:41:59.487969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b601cbe60>]}
[0m11:41:59.488447 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m11:41:59.490379 [info ] [MainThread]: 
[0m11:41:59.490745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:59.490980 [info ] [MainThread]: 
[0m11:41:59.491380 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:41:59.495518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:41:59.528052 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:41:59.528453 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:41:59.528676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:59.558943 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m11:41:59.560199 [debug] [ThreadPool]: On list_analytics: Close
[0m11:41:59.562001 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:41:59.562417 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:41:59.562643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:59.563643 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.564459 [debug] [ThreadPool]: On list_analytics: Close
[0m11:41:59.565865 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:41:59.566160 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:41:59.566467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:59.567267 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.568104 [debug] [ThreadPool]: On list_analytics: Close
[0m11:41:59.569200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m11:41:59.569575 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:41:59.575180 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:41:59.575519 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:41:59.575724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:59.576912 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.577998 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:41:59.578243 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:41:59.578972 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.579190 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:41:59.579360 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:41:59.579787 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:41:59.580347 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:41:59.580551 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:41:59.580740 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:41:59.581853 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.582074 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:41:59.582628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m11:41:59.582950 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:41:59.584103 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:41:59.584345 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:41:59.584579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:59.585471 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.586635 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:41:59.586991 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:41:59.587831 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.588136 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:41:59.588328 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:41:59.588981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:41:59.589633 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:41:59.589873 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:41:59.590035 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:41:59.590506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:41:59.590706 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:41:59.591235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m11:41:59.591616 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:41:59.592918 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:41:59.593265 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:41:59.593480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:59.594631 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.595578 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:41:59.595795 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:41:59.596499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:41:59.596926 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:41:59.597173 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:41:59.597815 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:41:59.598610 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:41:59.598854 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:41:59.599106 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:41:59.599605 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:41:59.599849 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:41:59.601551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m11:41:59.605951 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:41:59.606387 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:41:59.606593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:59.607728 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.608155 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:41:59.608503 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:41:59.621095 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:41:59.622607 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:41:59.624771 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:41:59.625055 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:41:59.625853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m11:41:59.629323 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:41:59.629592 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:41:59.629772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:59.630470 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:41:59.630708 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:41:59.630895 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:41:59.633763 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:41:59.634788 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:41:59.635398 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:41:59.635600 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:41:59.636148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m11:41:59.637774 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:41:59.638079 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:41:59.638334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:59.640181 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:41:59.640487 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:41:59.640701 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:41:59.644769 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:41:59.645883 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:41:59.646575 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:41:59.646776 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:41:59.648199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b371f3f20>]}
[0m11:41:59.648547 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:59.648728 [debug] [MainThread]: On master: BEGIN
[0m11:41:59.648879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:59.649604 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:41:59.649959 [debug] [MainThread]: On master: COMMIT
[0m11:41:59.650550 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:59.650785 [debug] [MainThread]: On master: COMMIT
[0m11:41:59.651232 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:41:59.651452 [debug] [MainThread]: On master: Close
[0m11:41:59.656555 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m11:41:59.657127 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m11:41:59.657831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_fixtures)
[0m11:41:59.658101 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m11:41:59.663261 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m11:41:59.663868 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m11:41:59.687191 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m11:41:59.687922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:41:59.688262 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m11:41:59.688484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:59.689436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.689874 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:41:59.690183 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m11:41:59.694396 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:41:59.698630 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:41:59.698970 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:41:59.699972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.700941 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:41:59.701221 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:41:59.703395 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:41:59.708895 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:41:59.709376 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m11:41:59.711311 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:41:59.713571 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:41:59.713891 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m11:41:59.714713 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.727094 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:41:59.727520 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:41:59.727772 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:41:59.734168 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:41:59.738250 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:41:59.738549 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m11:41:59.745687 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:41:59.747964 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m11:41:59.750167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b62bbec90>]}
[0m11:41:59.750762 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m11:41:59.751304 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m11:41:59.751618 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:41:59.751985 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:41:59.752401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m11:41:59.752956 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:41:59.755116 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.755631 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:41:59.759479 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.760210 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.760517 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:41:59.760727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:59.761594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.761856 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.762069 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:41:59.764299 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:41:59.765167 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.765450 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:41:59.766199 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:41:59.767146 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.767396 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:41:59.768455 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.770533 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.770779 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:41:59.771344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:41:59.773007 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.773264 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:41:59.774077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:41:59.775510 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:41:59.775995 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.776234 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:41:59.782753 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:41:59.784633 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:41:59.784919 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:41:59.790744 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:41:59.792479 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:41:59.793319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b362e8b30>]}
[0m11:41:59.793848 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m11:41:59.794388 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:41:59.794699 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:41:59.795029 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m11:41:59.795380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:41:59.795686 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:41:59.797960 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:41:59.799109 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:41:59.801252 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:41:59.801694 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:41:59.801929 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:41:59.802193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:59.802913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.803134 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:41:59.803410 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:41:59.815234 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m11:41:59.816212 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:41:59.816487 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:41:59.817302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.818286 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:41:59.818547 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:41:59.819392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.821226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:41:59.821465 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:41:59.822318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.824390 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:41:59.824670 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:41:59.825382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:41:59.826373 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:41:59.826640 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:41:59.826843 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:41:59.833333 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:41:59.835032 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:41:59.835314 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:41:59.841538 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:41:59.842592 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:41:59.843285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b362ba570>]}
[0m11:41:59.843760 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m11:41:59.844190 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:41:59.844486 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:41:59.844933 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m11:41:59.845282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:41:59.845515 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:41:59.847438 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:41:59.847989 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:41:59.850163 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:41:59.850724 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:41:59.850966 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:41:59.851166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:59.851894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.852142 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:41:59.852358 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:41:59.854679 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:41:59.855847 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:41:59.856162 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:41:59.857245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.859793 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:41:59.860083 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:41:59.861256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.863256 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:41:59.863538 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:41:59.864395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:41:59.866244 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:41:59.866513 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:41:59.867190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:41:59.868099 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:41:59.868350 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:41:59.868560 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:41:59.874333 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:41:59.876048 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:41:59.876330 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:41:59.881437 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:41:59.882649 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:41:59.883542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b36294800>]}
[0m11:41:59.884002 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m11:41:59.884465 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:41:59.884754 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:41:59.885137 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m11:41:59.885515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:41:59.886048 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:41:59.888094 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:41:59.888637 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:41:59.890666 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:41:59.891206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:41:59.891457 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:41:59.891656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:59.892492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.893043 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:41:59.893420 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:41:59.895644 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:41:59.896564 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:41:59.896945 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:41:59.897791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.898787 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:41:59.899074 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:41:59.900276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.902601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:41:59.902969 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:41:59.903869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.906240 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:41:59.906635 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:41:59.907620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.908997 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:41:59.909425 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:41:59.909680 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:41:59.916161 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:41:59.918365 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:41:59.918740 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:41:59.923957 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:41:59.925321 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:41:59.925966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b3631e570>]}
[0m11:41:59.926540 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:41:59.926969 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:41:59.927294 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:41:59.927646 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m11:41:59.928277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:41:59.928584 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:41:59.931126 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:41:59.932072 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:41:59.934947 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:41:59.935607 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:41:59.935904 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:41:59.936160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:59.936942 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.937204 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:41:59.937416 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:41:59.940720 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:41:59.941803 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:41:59.942149 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:41:59.943218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.944392 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:41:59.944683 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:41:59.946367 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.950392 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:41:59.950802 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:41:59.951669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.953751 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:41:59.954077 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:41:59.954902 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.955928 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:41:59.956233 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:41:59.956444 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:41:59.962624 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:41:59.964508 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:41:59.964987 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:41:59.970584 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:41:59.972225 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:41:59.973155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b36336f00>]}
[0m11:41:59.973685 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m11:41:59.974200 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:41:59.974560 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m11:41:59.974936 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m11:41:59.975663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m11:41:59.976000 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m11:41:59.978572 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m11:41:59.979340 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m11:41:59.981900 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m11:41:59.982709 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:41:59.983052 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m11:41:59.983285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:59.984139 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.984428 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:41:59.984667 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m11:41:59.987753 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:41:59.988794 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:41:59.989092 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:41:59.990096 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.991271 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:41:59.991600 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:41:59.992713 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.994922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:41:59.995224 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m11:41:59.996224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:41:59.998966 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:41:59.999364 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m11:42:00.000658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.001895 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:42:00.002429 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:42:00.002665 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:42:00.010334 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:42:00.012137 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:42:00.012442 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m11:42:00.018909 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:42:00.020776 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m11:42:00.021932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b3668e270>]}
[0m11:42:00.022655 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.05s]
[0m11:42:00.023140 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m11:42:00.023436 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:42:00.023871 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:42:00.024268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m11:42:00.024513 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:42:00.026475 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:42:00.027431 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:42:00.029447 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:42:00.029886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:42:00.030242 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:42:00.030482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:00.031318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.031581 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:42:00.031805 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:42:00.033562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.034533 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:42:00.034792 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:42:00.035632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.036493 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:42:00.036742 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:42:00.037674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.039659 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:42:00.039903 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:42:00.040502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.043227 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:42:00.043507 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:42:00.044035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.044830 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:42:00.045055 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:42:00.045255 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:42:00.052552 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:42:00.055039 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:42:00.055363 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:42:00.060539 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:42:00.061991 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:42:00.062778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b3631f2c0>]}
[0m11:42:00.063317 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:42:00.063723 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:42:00.064090 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:42:00.064486 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:42:00.065680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m11:42:00.066049 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:42:00.068366 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:42:00.069000 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:42:00.071023 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:42:00.071464 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:42:00.071740 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:42:00.071950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:00.072851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.073210 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:42:00.073453 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:42:00.075016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.076200 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:42:00.076639 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:42:00.077771 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.078784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:42:00.079035 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:42:00.080314 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.082590 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:42:00.082924 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:42:00.084162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.086392 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:42:00.086779 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:42:00.088184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.089417 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:42:00.089774 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:42:00.090010 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:42:00.095919 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:42:00.097590 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:42:00.097866 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:42:00.104057 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:42:00.105507 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:42:00.106171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b3628a150>]}
[0m11:42:00.106676 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m11:42:00.107103 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:42:00.107389 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:42:00.107816 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m11:42:00.108171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:42:00.108423 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:42:00.110366 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:42:00.110811 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:42:00.112714 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:42:00.113148 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:42:00.113391 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:42:00.113629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:00.114623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.114887 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:42:00.115107 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:42:00.118280 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:42:00.119520 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:42:00.119837 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:42:00.121001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.122017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:42:00.122331 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:42:00.123516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.125650 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:42:00.125946 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:42:00.126616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.128418 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:42:00.128650 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:42:00.129270 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.130275 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:42:00.130600 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:42:00.130835 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:42:00.137702 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:42:00.141022 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:42:00.141355 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:42:00.146853 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:42:00.148032 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:42:00.148797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b3635eab0>]}
[0m11:42:00.149246 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m11:42:00.149714 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:42:00.150031 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m11:42:00.150386 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m11:42:00.150806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m11:42:00.151585 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m11:42:00.154834 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.156139 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m11:42:00.158957 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.159760 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.160069 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m11:42:00.160257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:00.161090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.161403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.161627 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m11:42:00.164258 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:42:00.165296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.165583 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:42:00.166701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.167936 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.168296 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:42:00.169994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.172903 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.173299 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m11:42:00.174070 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.175952 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.176215 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m11:42:00.176798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.177724 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:42:00.177982 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.178315 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:42:00.184178 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:42:00.186566 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:42:00.187035 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m11:42:00.192603 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:42:00.194439 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m11:42:00.195213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b3635c050>]}
[0m11:42:00.195711 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m11:42:00.196191 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m11:42:00.196518 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:42:00.196907 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m11:42:00.197385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m11:42:00.197683 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:42:00.200674 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:42:00.201951 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:42:00.204541 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:42:00.205388 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:42:00.205683 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:42:00.205926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:00.206708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.206985 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:42:00.207294 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m11:42:00.237528 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m11:42:00.238613 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:42:00.238927 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:42:00.239841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.240906 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:42:00.241175 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:42:00.242266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.244194 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:42:00.244451 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:42:00.245157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.246927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:42:00.247182 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:42:00.247973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.248886 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:42:00.249138 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:42:00.249406 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:42:00.256220 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:42:00.259086 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:42:00.259371 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:42:00.264670 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:42:00.266249 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:42:00.268455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b3630f5f0>]}
[0m11:42:00.268913 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.07s]
[0m11:42:00.269379 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:42:00.269659 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m11:42:00.270353 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m11:42:00.270732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m11:42:00.270978 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m11:42:00.273254 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m11:42:00.273821 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m11:42:00.275822 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m11:42:00.276292 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:42:00.276534 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m11:42:00.276737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:00.277473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.277710 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:42:00.277954 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m11:42:00.282401 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:42:00.283387 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:42:00.283671 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:42:00.284499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.285402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:42:00.285652 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:42:00.286678 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.289224 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:42:00.289515 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m11:42:00.290272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.292077 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:42:00.292344 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m11:42:00.292919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:42:00.293893 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:42:00.294171 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:42:00.294408 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:42:00.300793 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:42:00.304073 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:42:00.304684 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m11:42:00.311443 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:42:00.313049 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m11:42:00.313973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b36278a10>]}
[0m11:42:00.314568 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m11:42:00.315065 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m11:42:00.315393 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:42:00.315786 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m11:42:00.316358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m11:42:00.316635 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:42:00.319247 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:42:00.320613 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:42:00.323939 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:42:00.324781 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:42:00.325160 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:42:00.325408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:00.326236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.326498 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:42:00.326756 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek in ((select * from gameweeks), (select * from gameweeks)+1, (select * from gameweeks)+2, (select * from gameweeks)+3)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:42:00.350612 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:42:00.351620 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:42:00.351934 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:42:00.352893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.354051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:42:00.354495 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:42:00.355829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.359215 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:42:00.359630 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:42:00.360663 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.363726 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:42:00.364219 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:42:00.365240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:00.366569 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:42:00.366961 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:42:00.367186 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:42:00.375955 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:42:00.378377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:42:00.378926 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:42:00.385367 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:42:00.386699 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:42:00.389719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c737f10-ca7d-46ba-af75-a0c9ebb1ddfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b366f55e0>]}
[0m11:42:00.390364 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.07s]
[0m11:42:00.390972 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:42:00.393999 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:00.394593 [debug] [MainThread]: On master: BEGIN
[0m11:42:00.394821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:00.395563 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:42:00.395854 [debug] [MainThread]: On master: COMMIT
[0m11:42:00.396089 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:00.396260 [debug] [MainThread]: On master: COMMIT
[0m11:42:00.396930 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:42:00.397321 [debug] [MainThread]: On master: Close
[0m11:42:00.397850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:00.398273 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:42:00.398598 [info ] [MainThread]: 
[0m11:42:00.398872 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m11:42:00.400277 [debug] [MainThread]: Command end result
[0m11:42:00.414593 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:42:00.416131 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:42:00.420543 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:42:00.420867 [info ] [MainThread]: 
[0m11:42:00.421166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:00.421398 [info ] [MainThread]: 
[0m11:42:00.421629 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m11:42:00.423523 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.9136637, "process_in_blocks": "111128", "process_kernel_time": 0.42529, "process_mem_max_rss": "181568", "process_out_blocks": "4816", "process_user_time": 2.827396}
[0m11:42:00.423994 [debug] [MainThread]: Command `dbt build` succeeded at 11:42:00.423894 after 1.91 seconds
[0m11:42:00.424375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b60bd48f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b54b3c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b602e4cb0>]}
[0m11:42:00.424689 [debug] [MainThread]: Flushing usage events
[0m11:42:00.999228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:01.571971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789253513cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7892534d7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7892534d5a90>]}


============================== 11:44:01.577282 | 52a79e39-92a0-4540-a330-e67a27d0b41b ==============================
[0m11:44:01.577282 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:44:01.577714 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'empty': 'False', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'invocation_command': 'dbt build', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'quiet': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager'}
[0m11:44:01.795042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78925299e300>]}
[0m11:44:01.858005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789253663230>]}
[0m11:44:01.861712 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:44:01.918524 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:44:02.016978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:44:02.017528 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m11:44:02.296570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789252a156d0>]}
[0m11:44:02.338398 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:44:02.341014 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:44:02.416129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789254a06840>]}
[0m11:44:02.416519 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m11:44:02.418622 [info ] [MainThread]: 
[0m11:44:02.418983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:44:02.419262 [info ] [MainThread]: 
[0m11:44:02.419693 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:44:02.423862 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:44:02.456170 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:44:02.456539 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:44:02.456755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:02.487653 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m11:44:02.489282 [debug] [ThreadPool]: On list_analytics: Close
[0m11:44:02.490951 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:44:02.491223 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:44:02.491502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:02.492439 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:02.493297 [debug] [ThreadPool]: On list_analytics: Close
[0m11:44:02.494674 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:44:02.494943 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:44:02.495320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:02.496520 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:02.497590 [debug] [ThreadPool]: On list_analytics: Close
[0m11:44:02.498250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m11:44:02.498627 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:44:02.503129 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:44:02.503372 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:44:02.503561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:02.504472 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:02.505465 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:44:02.505670 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:44:02.506073 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:02.506300 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:44:02.506461 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:44:02.506874 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:02.507381 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:44:02.507577 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:44:02.507735 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:44:02.509464 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:44:02.509689 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:44:02.510131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m11:44:02.510527 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:44:02.511661 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:44:02.511905 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:44:02.512124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:02.513064 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:02.513863 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:44:02.514079 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:44:02.514474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:02.514671 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:44:02.514834 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:44:02.515224 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:02.515745 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:44:02.515940 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:44:02.516098 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:44:02.516458 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:02.516665 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:44:02.517129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m11:44:02.517445 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:44:02.518456 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:44:02.518685 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:44:02.518906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:02.519705 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:02.520578 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:44:02.520834 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:44:02.521234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:02.521445 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:44:02.521647 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:44:02.522288 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:02.523119 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:44:02.523443 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:44:02.523728 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:44:02.524818 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:02.525236 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:44:02.527454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m11:44:02.531363 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:44:02.531669 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:44:02.531892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:02.532644 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:02.532938 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:44:02.533113 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:44:02.543161 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:44:02.544124 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:44:02.546574 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:44:02.546794 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:44:02.547266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m11:44:02.549315 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:44:02.549576 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:44:02.549791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:02.551073 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:02.551281 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:44:02.551452 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:44:02.554011 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:44:02.554975 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:44:02.555551 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:44:02.555732 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:44:02.556238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m11:44:02.557487 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:44:02.557735 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:44:02.557946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:02.559265 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:02.559479 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:44:02.559653 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:44:02.562282 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:44:02.563286 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:44:02.563798 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:44:02.563972 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:44:02.565350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789248b9b4a0>]}
[0m11:44:02.565683 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:02.565863 [debug] [MainThread]: On master: BEGIN
[0m11:44:02.566013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:02.566507 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:02.566702 [debug] [MainThread]: On master: COMMIT
[0m11:44:02.566868 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:02.567031 [debug] [MainThread]: On master: COMMIT
[0m11:44:02.567406 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:02.567591 [debug] [MainThread]: On master: Close
[0m11:44:02.572511 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m11:44:02.572947 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m11:44:02.573461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m11:44:02.573706 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m11:44:02.578870 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m11:44:02.580184 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m11:44:02.601480 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m11:44:02.602103 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:44:02.602374 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m11:44:02.602574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.603318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.603543 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:44:02.603733 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m11:44:02.609196 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:44:02.614819 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:44:02.615099 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:44:02.615906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.616729 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:44:02.617088 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:44:02.621597 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:44:02.626129 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:44:02.626411 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m11:44:02.627885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.629675 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:44:02.629924 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m11:44:02.630554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.641075 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:44:02.641463 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:44:02.641710 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:44:02.651843 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m11:44:02.655841 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:44:02.656140 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m11:44:02.661944 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:44:02.664026 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m11:44:02.665722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789255456a80>]}
[0m11:44:02.666207 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m11:44:02.666677 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m11:44:02.667006 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:44:02.667333 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:44:02.667737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m11:44:02.668141 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:44:02.670168 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.670885 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:44:02.674062 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.674579 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.674841 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:44:02.675047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.676088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.676342 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.676563 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:44:02.678691 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:02.679568 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.679818 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:44:02.680578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.681519 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.681769 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:44:02.682779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.684943 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.685224 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:44:02.685824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.687612 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.687840 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:44:02.688355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.689275 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:44:02.689511 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.689707 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:44:02.695851 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:02.698150 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:44:02.698457 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:44:02.703671 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:44:02.705153 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:44:02.705863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789230350ce0>]}
[0m11:44:02.706318 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m11:44:02.706749 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:44:02.707040 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:44:02.707373 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m11:44:02.708004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:44:02.708363 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:44:02.711183 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:44:02.711690 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:44:02.713672 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:44:02.714128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:44:02.714358 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:44:02.714550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.715262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.715484 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:44:02.715729 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:44:02.723400 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:44:02.724222 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:44:02.724465 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:44:02.725246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.726380 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:44:02.726666 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:44:02.728164 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.730443 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:44:02.730713 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:44:02.731328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.733158 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:44:02.733418 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:44:02.733980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.734897 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:44:02.735152 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:44:02.735354 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:44:02.742424 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:44:02.744412 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:44:02.744708 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:44:02.751149 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:02.752271 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:44:02.752991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789230f11a90>]}
[0m11:44:02.753476 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m11:44:02.753896 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:44:02.754177 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:44:02.754683 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m11:44:02.755052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:44:02.755291 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:44:02.757203 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:44:02.757610 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:44:02.759424 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:44:02.759884 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:44:02.760139 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:44:02.760337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.761104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.761368 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:44:02.761576 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:44:02.764445 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:02.765330 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:44:02.765585 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:44:02.766365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.768784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:44:02.769093 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:44:02.770229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.772208 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:44:02.772464 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:44:02.773205 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.774773 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:44:02.775089 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:44:02.775722 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.776721 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:44:02.777064 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:44:02.777294 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:44:02.784387 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:44:02.786371 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:44:02.786652 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:44:02.792010 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:44:02.793122 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:44:02.793753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789230397260>]}
[0m11:44:02.794203 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m11:44:02.794614 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:44:02.794939 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:44:02.795310 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m11:44:02.796067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:44:02.796380 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:44:02.798572 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:44:02.799057 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:44:02.801146 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:44:02.801610 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:44:02.801846 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:44:02.802040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.802801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.803043 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:44:02.803245 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:44:02.805249 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:02.806040 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:44:02.806287 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:44:02.807055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.807941 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:44:02.808188 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:44:02.809340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.811460 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:44:02.811727 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:44:02.812358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.814301 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:44:02.814549 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:44:02.815164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.816188 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:44:02.816427 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:44:02.816611 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:44:02.822885 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:02.824503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:44:02.824750 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:44:02.831318 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:02.832553 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:44:02.833379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789230325d00>]}
[0m11:44:02.833826 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:44:02.834235 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:44:02.834538 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:44:02.834901 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m11:44:02.835282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:44:02.835716 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:44:02.837996 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:44:02.838443 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:44:02.840415 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:44:02.840872 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:44:02.841111 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:44:02.841344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.842050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.842260 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:44:02.842457 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:44:02.844976 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:02.845826 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:44:02.846121 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:44:02.847025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.847920 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:44:02.848250 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:44:02.849485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.853779 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:44:02.854044 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:44:02.854720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.856270 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:44:02.856501 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:44:02.857273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.858079 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:44:02.858304 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:44:02.858497 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:44:02.865637 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:44:02.867209 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:44:02.867456 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:44:02.873414 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:02.874801 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:44:02.875625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7892303ae840>]}
[0m11:44:02.876264 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m11:44:02.877104 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:44:02.877469 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m11:44:02.877810 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m11:44:02.878558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m11:44:02.878836 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m11:44:02.880931 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m11:44:02.881439 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m11:44:02.883567 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m11:44:02.884022 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:44:02.884289 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m11:44:02.884504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.885606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.886025 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:44:02.886413 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m11:44:02.891071 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:44:02.892272 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:44:02.892715 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:44:02.893791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.894669 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:44:02.894913 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:44:02.895790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.897877 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:44:02.898221 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m11:44:02.898919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.900702 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:44:02.900976 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m11:44:02.901518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.902400 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:44:02.902645 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:44:02.902856 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:44:02.909079 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:02.910619 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:44:02.910867 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m11:44:02.916159 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:44:02.917517 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m11:44:02.918157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789230f2b770>]}
[0m11:44:02.918608 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m11:44:02.919011 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m11:44:02.919295 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:44:02.919814 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:44:02.920198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m11:44:02.920447 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:44:02.922287 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:44:02.922733 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:44:02.924881 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:44:02.925329 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:44:02.925590 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:44:02.925789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.926504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.926735 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:44:02.926939 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:44:02.928397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.929187 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:44:02.929429 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:44:02.930130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.931017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:44:02.931286 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:44:02.932595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.935078 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:44:02.935321 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:44:02.936136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.939593 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:44:02.939947 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:44:02.940798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.941865 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:44:02.942130 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:44:02.942338 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:44:02.948015 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:44:02.949895 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:44:02.950281 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:44:02.956248 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:02.957848 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:44:02.958632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789230311e20>]}
[0m11:44:02.959107 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:44:02.959566 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:44:02.959856 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:44:02.960183 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:44:02.960591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m11:44:02.961160 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:44:02.963155 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:44:02.963650 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:44:02.965922 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:44:02.966624 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:44:02.967052 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:44:02.967267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.968392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.968657 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:44:02.968991 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:44:02.970106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.970847 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:44:02.971068 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:44:02.971737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:02.972820 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:44:02.973107 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:44:02.974126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.976154 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:44:02.976400 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:44:02.977418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.980043 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:44:02.980476 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:44:02.981707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:02.982967 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:44:02.983250 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:44:02.983447 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:44:02.990407 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:44:02.992077 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:44:02.992384 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:44:02.998562 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:03.000235 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:44:03.001031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789230301a30>]}
[0m11:44:03.001548 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m11:44:03.001983 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:44:03.002305 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:44:03.002630 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m11:44:03.003016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:44:03.003614 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:44:03.005662 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:44:03.006111 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:44:03.008049 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:44:03.008504 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:44:03.008745 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:44:03.009029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:03.009787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.010024 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:44:03.010223 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:44:03.012442 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:03.013272 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:44:03.013519 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:44:03.014234 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:03.015125 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:44:03.015366 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:44:03.016384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.018825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:44:03.019130 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:44:03.019995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.021771 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:44:03.022017 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:44:03.022569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:03.023474 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:44:03.023714 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:44:03.023992 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:44:03.030945 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:44:03.033897 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:44:03.034222 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:44:03.040331 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:03.041741 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:44:03.042353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7892303d4260>]}
[0m11:44:03.042833 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m11:44:03.043249 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:44:03.043546 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m11:44:03.044362 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m11:44:03.044796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m11:44:03.045069 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m11:44:03.046768 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.047172 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m11:44:03.049058 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.049480 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.049717 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m11:44:03.049920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:03.050660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.050981 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.051197 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m11:44:03.052619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.053583 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.053848 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:44:03.054663 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.055656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.055921 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:44:03.057431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.059940 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.060200 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m11:44:03.061341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.063156 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.063409 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m11:44:03.063970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:03.064846 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:44:03.065157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.065366 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:44:03.072218 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:44:03.074052 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:44:03.074328 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m11:44:03.080557 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:03.081814 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m11:44:03.082475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789233ff0890>]}
[0m11:44:03.082912 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m11:44:03.083313 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m11:44:03.083612 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:44:03.083980 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m11:44:03.084336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m11:44:03.084601 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:44:03.087012 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:44:03.087748 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:44:03.090109 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:44:03.090731 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:44:03.091021 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:44:03.091234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:03.092044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.092317 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:44:03.092621 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m11:44:03.124093 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m11:44:03.125265 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:44:03.125617 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:44:03.126756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.128010 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:44:03.128299 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:44:03.129617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.131817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:44:03.132125 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:44:03.133104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.134967 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:44:03.135256 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:44:03.136480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.138464 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:44:03.138841 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:44:03.139044 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:44:03.147506 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:44:03.151073 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:44:03.151461 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:44:03.159765 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:44:03.161097 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:44:03.162497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789230386330>]}
[0m11:44:03.163020 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.08s]
[0m11:44:03.163484 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:44:03.163823 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m11:44:03.164182 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m11:44:03.164611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m11:44:03.165412 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m11:44:03.168126 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m11:44:03.168984 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m11:44:03.171516 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m11:44:03.172332 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:44:03.172618 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m11:44:03.172895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:03.173978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.174414 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:44:03.174833 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m11:44:03.180585 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:44:03.181739 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:44:03.182072 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:44:03.183186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.184148 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:44:03.184432 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:44:03.185739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.188036 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:44:03.188399 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m11:44:03.189497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.191535 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:44:03.191830 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m11:44:03.192771 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.193790 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:44:03.194050 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:44:03.194320 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:44:03.201823 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:44:03.203580 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:44:03.203854 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m11:44:03.209824 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:03.211251 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m11:44:03.213138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78923030f860>]}
[0m11:44:03.213625 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.05s]
[0m11:44:03.214066 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m11:44:03.214362 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:44:03.214707 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m11:44:03.215056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m11:44:03.215588 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:44:03.218874 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:44:03.220236 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:44:03.223082 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:44:03.223909 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:44:03.224262 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:44:03.224584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:03.225560 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.225883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:44:03.226186 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek in ((select * from gameweeks), (select * from gameweeks)+1, (select * from gameweeks)+2, (select * from gameweeks)+3)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 4 as attacking_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        attacking_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:44:03.248363 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:44:03.249449 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:44:03.249745 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:44:03.250605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.251501 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:44:03.251749 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:44:03.252947 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:03.255103 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:44:03.255446 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:44:03.256130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:03.258259 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:44:03.258533 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:44:03.259228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:03.260150 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:44:03.260402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:44:03.260610 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:44:03.268139 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:44:03.270135 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:44:03.270439 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:44:03.276923 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:44:03.277952 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:44:03.279799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a79e39-92a0-4540-a330-e67a27d0b41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78923030f860>]}
[0m11:44:03.280330 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.06s]
[0m11:44:03.280852 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:44:03.283073 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:03.283354 [debug] [MainThread]: On master: BEGIN
[0m11:44:03.283545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:44:03.284333 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:44:03.284618 [debug] [MainThread]: On master: COMMIT
[0m11:44:03.284914 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:03.285115 [debug] [MainThread]: On master: COMMIT
[0m11:44:03.285548 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:03.285770 [debug] [MainThread]: On master: Close
[0m11:44:03.286106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:03.286279 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:44:03.286537 [info ] [MainThread]: 
[0m11:44:03.286788 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m11:44:03.288139 [debug] [MainThread]: Command end result
[0m11:44:03.302007 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:44:03.303509 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:44:03.307920 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:44:03.308248 [info ] [MainThread]: 
[0m11:44:03.308566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:03.308823 [info ] [MainThread]: 
[0m11:44:03.309084 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m11:44:03.310953 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7931192, "process_in_blocks": "112712", "process_kernel_time": 0.391799, "process_mem_max_rss": "182848", "process_out_blocks": "4832", "process_user_time": 2.625058}
[0m11:44:03.311311 [debug] [MainThread]: Command `dbt build` succeeded at 11:44:03.311239 after 1.79 seconds
[0m11:44:03.311563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789253513c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789233fdd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789233f2ca10>]}
[0m11:44:03.311809 [debug] [MainThread]: Flushing usage events
[0m11:44:03.995090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:39.605057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fed62816d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fed3ee7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fed41be570>]}


============================== 11:46:39.609720 | fedf5185-d7f2-40cd-b7e0-1921bddfec5e ==============================
[0m11:46:39.609720 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:46:39.610209 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'quiet': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m11:46:39.849238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fed5dbfa40>]}
[0m11:46:39.916351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fed44f7440>]}
[0m11:46:39.920158 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:46:39.983819 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:46:40.106066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:46:40.106690 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m11:46:40.450986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb3d17fb0>]}
[0m11:46:40.505277 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:46:40.508978 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:46:40.618969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fec9988260>]}
[0m11:46:40.619443 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m11:46:40.621397 [info ] [MainThread]: 
[0m11:46:40.621779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:40.622017 [info ] [MainThread]: 
[0m11:46:40.622418 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:46:40.627391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:46:40.661417 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:46:40.661864 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:46:40.662100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:40.697569 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m11:46:40.698817 [debug] [ThreadPool]: On list_analytics: Close
[0m11:46:40.700801 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:46:40.701210 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:46:40.701442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:40.702607 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.703510 [debug] [ThreadPool]: On list_analytics: Close
[0m11:46:40.705128 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:46:40.705405 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:46:40.705818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:40.706805 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.707633 [debug] [ThreadPool]: On list_analytics: Close
[0m11:46:40.708397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m11:46:40.708735 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:46:40.714353 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:46:40.714780 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:46:40.715099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:40.716612 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.717937 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:46:40.718170 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:46:40.718625 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:40.718829 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:46:40.718983 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:46:40.719407 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:40.720000 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:46:40.720249 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:46:40.720437 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:46:40.721694 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.721975 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:46:40.722581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m11:46:40.722945 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:46:40.724350 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:46:40.724586 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:46:40.724786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:40.725872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.726791 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:46:40.727028 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:46:40.727823 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.728047 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:46:40.728300 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:46:40.728766 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:40.729392 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:46:40.729653 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:46:40.729846 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:46:40.730498 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:40.730837 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:46:40.731423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m11:46:40.731787 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:46:40.733119 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:46:40.733427 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:46:40.733740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:40.734946 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.735937 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:46:40.736181 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:46:40.736980 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.737344 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:46:40.737638 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:46:40.738406 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:40.739059 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:46:40.739281 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:46:40.739458 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:46:40.740305 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.740568 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:46:40.742426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m11:46:40.746732 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:46:40.747191 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:46:40.747434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:40.748762 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.749104 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:46:40.749386 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:46:40.760999 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:46:40.762310 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:46:40.765189 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:46:40.765635 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:46:40.766392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m11:46:40.768942 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:46:40.769953 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:46:40.770188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:40.771219 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:40.771461 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:46:40.771652 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:46:40.774893 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:46:40.776128 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:46:40.776782 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:46:40.776980 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:46:40.777700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m11:46:40.779056 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:46:40.779351 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:46:40.779579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:40.781309 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:46:40.781571 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:46:40.781779 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:46:40.784922 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:46:40.786237 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:46:40.786999 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:46:40.787247 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:46:40.788963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fed5e86420>]}
[0m11:46:40.789338 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:40.789527 [debug] [MainThread]: On master: BEGIN
[0m11:46:40.789683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:40.790303 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:46:40.790512 [debug] [MainThread]: On master: COMMIT
[0m11:46:40.790701 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:40.790861 [debug] [MainThread]: On master: COMMIT
[0m11:46:40.791475 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:46:40.791843 [debug] [MainThread]: On master: Close
[0m11:46:40.795174 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m11:46:40.795604 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m11:46:40.796250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m11:46:40.796527 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m11:46:40.801909 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m11:46:40.803098 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m11:46:40.825773 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m11:46:40.826351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:46:40.826626 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m11:46:40.826868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:40.827615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.827878 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:46:40.828092 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m11:46:40.832386 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:46:40.836762 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:46:40.837164 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:46:40.838453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.839350 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:46:40.839587 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:46:40.842274 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:40.846949 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:46:40.847334 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m11:46:40.849036 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.851331 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:46:40.851667 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m11:46:40.853094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.865051 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:46:40.865499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:46:40.865742 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:46:40.873011 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:46:40.877400 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:46:40.877723 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m11:46:40.883154 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:40.885164 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m11:46:40.887291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb1942ff0>]}
[0m11:46:40.887814 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m11:46:40.888315 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m11:46:40.888622 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:46:40.889348 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:46:40.889736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m11:46:40.889980 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:46:40.891896 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.892392 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:46:40.895471 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.895967 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.896242 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:46:40.896460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:40.897209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.897470 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.897671 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:46:40.900025 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:40.901275 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.901714 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:46:40.902978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.903894 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.904149 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:46:40.905248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.907126 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.907361 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:46:40.907903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:40.909578 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.909836 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:46:40.910599 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:40.911945 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:46:40.912455 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.912680 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:46:40.918577 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:40.920405 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:46:40.920694 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:46:40.925785 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:40.927192 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:46:40.927983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb04740e0>]}
[0m11:46:40.928642 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m11:46:40.929077 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:46:40.929359 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:46:40.929899 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m11:46:40.930232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:46:40.930458 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:46:40.932554 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:46:40.933073 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:46:40.935159 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:46:40.935632 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:46:40.935891 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:46:40.936097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:40.936900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.937134 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:46:40.937381 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:46:40.947218 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m11:46:40.948307 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:46:40.948597 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:46:40.949585 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.950404 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:46:40.950636 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:46:40.951756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.953819 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:46:40.954089 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:46:40.955151 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.957132 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:46:40.957446 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:46:40.958223 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.959209 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:46:40.959464 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:46:40.959672 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:46:40.966311 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:40.968099 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:46:40.968436 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:46:40.973889 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:40.975299 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:46:40.976083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb1966150>]}
[0m11:46:40.976633 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m11:46:40.977085 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:46:40.977386 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:46:40.977827 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m11:46:40.978192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:46:40.978451 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:46:40.980552 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:46:40.980994 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:46:40.983073 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:46:40.983660 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:46:40.983924 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:46:40.984122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:40.985149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.985402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:46:40.985608 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:46:40.988458 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:46:40.989403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:46:40.989661 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:46:40.990534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.992668 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:46:40.992934 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:46:40.994365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:40.997069 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:46:40.997378 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:46:40.998184 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:40.999962 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:46:41.000325 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:46:41.001080 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:41.002080 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:46:41.002359 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:46:41.002576 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:46:41.008402 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:41.010075 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:46:41.010349 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:46:41.015664 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:41.016957 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:46:41.017858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb04ab710>]}
[0m11:46:41.018360 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m11:46:41.018817 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:46:41.019145 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:46:41.019711 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m11:46:41.020174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:46:41.020456 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:46:41.022458 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:46:41.023426 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:46:41.025482 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:46:41.025927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:46:41.026164 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:46:41.026365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.027108 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.027345 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:46:41.027544 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:46:41.030027 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:41.030897 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:46:41.031148 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:46:41.031934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.032855 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:46:41.033170 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:46:41.034465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.036752 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:46:41.037042 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:46:41.037774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:41.039609 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:46:41.039855 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:46:41.040423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:41.041351 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:46:41.041630 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:46:41.041839 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:46:41.047040 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:41.048751 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:46:41.049017 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:46:41.054341 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:41.055530 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:46:41.056223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb19404a0>]}
[0m11:46:41.056696 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:46:41.057119 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:46:41.057395 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:46:41.057755 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m11:46:41.058219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:46:41.058457 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:46:41.060365 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:46:41.060816 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:46:41.062820 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:46:41.063298 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:46:41.063555 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:46:41.063761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.064730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.064982 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:46:41.065196 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:46:41.067573 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:41.068507 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:46:41.068857 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:46:41.069912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.070933 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:46:41.071195 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:46:41.072239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.075428 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:46:41.075671 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:46:41.076368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:41.078005 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:46:41.078241 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:46:41.078761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:41.079576 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:46:41.079811 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:46:41.080001 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:46:41.086575 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:41.088326 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:46:41.088608 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:46:41.095305 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:41.097558 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:46:41.098868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb04c3f20>]}
[0m11:46:41.102061 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m11:46:41.103001 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:46:41.103727 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m11:46:41.104578 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m11:46:41.105517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m11:46:41.106153 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m11:46:41.109407 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m11:46:41.110267 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m11:46:41.113602 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m11:46:41.114518 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:46:41.114983 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m11:46:41.115380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.116654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.117170 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:46:41.117844 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m11:46:41.123098 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:41.124375 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:46:41.124713 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:46:41.125584 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.126519 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:46:41.126776 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:46:41.128130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.131757 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:46:41.132271 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m11:46:41.133462 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.136351 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:46:41.136802 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m11:46:41.137766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.139007 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:46:41.139362 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:46:41.139585 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:46:41.148289 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:46:41.150195 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:46:41.150489 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m11:46:41.157890 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:46:41.159839 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m11:46:41.161031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb1931010>]}
[0m11:46:41.161613 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.06s]
[0m11:46:41.162116 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m11:46:41.162469 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:46:41.162845 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:46:41.163304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m11:46:41.163614 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:46:41.165669 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:46:41.166410 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:46:41.168922 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:46:41.169572 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:46:41.169858 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:46:41.170107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.171068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.171396 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:46:41.171642 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:46:41.173042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.173940 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:46:41.174252 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:46:41.175260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.176399 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:46:41.176790 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:46:41.178076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.180539 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:46:41.180854 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:46:41.181699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.184752 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:46:41.185048 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:46:41.185759 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:41.186738 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:46:41.187050 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:46:41.187335 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:46:41.194124 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:41.195968 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:46:41.196326 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:46:41.202180 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:41.203804 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:46:41.204634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb049dc10>]}
[0m11:46:41.205207 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:46:41.205688 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:46:41.205997 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:46:41.206390 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:46:41.206825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m11:46:41.207138 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:46:41.209255 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:46:41.210389 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:46:41.212765 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:46:41.213311 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:46:41.213601 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:46:41.213866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.214960 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.215380 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:46:41.215742 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:46:41.217531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.218541 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:46:41.218848 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:46:41.219804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.221051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:46:41.221604 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:46:41.224277 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:41.226948 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:46:41.227261 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:46:41.228197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.230089 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:46:41.230370 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:46:41.231318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.232972 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:46:41.233392 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:46:41.233657 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:46:41.239595 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:41.242700 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:46:41.243289 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:46:41.250346 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:46:41.253253 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:46:41.254683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb19871d0>]}
[0m11:46:41.255945 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.05s]
[0m11:46:41.256805 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:46:41.257286 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:46:41.257910 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m11:46:41.258913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:46:41.259348 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:46:41.261900 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:46:41.262552 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:46:41.265072 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:46:41.265691 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:46:41.266010 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:46:41.266264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.267086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.267378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:46:41.267733 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:46:41.270897 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:46:41.272461 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:46:41.272828 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:46:41.274379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.275903 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:46:41.276350 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:46:41.277760 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.280276 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:46:41.280599 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:46:41.281374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.283526 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:46:41.283814 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:46:41.284889 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.286109 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:46:41.286403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:46:41.286682 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:46:41.292369 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:41.296213 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:46:41.296615 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:46:41.302397 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:41.303768 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:46:41.304706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb04e5520>]}
[0m11:46:41.305219 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.05s]
[0m11:46:41.305682 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:46:41.306050 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m11:46:41.306444 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m11:46:41.307051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m11:46:41.307383 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m11:46:41.310529 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.311781 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m11:46:41.314720 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.315431 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.315741 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m11:46:41.315960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.317059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.317392 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.317636 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m11:46:41.319017 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.319999 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.320350 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:46:41.322157 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.323375 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.323724 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:46:41.325248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.328618 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.329015 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m11:46:41.330035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.332367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.332674 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m11:46:41.333556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.334750 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:46:41.335059 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.335279 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:46:41.341760 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:41.345200 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:46:41.345656 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m11:46:41.351866 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:41.353412 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m11:46:41.354084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb19652b0>]}
[0m11:46:41.354618 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.05s]
[0m11:46:41.355065 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m11:46:41.355382 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:46:41.355884 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m11:46:41.356390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m11:46:41.356692 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:46:41.360299 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:46:41.361312 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:46:41.364006 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:46:41.364843 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:46:41.365571 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:46:41.365845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.366901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.367255 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:46:41.367624 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m11:46:41.400614 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m11:46:41.401648 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:46:41.401971 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:46:41.403122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.404291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:46:41.404573 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:46:41.405709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.408033 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:46:41.408467 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:46:41.409905 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.412560 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:46:41.412957 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:46:41.414101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.415437 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:46:41.415843 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:46:41.416082 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:46:41.424681 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:46:41.427913 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:46:41.428636 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:46:41.435487 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:41.437013 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:46:41.439463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb049a540>]}
[0m11:46:41.440060 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.08s]
[0m11:46:41.440603 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:46:41.440931 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m11:46:41.441336 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m11:46:41.441778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m11:46:41.442328 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m11:46:41.445609 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m11:46:41.447277 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m11:46:41.450529 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m11:46:41.451461 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:46:41.451896 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m11:46:41.452272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.453196 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.453466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:46:41.453717 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m11:46:41.458892 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:41.459882 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:46:41.460268 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:46:41.461656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.462937 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:46:41.463383 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:46:41.465254 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.468638 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:46:41.469145 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m11:46:41.470248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.472906 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:46:41.473563 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m11:46:41.474599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.475908 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:46:41.476381 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:46:41.476675 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:46:41.484053 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:46:41.486425 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:46:41.486847 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m11:46:41.493006 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:46:41.494789 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m11:46:41.496012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb0498e60>]}
[0m11:46:41.496633 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.05s]
[0m11:46:41.497188 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m11:46:41.497628 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:46:41.498013 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m11:46:41.499055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m11:46:41.499566 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:46:41.502676 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:46:41.503916 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:46:41.506507 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:46:41.507038 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:46:41.507329 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:46:41.507590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.508503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.508800 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:46:41.509114 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek in ((select * from gameweeks), (select * from gameweeks)+1, (select * from gameweeks)+2, (select * from gameweeks)+3)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 4 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 4 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        attacking_biases_value,
        defending_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:46:41.537316 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m11:46:41.538470 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:46:41.538785 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:46:41.539734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.541005 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:46:41.541316 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:46:41.542231 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.544458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:46:41.544743 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:46:41.545652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.548158 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:46:41.548719 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:46:41.549610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:41.550746 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:46:41.551070 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:46:41.551713 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:46:41.560274 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:46:41.562203 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:46:41.562509 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:46:41.569506 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:46:41.571084 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:46:41.574716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedf5185-d7f2-40cd-b7e0-1921bddfec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75feb040d370>]}
[0m11:46:41.575345 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.08s]
[0m11:46:41.575880 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:46:41.578004 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:41.578392 [debug] [MainThread]: On master: BEGIN
[0m11:46:41.578605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:41.579513 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:46:41.579817 [debug] [MainThread]: On master: COMMIT
[0m11:46:41.580060 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:41.580379 [debug] [MainThread]: On master: COMMIT
[0m11:46:41.581177 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:46:41.581529 [debug] [MainThread]: On master: Close
[0m11:46:41.582066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:41.582350 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:46:41.582745 [info ] [MainThread]: 
[0m11:46:41.583201 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m11:46:41.585174 [debug] [MainThread]: Command end result
[0m11:46:41.600457 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:46:41.602191 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:46:41.607183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:46:41.607552 [info ] [MainThread]: 
[0m11:46:41.607872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:41.608149 [info ] [MainThread]: 
[0m11:46:41.608457 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m11:46:41.610186 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.0633748, "process_in_blocks": "113400", "process_kernel_time": 0.48185, "process_mem_max_rss": "184956", "process_out_blocks": "4840", "process_user_time": 2.98512}
[0m11:46:41.610626 [debug] [MainThread]: Command `dbt build` succeeded at 11:46:41.610540 after 2.06 seconds
[0m11:46:41.610911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fec96e9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fed36d1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fed36d1a60>]}
[0m11:46:41.611195 [debug] [MainThread]: Flushing usage events
[0m11:46:42.184512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:02.317098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbc5495fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbc7c2e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbc546b800>]}


============================== 11:48:02.321667 | 9da8423d-1f7e-4285-9479-cd425e4af6ba ==============================
[0m11:48:02.321667 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:48:02.322104 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'static_parser': 'True', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build'}
[0m11:48:02.537533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbc54fb470>]}
[0m11:48:02.597218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbc583c9e0>]}
[0m11:48:02.599683 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:48:02.654768 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:48:02.763248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:02.763814 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m11:48:03.040004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbb81f3bf0>]}
[0m11:48:03.083711 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:48:03.085578 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:48:03.167852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbbb1d19a0>]}
[0m11:48:03.168237 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m11:48:03.170134 [info ] [MainThread]: 
[0m11:48:03.170511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:03.170795 [info ] [MainThread]: 
[0m11:48:03.171211 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:48:03.175548 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:48:03.207776 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:48:03.208129 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:48:03.208343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:03.236739 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m11:48:03.237854 [debug] [ThreadPool]: On list_analytics: Close
[0m11:48:03.239553 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:48:03.239923 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:48:03.240140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:03.241269 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:03.242103 [debug] [ThreadPool]: On list_analytics: Close
[0m11:48:03.243539 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:48:03.243817 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:48:03.244061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:03.245260 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:03.246064 [debug] [ThreadPool]: On list_analytics: Close
[0m11:48:03.246734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m11:48:03.247060 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:48:03.251671 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:48:03.251928 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:48:03.252182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:03.253243 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:03.254779 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:48:03.254983 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:48:03.255385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:03.255591 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:48:03.255751 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:48:03.256164 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:03.256719 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:48:03.256950 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:48:03.257127 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:48:03.258183 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:03.258415 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:48:03.258940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m11:48:03.259362 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:48:03.260521 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:48:03.260744 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:48:03.260919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:03.261787 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:03.262679 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:48:03.262898 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:48:03.263522 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:03.263875 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:48:03.264168 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:48:03.264925 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:03.265495 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:48:03.265697 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:48:03.265873 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:48:03.266292 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:03.266495 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:48:03.267001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m11:48:03.267334 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:48:03.268521 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:48:03.268751 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:48:03.268937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:03.269965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:03.271150 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:48:03.271408 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:48:03.271851 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:03.272063 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:48:03.272238 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:48:03.272713 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:03.273268 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:48:03.273475 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:48:03.273648 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:48:03.274291 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:03.274596 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:48:03.276656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m11:48:03.280702 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:48:03.280983 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:48:03.281166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:03.281996 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:03.282208 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:48:03.282376 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:48:03.291885 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m11:48:03.292973 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:48:03.294646 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:48:03.294906 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:48:03.295422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m11:48:03.297562 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:48:03.297816 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:48:03.298026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:03.299212 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:03.299481 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:48:03.299672 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:48:03.302735 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:48:03.303701 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:48:03.304281 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:48:03.304505 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:48:03.304988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m11:48:03.306853 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:48:03.307083 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:48:03.307261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:03.307789 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:03.308010 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:48:03.308196 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:48:03.310801 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:48:03.311775 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:48:03.312345 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:48:03.312542 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:48:03.313711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db673fbec0>]}
[0m11:48:03.314029 [debug] [MainThread]: Using duckdb connection "master"
[0m11:48:03.314209 [debug] [MainThread]: On master: BEGIN
[0m11:48:03.314363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:03.315184 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:48:03.315421 [debug] [MainThread]: On master: COMMIT
[0m11:48:03.315644 [debug] [MainThread]: Using duckdb connection "master"
[0m11:48:03.315814 [debug] [MainThread]: On master: COMMIT
[0m11:48:03.316201 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:48:03.316402 [debug] [MainThread]: On master: Close
[0m11:48:03.320091 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m11:48:03.320513 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m11:48:03.321059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m11:48:03.321313 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m11:48:03.326659 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m11:48:03.327945 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m11:48:03.350885 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m11:48:03.351547 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:03.351823 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m11:48:03.352025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.353158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.353446 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:03.353659 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m11:48:03.357335 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:48:03.361291 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:03.361638 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:48:03.362504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.363426 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:03.363656 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:48:03.366712 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:48:03.371247 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:03.371530 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m11:48:03.373076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.374893 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:03.375143 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m11:48:03.375689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.385539 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:48:03.385837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:03.386040 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:48:03.393566 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:03.397385 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:03.397650 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m11:48:03.408371 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m11:48:03.410990 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m11:48:03.413123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbb81da4b0>]}
[0m11:48:03.413583 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m11:48:03.414004 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m11:48:03.414326 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:48:03.414718 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:48:03.415483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m11:48:03.415811 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:48:03.417919 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.418431 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:48:03.421662 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.422219 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.422492 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:48:03.422747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.423498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.423717 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.423909 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:48:03.426166 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:48:03.427080 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.427371 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:48:03.428204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.429086 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.429339 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:48:03.430348 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.432709 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.432965 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:48:03.433829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.436260 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.436601 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:48:03.437669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.439143 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:48:03.439506 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.439729 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:48:03.445967 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:03.447886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:03.448168 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:48:03.453890 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.455474 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:48:03.456086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6411b020>]}
[0m11:48:03.456588 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m11:48:03.457012 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:48:03.457295 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:48:03.457620 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m11:48:03.457995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:48:03.458273 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:48:03.460337 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:48:03.461262 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:48:03.463338 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:48:03.463782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:03.464015 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:48:03.464219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.464901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.465124 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:03.465353 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:48:03.474054 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:48:03.475141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:03.475469 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:48:03.476700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.478049 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:03.478496 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:48:03.480022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.483099 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:03.483376 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:48:03.483983 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.485701 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:03.485952 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:48:03.486538 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.487527 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:48:03.487771 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:03.487963 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:48:03.495644 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:03.497466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:03.497739 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:48:03.503528 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.504778 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:48:03.505435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6411a5d0>]}
[0m11:48:03.505880 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m11:48:03.506299 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:48:03.506630 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:48:03.507190 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m11:48:03.507608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:48:03.507882 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:48:03.509920 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:48:03.510353 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:48:03.512326 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:48:03.512759 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:03.513021 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:48:03.513226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.513965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.514190 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:03.514402 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:48:03.516382 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:48:03.517171 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:03.517432 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:48:03.518158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.520386 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:03.520716 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:48:03.522000 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.524074 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:03.524316 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:48:03.525340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.527643 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:03.527903 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:48:03.528557 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.529389 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:48:03.529692 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:03.529883 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:48:03.535426 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.536903 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:03.537198 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:48:03.542410 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.543800 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:48:03.544593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db640fdd30>]}
[0m11:48:03.545050 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m11:48:03.545470 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:48:03.545757 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:48:03.546099 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m11:48:03.546466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:48:03.546761 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:48:03.548913 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:48:03.549439 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:48:03.551496 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:48:03.551953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:03.552195 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:48:03.552396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.553117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.553347 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:03.553554 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:48:03.556198 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:48:03.557219 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:03.557492 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:48:03.558350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.559347 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:03.559613 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:48:03.560856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.562922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:03.563175 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:48:03.563942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.566399 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:03.566724 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:48:03.567369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.568340 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:48:03.568598 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:03.568805 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:48:03.575009 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:03.576733 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:03.576979 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:48:03.582636 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.583706 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:48:03.584247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db673eda30>]}
[0m11:48:03.584820 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:48:03.585250 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:48:03.585584 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:48:03.585910 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m11:48:03.586263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:48:03.586570 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:48:03.588475 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:48:03.589016 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:48:03.591401 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:48:03.592111 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:03.592373 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:48:03.592578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.593315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.593557 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:03.593792 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:48:03.596572 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:48:03.597736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:03.598172 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:48:03.599242 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.600192 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:03.600454 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:48:03.601356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.604532 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:03.604784 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:48:03.605379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.607189 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:03.607452 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:48:03.608076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.608939 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:48:03.609236 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:03.609464 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:48:03.615818 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:03.617494 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:03.617768 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:48:03.622809 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.624281 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:48:03.625191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db641af230>]}
[0m11:48:03.625722 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m11:48:03.626178 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:48:03.626469 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m11:48:03.626844 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m11:48:03.627241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m11:48:03.627544 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m11:48:03.629532 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m11:48:03.630423 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m11:48:03.632471 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m11:48:03.632945 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:03.633230 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m11:48:03.633444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.634182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.634437 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:03.634680 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m11:48:03.638035 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:48:03.638864 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:03.639102 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:48:03.640135 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.641575 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:03.641844 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:48:03.643192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.645390 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:03.645663 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m11:48:03.646275 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.648087 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:03.648346 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m11:48:03.648877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.649795 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:48:03.650039 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:03.650278 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:48:03.661423 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m11:48:03.663232 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:03.663501 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m11:48:03.669325 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.671069 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m11:48:03.671706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6410fc80>]}
[0m11:48:03.672120 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m11:48:03.672548 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m11:48:03.672838 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:48:03.673169 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:48:03.673530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m11:48:03.673786 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:48:03.675665 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:48:03.676396 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:48:03.678484 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:48:03.679022 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:03.679244 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:48:03.679439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.680701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.680947 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:03.681140 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:48:03.682506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.683308 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:03.683535 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:48:03.684526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.685716 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:03.686000 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:48:03.686850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.688757 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:03.688986 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:48:03.689510 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.692730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:03.693091 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:48:03.694216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.695435 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:48:03.695740 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:03.696021 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:48:03.702664 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:03.704411 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:03.704690 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:48:03.710613 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.712411 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:48:03.713048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6418a6f0>]}
[0m11:48:03.713529 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:48:03.714002 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:48:03.714368 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:48:03.714761 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:48:03.715203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m11:48:03.715488 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:48:03.717741 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:48:03.718285 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:48:03.720146 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:48:03.720567 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:03.720800 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:48:03.720994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.721721 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.721935 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:03.722117 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:48:03.723220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.724031 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:03.724282 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:48:03.725029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.726173 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:03.726433 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:48:03.727846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.729932 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:03.730173 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:48:03.730893 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.732580 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:03.732825 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:48:03.733500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.734330 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:48:03.734603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:03.734823 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:48:03.741068 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:03.742673 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:03.742957 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:48:03.749454 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:03.751264 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:48:03.751934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db64103bc0>]}
[0m11:48:03.752430 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m11:48:03.752926 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:48:03.753225 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:48:03.753566 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m11:48:03.753983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:48:03.754270 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:48:03.756352 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:48:03.757118 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:48:03.759130 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:48:03.759656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:03.759921 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:48:03.760200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.761149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.761456 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:03.761721 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:48:03.764704 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:48:03.765594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:03.765829 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:48:03.766638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.767469 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:03.767696 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:48:03.768815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.771628 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:03.771883 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:48:03.772691 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.774822 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:03.775106 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:48:03.775672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.776568 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:48:03.776816 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:03.777047 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:48:03.784100 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:03.787119 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:03.787406 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:48:03.794249 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:03.795961 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:48:03.796817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db641d4830>]}
[0m11:48:03.797287 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m11:48:03.797734 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:48:03.798050 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m11:48:03.798378 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m11:48:03.799298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m11:48:03.799627 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m11:48:03.801696 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.803395 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m11:48:03.805612 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.806129 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.806388 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m11:48:03.806602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.807421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.807662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.807844 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m11:48:03.809393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.810725 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.811007 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:48:03.812009 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.813004 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.813266 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:48:03.814448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.816468 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.816704 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m11:48:03.817542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.819803 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.820053 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m11:48:03.820610 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.821508 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:48:03.821737 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.821920 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:48:03.828703 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:03.830712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:03.831019 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m11:48:03.836924 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:03.837942 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m11:48:03.838563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db641d42f0>]}
[0m11:48:03.839072 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m11:48:03.839503 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m11:48:03.839787 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:48:03.840099 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m11:48:03.840470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m11:48:03.840785 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:48:03.843254 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:48:03.844126 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:48:03.846217 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:48:03.846954 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:03.847209 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:48:03.847406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.848168 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.848416 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:03.848727 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m11:48:03.877091 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m11:48:03.878017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:03.878275 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:48:03.879126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.880201 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:03.880455 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:48:03.881705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.883805 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:03.884069 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:48:03.884845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.886512 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:03.886813 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:48:03.887440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.888338 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:48:03.888589 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:03.888790 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:48:03.896702 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:48:03.899631 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:03.899943 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:48:03.905317 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.906763 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:48:03.908812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db641dfdd0>]}
[0m11:48:03.909275 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.07s]
[0m11:48:03.909692 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:48:03.909976 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m11:48:03.910308 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m11:48:03.911017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m11:48:03.911313 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m11:48:03.913586 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m11:48:03.914543 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m11:48:03.916868 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m11:48:03.917379 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:03.917721 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m11:48:03.917945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.918722 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.918969 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:03.919186 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m11:48:03.924463 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.925709 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:03.926055 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:48:03.926954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.927795 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:03.928018 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:48:03.929075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.931375 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:03.931730 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m11:48:03.932518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.934263 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:03.934485 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m11:48:03.935092 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:03.935932 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:48:03.936157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:03.936337 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:48:03.943836 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:03.945638 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:03.945910 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m11:48:03.951668 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:03.953275 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m11:48:03.954441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db673f28a0>]}
[0m11:48:03.955111 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m11:48:03.955714 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m11:48:03.956017 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:48:03.956679 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m11:48:03.957210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m11:48:03.957478 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:48:03.960253 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:48:03.961434 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:48:03.963583 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:48:03.964036 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:03.964294 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:48:03.964563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:03.965336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:03.965582 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:03.965857 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek in >= (select * from gameweeks) and gameweek <= ((select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 3 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 3 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        attacking_biases_value,
        defending_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:48:03.973981 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek in >= (select * from gameweeks) and gameweek <= ((select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 3 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 3 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        attacking_biases_value,
        defending_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:48:03.974445 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:48:03.974827 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: ROLLBACK
[0m11:48:03.981181 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.obt_players'
[0m11:48:03.981470 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:48:03.983278 [debug] [Thread-1 (]: Runtime Error in model obt_players (fpl_analytics/models/core/obt_players.sql)
  Parser Error: syntax error at or near ">="
  
  LINE 58:     where gameweek in >= (select * from gameweeks) and gameweek <= ((select *...
                                 ^
[0m11:48:03.983675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da8423d-1f7e-4285-9479-cd425e4af6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db641349b0>]}
[0m11:48:03.984136 [error] [Thread-1 (]: 14 of 14 ERROR creating sql table model core.obt_players ....................... [[31mERROR[0m in 0.03s]
[0m11:48:03.984594 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:48:03.985278 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'error'.  Reason: Runtime Error in model obt_players (fpl_analytics/models/core/obt_players.sql)
  Parser Error: syntax error at or near ">="
  
  LINE 58:     where gameweek in >= (select * from gameweeks) and gameweek <= ((select *...
                                 ^.
[0m11:48:03.987254 [debug] [MainThread]: Using duckdb connection "master"
[0m11:48:03.987638 [debug] [MainThread]: On master: BEGIN
[0m11:48:03.987953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:48:03.988946 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:48:03.989206 [debug] [MainThread]: On master: COMMIT
[0m11:48:03.989404 [debug] [MainThread]: Using duckdb connection "master"
[0m11:48:03.989578 [debug] [MainThread]: On master: COMMIT
[0m11:48:03.990248 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:48:03.990679 [debug] [MainThread]: On master: Close
[0m11:48:03.991075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:03.991273 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:48:03.991530 [info ] [MainThread]: 
[0m11:48:03.991791 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m11:48:03.993140 [debug] [MainThread]: Command end result
[0m11:48:04.007628 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:48:04.009089 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:48:04.013341 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:48:04.013601 [info ] [MainThread]: 
[0m11:48:04.013851 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:48:04.014126 [info ] [MainThread]: 
[0m11:48:04.014437 [error] [MainThread]: [31mFailure in model obt_players (fpl_analytics/models/core/obt_players.sql)[0m
[0m11:48:04.014784 [error] [MainThread]:   Runtime Error in model obt_players (fpl_analytics/models/core/obt_players.sql)
  Parser Error: syntax error at or near ">="
  
  LINE 58:     where gameweek in >= (select * from gameweeks) and gameweek <= ((select *...
                                 ^
[0m11:48:04.015014 [info ] [MainThread]: 
[0m11:48:04.015300 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/core/obt_players.sql
[0m11:48:04.015527 [info ] [MainThread]: 
[0m11:48:04.015779 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=14
[0m11:48:04.017717 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.7530415, "process_in_blocks": "117336", "process_kernel_time": 0.330999, "process_mem_max_rss": "176492", "process_out_blocks": "4456", "process_user_time": 2.624349}
[0m11:48:04.018132 [debug] [MainThread]: Command `dbt build` failed at 11:48:04.018048 after 1.75 seconds
[0m11:48:04.018419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbc54f9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dbc5fdb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db64197c20>]}
[0m11:48:04.018757 [debug] [MainThread]: Flushing usage events
[0m11:48:04.703165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:15.220913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b6248380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b6224140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b60e33b0>]}


============================== 11:48:15.223652 | 6cf737fb-0312-47e9-9e47-adff4813b201 ==============================
[0m11:48:15.223652 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:48:15.224119 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt build', 'quiet': 'False'}
[0m11:48:15.413988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b60e38f0>]}
[0m11:48:15.474384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b5cd3230>]}
[0m11:48:15.475676 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:48:15.524743 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:48:15.592504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:15.593206 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m11:48:15.880182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1aaff3d40>]}
[0m11:48:15.927438 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:48:15.929081 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:48:15.998435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1ab2d9ee0>]}
[0m11:48:15.998885 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m11:48:16.000899 [info ] [MainThread]: 
[0m11:48:16.001320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:16.001579 [info ] [MainThread]: 
[0m11:48:16.002052 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:48:16.006296 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m11:48:16.031142 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:48:16.031531 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:48:16.031750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:16.051665 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m11:48:16.052890 [debug] [ThreadPool]: On list_analytics: Close
[0m11:48:16.054580 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:48:16.054878 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:48:16.055112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:16.056153 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:16.056989 [debug] [ThreadPool]: On list_analytics: Close
[0m11:48:16.058449 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m11:48:16.058744 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m11:48:16.058979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:16.059926 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:16.060687 [debug] [ThreadPool]: On list_analytics: Close
[0m11:48:16.061441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m11:48:16.061756 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m11:48:16.066330 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:48:16.066704 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:48:16.066957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:16.068009 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:16.069079 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:48:16.069303 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m11:48:16.069748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:16.069948 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:48:16.070119 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m11:48:16.070537 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:16.071121 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:48:16.071338 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m11:48:16.071510 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m11:48:16.071965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:16.072207 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m11:48:16.072708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m11:48:16.073032 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m11:48:16.074242 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:48:16.074503 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:48:16.074782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:16.075881 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:16.076685 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:48:16.076885 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m11:48:16.077294 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:16.077508 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:48:16.077693 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m11:48:16.078115 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:16.078691 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:48:16.078917 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m11:48:16.079097 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m11:48:16.079477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:16.079703 [debug] [ThreadPool]: On create_analytics_core: Close
[0m11:48:16.080208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m11:48:16.080567 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m11:48:16.081736 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:48:16.082002 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m11:48:16.082234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:16.083372 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:16.084318 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:48:16.084524 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m11:48:16.085264 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:16.085678 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:48:16.086079 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m11:48:16.087217 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:16.088159 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:48:16.088518 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m11:48:16.088953 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m11:48:16.089419 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:48:16.089643 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m11:48:16.091646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m11:48:16.095379 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:48:16.095666 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:48:16.095909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:16.096981 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:16.097209 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m11:48:16.097379 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m11:48:16.105629 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:48:16.106813 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:48:16.107621 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m11:48:16.107839 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:48:16.108330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m11:48:16.110412 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:48:16.110700 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m11:48:16.110944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:16.112222 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:16.112434 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m11:48:16.112606 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m11:48:16.115637 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:48:16.116779 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m11:48:16.117410 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m11:48:16.117629 [debug] [ThreadPool]: On list_analytics_core: Close
[0m11:48:16.118194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m11:48:16.119499 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:48:16.119774 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m11:48:16.120500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:16.121191 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:48:16.121424 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m11:48:16.121607 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m11:48:16.124550 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:48:16.125550 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m11:48:16.126132 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m11:48:16.126360 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m11:48:16.127551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b7b22150>]}
[0m11:48:16.127921 [debug] [MainThread]: Using duckdb connection "master"
[0m11:48:16.128113 [debug] [MainThread]: On master: BEGIN
[0m11:48:16.128269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:16.128855 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:48:16.129056 [debug] [MainThread]: On master: COMMIT
[0m11:48:16.129228 [debug] [MainThread]: Using duckdb connection "master"
[0m11:48:16.129461 [debug] [MainThread]: On master: COMMIT
[0m11:48:16.129880 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:48:16.130101 [debug] [MainThread]: On master: Close
[0m11:48:16.132904 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m11:48:16.133360 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m11:48:16.133963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_fixtures)
[0m11:48:16.134247 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m11:48:16.139612 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m11:48:16.140270 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m11:48:16.162308 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m11:48:16.163126 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:16.163509 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m11:48:16.163740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.164722 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.165026 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:16.165279 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m11:48:16.167429 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:48:16.171441 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:16.171795 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:48:16.172740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.173667 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:16.173917 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m11:48:16.175294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.181644 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:16.182050 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m11:48:16.183246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.185213 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:16.185483 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m11:48:16.186066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.196638 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:48:16.197053 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:16.197316 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m11:48:16.205009 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:16.209449 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m11:48:16.209789 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m11:48:16.216666 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.219570 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m11:48:16.221257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b7a4e810>]}
[0m11:48:16.221759 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m11:48:16.222230 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m11:48:16.222528 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m11:48:16.222977 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m11:48:16.224024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m11:48:16.224540 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m11:48:16.227406 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.227929 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m11:48:16.231197 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.231821 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.232108 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m11:48:16.232326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.233105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.233339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.233534 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m11:48:16.235248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.236551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.237049 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:48:16.238228 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.239246 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.239522 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m11:48:16.240696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.242816 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.243066 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m11:48:16.243640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.245353 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.245621 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m11:48:16.246320 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.247667 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:48:16.248063 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.248292 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m11:48:16.255321 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:16.257380 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m11:48:16.257725 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m11:48:16.264576 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.266025 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m11:48:16.266729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a15755dc10>]}
[0m11:48:16.267205 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m11:48:16.267660 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m11:48:16.268005 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m11:48:16.268354 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m11:48:16.268766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m11:48:16.269031 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m11:48:16.271271 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m11:48:16.272478 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m11:48:16.274761 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m11:48:16.275239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:16.275489 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m11:48:16.275694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.276438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.276666 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:16.276918 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m11:48:16.284122 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:16.285221 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:16.285534 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:48:16.286498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.287549 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:16.287794 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m11:48:16.289024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.291324 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:16.291615 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m11:48:16.292282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.294092 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:16.294347 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m11:48:16.295264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.296574 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:48:16.296825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:16.297059 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m11:48:16.304224 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:16.306224 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m11:48:16.306535 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m11:48:16.312086 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:16.313362 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m11:48:16.314138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a15708c9e0>]}
[0m11:48:16.314705 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m11:48:16.315143 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m11:48:16.315439 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m11:48:16.315806 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m11:48:16.316202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m11:48:16.316615 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m11:48:16.318713 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m11:48:16.319256 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m11:48:16.321370 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m11:48:16.321824 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:16.322062 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m11:48:16.322276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.323400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.323820 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:16.324213 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m11:48:16.326532 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:48:16.327442 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:16.327701 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:48:16.328504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.330751 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:16.331047 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m11:48:16.332245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.334550 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:16.334889 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m11:48:16.335668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.337484 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:16.337739 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m11:48:16.338401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.339327 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:48:16.339590 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:16.339808 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m11:48:16.345613 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.347377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m11:48:16.347672 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m11:48:16.353573 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:16.355194 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m11:48:16.356064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a15709bb60>]}
[0m11:48:16.356585 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m11:48:16.357002 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m11:48:16.357315 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m11:48:16.357645 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m11:48:16.358056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m11:48:16.358358 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m11:48:16.360635 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m11:48:16.361576 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m11:48:16.363791 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m11:48:16.364273 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:16.364522 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m11:48:16.364722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.365501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.365750 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:16.365964 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m11:48:16.368165 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:48:16.369518 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:16.370035 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:48:16.371517 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.372960 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:16.373451 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m11:48:16.374912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.377427 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:16.377821 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m11:48:16.378805 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.380711 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:16.380969 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m11:48:16.381574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.382422 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:48:16.382763 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:16.383012 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m11:48:16.388940 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.390824 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m11:48:16.391110 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m11:48:16.397208 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.398982 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m11:48:16.399668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1570b2cc0>]}
[0m11:48:16.400199 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m11:48:16.400671 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m11:48:16.400993 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m11:48:16.401373 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m11:48:16.401838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m11:48:16.402154 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m11:48:16.404286 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m11:48:16.405208 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m11:48:16.407679 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m11:48:16.408214 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:16.408563 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m11:48:16.408829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.409994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.410591 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:16.411131 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m11:48:16.413697 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:48:16.414536 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:16.414819 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:48:16.415621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.416497 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:16.416742 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m11:48:16.417975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.421591 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:16.421918 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m11:48:16.422686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.424546 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:16.424819 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m11:48:16.425441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.426420 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:48:16.426761 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:16.426990 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m11:48:16.432725 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:16.434555 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m11:48:16.434881 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m11:48:16.441336 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.443025 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m11:48:16.443671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a15713c860>]}
[0m11:48:16.444160 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m11:48:16.444632 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m11:48:16.444929 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m11:48:16.445308 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m11:48:16.445734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m11:48:16.446058 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m11:48:16.448235 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m11:48:16.449063 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m11:48:16.451183 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m11:48:16.451710 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:16.451979 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m11:48:16.452206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.453255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.453534 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:16.453775 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m11:48:16.455901 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:48:16.456737 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:16.456986 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:48:16.457757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.458612 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:16.458945 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m11:48:16.460293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.462813 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:16.463085 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m11:48:16.463828 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.465522 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:16.465757 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m11:48:16.466320 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.467187 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:48:16.467434 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:16.467653 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m11:48:16.475101 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:16.477081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m11:48:16.477396 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m11:48:16.483197 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.484379 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m11:48:16.485152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1575deb70>]}
[0m11:48:16.485628 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m11:48:16.486037 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m11:48:16.486339 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m11:48:16.486744 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m11:48:16.487354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m11:48:16.487643 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m11:48:16.489604 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m11:48:16.490106 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m11:48:16.492385 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m11:48:16.492883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:16.493145 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m11:48:16.493353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.494104 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.494343 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:16.494578 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m11:48:16.496122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.497061 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:16.497312 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:48:16.498090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.499018 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:16.499273 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m11:48:16.500339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.502611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:16.502965 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m11:48:16.503816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.506874 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:16.507166 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m11:48:16.508250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.510006 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:48:16.510493 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:16.510993 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m11:48:16.517930 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:16.519765 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m11:48:16.520094 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m11:48:16.526761 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.528011 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m11:48:16.528694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a15709d6a0>]}
[0m11:48:16.529165 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m11:48:16.529593 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m11:48:16.529910 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m11:48:16.530247 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m11:48:16.530681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m11:48:16.530961 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m11:48:16.533119 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m11:48:16.534407 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m11:48:16.536587 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m11:48:16.537080 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:16.537405 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m11:48:16.537661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.538653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.538906 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:16.539107 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m11:48:16.540382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.541177 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:16.541410 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:48:16.542138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.543245 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:16.543491 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m11:48:16.544672 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.546695 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:16.546957 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m11:48:16.548002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.550970 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:16.551268 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m11:48:16.552347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.553450 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:48:16.553792 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:16.554013 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m11:48:16.560862 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:16.562704 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m11:48:16.562988 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m11:48:16.569656 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.570843 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m11:48:16.571463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1570c1850>]}
[0m11:48:16.571947 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m11:48:16.572386 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m11:48:16.572688 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m11:48:16.573057 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m11:48:16.573471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m11:48:16.573769 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m11:48:16.575802 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m11:48:16.576549 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m11:48:16.578785 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m11:48:16.579348 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:16.579668 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m11:48:16.579876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.580664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.580907 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:16.581112 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m11:48:16.582670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.583536 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:16.583843 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:48:16.584650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.585554 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:16.585818 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m11:48:16.587047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.589458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:16.589744 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m11:48:16.590641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.592611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:16.592870 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m11:48:16.593432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.594460 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:48:16.594773 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:16.595029 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m11:48:16.600710 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:16.603668 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m11:48:16.603986 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m11:48:16.610601 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.612257 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m11:48:16.613180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a15717bbf0>]}
[0m11:48:16.613729 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m11:48:16.614168 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m11:48:16.614485 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m11:48:16.614871 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m11:48:16.615268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m11:48:16.615547 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m11:48:16.617645 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.618520 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m11:48:16.620749 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.621302 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.621560 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m11:48:16.621784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.622774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.623084 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.623304 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m11:48:16.624739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.625609 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.625868 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:48:16.626705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.627662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.627913 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m11:48:16.628896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.631032 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.631289 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m11:48:16.632118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.635092 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.635438 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m11:48:16.636121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.637001 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:48:16.637264 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.637462 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m11:48:16.644555 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:48:16.646686 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m11:48:16.647031 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m11:48:16.652802 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:16.653999 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m11:48:16.654654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a15716f140>]}
[0m11:48:16.655151 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m11:48:16.655622 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m11:48:16.655930 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m11:48:16.656530 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m11:48:16.656983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m11:48:16.657246 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m11:48:16.659723 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m11:48:16.660295 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m11:48:16.662315 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m11:48:16.662952 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:16.663225 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m11:48:16.663424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.664212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.664454 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:16.664736 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m11:48:16.684869 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m11:48:16.686081 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:16.686464 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:48:16.687816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.689105 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:16.689417 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m11:48:16.690720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.693052 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:16.693367 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m11:48:16.694390 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.696309 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:16.696602 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m11:48:16.697302 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.698268 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:48:16.698618 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:16.698880 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m11:48:16.706790 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:48:16.709839 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m11:48:16.710249 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m11:48:16.716114 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.717311 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m11:48:16.719582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a157113200>]}
[0m11:48:16.720157 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.06s]
[0m11:48:16.720598 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m11:48:16.720907 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m11:48:16.721245 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m11:48:16.722194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m11:48:16.722925 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m11:48:16.726482 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m11:48:16.727275 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m11:48:16.729559 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m11:48:16.730043 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:16.730317 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m11:48:16.730522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.731370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.731605 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:16.731838 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m11:48:16.736840 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:16.738239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:16.738741 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:48:16.739617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.740481 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:16.740724 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m11:48:16.741545 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.743814 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:16.744157 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m11:48:16.745185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.747141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:16.747394 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m11:48:16.747990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:48:16.748905 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:48:16.749240 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:16.749465 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m11:48:16.757768 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:48:16.759848 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m11:48:16.760280 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m11:48:16.765869 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:48:16.767117 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m11:48:16.768065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a15708f200>]}
[0m11:48:16.768565 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.05s]
[0m11:48:16.769032 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m11:48:16.769364 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m11:48:16.769877 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m11:48:16.770322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m11:48:16.770815 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m11:48:16.773638 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m11:48:16.774121 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m11:48:16.776371 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m11:48:16.776946 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:16.777222 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m11:48:16.777461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:16.778313 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.778581 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:16.778914 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek >= (select * from gameweeks) and gameweek <= ((select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 3 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 3 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        attacking_biases_value,
        defending_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m11:48:16.802653 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:48:16.803808 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:16.804130 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:48:16.805335 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.806316 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:16.806604 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m11:48:16.807862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.810051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:16.810353 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m11:48:16.811203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.813359 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:16.813617 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m11:48:16.814863 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:48:16.815856 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:48:16.816163 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:16.816374 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m11:48:16.825043 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:48:16.827065 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m11:48:16.827383 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m11:48:16.833501 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:48:16.834756 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m11:48:16.837529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf737fb-0312-47e9-9e47-adff4813b201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a15708ea80>]}
[0m11:48:16.838026 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.07s]
[0m11:48:16.838449 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m11:48:16.840303 [debug] [MainThread]: Using duckdb connection "master"
[0m11:48:16.840577 [debug] [MainThread]: On master: BEGIN
[0m11:48:16.840761 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:48:16.841957 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:48:16.842290 [debug] [MainThread]: On master: COMMIT
[0m11:48:16.842596 [debug] [MainThread]: Using duckdb connection "master"
[0m11:48:16.842822 [debug] [MainThread]: On master: COMMIT
[0m11:48:16.843544 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:48:16.843955 [debug] [MainThread]: On master: Close
[0m11:48:16.844513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:16.844992 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m11:48:16.845357 [info ] [MainThread]: 
[0m11:48:16.845703 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m11:48:16.847270 [debug] [MainThread]: Command end result
[0m11:48:16.861686 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m11:48:16.863546 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m11:48:16.868236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m11:48:16.868569 [info ] [MainThread]: 
[0m11:48:16.868887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:16.869214 [info ] [MainThread]: 
[0m11:48:16.869499 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m11:48:16.870435 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7036895, "process_in_blocks": "1296", "process_kernel_time": 0.259725, "process_mem_max_rss": "184060", "process_out_blocks": "4808", "process_user_time": 2.565774}
[0m11:48:16.870819 [debug] [MainThread]: Command `dbt build` succeeded at 11:48:16.870740 after 1.70 seconds
[0m11:48:16.871080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b78e58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1571002c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b5944590>]}
[0m11:48:16.871379 [debug] [MainThread]: Flushing usage events
[0m11:48:17.462216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:07.072476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c0b7cd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c0b227cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c0b360080>]}


============================== 12:00:07.076895 | 674c75aa-6cbb-40b5-b9a7-1164fea29ae4 ==============================
[0m12:00:07.076895 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:00:07.077491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'cache_selected_only': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'target_path': 'None', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt build', 'write_json': 'True', 'no_print': 'None'}
[0m12:00:07.283603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c0bf599d0>]}
[0m12:00:07.351994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c0ad89850>]}
[0m12:00:07.355605 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:00:07.410589 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:00:07.508359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:07.508724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:07.533689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c010b4bf0>]}
[0m12:00:07.579732 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m12:00:07.581103 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m12:00:07.614449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c00cffb90>]}
[0m12:00:07.614917 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m12:00:07.617125 [info ] [MainThread]: 
[0m12:00:07.617607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:07.617895 [info ] [MainThread]: 
[0m12:00:07.618416 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:00:07.623130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m12:00:07.654407 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:00:07.654835 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:00:07.655056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:07.674372 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:00:07.675466 [debug] [ThreadPool]: On list_analytics: Close
[0m12:00:07.677300 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:00:07.677586 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:00:07.677818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:07.678999 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.679810 [debug] [ThreadPool]: On list_analytics: Close
[0m12:00:07.681163 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:00:07.681422 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:00:07.681653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:07.682659 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.683491 [debug] [ThreadPool]: On list_analytics: Close
[0m12:00:07.684280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m12:00:07.684590 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m12:00:07.688731 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:00:07.688967 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:00:07.689134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:07.690119 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.691033 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:00:07.691251 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m12:00:07.691969 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:07.692380 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:00:07.692729 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m12:00:07.693847 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.694497 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m12:00:07.694707 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:00:07.694869 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m12:00:07.695306 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:07.695556 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m12:00:07.696125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m12:00:07.696457 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m12:00:07.697688 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:00:07.697963 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:00:07.698179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:07.699154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.700096 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:00:07.700327 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m12:00:07.701210 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.701716 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:00:07.702048 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m12:00:07.702789 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:07.703389 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m12:00:07.703681 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:00:07.703883 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m12:00:07.704301 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:07.704527 [debug] [ThreadPool]: On create_analytics_core: Close
[0m12:00:07.705091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m12:00:07.705533 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m12:00:07.706733 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:00:07.706988 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:00:07.707206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:07.708256 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.709128 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:00:07.709329 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m12:00:07.709759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:07.709948 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:00:07.710099 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m12:00:07.710506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:07.711070 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m12:00:07.711259 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:00:07.711421 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m12:00:07.711992 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:07.712220 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m12:00:07.714079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m12:00:07.717641 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m12:00:07.717928 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m12:00:07.718143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:07.718769 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.718968 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m12:00:07.719130 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m12:00:07.729178 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:00:07.730264 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m12:00:07.732565 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m12:00:07.732892 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m12:00:07.733471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m12:00:07.734719 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m12:00:07.734987 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m12:00:07.735206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:07.736421 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.736640 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m12:00:07.736810 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m12:00:07.739635 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:00:07.740611 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m12:00:07.741162 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m12:00:07.741343 [debug] [ThreadPool]: On list_analytics_core: Close
[0m12:00:07.741789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m12:00:07.743805 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m12:00:07.744065 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m12:00:07.744283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:07.745369 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:07.745583 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m12:00:07.745757 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m12:00:07.749215 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:00:07.750209 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m12:00:07.750741 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m12:00:07.750960 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m12:00:07.752521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c06b592b0>]}
[0m12:00:07.752874 [debug] [MainThread]: Using duckdb connection "master"
[0m12:00:07.753057 [debug] [MainThread]: On master: BEGIN
[0m12:00:07.753206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:07.753758 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:00:07.753969 [debug] [MainThread]: On master: COMMIT
[0m12:00:07.754124 [debug] [MainThread]: Using duckdb connection "master"
[0m12:00:07.754326 [debug] [MainThread]: On master: COMMIT
[0m12:00:07.754726 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:00:07.754916 [debug] [MainThread]: On master: Close
[0m12:00:07.759935 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m12:00:07.760419 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m12:00:07.760848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m12:00:07.761104 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m12:00:07.766637 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m12:00:07.767348 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m12:00:07.789906 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m12:00:07.790624 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:07.790936 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m12:00:07.791145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:07.792287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.792817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:07.793122 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m12:00:07.796403 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:00:07.800712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:07.801134 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m12:00:07.802571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.804048 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:07.804315 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m12:00:07.805932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.810418 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:07.810745 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m12:00:07.811607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.813474 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:07.813737 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m12:00:07.814313 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:07.824371 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m12:00:07.824720 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:07.825052 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m12:00:07.832414 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:00:07.836621 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:07.836936 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m12:00:07.842819 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:07.845089 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m12:00:07.847256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c010b6d80>]}
[0m12:00:07.847869 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m12:00:07.848333 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m12:00:07.848652 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m12:00:07.849021 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m12:00:07.849664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m12:00:07.850107 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m12:00:07.852124 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.853461 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m12:00:07.855775 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.856261 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.856497 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m12:00:07.856687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:07.857455 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.857728 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.857966 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m12:00:07.860737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:00:07.861702 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.861965 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m12:00:07.863041 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.864094 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.864380 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m12:00:07.865815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.869242 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.869612 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m12:00:07.870423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.922692 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.923073 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m12:00:07.924314 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.925586 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m12:00:07.925885 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.926102 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m12:00:07.931062 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:07.932969 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:07.933286 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m12:00:07.938805 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:07.940447 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m12:00:07.941167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774bfa9c93a0>]}
[0m12:00:07.941640 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.09s]
[0m12:00:07.942123 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m12:00:07.942429 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m12:00:07.942782 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m12:00:07.943240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m12:00:07.943524 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m12:00:07.945797 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m12:00:07.946759 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m12:00:07.949037 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m12:00:07.949661 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:07.949946 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m12:00:07.950153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:07.950952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.951208 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:07.951479 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m12:00:07.962486 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:00:07.963551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:07.964016 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m12:00:07.965512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.966755 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:07.967052 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m12:00:07.968283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.970624 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:07.970965 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m12:00:07.972087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.974496 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:07.974825 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m12:00:07.975673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:07.976634 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m12:00:07.976909 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:07.977113 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m12:00:07.984869 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:00:07.986845 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:07.987159 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m12:00:07.993756 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:00:07.994998 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m12:00:07.996549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c06b137a0>]}
[0m12:00:07.997267 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m12:00:07.997759 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m12:00:07.998070 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m12:00:07.998425 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m12:00:07.998813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m12:00:07.999149 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m12:00:08.001364 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m12:00:08.002040 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m12:00:08.004434 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m12:00:08.005017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:08.005295 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m12:00:08.005496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.006689 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.007159 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:08.007583 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m12:00:08.009926 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:00:08.010878 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:08.011161 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m12:00:08.012365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.014068 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:08.014545 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m12:00:08.016301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.018754 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:08.019083 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m12:00:08.019950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.023061 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:08.023351 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m12:00:08.024420 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.025614 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m12:00:08.025962 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:08.026179 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m12:00:08.031597 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.033360 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:08.033649 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m12:00:08.038651 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.040035 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m12:00:08.040656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774bfa952870>]}
[0m12:00:08.041150 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m12:00:08.041607 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m12:00:08.041904 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m12:00:08.042250 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m12:00:08.042677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m12:00:08.042980 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m12:00:08.045115 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m12:00:08.045964 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m12:00:08.048413 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m12:00:08.049210 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:08.049548 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m12:00:08.049808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.050919 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.051196 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:08.051414 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m12:00:08.053162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.054055 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:08.054396 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m12:00:08.055436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.056558 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:08.056917 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m12:00:08.058148 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.060652 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:08.061033 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m12:00:08.062007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.064204 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:08.064571 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m12:00:08.065476 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.066560 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m12:00:08.066867 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:08.067193 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m12:00:08.072583 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.074586 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:08.074893 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m12:00:08.080500 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.081916 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m12:00:08.082780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774bfaa2da90>]}
[0m12:00:08.083267 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m12:00:08.083820 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m12:00:08.084136 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m12:00:08.084481 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m12:00:08.085167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m12:00:08.085410 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m12:00:08.087476 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m12:00:08.087991 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m12:00:08.090016 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m12:00:08.090449 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:08.090694 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m12:00:08.090896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.091717 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.091953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:08.092162 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m12:00:08.093864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.094628 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:08.094867 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m12:00:08.095586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.096473 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:08.096730 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m12:00:08.097827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.100012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:08.100346 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m12:00:08.101146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.103007 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:08.103271 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m12:00:08.104063 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.105094 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m12:00:08.105364 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:08.105578 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m12:00:08.111324 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.114233 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:08.114579 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m12:00:08.119880 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.121040 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m12:00:08.121866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774bfa99fe00>]}
[0m12:00:08.122328 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m12:00:08.122776 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m12:00:08.123074 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m12:00:08.123425 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m12:00:08.123876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m12:00:08.124176 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m12:00:08.126304 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m12:00:08.126904 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m12:00:08.129014 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m12:00:08.129846 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:08.130116 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m12:00:08.130335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.131089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.131340 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:08.131634 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m12:00:08.135402 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:00:08.136489 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:08.136816 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m12:00:08.137758 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.138782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:08.139049 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m12:00:08.140168 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.142492 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:08.142789 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m12:00:08.143546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.145515 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:08.145787 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m12:00:08.146709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.147953 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m12:00:08.148294 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:08.148527 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m12:00:08.154470 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:00:08.156486 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:08.156787 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m12:00:08.162013 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.163286 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m12:00:08.163958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c010b4980>]}
[0m12:00:08.164429 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m12:00:08.164886 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m12:00:08.165184 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m12:00:08.165545 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m12:00:08.165953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m12:00:08.166304 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m12:00:08.168726 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m12:00:08.169256 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m12:00:08.171339 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m12:00:08.171846 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:08.172111 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m12:00:08.172325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.173041 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.173270 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:08.173480 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m12:00:08.174798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.175978 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:08.176430 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m12:00:08.177622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.178881 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:08.179321 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m12:00:08.180499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.182495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:08.182762 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m12:00:08.183334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.185495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:08.185791 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m12:00:08.186474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.187392 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m12:00:08.187668 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:08.187875 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m12:00:08.193072 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.194668 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:08.194937 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m12:00:08.199627 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:00:08.202444 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m12:00:08.203070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774bc517c260>]}
[0m12:00:08.203537 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m12:00:08.204017 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m12:00:08.204326 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m12:00:08.204678 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m12:00:08.205076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m12:00:08.205354 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m12:00:08.207188 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m12:00:08.207763 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m12:00:08.210178 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m12:00:08.210647 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:08.210886 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m12:00:08.211081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.211982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.212241 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:08.212454 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m12:00:08.213704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.214466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:08.214713 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m12:00:08.215420 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.216317 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:08.216569 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m12:00:08.217516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.219973 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:08.220301 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m12:00:08.221102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.222948 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:08.223232 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m12:00:08.223852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.224765 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m12:00:08.225014 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:08.225218 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m12:00:08.230076 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.231563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:08.231918 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m12:00:08.236840 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.237981 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m12:00:08.238760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774bc5178a70>]}
[0m12:00:08.239237 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.03s]
[0m12:00:08.239726 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m12:00:08.240026 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m12:00:08.240361 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m12:00:08.240764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m12:00:08.241137 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m12:00:08.243176 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m12:00:08.243660 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m12:00:08.245551 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m12:00:08.245991 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:08.246233 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m12:00:08.246432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.247146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.247372 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:08.247620 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m12:00:08.249448 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:00:08.250243 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:08.250490 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m12:00:08.251194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.252292 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:08.252571 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m12:00:08.253890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.256128 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:08.256404 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m12:00:08.257138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.258868 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:08.259122 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m12:00:08.259759 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.260657 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m12:00:08.260912 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:08.261131 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m12:00:08.266345 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.267917 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:08.268185 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m12:00:08.273604 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.275190 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m12:00:08.276076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c06b5b4d0>]}
[0m12:00:08.276591 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m12:00:08.277049 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m12:00:08.277358 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m12:00:08.277706 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m12:00:08.278093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m12:00:08.278621 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m12:00:08.281916 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.282421 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m12:00:08.284317 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.284823 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.285067 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m12:00:08.285271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.286001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.286301 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.286535 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m12:00:08.287993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.288885 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.289153 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m12:00:08.290006 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.290909 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.291167 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m12:00:08.292053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.294148 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.294408 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m12:00:08.294995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.296803 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.297064 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m12:00:08.297608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.298526 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m12:00:08.298777 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.298982 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m12:00:08.304737 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.306531 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:08.306814 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m12:00:08.312493 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.313435 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m12:00:08.313948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c0128f8c0>]}
[0m12:00:08.314436 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m12:00:08.314952 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m12:00:08.315267 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m12:00:08.315643 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m12:00:08.316157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m12:00:08.316452 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m12:00:08.318684 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m12:00:08.319118 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m12:00:08.321254 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m12:00:08.321965 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:00:08.322238 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m12:00:08.322445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.323468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.323760 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:00:08.324065 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m12:00:08.342795 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m12:00:08.343357 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:00:08.343814 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m12:00:08.350134 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m12:00:08.350428 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m12:00:08.352404 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Invalid Input Error: More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.
  
  Use "SET scalar_subquery_error_on_multiple_rows=false" to revert to previous behavior of returning a random row.
[0m12:00:08.352783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774bfa94a4e0>]}
[0m12:00:08.353256 [error] [Thread-1 (]: 12 of 14 ERROR creating sql table model intermediate.int_players ............... [[31mERROR[0m in 0.04s]
[0m12:00:08.353732 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m12:00:08.354023 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m12:00:08.354367 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m12:00:08.354816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m12:00:08.355287 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Invalid Input Error: More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.
  
  Use "SET scalar_subquery_error_on_multiple_rows=false" to revert to previous behavior of returning a random row..
[0m12:00:08.355844 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m12:00:08.359036 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m12:00:08.359532 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m12:00:08.361454 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m12:00:08.361883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:08.362142 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m12:00:08.362383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:08.363115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.363347 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:08.363602 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m12:00:08.369473 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.370790 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:08.371245 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m12:00:08.372603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.373721 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:08.374073 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m12:00:08.375428 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.377650 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:08.377950 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m12:00:08.378842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:08.380974 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:08.381269 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m12:00:08.381863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:08.382774 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m12:00:08.383022 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:08.383261 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m12:00:08.389471 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:00:08.392677 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:08.392970 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m12:00:08.398171 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:00:08.399757 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m12:00:08.400596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674c75aa-6cbb-40b5-b9a7-1164fea29ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774bc51b8320>]}
[0m12:00:08.401041 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.05s]
[0m12:00:08.401573 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m12:00:08.401870 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m12:00:08.402151 [info ] [Thread-1 (]: 14 of 14 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m12:00:08.402573 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m12:00:08.402843 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m12:00:08.404153 [debug] [MainThread]: Using duckdb connection "master"
[0m12:00:08.404479 [debug] [MainThread]: On master: BEGIN
[0m12:00:08.404669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:08.405339 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:00:08.405587 [debug] [MainThread]: On master: COMMIT
[0m12:00:08.405847 [debug] [MainThread]: Using duckdb connection "master"
[0m12:00:08.406021 [debug] [MainThread]: On master: COMMIT
[0m12:00:08.406797 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:00:08.407197 [debug] [MainThread]: On master: Close
[0m12:00:08.407708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:08.407923 [debug] [MainThread]: Connection 'model.fpl_analytics.fact_fixtures' was properly closed.
[0m12:00:08.408196 [info ] [MainThread]: 
[0m12:00:08.408474 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m12:00:08.409905 [debug] [MainThread]: Command end result
[0m12:00:08.421753 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m12:00:08.423441 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m12:00:08.428295 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m12:00:08.428616 [info ] [MainThread]: 
[0m12:00:08.428948 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:00:08.429271 [info ] [MainThread]: 
[0m12:00:08.429590 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m12:00:08.429899 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Invalid Input Error: More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.
  
  Use "SET scalar_subquery_error_on_multiple_rows=false" to revert to previous behavior of returning a random row.
[0m12:00:08.430129 [info ] [MainThread]: 
[0m12:00:08.430411 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m12:00:08.430619 [info ] [MainThread]: 
[0m12:00:08.430900 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m12:00:08.432333 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4110383, "process_in_blocks": "34680", "process_kernel_time": 0.266155, "process_mem_max_rss": "168452", "process_out_blocks": "3960", "process_user_time": 2.221819}
[0m12:00:08.432701 [debug] [MainThread]: Command `dbt build` failed at 12:00:08.432625 after 1.41 seconds
[0m12:00:08.432977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c0b60d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c0b60c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774c0b6fde50>]}
[0m12:00:08.433233 [debug] [MainThread]: Flushing usage events
[0m12:00:09.083292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:35.399235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79811231c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798112247b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798111dd1100>]}


============================== 12:00:35.401998 | e136d2fc-0e12-42af-b789-29fd4381d872 ==============================
[0m12:00:35.401998 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:00:35.402456 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'profiles_dir': '/home/robgriffin247/fpl', 'log_path': '/home/robgriffin247/fpl/logs', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'version_check': 'True'}
[0m12:00:35.594129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981111d69f0>]}
[0m12:00:35.653944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981121cc410>]}
[0m12:00:35.655168 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:00:35.705538 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:00:35.775168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:35.775475 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:35.799545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981075aecf0>]}
[0m12:00:35.844517 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m12:00:35.845919 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m12:00:35.863953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79810739ac90>]}
[0m12:00:35.864408 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m12:00:35.866543 [info ] [MainThread]: 
[0m12:00:35.866982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:35.867230 [info ] [MainThread]: 
[0m12:00:35.867725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:00:35.871902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m12:00:35.898391 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:00:35.898836 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:00:35.899088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:35.922561 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:00:35.923822 [debug] [ThreadPool]: On list_analytics: Close
[0m12:00:35.925825 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:00:35.926432 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:00:35.926684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:35.927737 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:35.928673 [debug] [ThreadPool]: On list_analytics: Close
[0m12:00:35.930237 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:00:35.930512 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:00:35.930751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:35.931988 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:35.932837 [debug] [ThreadPool]: On list_analytics: Close
[0m12:00:35.933525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m12:00:35.933866 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m12:00:35.938584 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:00:35.938874 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:00:35.939058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:35.940429 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:35.941720 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:00:35.941997 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m12:00:35.942866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:35.943117 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:00:35.943299 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m12:00:35.943817 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:35.944632 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m12:00:35.944927 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:00:35.945103 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m12:00:35.951259 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m12:00:35.951738 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m12:00:35.952423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m12:00:35.952865 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m12:00:35.954147 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:00:35.954385 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:00:35.954598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:35.955658 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:35.956666 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:00:35.956897 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m12:00:35.957418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:35.957669 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:00:35.957865 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m12:00:35.958321 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:35.958886 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m12:00:35.959079 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:00:35.959282 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m12:00:35.964542 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m12:00:35.964893 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m12:00:35.965509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m12:00:35.965862 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m12:00:35.967117 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:00:35.967380 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:00:35.967621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:35.968934 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:35.969904 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:00:35.970202 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m12:00:35.970645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:35.970854 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:00:35.971035 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m12:00:35.971764 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:00:35.972654 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m12:00:35.972900 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:00:35.973124 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m12:00:35.979116 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m12:00:35.979707 [debug] [ThreadPool]: On create_analytics_core: Close
[0m12:00:35.981806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_intermediate)
[0m12:00:35.985594 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m12:00:35.985883 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m12:00:35.986109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:35.987018 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:35.987242 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m12:00:35.987418 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m12:00:35.995816 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:00:35.996879 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m12:00:35.997782 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m12:00:35.998013 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m12:00:35.998563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m12:00:35.999742 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m12:00:35.999988 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m12:00:36.000203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:36.000881 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:36.001114 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m12:00:36.001308 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m12:00:36.004115 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:00:36.005575 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m12:00:36.006494 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m12:00:36.006809 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m12:00:36.007599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m12:00:36.009643 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m12:00:36.009952 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m12:00:36.010184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:36.010824 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:00:36.011015 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m12:00:36.011171 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m12:00:36.013858 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:00:36.014865 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m12:00:36.015423 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m12:00:36.015616 [debug] [ThreadPool]: On list_analytics_core: Close
[0m12:00:36.016566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981077331a0>]}
[0m12:00:36.016912 [debug] [MainThread]: Using duckdb connection "master"
[0m12:00:36.017100 [debug] [MainThread]: On master: BEGIN
[0m12:00:36.017251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:36.017766 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:00:36.017968 [debug] [MainThread]: On master: COMMIT
[0m12:00:36.018124 [debug] [MainThread]: Using duckdb connection "master"
[0m12:00:36.018292 [debug] [MainThread]: On master: COMMIT
[0m12:00:36.018679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:00:36.018882 [debug] [MainThread]: On master: Close
[0m12:00:36.021586 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m12:00:36.022032 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m12:00:36.022418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_fixtures)
[0m12:00:36.022651 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m12:00:36.028031 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m12:00:36.028680 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m12:00:36.049822 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m12:00:36.050443 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:36.050707 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m12:00:36.050919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.051715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.051972 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:36.052206 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m12:00:36.054845 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:00:36.059601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:36.059960 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m12:00:36.060909 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.069811 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m12:00:36.070144 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:36.070366 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m12:00:36.078471 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:00:36.082782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:00:36.083097 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m12:00:36.083790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.085631 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m12:00:36.087051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798113a7aff0>]}
[0m12:00:36.087509 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.06s]
[0m12:00:36.087938 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m12:00:36.088359 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m12:00:36.088727 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m12:00:36.089142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m12:00:36.089396 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m12:00:36.091480 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m12:00:36.092904 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m12:00:36.094915 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m12:00:36.095478 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:36.095754 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m12:00:36.095955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.096894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.097141 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:36.097354 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m12:00:36.098959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.100919 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:36.101180 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m12:00:36.101802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.102793 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m12:00:36.103065 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:36.103323 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m12:00:36.110435 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:00:36.113357 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:00:36.113705 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m12:00:36.114496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.115419 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m12:00:36.115986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981065b6de0>]}
[0m12:00:36.116426 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.03s]
[0m12:00:36.116855 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m12:00:36.117158 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m12:00:36.117479 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m12:00:36.117836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m12:00:36.118120 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m12:00:36.120027 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m12:00:36.121347 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m12:00:36.177527 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m12:00:36.178159 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:36.178450 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m12:00:36.178708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.179407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.179625 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:36.179844 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m12:00:36.190655 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:00:36.192762 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:36.193027 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m12:00:36.194153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.195071 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m12:00:36.195324 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:36.195519 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m12:00:36.203775 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:00:36.205622 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:00:36.205920 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m12:00:36.206615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.207592 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m12:00:36.208305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981112ab890>]}
[0m12:00:36.208749 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.09s]
[0m12:00:36.209174 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m12:00:36.209458 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m12:00:36.209806 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m12:00:36.210267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m12:00:36.210743 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m12:00:36.212886 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m12:00:36.213435 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m12:00:36.215495 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m12:00:36.215963 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:36.216260 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m12:00:36.216501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.217291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.217525 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:36.217769 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m12:00:36.219314 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.221284 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:36.221565 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m12:00:36.222273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.223359 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m12:00:36.223770 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:36.223997 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m12:00:36.230408 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:00:36.232275 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:00:36.232584 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m12:00:36.233251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.234256 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m12:00:36.235251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798107730ad0>]}
[0m12:00:36.235703 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.03s]
[0m12:00:36.236146 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m12:00:36.236480 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m12:00:36.236917 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m12:00:36.237314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m12:00:36.237576 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m12:00:36.239691 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m12:00:36.240739 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m12:00:36.242854 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m12:00:36.243349 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:36.243595 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m12:00:36.243788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.244899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.245367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:36.245816 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m12:00:36.247911 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:00:36.249956 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:36.250222 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m12:00:36.252091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.253052 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m12:00:36.253293 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:36.253504 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m12:00:36.259829 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:00:36.261664 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:00:36.261948 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m12:00:36.262628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.263544 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m12:00:36.264040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79810652aa50>]}
[0m12:00:36.264520 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.03s]
[0m12:00:36.264933 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m12:00:36.265216 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m12:00:36.265538 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m12:00:36.265903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m12:00:36.266187 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m12:00:36.268138 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m12:00:36.268733 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m12:00:36.270703 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m12:00:36.271225 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:36.271465 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m12:00:36.271697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.272531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.272764 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:36.272959 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m12:00:36.275262 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:00:36.277621 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:36.277912 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m12:00:36.278636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.279499 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m12:00:36.279739 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:36.279928 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m12:00:36.286871 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:00:36.288629 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:00:36.288898 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m12:00:36.289483 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.290422 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m12:00:36.290963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79810653a270>]}
[0m12:00:36.291415 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.03s]
[0m12:00:36.291836 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m12:00:36.292282 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m12:00:36.292649 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m12:00:36.293081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m12:00:36.293390 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m12:00:36.295456 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m12:00:36.296387 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m12:00:36.298151 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m12:00:36.298590 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:36.298818 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m12:00:36.299026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.299747 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.299955 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:36.300189 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m12:00:36.302353 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:00:36.304396 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:36.304664 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m12:00:36.305668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.307337 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m12:00:36.307780 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:36.308174 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m12:00:36.315611 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:00:36.317352 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:00:36.317622 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m12:00:36.318263 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.319186 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m12:00:36.319777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79810659a1b0>]}
[0m12:00:36.320272 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.03s]
[0m12:00:36.320691 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m12:00:36.320985 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m12:00:36.321327 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m12:00:36.321878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m12:00:36.322147 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m12:00:36.323902 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m12:00:36.324403 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m12:00:36.327936 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m12:00:36.328607 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:36.328889 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m12:00:36.329097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.329871 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.330117 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:36.330330 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m12:00:36.331541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.333425 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:36.333676 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m12:00:36.334266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.335140 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m12:00:36.335402 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:36.335600 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m12:00:36.342885 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:00:36.344813 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:00:36.345146 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m12:00:36.345944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.346937 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m12:00:36.347644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981065c8470>]}
[0m12:00:36.348113 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m12:00:36.348558 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m12:00:36.348852 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m12:00:36.349181 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m12:00:36.349585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m12:00:36.349901 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m12:00:36.351956 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m12:00:36.352834 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m12:00:36.354653 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m12:00:36.355092 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:36.355342 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m12:00:36.355560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.356387 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.356628 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:36.356812 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m12:00:36.358095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.360306 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:36.360660 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m12:00:36.361505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.362651 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m12:00:36.362896 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:36.363083 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m12:00:36.369535 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:00:36.371377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:00:36.371663 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m12:00:36.372326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.373340 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m12:00:36.373860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79810658ede0>]}
[0m12:00:36.374303 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.02s]
[0m12:00:36.374737 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m12:00:36.375009 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m12:00:36.375352 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m12:00:36.375876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m12:00:36.376159 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m12:00:36.378115 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m12:00:36.378602 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m12:00:36.380800 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m12:00:36.381274 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:36.381510 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m12:00:36.381763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.382514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.382740 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:36.382934 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m12:00:36.384806 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:00:36.386805 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:36.387100 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m12:00:36.388096 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.389381 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m12:00:36.389663 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:36.389887 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m12:00:36.396618 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:00:36.398377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:00:36.398650 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m12:00:36.399298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.400255 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m12:00:36.400769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798106695ac0>]}
[0m12:00:36.401281 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.02s]
[0m12:00:36.401738 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m12:00:36.402065 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m12:00:36.402413 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m12:00:36.402807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m12:00:36.403094 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m12:00:36.406204 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m12:00:36.407171 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m12:00:36.409046 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m12:00:36.409534 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:36.409794 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m12:00:36.409993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.410865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.411213 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:36.411422 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m12:00:36.413045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.415210 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:36.415500 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m12:00:36.416500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.417367 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m12:00:36.417690 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:36.417908 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m12:00:36.424564 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:00:36.426362 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:00:36.426637 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m12:00:36.427272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.428341 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m12:00:36.428986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798106532b70>]}
[0m12:00:36.429473 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.03s]
[0m12:00:36.429907 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m12:00:36.430227 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m12:00:36.430619 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m12:00:36.431154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m12:00:36.431408 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m12:00:36.433791 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m12:00:36.434304 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m12:00:36.436341 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m12:00:36.436814 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:00:36.437056 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m12:00:36.437255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.438028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.438275 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:00:36.438587 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m12:00:36.447706 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m12:00:36.448332 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:00:36.448726 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m12:00:36.451419 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m12:00:36.451772 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m12:00:36.453714 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Invalid Input Error: More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.
  
  Use "SET scalar_subquery_error_on_multiple_rows=false" to revert to previous behavior of returning a random row.
[0m12:00:36.454094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798106581a30>]}
[0m12:00:36.454585 [error] [Thread-1 (]: 12 of 14 ERROR creating sql table model intermediate.int_players ............... [[31mERROR[0m in 0.02s]
[0m12:00:36.455017 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m12:00:36.455340 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m12:00:36.455681 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m12:00:36.456017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m12:00:36.456329 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m12:00:36.458494 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m12:00:36.459039 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Invalid Input Error: More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.
  
  Use "SET scalar_subquery_error_on_multiple_rows=false" to revert to previous behavior of returning a random row..
[0m12:00:36.459903 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m12:00:36.461758 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m12:00:36.462339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:36.462659 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m12:00:36.462891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:36.463846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.464333 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:36.464787 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m12:00:36.473398 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:00:36.475525 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:36.475802 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m12:00:36.476597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:00:36.477498 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m12:00:36.477735 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:36.477922 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m12:00:36.486605 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:00:36.488652 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:00:36.488969 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m12:00:36.489686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:00:36.490777 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m12:00:36.491515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e136d2fc-0e12-42af-b789-29fd4381d872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7981065814f0>]}
[0m12:00:36.491957 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m12:00:36.492400 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m12:00:36.492677 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m12:00:36.492979 [info ] [Thread-1 (]: 14 of 14 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m12:00:36.493298 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m12:00:36.493652 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m12:00:36.495376 [debug] [MainThread]: Using duckdb connection "master"
[0m12:00:36.495632 [debug] [MainThread]: On master: BEGIN
[0m12:00:36.495813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:36.496749 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:00:36.497088 [debug] [MainThread]: On master: COMMIT
[0m12:00:36.497287 [debug] [MainThread]: Using duckdb connection "master"
[0m12:00:36.497456 [debug] [MainThread]: On master: COMMIT
[0m12:00:36.498127 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:00:36.498597 [debug] [MainThread]: On master: Close
[0m12:00:36.499076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:36.499279 [debug] [MainThread]: Connection 'model.fpl_analytics.fact_fixtures' was properly closed.
[0m12:00:36.499544 [info ] [MainThread]: 
[0m12:00:36.499820 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m12:00:36.501243 [debug] [MainThread]: Command end result
[0m12:00:36.515191 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m12:00:36.517172 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m12:00:36.522127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m12:00:36.522443 [info ] [MainThread]: 
[0m12:00:36.522768 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:00:36.523058 [info ] [MainThread]: 
[0m12:00:36.523354 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m12:00:36.523626 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Invalid Input Error: More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.
  
  Use "SET scalar_subquery_error_on_multiple_rows=false" to revert to previous behavior of returning a random row.
[0m12:00:36.523834 [info ] [MainThread]: 
[0m12:00:36.524069 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m12:00:36.524294 [info ] [MainThread]: 
[0m12:00:36.524547 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m12:00:36.525418 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1780692, "process_in_blocks": "0", "process_kernel_time": 0.251221, "process_mem_max_rss": "166548", "process_out_blocks": "4480", "process_user_time": 2.151087}
[0m12:00:36.525768 [debug] [MainThread]: Command `dbt build` failed at 12:00:36.525692 after 1.18 seconds
[0m12:00:36.526049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798111ff8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79811211af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798112119c40>]}
[0m12:00:36.526326 [debug] [MainThread]: Flushing usage events
[0m12:00:37.101046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:22.086920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a70911af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a70c50950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a70c50a70>]}


============================== 12:01:22.090637 | 7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f ==============================
[0m12:01:22.090637 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:01:22.091092 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/robgriffin247/fpl/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'invocation_command': 'dbt build', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error': 'None'}
[0m12:01:22.298000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a70bdc560>]}
[0m12:01:22.357505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a71529700>]}
[0m12:01:22.359327 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:01:22.413917 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:01:22.529924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:22.530297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:22.555695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a6693eed0>]}
[0m12:01:22.602826 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m12:01:22.604252 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m12:01:22.638198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a6641f470>]}
[0m12:01:22.638641 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m12:01:22.640678 [info ] [MainThread]: 
[0m12:01:22.641065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:01:22.641327 [info ] [MainThread]: 
[0m12:01:22.641760 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:01:22.645939 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m12:01:22.679798 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:01:22.680240 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:01:22.680515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:22.702305 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m12:01:22.703471 [debug] [ThreadPool]: On list_analytics: Close
[0m12:01:22.705377 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:01:22.705839 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:01:22.706081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:22.707101 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:01:22.707992 [debug] [ThreadPool]: On list_analytics: Close
[0m12:01:22.709508 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:01:22.709791 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:01:22.710161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:22.711021 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:01:22.711909 [debug] [ThreadPool]: On list_analytics: Close
[0m12:01:22.712732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m12:01:22.713121 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m12:01:22.718026 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:01:22.718469 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:01:22.718718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:22.720006 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:01:22.721196 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:01:22.721431 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m12:01:22.721890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:01:22.722096 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:01:22.722261 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m12:01:22.722690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:01:22.723299 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m12:01:22.723527 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:01:22.723699 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m12:01:22.724135 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:01:22.724351 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m12:01:22.725001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_core)
[0m12:01:22.725380 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m12:01:22.726636 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:01:22.726893 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:01:22.727267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:22.728179 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:01:22.729088 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:01:22.729321 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m12:01:22.729734 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:01:22.729960 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:01:22.730119 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m12:01:22.730521 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:01:22.731108 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m12:01:22.731350 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:01:22.731541 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m12:01:22.731959 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:01:22.732235 [debug] [ThreadPool]: On create_analytics_core: Close
[0m12:01:22.732695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m12:01:22.733017 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m12:01:22.734252 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:01:22.734527 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:01:22.734798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:22.735905 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:01:22.736822 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:01:22.737017 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m12:01:22.737425 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:01:22.737636 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:01:22.737793 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m12:01:22.738178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:01:22.738701 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m12:01:22.738906 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:01:22.739082 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m12:01:22.739456 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:01:22.739675 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m12:01:22.741548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now list_analytics_staging)
[0m12:01:22.745296 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m12:01:22.745590 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m12:01:22.745829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:22.746784 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:01:22.747050 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m12:01:22.747238 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m12:01:22.756534 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:01:22.757700 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m12:01:22.759099 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m12:01:22.759338 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m12:01:22.759849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_core)
[0m12:01:22.761951 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m12:01:22.762206 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m12:01:22.762382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:22.763184 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:01:22.763536 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m12:01:22.764027 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m12:01:22.766804 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:01:22.767746 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m12:01:22.768384 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m12:01:22.768604 [debug] [ThreadPool]: On list_analytics_core: Close
[0m12:01:22.769126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m12:01:22.771106 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m12:01:22.771368 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m12:01:22.771993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:22.772857 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:01:22.773216 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m12:01:22.773525 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m12:01:22.777567 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:01:22.778633 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m12:01:22.779182 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m12:01:22.779395 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m12:01:22.780592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a4ff9e0f0>]}
[0m12:01:22.780950 [debug] [MainThread]: Using duckdb connection "master"
[0m12:01:22.781146 [debug] [MainThread]: On master: BEGIN
[0m12:01:22.781308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:22.782119 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:01:22.782504 [debug] [MainThread]: On master: COMMIT
[0m12:01:22.782938 [debug] [MainThread]: Using duckdb connection "master"
[0m12:01:22.783109 [debug] [MainThread]: On master: COMMIT
[0m12:01:22.783493 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:01:22.783693 [debug] [MainThread]: On master: Close
[0m12:01:22.788829 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m12:01:22.789498 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m12:01:22.789971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now model.fpl_analytics.stg_fixtures)
[0m12:01:22.790258 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m12:01:22.795399 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m12:01:22.795893 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m12:01:22.818385 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m12:01:22.819031 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:01:22.819341 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m12:01:22.819556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:22.820690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.821193 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:01:22.821522 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m12:01:22.823546 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:01:22.827677 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:01:22.827968 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m12:01:22.828801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.829781 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:01:22.830040 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m12:01:22.831315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.835736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:01:22.836024 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m12:01:22.836697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:22.838825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:01:22.839083 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m12:01:22.839860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.849843 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m12:01:22.850132 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:01:22.850475 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m12:01:22.858605 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:01:22.862979 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:01:22.863292 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m12:01:22.868688 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:01:22.871303 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m12:01:22.873619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a6693fce0>]}
[0m12:01:22.874180 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.08s]
[0m12:01:22.874666 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m12:01:22.874966 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m12:01:22.875930 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m12:01:22.876487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m12:01:22.876741 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m12:01:22.879030 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.879508 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m12:01:22.881636 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.882100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.882368 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m12:01:22.882589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:22.883324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.883546 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.883740 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m12:01:22.885622 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:01:22.886436 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.886784 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m12:01:22.887651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.888818 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.889143 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m12:01:22.890609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.894057 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.894364 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m12:01:22.895255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.949423 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.949800 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m12:01:22.950907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.952607 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m12:01:22.952881 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.953072 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m12:01:22.962124 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m12:01:22.964297 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:01:22.964654 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m12:01:22.970879 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:01:22.972043 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m12:01:22.973199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a72bf0f20>]}
[0m12:01:22.973747 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.10s]
[0m12:01:22.974210 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m12:01:22.974503 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m12:01:22.974853 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m12:01:22.975246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m12:01:22.975500 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m12:01:22.977530 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m12:01:22.978484 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m12:01:22.980830 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m12:01:22.981331 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:01:22.981584 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m12:01:22.981785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:22.982794 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:22.983226 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:01:22.983797 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m12:01:22.998986 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:01:23.000397 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:01:23.000695 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m12:01:23.001511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.002395 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:01:23.002624 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m12:01:23.003630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.005912 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:01:23.006251 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m12:01:23.007068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.009310 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:01:23.009631 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m12:01:23.010350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.011305 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m12:01:23.011645 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:01:23.011879 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m12:01:23.019911 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:01:23.021772 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:01:23.022060 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m12:01:23.027861 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:01:23.029293 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m12:01:23.030155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a7043c230>]}
[0m12:01:23.030637 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m12:01:23.031099 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m12:01:23.031404 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m12:01:23.031748 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m12:01:23.032339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m12:01:23.032615 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m12:01:23.034697 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m12:01:23.035145 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m12:01:23.037315 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m12:01:23.037796 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:01:23.038046 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m12:01:23.038305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.039379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.039683 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:01:23.039908 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m12:01:23.042191 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:01:23.043159 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:01:23.043449 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m12:01:23.044712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.045791 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:01:23.046051 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m12:01:23.047268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.049448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:01:23.049716 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m12:01:23.050305 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.053309 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:01:23.053592 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m12:01:23.054533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.055541 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m12:01:23.055795 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:01:23.056080 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m12:01:23.061626 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:01:23.063441 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:01:23.063720 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m12:01:23.068558 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:01:23.069694 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m12:01:23.070272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a4ff91370>]}
[0m12:01:23.070718 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m12:01:23.071152 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m12:01:23.071435 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m12:01:23.071777 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m12:01:23.072384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m12:01:23.072671 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m12:01:23.074723 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m12:01:23.075270 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m12:01:23.077479 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m12:01:23.078078 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:01:23.078461 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m12:01:23.078670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.079832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.080296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:01:23.080660 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m12:01:23.082356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.083149 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:01:23.083397 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m12:01:23.084181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.085077 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:01:23.085329 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m12:01:23.086640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.088875 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:01:23.089160 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m12:01:23.089837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.091675 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:01:23.091922 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m12:01:23.092577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.093517 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m12:01:23.093886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:01:23.094084 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m12:01:23.099717 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:01:23.101421 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:01:23.101682 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m12:01:23.107568 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:01:23.108858 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m12:01:23.109663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a4ffc0350>]}
[0m12:01:23.110214 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m12:01:23.110706 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m12:01:23.111087 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m12:01:23.111470 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m12:01:23.112025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m12:01:23.112293 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m12:01:23.114286 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m12:01:23.114775 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m12:01:23.116910 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m12:01:23.117357 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:01:23.117604 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m12:01:23.117841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.118629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.118858 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:01:23.119064 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m12:01:23.121101 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:01:23.122282 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:01:23.122681 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m12:01:23.123468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.124452 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:01:23.124717 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m12:01:23.125981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.128619 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:01:23.128973 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m12:01:23.129964 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.131829 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:01:23.132117 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m12:01:23.132687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.133605 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m12:01:23.133865 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:01:23.134070 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m12:01:23.139592 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:01:23.142325 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:01:23.142612 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m12:01:23.148413 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:01:23.150079 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m12:01:23.150955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a2c306690>]}
[0m12:01:23.151667 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m12:01:23.152211 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m12:01:23.152516 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m12:01:23.152868 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m12:01:23.153850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m12:01:23.154166 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m12:01:23.156224 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m12:01:23.156663 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m12:01:23.158504 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m12:01:23.158925 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:01:23.159202 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m12:01:23.159403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.160181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.160415 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:01:23.160636 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m12:01:23.163606 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:01:23.164611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:01:23.164888 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m12:01:23.165673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.166579 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:01:23.166854 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m12:01:23.167801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.169961 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:01:23.170256 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m12:01:23.171152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.173882 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:01:23.174301 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m12:01:23.175210 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.176126 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m12:01:23.176367 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:01:23.176558 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m12:01:23.183036 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:01:23.184733 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:01:23.184994 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m12:01:23.191697 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:01:23.192749 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m12:01:23.193310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a4ffa6ba0>]}
[0m12:01:23.193754 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m12:01:23.194158 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m12:01:23.194439 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m12:01:23.195059 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m12:01:23.195446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m12:01:23.195677 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m12:01:23.197670 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m12:01:23.198138 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m12:01:23.200108 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m12:01:23.200546 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:01:23.200786 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m12:01:23.201016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.202090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.202597 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:01:23.202847 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m12:01:23.204380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.205206 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:01:23.205446 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m12:01:23.206466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.207778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:01:23.208280 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m12:01:23.209321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.211464 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:01:23.211725 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m12:01:23.212631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.214865 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:01:23.215134 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m12:01:23.215817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.216807 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m12:01:23.217072 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:01:23.217276 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m12:01:23.224166 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:01:23.225906 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:01:23.226169 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m12:01:23.232395 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:01:23.235233 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m12:01:23.236200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a2c3294f0>]}
[0m12:01:23.236698 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m12:01:23.237125 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m12:01:23.237423 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m12:01:23.237746 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m12:01:23.238125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m12:01:23.238694 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m12:01:23.240552 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m12:01:23.241038 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m12:01:23.242949 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m12:01:23.243358 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:01:23.243587 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m12:01:23.243783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.244569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.244800 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:01:23.244994 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m12:01:23.246138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.247000 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:01:23.247275 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m12:01:23.248364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.249417 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:01:23.249686 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m12:01:23.250774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.252947 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:01:23.253258 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m12:01:23.253973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.255758 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:01:23.255997 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m12:01:23.256712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.257587 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m12:01:23.257819 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:01:23.258002 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m12:01:23.264954 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:01:23.266825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:01:23.267123 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m12:01:23.274147 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:01:23.275817 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m12:01:23.276773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a2c32dee0>]}
[0m12:01:23.277254 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m12:01:23.277678 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m12:01:23.277996 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m12:01:23.278390 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m12:01:23.278737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m12:01:23.279026 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m12:01:23.281181 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m12:01:23.281692 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m12:01:23.283884 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m12:01:23.284520 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:01:23.284822 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m12:01:23.285038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.286144 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.286662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:01:23.287095 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m12:01:23.289699 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:01:23.290745 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:01:23.291042 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m12:01:23.291982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.293175 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:01:23.293473 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m12:01:23.294725 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.296920 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:01:23.297209 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m12:01:23.298122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.300260 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:01:23.300593 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m12:01:23.301834 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.303574 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m12:01:23.304020 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:01:23.304595 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m12:01:23.312193 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:01:23.314020 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:01:23.314261 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m12:01:23.321761 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:01:23.323478 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m12:01:23.324519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a7050f200>]}
[0m12:01:23.325047 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.05s]
[0m12:01:23.325482 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m12:01:23.325779 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m12:01:23.326125 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m12:01:23.326513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m12:01:23.326785 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m12:01:23.329845 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.331091 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m12:01:23.333356 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.333977 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.334291 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m12:01:23.334501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.335431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.335746 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.335950 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m12:01:23.337183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.337951 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.338201 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m12:01:23.338921 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.339767 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.339991 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m12:01:23.341136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.343112 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.343346 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m12:01:23.343884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.345610 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.345843 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m12:01:23.346340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.347218 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m12:01:23.347448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.347643 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m12:01:23.355535 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:01:23.357434 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:01:23.357706 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m12:01:23.364457 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:01:23.365489 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m12:01:23.366210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a72c189b0>]}
[0m12:01:23.366682 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m12:01:23.367147 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m12:01:23.367439 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m12:01:23.367795 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m12:01:23.368519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m12:01:23.368786 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m12:01:23.370948 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m12:01:23.371394 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m12:01:23.373376 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m12:01:23.373814 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:01:23.374052 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m12:01:23.374284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.374984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.375197 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:01:23.375476 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m12:01:23.393224 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m12:01:23.393787 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:01:23.394167 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: ROLLBACK
[0m12:01:23.400579 [debug] [Thread-1 (]: Failed to rollback 'model.fpl_analytics.int_players'
[0m12:01:23.400925 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m12:01:23.402856 [debug] [Thread-1 (]: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Invalid Input Error: More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.
  
  Use "SET scalar_subquery_error_on_multiple_rows=false" to revert to previous behavior of returning a random row.
[0m12:01:23.403278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a7043ce90>]}
[0m12:01:23.403771 [error] [Thread-1 (]: 12 of 14 ERROR creating sql table model intermediate.int_players ............... [[31mERROR[0m in 0.03s]
[0m12:01:23.404238 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m12:01:23.404526 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m12:01:23.404868 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m12:01:23.405251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m12:01:23.405563 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m12:01:23.405955 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.int_players' to be skipped because of status 'error'.  Reason: Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Invalid Input Error: More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.
  
  Use "SET scalar_subquery_error_on_multiple_rows=false" to revert to previous behavior of returning a random row..
[0m12:01:23.408397 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m12:01:23.409441 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m12:01:23.411354 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m12:01:23.411787 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:01:23.412024 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m12:01:23.412297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:23.413045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.413301 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:01:23.413549 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m12:01:23.429071 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:01:23.430288 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:01:23.430640 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m12:01:23.431611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.432690 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:01:23.432966 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m12:01:23.434100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.436717 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:01:23.437048 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m12:01:23.437895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:01:23.439701 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:01:23.439968 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m12:01:23.440649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:01:23.441517 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m12:01:23.441744 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:01:23.441954 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m12:01:23.451323 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m12:01:23.455171 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:01:23.455513 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m12:01:23.460964 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:01:23.462403 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m12:01:23.463413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0a88fb-fb09-4732-89c4-bc4dc2ffed3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a2c364b90>]}
[0m12:01:23.463903 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.06s]
[0m12:01:23.464367 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m12:01:23.464646 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m12:01:23.464931 [info ] [Thread-1 (]: 14 of 14 SKIP relation core.obt_players ........................................ [[33mSKIP[0m]
[0m12:01:23.465235 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m12:01:23.465645 [debug] [Thread-4 (]: Marking all children of 'model.fpl_analytics.obt_players' to be skipped because of status 'skipped'. 
[0m12:01:23.467208 [debug] [MainThread]: Using duckdb connection "master"
[0m12:01:23.467491 [debug] [MainThread]: On master: BEGIN
[0m12:01:23.467674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:01:23.468508 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:01:23.468779 [debug] [MainThread]: On master: COMMIT
[0m12:01:23.469038 [debug] [MainThread]: Using duckdb connection "master"
[0m12:01:23.469219 [debug] [MainThread]: On master: COMMIT
[0m12:01:23.469706 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:01:23.469918 [debug] [MainThread]: On master: Close
[0m12:01:23.470613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:23.470824 [debug] [MainThread]: Connection 'model.fpl_analytics.fact_fixtures' was properly closed.
[0m12:01:23.471082 [info ] [MainThread]: 
[0m12:01:23.471338 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m12:01:23.472734 [debug] [MainThread]: Command end result
[0m12:01:23.484848 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m12:01:23.486446 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m12:01:23.491611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m12:01:23.491919 [info ] [MainThread]: 
[0m12:01:23.492206 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:01:23.492507 [info ] [MainThread]: 
[0m12:01:23.492836 [error] [MainThread]: [31mFailure in model int_players (fpl_analytics/models/intermediate/int_players.sql)[0m
[0m12:01:23.493115 [error] [MainThread]:   Runtime Error in model int_players (fpl_analytics/models/intermediate/int_players.sql)
  Invalid Input Error: More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.
  
  Use "SET scalar_subquery_error_on_multiple_rows=false" to revert to previous behavior of returning a random row.
[0m12:01:23.493319 [info ] [MainThread]: 
[0m12:01:23.493586 [info ] [MainThread]:   compiled code at target/compiled/fpl_analytics/fpl_analytics/models/intermediate/int_players.sql
[0m12:01:23.493804 [info ] [MainThread]: 
[0m12:01:23.494056 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m12:01:23.495673 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4613181, "process_in_blocks": "50136", "process_kernel_time": 0.256727, "process_mem_max_rss": "174944", "process_out_blocks": "5296", "process_user_time": 2.326843}
[0m12:01:23.496031 [debug] [MainThread]: Command `dbt build` failed at 12:01:23.495959 after 1.46 seconds
[0m12:01:23.496326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a70567500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a705c5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738a668849b0>]}
[0m12:01:23.496574 [debug] [MainThread]: Flushing usage events
[0m12:01:24.040904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:01.400867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812ab307da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812aaeff290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812abd1c6b0>]}


============================== 12:02:01.403098 | e634f9a1-42f9-4682-ac5f-d04a6026f115 ==============================
[0m12:02:01.403098 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:02:01.403498 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/home/robgriffin247/fpl/logs', 'target_path': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/robgriffin247/fpl', 'printer_width': '80', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_cache_events': 'False', 'log_format': 'default'}
[0m12:02:01.581188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812ad7f1100>]}
[0m12:02:01.638836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812aa9837a0>]}
[0m12:02:01.639934 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:02:01.685903 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:02:01.749082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:02:01.749384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:02:01.772044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812a0dc5280>]}
[0m12:02:01.814843 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m12:02:01.816077 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m12:02:01.832501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812a0a27d70>]}
[0m12:02:01.832875 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m12:02:01.834652 [info ] [MainThread]: 
[0m12:02:01.834987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:01.835208 [info ] [MainThread]: 
[0m12:02:01.835593 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:02:01.839621 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m12:02:01.865135 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:02:01.865457 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:02:01.865716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:01.885346 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:02:01.886472 [debug] [ThreadPool]: On list_analytics: Close
[0m12:02:01.888096 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:02:01.888376 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:02:01.888605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:01.889731 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:01.890448 [debug] [ThreadPool]: On list_analytics: Close
[0m12:02:01.891722 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m12:02:01.891975 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m12:02:01.892195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:01.893136 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:01.894046 [debug] [ThreadPool]: On list_analytics: Close
[0m12:02:01.894886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m12:02:01.895333 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m12:02:01.900253 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:02:01.900576 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:02:01.900807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:01.902238 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:01.903379 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:02:01.903603 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m12:02:01.904485 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:01.904829 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:02:01.905291 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m12:02:01.905774 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:01.906324 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m12:02:01.906528 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m12:02:01.906686 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m12:02:01.907086 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:01.907290 [debug] [ThreadPool]: On create_analytics_core: Close
[0m12:02:01.907743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m12:02:01.908066 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m12:02:01.909341 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:02:01.909687 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:02:01.909878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:01.910697 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:01.911572 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:02:01.911764 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m12:02:01.912155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:01.912343 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:02:01.912490 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m12:02:01.912873 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:01.913470 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m12:02:01.913683 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m12:02:01.913856 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m12:02:01.914240 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:01.914454 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m12:02:01.914878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m12:02:01.915191 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m12:02:01.916228 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:02:01.916469 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m12:02:01.916694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:01.917561 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:01.918498 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:02:01.918717 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m12:02:01.919178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:01.919403 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:02:01.919573 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m12:02:01.919979 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:01.920529 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m12:02:01.920743 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m12:02:01.920977 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m12:02:01.921501 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:01.921744 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m12:02:01.923674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m12:02:01.927756 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m12:02:01.928017 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m12:02:01.928191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:01.929178 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:01.929407 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m12:02:01.929572 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m12:02:01.937401 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:02:01.938300 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m12:02:01.938975 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m12:02:01.939191 [debug] [ThreadPool]: On list_analytics_core: Close
[0m12:02:01.939620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m12:02:01.940712 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m12:02:01.940953 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m12:02:01.941183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:01.942217 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:01.942469 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m12:02:01.942652 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m12:02:01.945390 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:02:01.946316 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m12:02:01.946850 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m12:02:01.947048 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m12:02:01.947477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m12:02:01.949358 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m12:02:01.949606 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m12:02:01.949821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:01.951143 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:01.951373 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m12:02:01.951545 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m12:02:01.954217 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:02:01.955296 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m12:02:01.955831 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m12:02:01.956018 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m12:02:01.957367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812aa9677a0>]}
[0m12:02:01.957706 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:01.957900 [debug] [MainThread]: On master: BEGIN
[0m12:02:01.958068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:01.958748 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:02:01.958971 [debug] [MainThread]: On master: COMMIT
[0m12:02:01.959173 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:01.959340 [debug] [MainThread]: On master: COMMIT
[0m12:02:01.959750 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:01.959949 [debug] [MainThread]: On master: Close
[0m12:02:01.963436 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m12:02:01.963901 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m12:02:01.964327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m12:02:01.964611 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m12:02:01.970169 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m12:02:01.970895 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m12:02:01.994105 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m12:02:01.994736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:02:01.995015 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m12:02:01.995217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:01.996029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:01.996297 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:02:01.996514 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m12:02:01.998590 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:02.003060 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:02:02.003451 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m12:02:02.004479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.005516 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:02:02.005798 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m12:02:02.007286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.011981 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:02:02.012338 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m12:02:02.013241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.015208 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:02:02.015461 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m12:02:02.016139 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.026839 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m12:02:02.027307 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:02:02.027701 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m12:02:02.033960 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.038188 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m12:02:02.038561 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m12:02:02.044197 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.046341 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m12:02:02.047844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812ad526900>]}
[0m12:02:02.048275 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.08s]
[0m12:02:02.048721 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m12:02:02.049077 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m12:02:02.049426 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m12:02:02.049808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m12:02:02.050103 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m12:02:02.051888 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.052861 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m12:02:02.054951 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.055409 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.055641 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m12:02:02.055840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.056604 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.056841 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.057066 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m12:02:02.059449 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:02.060668 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.061019 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m12:02:02.061984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.062979 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.063240 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m12:02:02.064382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.067677 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.068013 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m12:02:02.068841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.122164 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.122553 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m12:02:02.123587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.124702 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m12:02:02.125075 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.125316 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m12:02:02.131311 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.133274 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m12:02:02.133576 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m12:02:02.139056 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.140558 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m12:02:02.141247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78129bcb9f10>]}
[0m12:02:02.141775 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.09s]
[0m12:02:02.142243 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m12:02:02.142540 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m12:02:02.142874 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m12:02:02.143534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m12:02:02.143888 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m12:02:02.146187 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m12:02:02.147268 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m12:02:02.149563 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m12:02:02.150084 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:02:02.150342 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m12:02:02.150540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.151320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.151570 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:02:02.151830 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m12:02:02.159037 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:02:02.160023 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:02:02.160319 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m12:02:02.161608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.162579 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:02:02.162851 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m12:02:02.164057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.166410 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:02:02.166729 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m12:02:02.167568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.169576 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:02:02.169855 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m12:02:02.170595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.171562 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m12:02:02.171820 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:02:02.172023 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m12:02:02.179202 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:02:02.181360 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m12:02:02.181658 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m12:02:02.186943 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.188341 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m12:02:02.189530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812a0f9e240>]}
[0m12:02:02.189999 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m12:02:02.190418 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m12:02:02.190702 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m12:02:02.191027 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m12:02:02.191440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m12:02:02.191835 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m12:02:02.193881 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m12:02:02.194394 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m12:02:02.196575 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m12:02:02.197133 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:02:02.197390 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m12:02:02.197589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.198732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.199332 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:02:02.199684 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m12:02:02.201447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.202383 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:02:02.202669 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m12:02:02.203626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.204621 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:02:02.204889 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m12:02:02.206161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.208325 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:02:02.208610 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m12:02:02.209560 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.213040 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:02:02.213405 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m12:02:02.214207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.215198 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m12:02:02.215466 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:02:02.215680 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m12:02:02.221949 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.223860 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m12:02:02.224162 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m12:02:02.229917 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.231244 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m12:02:02.231901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78129bc8b0b0>]}
[0m12:02:02.232411 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m12:02:02.232872 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m12:02:02.233242 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m12:02:02.233673 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m12:02:02.234411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m12:02:02.234806 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m12:02:02.236879 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m12:02:02.237807 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m12:02:02.239784 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m12:02:02.240239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:02:02.240478 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m12:02:02.240675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.241673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.242083 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:02:02.242438 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m12:02:02.244539 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:02.245676 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:02:02.245990 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m12:02:02.246839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.247756 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:02:02.248009 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m12:02:02.249026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.251287 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:02:02.251608 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m12:02:02.252506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.254381 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:02:02.254643 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m12:02:02.255201 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.256082 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m12:02:02.256358 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:02:02.256564 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m12:02:02.261360 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.263154 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m12:02:02.263419 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m12:02:02.269171 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.270646 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m12:02:02.271291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78129bdedf40>]}
[0m12:02:02.271770 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m12:02:02.272183 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m12:02:02.272463 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m12:02:02.272791 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m12:02:02.273194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m12:02:02.273537 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m12:02:02.275309 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m12:02:02.275799 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m12:02:02.277891 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m12:02:02.278565 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:02:02.278834 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m12:02:02.279029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.279843 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.280108 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:02:02.280326 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m12:02:02.281899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.282761 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:02:02.283009 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m12:02:02.284135 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.285438 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:02:02.285726 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m12:02:02.286822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.289884 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:02:02.290300 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m12:02:02.291390 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.293801 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:02:02.294070 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m12:02:02.294685 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.295666 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m12:02:02.295935 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:02:02.296121 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m12:02:02.301819 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.304730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m12:02:02.305141 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m12:02:02.310351 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.311709 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m12:02:02.312518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78129bce3770>]}
[0m12:02:02.313007 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m12:02:02.313462 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m12:02:02.313748 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m12:02:02.314084 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m12:02:02.314997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m12:02:02.315281 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m12:02:02.317396 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m12:02:02.317864 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m12:02:02.319735 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m12:02:02.320164 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:02:02.320403 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m12:02:02.320598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.321696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.322118 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:02:02.322565 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m12:02:02.325394 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:02.326208 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:02:02.326463 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m12:02:02.327514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.329163 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:02:02.329526 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m12:02:02.330737 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.333195 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:02:02.333502 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m12:02:02.334364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.336215 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:02:02.336463 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m12:02:02.337062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.337963 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m12:02:02.338255 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:02:02.338480 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m12:02:02.343743 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.345460 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m12:02:02.345740 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m12:02:02.351451 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.353132 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m12:02:02.353782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812a09a1670>]}
[0m12:02:02.354231 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m12:02:02.354635 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m12:02:02.354937 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m12:02:02.355270 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m12:02:02.355640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m12:02:02.355920 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m12:02:02.357798 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m12:02:02.358333 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m12:02:02.360188 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m12:02:02.360603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:02:02.360851 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m12:02:02.361129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.361814 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.362037 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:02:02.362234 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m12:02:02.363667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.364684 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:02:02.365058 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m12:02:02.366385 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.367378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:02:02.367632 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m12:02:02.368728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.370990 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:02:02.371283 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m12:02:02.372309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.374610 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:02:02.374941 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m12:02:02.375657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.376611 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m12:02:02.376866 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:02:02.377169 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m12:02:02.383614 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.385851 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m12:02:02.386134 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m12:02:02.391986 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.394206 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m12:02:02.394671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781295efc5f0>]}
[0m12:02:02.395061 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m12:02:02.395447 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m12:02:02.395736 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m12:02:02.396059 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m12:02:02.396848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m12:02:02.397272 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m12:02:02.399830 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m12:02:02.400392 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m12:02:02.402547 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m12:02:02.402986 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:02:02.403230 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m12:02:02.403427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.404154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.404397 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:02:02.404595 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m12:02:02.406076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.406957 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:02:02.407201 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m12:02:02.407997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.408817 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:02:02.409099 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m12:02:02.410061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.411948 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:02:02.412200 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m12:02:02.413016 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.415173 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:02:02.415426 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m12:02:02.416225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.417135 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m12:02:02.417421 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:02:02.417635 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m12:02:02.423600 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.425324 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m12:02:02.425594 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m12:02:02.430802 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.432117 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m12:02:02.432937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78129bcf9670>]}
[0m12:02:02.433495 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m12:02:02.433919 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m12:02:02.434213 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m12:02:02.434565 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m12:02:02.434942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m12:02:02.435220 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m12:02:02.437181 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m12:02:02.437703 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m12:02:02.439592 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m12:02:02.440019 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:02:02.440262 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m12:02:02.440460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.441214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.441471 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:02:02.441685 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m12:02:02.443357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.444594 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:02:02.445055 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m12:02:02.445982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.446991 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:02:02.447243 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m12:02:02.448562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.450909 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:02:02.451210 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m12:02:02.452240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.454868 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:02:02.455281 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m12:02:02.456570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.457682 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m12:02:02.457949 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:02:02.458173 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m12:02:02.464365 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.466219 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m12:02:02.466606 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m12:02:02.472538 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.473644 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m12:02:02.474168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812aaafa000>]}
[0m12:02:02.474607 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m12:02:02.475046 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m12:02:02.475338 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m12:02:02.475670 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m12:02:02.476057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m12:02:02.476332 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m12:02:02.479468 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.480285 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m12:02:02.482111 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.482572 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.482838 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m12:02:02.483075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.483841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.484121 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.484341 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m12:02:02.485602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.486407 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.486637 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m12:02:02.487345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.488178 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.488405 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m12:02:02.489276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.491429 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.491684 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m12:02:02.492259 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.494066 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.494321 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m12:02:02.495077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.496418 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m12:02:02.496869 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.497361 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m12:02:02.504002 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.505731 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m12:02:02.505993 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m12:02:02.511839 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.513261 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m12:02:02.513779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78129bce2960>]}
[0m12:02:02.514198 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m12:02:02.514585 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m12:02:02.514874 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m12:02:02.515229 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m12:02:02.515587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m12:02:02.515848 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m12:02:02.518160 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m12:02:02.518838 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m12:02:02.520846 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m12:02:02.521339 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:02:02.521605 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m12:02:02.521819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.522562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.522783 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:02:02.523063 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m12:02:02.548694 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m12:02:02.550948 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:02:02.551257 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m12:02:02.552048 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.552936 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m12:02:02.553263 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:02:02.553477 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m12:02:02.559641 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.561276 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m12:02:02.561551 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m12:02:02.562158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.563111 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m12:02:02.565069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78129bdefc20>]}
[0m12:02:02.565518 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.05s]
[0m12:02:02.565964 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m12:02:02.566247 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m12:02:02.566564 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m12:02:02.566926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m12:02:02.567208 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m12:02:02.569313 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m12:02:02.570021 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m12:02:02.571881 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m12:02:02.572305 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:02:02.572544 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m12:02:02.572740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.573747 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.574165 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:02:02.574595 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m12:02:02.578365 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:02.579221 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:02:02.579484 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m12:02:02.580208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.581118 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:02:02.581379 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m12:02:02.582351 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.586514 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:02:02.586910 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m12:02:02.587804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.589681 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:02:02.589945 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m12:02:02.590520 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.591425 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m12:02:02.591680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:02:02.591892 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m12:02:02.597787 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:02:02.599721 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m12:02:02.600034 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m12:02:02.605713 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:02:02.607550 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m12:02:02.608774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781295f337d0>]}
[0m12:02:02.609585 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m12:02:02.610070 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m12:02:02.610360 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m12:02:02.610678 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m12:02:02.611318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m12:02:02.611602 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m12:02:02.613981 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m12:02:02.614857 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m12:02:02.616866 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m12:02:02.617340 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m12:02:02.617582 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m12:02:02.617789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:02.618573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.618818 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m12:02:02.619114 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek >= (select * from gameweeks) and gameweek <= ((select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 3 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 3 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        attacking_biases_value,
        defending_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m12:02:02.644677 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m12:02:02.647054 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m12:02:02.647349 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m12:02:02.648050 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:02.648940 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m12:02:02.649240 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m12:02:02.649431 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m12:02:02.656312 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:02:02.658099 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m12:02:02.658379 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m12:02:02.659253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:02.660647 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m12:02:02.662743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e634f9a1-42f9-4682-ac5f-d04a6026f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78129bc6f680>]}
[0m12:02:02.663298 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.05s]
[0m12:02:02.663724 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m12:02:02.665323 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:02.665591 [debug] [MainThread]: On master: BEGIN
[0m12:02:02.665778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:02.666411 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:02:02.666642 [debug] [MainThread]: On master: COMMIT
[0m12:02:02.666900 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:02.667075 [debug] [MainThread]: On master: COMMIT
[0m12:02:02.667676 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:02.668040 [debug] [MainThread]: On master: Close
[0m12:02:02.669766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:02.670008 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m12:02:02.670279 [info ] [MainThread]: 
[0m12:02:02.670553 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m12:02:02.672040 [debug] [MainThread]: Command end result
[0m12:02:02.684703 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m12:02:02.686082 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m12:02:02.690710 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m12:02:02.691021 [info ] [MainThread]: 
[0m12:02:02.691467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:02.691756 [info ] [MainThread]: 
[0m12:02:02.692027 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m12:02:02.692779 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3398907, "process_in_blocks": "2704", "process_kernel_time": 0.252212, "process_mem_max_rss": "179924", "process_out_blocks": "3792", "process_user_time": 2.253902}
[0m12:02:02.693154 [debug] [MainThread]: Command `dbt build` succeeded at 12:02:02.693072 after 1.34 seconds
[0m12:02:02.693422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812ab5ec5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812abd1c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7812ab3ca630>]}
[0m12:02:02.693691 [debug] [MainThread]: Flushing usage events
[0m12:02:03.327505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:38.138297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876c925c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876c92315b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876c9210380>]}


============================== 15:56:38.142527 | b6f4c3ff-6999-4bbe-9aff-9af89d68fc86 ==============================
[0m15:56:38.142527 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:56:38.143030 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'log_format': 'default', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'profiles_dir': '/home/robgriffin247/fpl', 'warn_error': 'None'}
[0m15:56:38.378451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876c7fa63c0>]}
[0m15:56:38.443353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876c8210650>]}
[0m15:56:38.446975 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:56:38.501472 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:56:38.609952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:38.610530 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m15:56:38.889225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787696ff7cb0>]}
[0m15:56:38.933990 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m15:56:38.935936 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m15:56:39.012815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876be11deb0>]}
[0m15:56:39.013207 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m15:56:39.015069 [info ] [MainThread]: 
[0m15:56:39.015419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:39.015670 [info ] [MainThread]: 
[0m15:56:39.016103 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:56:39.020522 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m15:56:39.055452 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m15:56:39.055801 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m15:56:39.056015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:39.085337 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m15:56:39.087038 [debug] [ThreadPool]: On list_analytics: Close
[0m15:56:39.088731 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m15:56:39.089060 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m15:56:39.089313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:39.090782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.091650 [debug] [ThreadPool]: On list_analytics: Close
[0m15:56:39.093485 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m15:56:39.093920 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m15:56:39.094168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:39.095371 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.096260 [debug] [ThreadPool]: On list_analytics: Close
[0m15:56:39.096995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m15:56:39.097416 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m15:56:39.101755 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:56:39.101982 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m15:56:39.102146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:39.103292 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.104440 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:56:39.104727 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m15:56:39.105282 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:56:39.105510 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:56:39.105679 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m15:56:39.106464 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.107439 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m15:56:39.107678 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:56:39.107849 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m15:56:39.109223 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.109466 [debug] [ThreadPool]: On create_analytics_core: Close
[0m15:56:39.109968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m15:56:39.110301 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m15:56:39.111583 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:56:39.111838 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m15:56:39.112096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:39.113094 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.113955 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:56:39.114174 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m15:56:39.114870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:56:39.115107 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:56:39.115286 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m15:56:39.116033 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.116639 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m15:56:39.116849 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:56:39.117017 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m15:56:39.117672 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:56:39.118025 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m15:56:39.118841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m15:56:39.119227 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m15:56:39.120391 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:56:39.120661 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m15:56:39.120885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:39.122024 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.123497 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:56:39.123868 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m15:56:39.124775 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.125036 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:56:39.125215 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m15:56:39.126084 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.126808 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m15:56:39.127043 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:56:39.127219 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m15:56:39.127796 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:56:39.128040 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m15:56:39.129823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m15:56:39.133982 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m15:56:39.134269 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m15:56:39.134453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:39.135422 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.135783 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m15:56:39.136124 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m15:56:39.149369 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:56:39.151048 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m15:56:39.152347 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m15:56:39.152567 [debug] [ThreadPool]: On list_analytics_core: Close
[0m15:56:39.153104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m15:56:39.155405 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m15:56:39.156365 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m15:56:39.156645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:39.157381 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.157617 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m15:56:39.157792 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m15:56:39.160660 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:56:39.161716 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m15:56:39.162351 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m15:56:39.162560 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m15:56:39.163125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m15:56:39.164381 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m15:56:39.164624 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m15:56:39.164828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:39.165863 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:39.166058 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m15:56:39.166223 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m15:56:39.168846 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:56:39.169888 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m15:56:39.170509 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m15:56:39.170776 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m15:56:39.172337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876c854b530>]}
[0m15:56:39.172716 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:39.172915 [debug] [MainThread]: On master: BEGIN
[0m15:56:39.173083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:39.173697 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:56:39.173913 [debug] [MainThread]: On master: COMMIT
[0m15:56:39.174113 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:39.174285 [debug] [MainThread]: On master: COMMIT
[0m15:56:39.174782 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:56:39.174996 [debug] [MainThread]: On master: Close
[0m15:56:39.178742 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m15:56:39.179194 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m15:56:39.179768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m15:56:39.180018 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m15:56:39.184945 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m15:56:39.185521 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m15:56:39.207838 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m15:56:39.208662 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:56:39.209076 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m15:56:39.209266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.210149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.210427 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:56:39.210688 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m15:56:39.215470 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:56:39.219377 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:56:39.219726 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m15:56:39.220657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.221600 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:56:39.221857 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m15:56:39.226681 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:56:39.231463 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:56:39.231736 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m15:56:39.233572 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:56:39.235519 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:56:39.235781 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m15:56:39.236381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.246446 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m15:56:39.246861 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:56:39.247083 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m15:56:39.254193 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:56:39.258321 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:56:39.258640 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m15:56:39.264842 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:56:39.267036 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m15:56:39.268901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876ca9e7020>]}
[0m15:56:39.269388 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m15:56:39.269821 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m15:56:39.270114 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m15:56:39.270454 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m15:56:39.271245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m15:56:39.271748 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m15:56:39.273756 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.274249 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m15:56:39.277586 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.278199 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.278448 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m15:56:39.278677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.279456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.279720 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.279927 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m15:56:39.282205 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:56:39.283073 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.283339 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m15:56:39.284112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.284996 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.285246 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m15:56:39.286308 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.288357 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.288661 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m15:56:39.289518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.291714 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.292021 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m15:56:39.292753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.293706 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m15:56:39.293955 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.294194 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m15:56:39.299664 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.301391 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:56:39.301685 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m15:56:39.307073 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.308385 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m15:56:39.309199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876965d6240>]}
[0m15:56:39.309674 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m15:56:39.310115 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m15:56:39.310423 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m15:56:39.310797 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m15:56:39.311477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m15:56:39.311787 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m15:56:39.313979 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m15:56:39.314495 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m15:56:39.316555 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m15:56:39.316990 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:56:39.317218 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m15:56:39.317406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.318142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.318362 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:56:39.318651 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m15:56:39.327236 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:56:39.328528 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:56:39.328972 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m15:56:39.330359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.331637 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:56:39.332005 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m15:56:39.333303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.335237 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:56:39.335479 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m15:56:39.336075 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.337815 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:56:39.338112 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m15:56:39.339305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.340432 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m15:56:39.340692 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:56:39.340914 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m15:56:39.348191 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:56:39.349954 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:56:39.350228 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m15:56:39.355380 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.356622 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m15:56:39.357341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876964edb80>]}
[0m15:56:39.357827 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m15:56:39.358249 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m15:56:39.358541 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m15:56:39.358937 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m15:56:39.359515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m15:56:39.359796 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m15:56:39.361832 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m15:56:39.362354 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m15:56:39.364334 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m15:56:39.364803 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:56:39.365040 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m15:56:39.365240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.365982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.366217 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:56:39.366409 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m15:56:39.369492 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:56:39.370747 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:56:39.371186 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m15:56:39.372302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.374897 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:56:39.375276 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m15:56:39.376736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.378827 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:56:39.379098 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m15:56:39.379835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.381432 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:56:39.381662 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m15:56:39.382353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.383236 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m15:56:39.383503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:56:39.383697 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m15:56:39.390059 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:56:39.391961 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:56:39.392253 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m15:56:39.397301 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.398831 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m15:56:39.399434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78769611bf80>]}
[0m15:56:39.399905 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m15:56:39.400305 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m15:56:39.400600 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m15:56:39.400909 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m15:56:39.401298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m15:56:39.401602 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m15:56:39.403506 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m15:56:39.404432 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m15:56:39.406816 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m15:56:39.407511 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:56:39.407823 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m15:56:39.408032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.408898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.409198 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:56:39.409432 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m15:56:39.411629 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:56:39.412490 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:56:39.412763 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m15:56:39.413535 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.414651 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:56:39.415029 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m15:56:39.416523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.418853 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:56:39.419152 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m15:56:39.419834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.421701 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:56:39.421966 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m15:56:39.423244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.424361 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m15:56:39.424659 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:56:39.424863 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m15:56:39.430544 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.432433 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:56:39.432705 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m15:56:39.437489 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:56:39.438860 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m15:56:39.439638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876964ef1d0>]}
[0m15:56:39.440081 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m15:56:39.440477 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m15:56:39.440769 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m15:56:39.441151 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m15:56:39.441627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m15:56:39.441863 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m15:56:39.443885 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m15:56:39.444415 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m15:56:39.446357 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m15:56:39.446864 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:56:39.447119 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m15:56:39.447343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.448237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.448462 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:56:39.448662 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m15:56:39.451487 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:56:39.452324 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:56:39.452567 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m15:56:39.453349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.454168 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:56:39.454394 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m15:56:39.456041 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.459607 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:56:39.459928 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m15:56:39.460704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.462561 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:56:39.462846 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m15:56:39.463489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.464475 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m15:56:39.464730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:56:39.464931 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m15:56:39.470847 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:56:39.472525 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:56:39.472839 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m15:56:39.477809 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.479157 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m15:56:39.479809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876960b54f0>]}
[0m15:56:39.480271 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m15:56:39.480696 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m15:56:39.480998 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m15:56:39.481318 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m15:56:39.481901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m15:56:39.482197 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m15:56:39.484273 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m15:56:39.485075 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m15:56:39.487159 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m15:56:39.487618 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:56:39.487865 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m15:56:39.488066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.488829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.489064 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:56:39.489289 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m15:56:39.493773 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:56:39.494775 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:56:39.495083 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m15:56:39.495912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.496719 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:56:39.496941 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m15:56:39.497759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.499630 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:56:39.499866 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m15:56:39.500407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.502060 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:56:39.502295 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m15:56:39.503186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.504040 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m15:56:39.504259 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:56:39.504446 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m15:56:39.511481 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:56:39.513332 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:56:39.513633 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m15:56:39.518941 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.520569 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m15:56:39.521336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876be2296a0>]}
[0m15:56:39.521949 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m15:56:39.522580 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m15:56:39.522989 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m15:56:39.523392 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m15:56:39.523925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m15:56:39.524184 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m15:56:39.526038 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m15:56:39.526483 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m15:56:39.528533 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m15:56:39.528981 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:56:39.529211 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m15:56:39.529412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.530162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.530397 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:56:39.530626 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m15:56:39.531961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.532687 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:56:39.532927 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m15:56:39.533653 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.534486 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:56:39.534783 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m15:56:39.535773 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.537583 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:56:39.537812 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m15:56:39.538340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.541220 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:56:39.541589 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m15:56:39.542613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.543772 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m15:56:39.544032 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:56:39.544227 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m15:56:39.550316 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:56:39.551852 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:56:39.552106 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m15:56:39.557479 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.558901 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m15:56:39.559841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78769610e000>]}
[0m15:56:39.560365 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m15:56:39.560857 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m15:56:39.561209 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m15:56:39.561590 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m15:56:39.562020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m15:56:39.562292 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m15:56:39.565041 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m15:56:39.566217 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m15:56:39.568395 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m15:56:39.568989 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:56:39.569275 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m15:56:39.569564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.570714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.571168 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:56:39.571481 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m15:56:39.573857 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:56:39.575055 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:56:39.575404 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m15:56:39.576691 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.577924 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:56:39.578183 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m15:56:39.579316 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.581315 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:56:39.581563 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m15:56:39.582244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.583974 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:56:39.584238 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m15:56:39.584875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.585787 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m15:56:39.586038 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:56:39.586239 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m15:56:39.592271 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:56:39.594101 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:56:39.594370 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m15:56:39.599218 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.600646 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m15:56:39.601335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787696087fe0>]}
[0m15:56:39.601807 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m15:56:39.602255 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m15:56:39.602550 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m15:56:39.602936 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m15:56:39.603380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m15:56:39.603651 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m15:56:39.605463 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m15:56:39.605950 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m15:56:39.608412 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m15:56:39.609098 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:56:39.609406 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m15:56:39.609658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.610493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.610762 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:56:39.610967 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m15:56:39.613021 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:56:39.613811 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:56:39.614058 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m15:56:39.614785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.615651 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:56:39.615884 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m15:56:39.616991 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.619527 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:56:39.619836 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m15:56:39.620530 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.622419 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:56:39.622707 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m15:56:39.623524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.624674 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m15:56:39.624953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:56:39.625166 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m15:56:39.630081 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.633112 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:56:39.633438 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m15:56:39.638575 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.639868 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m15:56:39.640627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787696173860>]}
[0m15:56:39.641166 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m15:56:39.641647 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m15:56:39.641986 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m15:56:39.642326 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m15:56:39.643138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m15:56:39.643567 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m15:56:39.645790 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.646338 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m15:56:39.648388 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.648923 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.649176 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m15:56:39.649443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.650224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.650478 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.650718 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m15:56:39.652010 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.652825 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.653110 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m15:56:39.653870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.654806 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.655080 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m15:56:39.656046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.658520 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.658929 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m15:56:39.659899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.661796 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.662065 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m15:56:39.662657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.663619 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m15:56:39.663872 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.664078 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m15:56:39.669822 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.671800 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:56:39.672078 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m15:56:39.677574 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.678667 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m15:56:39.679465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876be229fa0>]}
[0m15:56:39.679885 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m15:56:39.680300 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m15:56:39.680623 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m15:56:39.680972 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m15:56:39.681354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m15:56:39.681738 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m15:56:39.684131 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m15:56:39.684614 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m15:56:39.686321 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m15:56:39.686782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:56:39.687021 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m15:56:39.687207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.687921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.688142 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:56:39.688415 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m15:56:39.715505 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m15:56:39.716503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:56:39.716781 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m15:56:39.717667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.718736 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:56:39.719017 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m15:56:39.719959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.721873 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:56:39.722136 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m15:56:39.722903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.724637 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:56:39.724886 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m15:56:39.725654 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.726550 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m15:56:39.726860 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:56:39.727073 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m15:56:39.733395 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:56:39.736098 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:56:39.736370 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m15:56:39.741232 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.742831 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m15:56:39.744028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787696141970>]}
[0m15:56:39.744489 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.06s]
[0m15:56:39.744917 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m15:56:39.745204 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m15:56:39.745513 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m15:56:39.745842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m15:56:39.746473 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m15:56:39.748774 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m15:56:39.749227 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m15:56:39.751112 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m15:56:39.751544 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:56:39.751783 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m15:56:39.751980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.752694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.752919 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:56:39.753151 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m15:56:39.758303 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.759568 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:56:39.759907 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m15:56:39.760815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.761782 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:56:39.762032 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m15:56:39.762896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.764965 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:56:39.765219 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m15:56:39.765798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.767586 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:56:39.767844 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m15:56:39.768368 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.769263 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m15:56:39.769513 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:56:39.769715 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m15:56:39.775819 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:56:39.777637 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:56:39.777907 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m15:56:39.782837 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.784230 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m15:56:39.786095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787696085250>]}
[0m15:56:39.786592 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m15:56:39.787048 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m15:56:39.787357 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m15:56:39.787684 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m15:56:39.788141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m15:56:39.788382 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m15:56:39.790790 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m15:56:39.791342 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m15:56:39.793486 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m15:56:39.794032 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:56:39.794286 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m15:56:39.794482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:39.795275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.795499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:56:39.795813 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek >= (select * from gameweeks) and gameweek <= ((select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(opponent_abbreviation, '/') over (partition by team_abbreviation order by gameweek) as opponent_abbreviations,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 3 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 3 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.opponent_abbreviations,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        opponent_abbreviations,
        attacking_biases_value,
        defending_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m15:56:39.819338 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m15:56:39.820300 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:56:39.820577 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m15:56:39.821481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.822347 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:56:39.822639 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m15:56:39.823870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:39.826239 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:56:39.826519 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m15:56:39.827208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.828914 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:56:39.829166 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m15:56:39.829713 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:39.830575 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m15:56:39.830902 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:56:39.831107 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m15:56:39.837945 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:56:39.839596 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:56:39.839855 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m15:56:39.844930 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:56:39.846515 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m15:56:39.848619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4c3ff-6999-4bbe-9aff-9af89d68fc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787696093dd0>]}
[0m15:56:39.849073 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.06s]
[0m15:56:39.849519 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m15:56:39.851143 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:39.851531 [debug] [MainThread]: On master: BEGIN
[0m15:56:39.851824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:39.852972 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:56:39.853339 [debug] [MainThread]: On master: COMMIT
[0m15:56:39.853637 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:39.853913 [debug] [MainThread]: On master: COMMIT
[0m15:56:39.854597 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:56:39.854896 [debug] [MainThread]: On master: Close
[0m15:56:39.855233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:39.855426 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m15:56:39.855669 [info ] [MainThread]: 
[0m15:56:39.855926 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m15:56:39.857220 [debug] [MainThread]: Command end result
[0m15:56:39.870360 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m15:56:39.871746 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m15:56:39.876111 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m15:56:39.876415 [info ] [MainThread]: 
[0m15:56:39.876738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:39.876965 [info ] [MainThread]: 
[0m15:56:39.877200 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m15:56:39.878916 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7943206, "process_in_blocks": "111640", "process_kernel_time": 0.395583, "process_mem_max_rss": "185184", "process_out_blocks": "4840", "process_user_time": 2.785232}
[0m15:56:39.879271 [debug] [MainThread]: Command `dbt build` succeeded at 15:56:39.879201 after 1.79 seconds
[0m15:56:39.879519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876c819de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876c86d9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876bc943560>]}
[0m15:56:39.879755 [debug] [MainThread]: Flushing usage events
[0m15:56:40.463589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:55.074315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70815b082cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70815a5d7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70815a5d73b0>]}


============================== 15:58:55.079227 | 2f71b201-1b2e-457a-8439-4407966f0c52 ==============================
[0m15:58:55.079227 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:58:55.079687 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt build', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/robgriffin247/fpl/logs', 'cache_selected_only': 'False', 'profiles_dir': '/home/robgriffin247/fpl', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True'}
[0m15:58:55.302297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70815a1b6690>]}
[0m15:58:55.359940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70815c123fe0>]}
[0m15:58:55.362550 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:58:55.416542 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:58:55.519029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:58:55.519571 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m15:58:55.789124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081412f3c50>]}
[0m15:58:55.830939 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m15:58:55.833101 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m15:58:55.914147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708142bfe660>]}
[0m15:58:55.914549 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m15:58:55.916378 [info ] [MainThread]: 
[0m15:58:55.916764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:55.917013 [info ] [MainThread]: 
[0m15:58:55.917405 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:58:55.921568 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m15:58:55.954080 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m15:58:55.954441 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m15:58:55.954721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:55.987890 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m15:58:55.989204 [debug] [ThreadPool]: On list_analytics: Close
[0m15:58:55.991123 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m15:58:55.991731 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m15:58:55.992164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:55.994117 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:58:55.995317 [debug] [ThreadPool]: On list_analytics: Close
[0m15:58:55.997068 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m15:58:55.997460 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m15:58:55.997692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:55.998963 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:55.999919 [debug] [ThreadPool]: On list_analytics: Close
[0m15:58:56.000904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m15:58:56.001306 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m15:58:56.006351 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:58:56.006858 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m15:58:56.007080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:56.008255 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.009389 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:58:56.009660 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m15:58:56.010681 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.010974 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:58:56.011153 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m15:58:56.011759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:56.012414 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m15:58:56.012666 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:58:56.012847 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m15:58:56.014237 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.014553 [debug] [ThreadPool]: On create_analytics_core: Close
[0m15:58:56.015208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m15:58:56.015587 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m15:58:56.016914 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:58:56.017229 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m15:58:56.017470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:56.018696 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.019876 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:58:56.020224 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m15:58:56.021258 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.021644 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:58:56.021892 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m15:58:56.022696 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.023524 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m15:58:56.023789 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:58:56.023991 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m15:58:56.024681 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:56.024935 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m15:58:56.025554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m15:58:56.025941 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m15:58:56.027385 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:58:56.027722 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m15:58:56.027966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:56.029291 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.030352 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:58:56.030635 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m15:58:56.031345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:56.031550 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:58:56.031716 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m15:58:56.032389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:56.033476 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m15:58:56.033763 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:58:56.033957 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m15:58:56.034870 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.035350 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m15:58:56.037347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m15:58:56.041648 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m15:58:56.042106 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m15:58:56.042399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:56.043373 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.043622 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m15:58:56.043809 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m15:58:56.057017 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:58:56.058443 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m15:58:56.060814 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m15:58:56.061066 [debug] [ThreadPool]: On list_analytics_core: Close
[0m15:58:56.061738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m15:58:56.063955 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m15:58:56.064358 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m15:58:56.064580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:56.066047 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.066592 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m15:58:56.067055 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m15:58:56.070244 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:58:56.071393 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m15:58:56.071999 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m15:58:56.072217 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m15:58:56.072885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m15:58:56.074113 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m15:58:56.074389 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m15:58:56.074677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:56.075941 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:56.076185 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m15:58:56.076364 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m15:58:56.079240 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:58:56.080399 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m15:58:56.080956 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m15:58:56.081191 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m15:58:56.083136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708155f0f0e0>]}
[0m15:58:56.083621 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:56.083829 [debug] [MainThread]: On master: BEGIN
[0m15:58:56.084020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:56.084782 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:58:56.085024 [debug] [MainThread]: On master: COMMIT
[0m15:58:56.085192 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:56.085336 [debug] [MainThread]: On master: COMMIT
[0m15:58:56.085832 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:56.086066 [debug] [MainThread]: On master: Close
[0m15:58:56.091082 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m15:58:56.091605 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m15:58:56.092266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m15:58:56.092578 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m15:58:56.097445 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m15:58:56.097983 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m15:58:56.119599 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m15:58:56.120220 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:58:56.120492 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m15:58:56.120734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.121502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.121743 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:58:56.121931 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m15:58:56.125391 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:58:56.128967 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:58:56.129245 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m15:58:56.130075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.131118 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:58:56.131389 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m15:58:56.134702 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:58:56.139082 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:58:56.139370 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m15:58:56.140703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.142597 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:58:56.142881 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m15:58:56.143473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.153238 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m15:58:56.153575 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:58:56.153791 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m15:58:56.160125 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.164144 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:58:56.164455 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m15:58:56.170011 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.172322 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m15:58:56.174204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081407e0050>]}
[0m15:58:56.174768 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.08s]
[0m15:58:56.175194 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m15:58:56.175482 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m15:58:56.175835 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m15:58:56.176244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m15:58:56.176772 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m15:58:56.179042 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.179619 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m15:58:56.182929 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.183533 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.183821 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m15:58:56.184050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.184897 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.185140 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.185336 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m15:58:56.187368 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:56.188215 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.188464 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m15:58:56.189279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.190179 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.190422 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m15:58:56.191296 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.193489 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.193756 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m15:58:56.194660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.196613 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.196869 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m15:58:56.197431 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.198404 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m15:58:56.198706 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.198965 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m15:58:56.204225 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.206043 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:58:56.206317 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m15:58:56.211702 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.213272 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m15:58:56.214026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bf64e00>]}
[0m15:58:56.214867 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m15:58:56.215394 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m15:58:56.215719 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m15:58:56.216104 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m15:58:56.216687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m15:58:56.217233 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m15:58:56.219858 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m15:58:56.220319 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m15:58:56.222220 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m15:58:56.222745 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:58:56.222986 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m15:58:56.223181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.223882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.224134 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:58:56.224490 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m15:58:56.231302 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.232279 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:58:56.232566 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m15:58:56.233917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.235257 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:58:56.235626 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m15:58:56.236828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.239088 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:58:56.239389 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m15:58:56.240021 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.241872 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:58:56.242120 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m15:58:56.242804 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.243760 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m15:58:56.244007 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:58:56.244201 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m15:58:56.250370 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.252327 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:58:56.252604 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m15:58:56.257924 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.259446 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m15:58:56.260202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bf1b080>]}
[0m15:58:56.260693 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.04s]
[0m15:58:56.261092 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m15:58:56.261375 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m15:58:56.261734 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m15:58:56.262230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m15:58:56.262487 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m15:58:56.264409 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m15:58:56.264848 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m15:58:56.266952 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m15:58:56.267512 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:58:56.267781 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m15:58:56.268042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.269086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.269394 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:58:56.269618 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m15:58:56.271737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:56.272605 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:58:56.272867 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m15:58:56.273690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.275970 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:58:56.276246 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m15:58:56.277377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.279835 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:58:56.280086 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m15:58:56.280852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.282589 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:58:56.282897 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m15:58:56.283938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.284904 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m15:58:56.285163 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:58:56.285407 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m15:58:56.291391 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.293028 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:58:56.293351 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m15:58:56.299238 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.300384 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m15:58:56.301171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708140713410>]}
[0m15:58:56.301672 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m15:58:56.302078 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m15:58:56.302382 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m15:58:56.302817 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m15:58:56.303217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m15:58:56.303486 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m15:58:56.305503 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m15:58:56.306429 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m15:58:56.308403 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m15:58:56.308927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:58:56.309167 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m15:58:56.309368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.310114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.310352 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:58:56.310547 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m15:58:56.313201 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:56.314455 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:58:56.315111 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m15:58:56.316261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.317283 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:58:56.317543 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m15:58:56.318842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.321765 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:58:56.322075 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m15:58:56.322967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.324881 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:58:56.325130 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m15:58:56.326037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.327436 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m15:58:56.327712 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:58:56.327955 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m15:58:56.334924 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:58:56.336734 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:58:56.337014 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m15:58:56.343092 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.344177 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m15:58:56.344730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708140713140>]}
[0m15:58:56.345225 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m15:58:56.345612 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m15:58:56.345900 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m15:58:56.346224 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m15:58:56.346648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m15:58:56.346945 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m15:58:56.348976 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m15:58:56.349517 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m15:58:56.351625 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m15:58:56.352087 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:58:56.352325 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m15:58:56.352518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.353284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.353537 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:58:56.353755 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m15:58:56.356277 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:56.357093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:58:56.357374 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m15:58:56.358287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.359414 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:58:56.359722 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m15:58:56.360792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.363908 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:58:56.364244 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m15:58:56.365150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.367185 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:58:56.367517 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m15:58:56.368736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.369731 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m15:58:56.369972 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:58:56.370160 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m15:58:56.377010 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:58:56.378772 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:58:56.379039 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m15:58:56.384713 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.385948 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m15:58:56.386640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bfb2ff0>]}
[0m15:58:56.387133 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m15:58:56.387558 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m15:58:56.387831 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m15:58:56.388172 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m15:58:56.388552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m15:58:56.388813 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m15:58:56.390968 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m15:58:56.391862 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m15:58:56.393786 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m15:58:56.394223 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:58:56.394457 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m15:58:56.394726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.395682 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.396091 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:58:56.396468 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m15:58:56.400476 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:58:56.401691 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:58:56.402046 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m15:58:56.402998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.403981 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:58:56.404235 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m15:58:56.405491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.408074 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:58:56.408348 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m15:58:56.409005 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.410818 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:58:56.411107 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m15:58:56.411663 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.412571 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m15:58:56.412832 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:58:56.413038 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m15:58:56.419277 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.421155 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:58:56.421451 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m15:58:56.426379 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.427732 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m15:58:56.428466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081408c5310>]}
[0m15:58:56.428946 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m15:58:56.429349 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m15:58:56.429645 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m15:58:56.430300 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m15:58:56.430766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m15:58:56.431064 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m15:58:56.432987 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m15:58:56.433442 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m15:58:56.435463 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m15:58:56.435931 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:58:56.436183 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m15:58:56.436374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.437086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.437304 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:58:56.437503 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m15:58:56.438691 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.439486 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:58:56.439725 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m15:58:56.440482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.441353 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:58:56.441598 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m15:58:56.442506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.444495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:58:56.444743 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m15:58:56.445309 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.448029 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:58:56.448427 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m15:58:56.449432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.450832 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m15:58:56.451188 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:58:56.451404 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m15:58:56.456191 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:58:56.457913 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:58:56.458185 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m15:58:56.463024 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:58:56.464298 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m15:58:56.464930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bf8ef00>]}
[0m15:58:56.465458 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.03s]
[0m15:58:56.465931 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m15:58:56.466249 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m15:58:56.466666 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m15:58:56.467125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m15:58:56.467439 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m15:58:56.469428 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m15:58:56.470384 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m15:58:56.472401 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m15:58:56.472875 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:58:56.473145 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m15:58:56.473355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.474339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.474855 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:58:56.475284 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m15:58:56.476977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.477792 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:58:56.478044 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m15:58:56.479240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.480833 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:58:56.481119 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m15:58:56.482701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.485255 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:58:56.485524 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m15:58:56.486634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.488378 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:58:56.488646 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m15:58:56.489362 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.490245 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m15:58:56.490499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:58:56.490747 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m15:58:56.496648 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.498435 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:58:56.498834 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m15:58:56.503843 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.505415 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m15:58:56.506226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bf03650>]}
[0m15:58:56.506934 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m15:58:56.507476 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m15:58:56.507790 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m15:58:56.508123 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m15:58:56.508574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m15:58:56.508892 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m15:58:56.510846 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m15:58:56.511463 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m15:58:56.513321 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m15:58:56.513813 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:58:56.514066 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m15:58:56.514289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.515182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.515485 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:58:56.515696 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m15:58:56.518468 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:56.519436 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:58:56.519720 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m15:58:56.520522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.521425 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:58:56.521676 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m15:58:56.522610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.524809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:58:56.525095 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m15:58:56.525816 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.527729 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:58:56.527984 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m15:58:56.528555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.529478 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m15:58:56.529730 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:58:56.529922 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m15:58:56.535723 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.538815 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:58:56.539129 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m15:58:56.544930 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.546269 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m15:58:56.547105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bfd64e0>]}
[0m15:58:56.547628 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m15:58:56.548044 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m15:58:56.548328 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m15:58:56.548678 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m15:58:56.549401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m15:58:56.549674 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m15:58:56.551621 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.552108 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m15:58:56.554055 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.554513 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.554852 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m15:58:56.555110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.556136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.556499 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.556728 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m15:58:56.558100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.559084 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.559429 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m15:58:56.560499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.561842 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.562282 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m15:58:56.563467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.565927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.566256 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m15:58:56.567188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.569080 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.569333 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m15:58:56.569924 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.570834 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m15:58:56.571122 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.571339 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m15:58:56.577301 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.579143 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:58:56.579444 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m15:58:56.584986 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.586767 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m15:58:56.587396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bfd5c40>]}
[0m15:58:56.587924 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m15:58:56.588390 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m15:58:56.588690 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m15:58:56.589056 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m15:58:56.589537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m15:58:56.589776 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m15:58:56.592230 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m15:58:56.592688 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m15:58:56.594548 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m15:58:56.595070 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:58:56.595325 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m15:58:56.595547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.596298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.596566 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:58:56.596888 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m15:58:56.623696 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m15:58:56.624815 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:58:56.625140 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m15:58:56.625983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.627065 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:58:56.627322 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m15:58:56.628354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.630253 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:58:56.630527 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m15:58:56.631445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.633012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:58:56.633247 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m15:58:56.633971 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.634913 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m15:58:56.635148 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:58:56.635329 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m15:58:56.642236 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:58:56.645133 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:58:56.645438 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m15:58:56.651479 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.652739 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m15:58:56.654669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bf88710>]}
[0m15:58:56.655189 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.07s]
[0m15:58:56.655631 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m15:58:56.655954 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m15:58:56.656293 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m15:58:56.657250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m15:58:56.657528 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m15:58:56.659708 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m15:58:56.660195 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m15:58:56.662093 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m15:58:56.662621 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:58:56.662947 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m15:58:56.663186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.664233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.664599 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:58:56.664844 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m15:58:56.671057 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.672117 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:58:56.672413 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m15:58:56.673410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.674360 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:58:56.674668 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m15:58:56.675750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.677852 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:58:56.678106 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m15:58:56.678796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.680642 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:58:56.680959 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m15:58:56.681850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.682909 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m15:58:56.683174 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:58:56.683430 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m15:58:56.689622 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:58:56.691505 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:58:56.691782 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m15:58:56.697034 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.698199 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m15:58:56.699084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bf0faa0>]}
[0m15:58:56.699540 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m15:58:56.699955 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m15:58:56.700281 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m15:58:56.700653 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m15:58:56.701059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m15:58:56.701441 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m15:58:56.704078 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m15:58:56.705268 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m15:58:56.707507 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m15:58:56.707979 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:58:56.708226 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m15:58:56.708410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.709197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.709422 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:58:56.709695 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek >= (select * from gameweeks) and gameweek <= ((select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(opponent_abbreviation, '/') over (partition by team_abbreviation order by gameweek) as opponent_abbreviations,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 3 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 3 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.opponent_abbreviations,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        opponent_abbreviations || ': ' || biases as biases,
        attacking_biases_value,
        defending_biases_value,
        --biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m15:58:56.731580 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m15:58:56.732658 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:58:56.732969 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m15:58:56.734020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.735030 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:58:56.735264 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m15:58:56.736269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:56.738292 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:58:56.738531 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m15:58:56.739260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.740929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:58:56.741172 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m15:58:56.741714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:56.742589 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m15:58:56.742854 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:58:56.743050 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m15:58:56.750538 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:58:56.752348 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:58:56.752621 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m15:58:56.758345 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:56.759558 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m15:58:56.762268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f71b201-1b2e-457a-8439-4407966f0c52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70813bf003e0>]}
[0m15:58:56.762775 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.06s]
[0m15:58:56.763256 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m15:58:56.765238 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:56.765534 [debug] [MainThread]: On master: BEGIN
[0m15:58:56.765735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:56.766503 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:58:56.766833 [debug] [MainThread]: On master: COMMIT
[0m15:58:56.767015 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:56.767167 [debug] [MainThread]: On master: COMMIT
[0m15:58:56.767604 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:56.767803 [debug] [MainThread]: On master: Close
[0m15:58:56.768107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:56.768288 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m15:58:56.768564 [info ] [MainThread]: 
[0m15:58:56.768816 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m15:58:56.770043 [debug] [MainThread]: Command end result
[0m15:58:56.782882 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m15:58:56.784614 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m15:58:56.788941 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m15:58:56.789230 [info ] [MainThread]: 
[0m15:58:56.789540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:56.789798 [info ] [MainThread]: 
[0m15:58:56.790069 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m15:58:56.791679 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7692358, "process_in_blocks": "110096", "process_kernel_time": 0.367497, "process_mem_max_rss": "185476", "process_out_blocks": "4848", "process_user_time": 2.764397}
[0m15:58:56.792087 [debug] [MainThread]: Command `dbt build` succeeded at 15:58:56.792003 after 1.77 seconds
[0m15:58:56.792400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70815bf37cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708150118740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70815a1d81a0>]}
[0m15:58:56.792677 [debug] [MainThread]: Flushing usage events
[0m15:58:57.352919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:50.578211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deca4ee3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deca641e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deca46d1430>]}


============================== 15:59:50.580652 | d83e0912-4db7-425e-9509-276546b75854 ==============================
[0m15:59:50.580652 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:59:50.581056 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/robgriffin247/fpl/logs', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'profiles_dir': '/home/robgriffin247/fpl'}
[0m15:59:50.771047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec9a42e210>]}
[0m15:59:50.840610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deca5226e70>]}
[0m15:59:50.842175 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:59:50.939059 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:59:51.019607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:51.020314 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m15:59:51.339979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec82deffb0>]}
[0m15:59:51.387963 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m15:59:51.389711 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m15:59:51.473152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec9a0d98b0>]}
[0m15:59:51.473644 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m15:59:51.475807 [info ] [MainThread]: 
[0m15:59:51.476212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:51.476491 [info ] [MainThread]: 
[0m15:59:51.476904 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:59:51.481940 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m15:59:51.509875 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m15:59:51.510247 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m15:59:51.510464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:51.532648 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m15:59:51.534311 [debug] [ThreadPool]: On list_analytics: Close
[0m15:59:51.536422 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m15:59:51.536965 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m15:59:51.537224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:51.538428 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:51.539397 [debug] [ThreadPool]: On list_analytics: Close
[0m15:59:51.541070 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m15:59:51.541337 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m15:59:51.541587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:51.542659 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:51.543480 [debug] [ThreadPool]: On list_analytics: Close
[0m15:59:51.544471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m15:59:51.544860 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m15:59:51.550061 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:59:51.550484 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m15:59:51.550732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:51.552081 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:51.553317 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:59:51.553622 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m15:59:51.554112 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:51.554352 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:59:51.554521 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m15:59:51.555295 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:51.556013 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m15:59:51.556230 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m15:59:51.556392 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m15:59:51.556818 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:51.557064 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m15:59:51.557588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now create_analytics_intermediate)
[0m15:59:51.557929 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m15:59:51.559250 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:59:51.559508 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m15:59:51.559745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:51.560724 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:51.561610 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:59:51.561820 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m15:59:51.562242 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:51.562429 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:59:51.562577 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m15:59:51.563210 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:51.563787 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m15:59:51.564016 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m15:59:51.564221 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m15:59:51.564717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:51.565057 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m15:59:51.565986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m15:59:51.566340 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m15:59:51.567708 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:59:51.568021 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m15:59:51.568228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:51.569464 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:51.570439 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:59:51.570696 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m15:59:51.571226 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:51.571451 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:59:51.571620 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m15:59:51.572304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:51.572952 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m15:59:51.573175 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m15:59:51.573345 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m15:59:51.573982 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:51.574365 [debug] [ThreadPool]: On create_analytics_core: Close
[0m15:59:51.576320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now list_analytics_staging)
[0m15:59:51.580369 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m15:59:51.580991 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m15:59:51.581512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:51.582823 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:51.583131 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m15:59:51.583337 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m15:59:51.592732 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m15:59:51.593946 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m15:59:51.594850 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m15:59:51.595227 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m15:59:51.595765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_staging, now list_analytics_intermediate)
[0m15:59:51.598415 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m15:59:51.598979 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m15:59:51.599386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:51.601705 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:51.602067 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m15:59:51.602290 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m15:59:51.605819 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:59:51.607243 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m15:59:51.607834 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m15:59:51.608025 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m15:59:51.608532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m15:59:51.609715 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m15:59:51.609955 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m15:59:51.610190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:51.611329 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:51.611545 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m15:59:51.611735 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m15:59:51.614251 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:51.615779 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m15:59:51.616540 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m15:59:51.616776 [debug] [ThreadPool]: On list_analytics_core: Close
[0m15:59:51.618115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec8221ca70>]}
[0m15:59:51.618507 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:51.618851 [debug] [MainThread]: On master: BEGIN
[0m15:59:51.619037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:51.619747 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:59:51.619993 [debug] [MainThread]: On master: COMMIT
[0m15:59:51.620162 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:51.620306 [debug] [MainThread]: On master: COMMIT
[0m15:59:51.620737 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:59:51.620952 [debug] [MainThread]: On master: Close
[0m15:59:51.624394 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m15:59:51.624841 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m15:59:51.625452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_core, now model.fpl_analytics.stg_fixtures)
[0m15:59:51.625743 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m15:59:51.631129 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m15:59:51.631868 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m15:59:51.657716 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m15:59:51.658505 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:59:51.658910 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m15:59:51.659141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:51.660225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.660485 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:59:51.660699 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m15:59:51.662457 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:59:51.666820 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:59:51.667249 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m15:59:51.668461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.669608 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:59:51.669943 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m15:59:51.671383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.676528 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:59:51.676853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m15:59:51.677914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.680274 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:59:51.680641 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m15:59:51.681418 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:51.694309 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m15:59:51.694867 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:59:51.695144 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m15:59:51.704277 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:59:51.708886 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m15:59:51.709222 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m15:59:51.714331 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:51.717006 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m15:59:51.719045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec822ed8e0>]}
[0m15:59:51.719635 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m15:59:51.720148 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m15:59:51.720500 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m15:59:51.720877 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m15:59:51.721767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m15:59:51.722116 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m15:59:51.724256 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.724794 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m15:59:51.727970 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.728451 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.728695 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m15:59:51.728924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:51.729669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.729934 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.730135 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m15:59:51.731921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.733130 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.733493 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m15:59:51.735010 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.736488 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.736789 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m15:59:51.738115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.740635 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.740938 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m15:59:51.741692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.743565 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.743828 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m15:59:51.744704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.746314 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m15:59:51.746838 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.747154 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m15:59:51.753150 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:51.755220 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m15:59:51.755546 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m15:59:51.760443 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:51.762036 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m15:59:51.763188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec803cf350>]}
[0m15:59:51.763711 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m15:59:51.764175 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m15:59:51.764549 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m15:59:51.764976 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m15:59:51.765629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m15:59:51.765971 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m15:59:51.768967 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m15:59:51.770228 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m15:59:51.772523 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m15:59:51.773012 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:59:51.773314 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m15:59:51.773564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:51.774347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.774603 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:59:51.774862 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m15:59:51.781681 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:51.782928 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:59:51.783272 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m15:59:51.784519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.785784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:59:51.786096 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m15:59:51.787593 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.790048 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:59:51.790333 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m15:59:51.791432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.794569 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:59:51.795137 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m15:59:51.796016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.796867 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m15:59:51.797093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:59:51.797282 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m15:59:51.804967 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:59:51.806943 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m15:59:51.807268 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m15:59:51.813455 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:51.815189 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m15:59:51.815967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec8037bc20>]}
[0m15:59:51.816476 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m15:59:51.816903 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m15:59:51.817252 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m15:59:51.817669 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m15:59:51.818445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m15:59:51.818811 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m15:59:51.821014 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m15:59:51.821511 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m15:59:51.823481 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m15:59:51.823944 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:59:51.824212 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m15:59:51.824409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:51.825134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.825355 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:59:51.825547 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m15:59:51.827439 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:59:51.828220 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:59:51.828450 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m15:59:51.829181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:51.831389 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:59:51.831663 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m15:59:51.832782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.836011 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:59:51.836576 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m15:59:51.837719 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.839696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:59:51.839953 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m15:59:51.840723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:51.841707 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m15:59:51.841982 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:59:51.842229 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m15:59:51.848817 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:51.851733 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m15:59:51.852260 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m15:59:51.858291 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:51.859577 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m15:59:51.860189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec803fdee0>]}
[0m15:59:51.860641 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m15:59:51.861052 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m15:59:51.861367 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m15:59:51.861717 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m15:59:51.862560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m15:59:51.862928 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m15:59:51.864977 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m15:59:51.865493 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m15:59:51.868757 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m15:59:51.869822 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:59:51.870187 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m15:59:51.870408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:51.871239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.871517 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:59:51.871752 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m15:59:51.873595 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:59:51.874439 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:59:51.874717 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m15:59:51.875785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.876842 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:59:51.877113 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m15:59:51.878610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.880921 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:59:51.881222 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m15:59:51.882011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.884103 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:59:51.884525 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m15:59:51.885766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.886885 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m15:59:51.887185 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:59:51.887438 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m15:59:51.893343 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:51.895082 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m15:59:51.895344 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m15:59:51.900897 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:51.902401 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m15:59:51.903333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec82282f90>]}
[0m15:59:51.903826 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m15:59:51.904276 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m15:59:51.904621 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m15:59:51.904974 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m15:59:51.905546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m15:59:51.905805 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m15:59:51.907826 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m15:59:51.908302 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m15:59:51.910308 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m15:59:51.910820 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:59:51.911123 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m15:59:51.911355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:51.912352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.912769 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:59:51.913134 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m15:59:51.915584 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:59:51.916721 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:59:51.917183 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m15:59:51.918829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.920403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:59:51.920746 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m15:59:51.922097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.925703 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:59:51.925999 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m15:59:51.926737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:51.928566 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:59:51.928824 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m15:59:51.929421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:51.930369 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m15:59:51.930636 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:59:51.930863 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m15:59:51.937629 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:51.939963 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m15:59:51.940308 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m15:59:51.945588 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:51.947343 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m15:59:51.947956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec8042cad0>]}
[0m15:59:51.948399 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m15:59:51.948913 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m15:59:51.949280 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m15:59:51.949647 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m15:59:51.950155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m15:59:51.950461 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m15:59:51.953013 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m15:59:51.954452 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m15:59:51.956853 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m15:59:51.957524 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:59:51.957832 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m15:59:51.958036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:51.958874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.959115 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:59:51.959319 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m15:59:51.961431 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:59:51.962267 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:59:51.962504 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m15:59:51.963271 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.964129 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:59:51.964373 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m15:59:51.965290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.967703 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:59:51.968056 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m15:59:51.969077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.971851 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:59:51.972219 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m15:59:51.973220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.974208 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m15:59:51.974472 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:59:51.974759 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m15:59:51.979797 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:51.981512 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m15:59:51.981794 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m15:59:51.986951 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:51.988424 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m15:59:51.989115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec8038bfb0>]}
[0m15:59:51.989598 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m15:59:51.990050 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m15:59:51.990374 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m15:59:51.990834 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m15:59:51.991204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m15:59:51.991493 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m15:59:51.993381 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m15:59:51.993820 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m15:59:51.995832 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m15:59:51.996292 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:59:51.996523 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m15:59:51.996727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:51.997459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:51.997689 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:59:51.997885 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m15:59:51.999215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.000166 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:59:52.000666 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m15:59:52.002011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.003122 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:59:52.003385 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m15:59:52.004427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.006445 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:59:52.006724 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m15:59:52.007363 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.010191 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:59:52.010448 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m15:59:52.011099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.011937 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m15:59:52.012192 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:59:52.012389 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m15:59:52.017998 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.020058 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m15:59:52.020352 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m15:59:52.025745 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.027321 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m15:59:52.028211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec803f7320>]}
[0m15:59:52.028746 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m15:59:52.029216 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m15:59:52.029531 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m15:59:52.029914 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m15:59:52.030483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m15:59:52.030941 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m15:59:52.033358 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m15:59:52.034017 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m15:59:52.036537 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m15:59:52.037234 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:59:52.037505 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m15:59:52.037715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:52.038524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.038801 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:59:52.039009 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m15:59:52.040332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.041089 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:59:52.041323 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m15:59:52.042080 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.043252 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:59:52.043532 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m15:59:52.044708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.046793 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:59:52.047046 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m15:59:52.047831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.049497 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:59:52.049726 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m15:59:52.050484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.051455 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m15:59:52.051790 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:59:52.052020 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m15:59:52.057517 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.059304 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m15:59:52.059573 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m15:59:52.065168 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.066287 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m15:59:52.067025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec80406510>]}
[0m15:59:52.067488 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m15:59:52.067912 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m15:59:52.068239 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m15:59:52.068575 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m15:59:52.069089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m15:59:52.069368 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m15:59:52.071322 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m15:59:52.071760 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m15:59:52.073657 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m15:59:52.074106 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:59:52.074344 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m15:59:52.074541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:52.075375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.075609 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:59:52.075812 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m15:59:52.077415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.078172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:59:52.078409 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m15:59:52.079170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.080017 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:59:52.080313 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m15:59:52.081562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.084302 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:59:52.084655 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m15:59:52.085701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.087696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:59:52.087964 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m15:59:52.088586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.089598 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m15:59:52.089855 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:59:52.090052 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m15:59:52.095684 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.099004 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m15:59:52.099398 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m15:59:52.105574 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:52.107215 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m15:59:52.107878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec804609e0>]}
[0m15:59:52.108421 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m15:59:52.108873 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m15:59:52.109234 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m15:59:52.109577 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m15:59:52.110072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m15:59:52.110444 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m15:59:52.112923 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.114049 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m15:59:52.116235 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.116794 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.117141 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m15:59:52.117383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:52.118277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.118642 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.118920 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m15:59:52.120238 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.121458 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.121738 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m15:59:52.122455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.123358 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.123588 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m15:59:52.124466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.126369 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.126622 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m15:59:52.127192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.129140 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.129431 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m15:59:52.130391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.131477 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m15:59:52.131744 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.131996 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m15:59:52.137406 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.139379 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m15:59:52.139671 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m15:59:52.145332 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.146739 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m15:59:52.147546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec804535f0>]}
[0m15:59:52.147985 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m15:59:52.148412 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m15:59:52.148700 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m15:59:52.149244 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m15:59:52.149609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m15:59:52.149876 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m15:59:52.152346 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m15:59:52.152832 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m15:59:52.154766 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m15:59:52.155227 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:59:52.155478 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m15:59:52.155694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:52.156412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.156630 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:59:52.156941 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m15:59:52.177506 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m15:59:52.178559 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:59:52.178982 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m15:59:52.179961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.181096 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:59:52.181370 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m15:59:52.182346 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.184415 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:59:52.184701 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m15:59:52.185619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.187532 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:59:52.187795 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m15:59:52.188547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.189473 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m15:59:52.189738 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:59:52.189951 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m15:59:52.196477 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:52.199549 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m15:59:52.199872 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m15:59:52.205365 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.207045 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m15:59:52.208246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec803f44a0>]}
[0m15:59:52.208746 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.06s]
[0m15:59:52.209198 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m15:59:52.209504 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m15:59:52.209865 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m15:59:52.210489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m15:59:52.210851 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m15:59:52.213088 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m15:59:52.213563 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m15:59:52.215493 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m15:59:52.215931 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:59:52.216163 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m15:59:52.216358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:52.217343 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.217758 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:59:52.218184 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m15:59:52.222957 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:59:52.224178 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:59:52.224533 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m15:59:52.225568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.226403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:59:52.226634 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m15:59:52.227839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.230931 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:59:52.231208 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m15:59:52.232013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.233819 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:59:52.234073 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m15:59:52.234660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.235645 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m15:59:52.235929 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:59:52.236155 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m15:59:52.242615 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:52.244462 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m15:59:52.244723 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m15:59:52.250046 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.251252 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m15:59:52.252649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec8223c260>]}
[0m15:59:52.253079 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m15:59:52.253500 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m15:59:52.253844 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m15:59:52.254181 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m15:59:52.254603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m15:59:52.254927 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m15:59:52.257540 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m15:59:52.258310 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m15:59:52.260723 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m15:59:52.261332 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:59:52.261629 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m15:59:52.261865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:52.262648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.262971 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:59:52.263306 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek >= (select * from gameweeks) and gameweek <= ((select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(opponent_abbreviation, '/') over (partition by team_abbreviation order by gameweek) as opponent_abbreviations,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 3 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 3 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.opponent_abbreviations,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        opponent_abbreviations,
        attacking_biases_value,
        defending_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m15:59:52.285799 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m15:59:52.287280 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:59:52.287714 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m15:59:52.288867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.289922 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:59:52.290234 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m15:59:52.291467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.294074 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:59:52.294427 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m15:59:52.295492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:52.297519 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:59:52.297765 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m15:59:52.298428 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:52.299425 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m15:59:52.299689 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:59:52.299875 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m15:59:52.306934 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:59:52.308800 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m15:59:52.309083 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m15:59:52.314823 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:52.315907 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m15:59:52.317961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd83e0912-4db7-425e-9509-276546b75854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec8223f3e0>]}
[0m15:59:52.318529 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.06s]
[0m15:59:52.319075 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m15:59:52.321294 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:52.321676 [debug] [MainThread]: On master: BEGIN
[0m15:59:52.322014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:52.323205 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:59:52.323490 [debug] [MainThread]: On master: COMMIT
[0m15:59:52.323742 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:52.323916 [debug] [MainThread]: On master: COMMIT
[0m15:59:52.324571 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:59:52.324823 [debug] [MainThread]: On master: Close
[0m15:59:52.325168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:52.325357 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m15:59:52.325672 [info ] [MainThread]: 
[0m15:59:52.325968 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m15:59:52.327469 [debug] [MainThread]: Command end result
[0m15:59:52.340909 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m15:59:52.342439 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m15:59:52.346967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m15:59:52.347231 [info ] [MainThread]: 
[0m15:59:52.347508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:52.347732 [info ] [MainThread]: 
[0m15:59:52.348003 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m15:59:52.348890 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.8197986, "process_in_blocks": "0", "process_kernel_time": 0.270086, "process_mem_max_rss": "186084", "process_out_blocks": "4832", "process_user_time": 2.866145}
[0m15:59:52.349197 [debug] [MainThread]: Command `dbt build` succeeded at 15:59:52.349129 after 1.82 seconds
[0m15:59:52.349473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deca46d1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec9872d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dec822eda30>]}
[0m15:59:52.349745 [debug] [MainThread]: Flushing usage events
[0m15:59:52.891010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:10.382701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabfb60ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabfb9e9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabfb8a77a0>]}


============================== 16:01:10.386162 | 0d6abe6a-1175-4e23-b0d9-c2b33d052e51 ==============================
[0m16:01:10.386162 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:01:10.386665 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/robgriffin247/fpl', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt build', 'empty': 'False', 'introspect': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'log_path': '/home/robgriffin247/fpl/logs'}
[0m16:01:10.622878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabf112e7e0>]}
[0m16:01:10.685612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabfb0434a0>]}
[0m16:01:10.689098 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:01:10.748496 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:01:10.853728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:01:10.854320 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m16:01:11.151474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc1befc80>]}
[0m16:01:11.191869 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m16:01:11.193916 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m16:01:11.272250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabf0be34d0>]}
[0m16:01:11.272633 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m16:01:11.274463 [info ] [MainThread]: 
[0m16:01:11.274816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:11.275060 [info ] [MainThread]: 
[0m16:01:11.275451 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:01:11.279281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m16:01:11.311427 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m16:01:11.311787 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m16:01:11.312044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:11.340344 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m16:01:11.342122 [debug] [ThreadPool]: On list_analytics: Close
[0m16:01:11.343951 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m16:01:11.344258 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m16:01:11.344532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:11.345597 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.346465 [debug] [ThreadPool]: On list_analytics: Close
[0m16:01:11.348039 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m16:01:11.348325 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m16:01:11.348581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:11.349748 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.350969 [debug] [ThreadPool]: On list_analytics: Close
[0m16:01:11.351710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_core)
[0m16:01:11.352030 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m16:01:11.356354 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m16:01:11.356624 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m16:01:11.356798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:11.357852 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.358853 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m16:01:11.359070 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m16:01:11.359496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:01:11.359679 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m16:01:11.359826 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m16:01:11.360267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:01:11.360803 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m16:01:11.360991 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m16:01:11.361143 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m16:01:11.362533 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.362832 [debug] [ThreadPool]: On create_analytics_core: Close
[0m16:01:11.363300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_intermediate)
[0m16:01:11.363630 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m16:01:11.364729 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m16:01:11.365015 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m16:01:11.365263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:11.366210 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.367048 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m16:01:11.367262 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m16:01:11.367665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:01:11.367856 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m16:01:11.368014 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m16:01:11.368444 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:01:11.368951 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m16:01:11.369127 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m16:01:11.369299 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m16:01:11.369656 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:01:11.369839 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m16:01:11.370313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_staging)
[0m16:01:11.370651 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m16:01:11.371798 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m16:01:11.372102 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m16:01:11.372351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:11.373357 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.374257 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m16:01:11.374473 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m16:01:11.375348 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.375576 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m16:01:11.375752 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m16:01:11.376233 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:01:11.376802 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m16:01:11.377022 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m16:01:11.377199 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m16:01:11.377616 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:01:11.377821 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m16:01:11.379758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_core)
[0m16:01:11.383920 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m16:01:11.384180 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m16:01:11.384356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:11.385040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.385251 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m16:01:11.385432 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m16:01:11.397594 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:01:11.398941 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m16:01:11.401293 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m16:01:11.401529 [debug] [ThreadPool]: On list_analytics_core: Close
[0m16:01:11.402027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_intermediate)
[0m16:01:11.404123 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m16:01:11.404409 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m16:01:11.404626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:11.405635 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.405897 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m16:01:11.406089 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m16:01:11.408882 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:01:11.409846 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m16:01:11.410399 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m16:01:11.410649 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m16:01:11.411148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_staging)
[0m16:01:11.412266 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m16:01:11.412503 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m16:01:11.412703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:11.413877 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:01:11.414084 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m16:01:11.414260 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m16:01:11.416994 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:01:11.418042 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m16:01:11.418612 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m16:01:11.418853 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m16:01:11.420215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabf0deb4a0>]}
[0m16:01:11.420546 [debug] [MainThread]: Using duckdb connection "master"
[0m16:01:11.420724 [debug] [MainThread]: On master: BEGIN
[0m16:01:11.420878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:11.421398 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:01:11.421601 [debug] [MainThread]: On master: COMMIT
[0m16:01:11.421821 [debug] [MainThread]: Using duckdb connection "master"
[0m16:01:11.422029 [debug] [MainThread]: On master: COMMIT
[0m16:01:11.422821 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:01:11.423052 [debug] [MainThread]: On master: Close
[0m16:01:11.427713 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m16:01:11.428133 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m16:01:11.428693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m16:01:11.428996 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m16:01:11.433862 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m16:01:11.434434 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m16:01:11.456373 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m16:01:11.456979 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:01:11.457294 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m16:01:11.457494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.458207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.458428 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:01:11.458676 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m16:01:11.462492 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:01:11.466111 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:01:11.466386 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m16:01:11.467160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.468015 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:01:11.468268 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m16:01:11.471952 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:01:11.477488 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:01:11.477781 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m16:01:11.479468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.481157 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:01:11.481401 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m16:01:11.481957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:01:11.491835 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m16:01:11.492169 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:01:11.492382 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m16:01:11.500051 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:01:11.504287 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:01:11.504624 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m16:01:11.510830 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:11.512900 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m16:01:11.514836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabfd72ab70>]}
[0m16:01:11.515290 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.08s]
[0m16:01:11.515744 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m16:01:11.516066 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m16:01:11.516392 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m16:01:11.517107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m16:01:11.517467 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m16:01:11.519567 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.520419 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m16:01:11.523939 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.524555 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.524888 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m16:01:11.525115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.525973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.526241 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.526460 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m16:01:11.529490 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:01:11.531047 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.531318 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m16:01:11.532150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.532983 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.533223 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m16:01:11.534233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.536322 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.536597 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m16:01:11.537815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.539927 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.540210 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m16:01:11.541064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.541954 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m16:01:11.542205 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.542410 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m16:01:11.549050 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:11.550802 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:01:11.551065 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m16:01:11.556631 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:11.557808 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m16:01:11.558665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc04c07d0>]}
[0m16:01:11.559201 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.04s]
[0m16:01:11.559615 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m16:01:11.559934 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m16:01:11.560297 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m16:01:11.560722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m16:01:11.560994 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m16:01:11.563318 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m16:01:11.564269 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m16:01:11.566415 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m16:01:11.566946 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:01:11.567217 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m16:01:11.567424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.568152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.568375 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:01:11.568626 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m16:01:11.576981 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:01:11.578541 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:01:11.579075 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m16:01:11.580723 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.581599 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:01:11.581843 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m16:01:11.582950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.584898 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:01:11.585152 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m16:01:11.585895 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:01:11.587937 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:01:11.588202 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m16:01:11.588991 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.589937 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m16:01:11.590182 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:01:11.590389 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m16:01:11.597961 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:01:11.599906 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:01:11.600188 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m16:01:11.606049 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:11.607347 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m16:01:11.608074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc1017530>]}
[0m16:01:11.608551 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m16:01:11.608979 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m16:01:11.609270 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m16:01:11.609650 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m16:01:11.610443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m16:01:11.610796 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m16:01:11.612799 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m16:01:11.613246 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m16:01:11.615147 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m16:01:11.615587 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:01:11.615819 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m16:01:11.616066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.616765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.617008 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:01:11.617263 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m16:01:11.620847 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:01:11.622396 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:01:11.622757 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m16:01:11.623935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.626480 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:01:11.626865 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m16:01:11.628291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.630482 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:01:11.630834 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m16:01:11.631652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:01:11.633500 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:01:11.633853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m16:01:11.635006 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.636006 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m16:01:11.636268 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:01:11.636521 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m16:01:11.642923 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:11.645054 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:01:11.645384 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m16:01:11.650552 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:11.651821 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m16:01:11.652425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc04f97f0>]}
[0m16:01:11.652900 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m16:01:11.653361 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m16:01:11.653672 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m16:01:11.654026 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m16:01:11.654782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m16:01:11.655068 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m16:01:11.657225 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m16:01:11.657737 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m16:01:11.659878 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m16:01:11.660388 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:01:11.660648 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m16:01:11.660866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.661645 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.661874 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:01:11.662091 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m16:01:11.664756 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:01:11.665905 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:01:11.666264 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m16:01:11.667480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.668721 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:01:11.669052 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m16:01:11.670603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.673172 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:01:11.673595 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m16:01:11.674667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.676977 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:01:11.677341 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m16:01:11.678094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:01:11.679193 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m16:01:11.679462 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:01:11.679707 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m16:01:11.685551 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:11.687441 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:01:11.687743 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m16:01:11.693862 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:11.695471 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m16:01:11.696330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc1060200>]}
[0m16:01:11.696808 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m16:01:11.697233 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m16:01:11.697520 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m16:01:11.697890 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m16:01:11.698253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m16:01:11.698541 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m16:01:11.700754 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m16:01:11.701255 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m16:01:11.703506 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m16:01:11.703960 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:01:11.704242 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m16:01:11.704451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.705226 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.705460 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:01:11.705676 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m16:01:11.709146 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:01:11.710326 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:01:11.710712 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m16:01:11.711764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.712684 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:01:11.712929 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m16:01:11.713963 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.717503 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:01:11.717853 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m16:01:11.718668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:01:11.720547 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:01:11.720806 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m16:01:11.721411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:01:11.722368 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m16:01:11.722697 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:01:11.722930 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m16:01:11.729161 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:11.731112 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:01:11.731417 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m16:01:11.736492 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:11.738148 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m16:01:11.739075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc0526f60>]}
[0m16:01:11.739618 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m16:01:11.740185 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m16:01:11.740544 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m16:01:11.740917 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m16:01:11.741655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m16:01:11.741939 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m16:01:11.744024 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m16:01:11.744473 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m16:01:11.746408 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m16:01:11.746895 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:01:11.747162 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m16:01:11.747383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.748141 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.748404 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:01:11.748645 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m16:01:11.752467 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:01:11.753845 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:01:11.754313 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m16:01:11.755331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.756645 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:01:11.757048 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m16:01:11.759011 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:01:11.761462 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:01:11.761770 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m16:01:11.762731 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.764754 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:01:11.765029 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m16:01:11.765852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.766894 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m16:01:11.767142 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:01:11.767354 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m16:01:11.772866 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:11.775240 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:01:11.775672 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m16:01:11.782990 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:01:11.784465 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m16:01:11.785104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabf11a3800>]}
[0m16:01:11.785554 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m16:01:11.785993 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m16:01:11.786286 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m16:01:11.786649 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m16:01:11.787166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m16:01:11.787432 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m16:01:11.789926 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m16:01:11.790806 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m16:01:11.793663 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m16:01:11.794346 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:01:11.794790 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m16:01:11.795033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.796358 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.796809 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:01:11.797056 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m16:01:11.798599 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.799580 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:01:11.799842 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m16:01:11.800633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.801571 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:01:11.801827 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m16:01:11.802818 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.804904 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:01:11.805204 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m16:01:11.805986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.812070 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:01:11.812903 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m16:01:11.814500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.815771 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m16:01:11.816085 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:01:11.816320 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m16:01:11.823445 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:01:11.826611 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:01:11.827334 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m16:01:11.834084 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:11.835502 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m16:01:11.836432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc05025d0>]}
[0m16:01:11.836925 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.05s]
[0m16:01:11.837397 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m16:01:11.837708 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m16:01:11.838061 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m16:01:11.838498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m16:01:11.839221 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m16:01:11.841754 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m16:01:11.842688 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m16:01:11.844901 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m16:01:11.845513 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:01:11.845825 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m16:01:11.846064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.846975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.847256 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:01:11.847466 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m16:01:11.848671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.849452 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:01:11.849682 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m16:01:11.850399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:01:11.851453 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:01:11.851698 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m16:01:11.852979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.855104 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:01:11.855381 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m16:01:11.856580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.859093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:01:11.859542 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m16:01:11.860755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.861955 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m16:01:11.862296 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:01:11.862533 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m16:01:11.869693 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:01:11.871546 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:01:11.871832 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m16:01:11.878577 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:11.880105 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m16:01:11.880763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc1041610>]}
[0m16:01:11.881250 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m16:01:11.881662 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m16:01:11.882000 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m16:01:11.882354 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m16:01:11.882965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m16:01:11.883258 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m16:01:11.885302 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m16:01:11.885799 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m16:01:11.887919 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m16:01:11.888403 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:01:11.888682 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m16:01:11.888881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.890182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.890690 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:01:11.891097 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m16:01:11.895766 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:01:11.896853 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:01:11.897169 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m16:01:11.898327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.899676 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:01:11.900009 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m16:01:11.901592 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.904169 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:01:11.904550 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m16:01:11.905552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.909448 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:01:11.910084 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m16:01:11.911246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.912751 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m16:01:11.913144 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:01:11.913390 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m16:01:11.919311 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:11.922675 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:01:11.923071 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m16:01:11.930079 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:01:11.931926 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m16:01:11.932635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc054c620>]}
[0m16:01:11.933082 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.05s]
[0m16:01:11.933552 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m16:01:11.933864 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m16:01:11.934251 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m16:01:11.935017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m16:01:11.935320 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m16:01:11.937242 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.937702 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m16:01:11.940057 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.940907 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.941384 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m16:01:11.941638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.943048 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.944006 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.944350 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m16:01:11.946112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.947118 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.947402 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m16:01:11.948405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.949784 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.950270 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m16:01:11.952107 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.954493 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.954961 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m16:01:11.956001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.958511 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.959138 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m16:01:11.960336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.961545 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m16:01:11.961841 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.962045 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m16:01:11.967409 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:11.969551 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:01:11.969894 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m16:01:11.975557 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:11.976949 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m16:01:11.977799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc0563b60>]}
[0m16:01:11.978318 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m16:01:11.978881 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m16:01:11.979191 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m16:01:11.979546 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m16:01:11.980006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m16:01:11.980288 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m16:01:11.982828 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m16:01:11.983298 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m16:01:11.985172 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m16:01:11.985652 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:01:11.985894 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m16:01:11.986093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.987134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:11.987580 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:01:11.988114 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m16:01:12.017214 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m16:01:12.018249 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:01:12.018639 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m16:01:12.019582 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.020646 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:01:12.020955 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m16:01:12.021967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.024325 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:01:12.024809 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m16:01:12.026144 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.028354 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:01:12.028680 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m16:01:12.029821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.031092 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m16:01:12.031656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:01:12.031919 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m16:01:12.038739 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:12.042348 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:01:12.042886 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m16:01:12.048933 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:12.050422 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m16:01:12.052224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc04fc8f0>]}
[0m16:01:12.052965 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.07s]
[0m16:01:12.053589 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m16:01:12.054001 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m16:01:12.054508 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m16:01:12.055500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m16:01:12.056011 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m16:01:12.059042 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m16:01:12.059943 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m16:01:12.062676 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m16:01:12.063842 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:01:12.064225 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m16:01:12.064444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:12.065383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.065763 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:01:12.066059 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m16:01:12.072050 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:12.073235 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:01:12.074000 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m16:01:12.075729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.077326 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:01:12.078093 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m16:01:12.080562 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:01:12.083761 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:01:12.084260 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m16:01:12.085253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.087860 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:01:12.088351 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m16:01:12.089261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.090670 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m16:01:12.091235 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:01:12.091574 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m16:01:12.099956 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:01:12.101924 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:01:12.102274 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m16:01:12.108304 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:12.110787 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m16:01:12.113055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc0487b60>]}
[0m16:01:12.113740 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.06s]
[0m16:01:12.114458 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m16:01:12.114949 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m16:01:12.115610 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m16:01:12.116281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m16:01:12.116783 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m16:01:12.120139 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m16:01:12.121434 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m16:01:12.125612 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m16:01:12.126799 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:01:12.127263 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m16:01:12.127531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:12.129156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.129554 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:01:12.129869 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek >= (select * from gameweeks) and gameweek <= ((select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(opponent_abbreviation, ' | ') over (partition by team_abbreviation order by gameweek) as opponent_abbreviations,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 3 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 3 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.opponent_abbreviations,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        opponent_abbreviations,
        attacking_biases_value,
        defending_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m16:01:12.159394 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m16:01:12.160563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:01:12.160908 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m16:01:12.162123 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.163348 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:01:12.163728 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m16:01:12.165138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.167791 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:01:12.168112 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m16:01:12.168968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.170959 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:01:12.171235 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m16:01:12.172095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:01:12.173222 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m16:01:12.173535 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:01:12.173823 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m16:01:12.180385 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:01:12.182192 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:01:12.182452 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m16:01:12.187876 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:01:12.189054 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m16:01:12.191331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6abe6a-1175-4e23-b0d9-c2b33d052e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc0487ef0>]}
[0m16:01:12.191859 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.08s]
[0m16:01:12.192350 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m16:01:12.194264 [debug] [MainThread]: Using duckdb connection "master"
[0m16:01:12.194644 [debug] [MainThread]: On master: BEGIN
[0m16:01:12.194926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:12.195722 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:01:12.195981 [debug] [MainThread]: On master: COMMIT
[0m16:01:12.196208 [debug] [MainThread]: Using duckdb connection "master"
[0m16:01:12.196393 [debug] [MainThread]: On master: COMMIT
[0m16:01:12.196895 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:01:12.197109 [debug] [MainThread]: On master: Close
[0m16:01:12.197470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:12.197678 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m16:01:12.197957 [info ] [MainThread]: 
[0m16:01:12.198254 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m16:01:12.199733 [debug] [MainThread]: Command end result
[0m16:01:12.214343 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m16:01:12.216063 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m16:01:12.221019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m16:01:12.221378 [info ] [MainThread]: 
[0m16:01:12.221721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:12.222001 [info ] [MainThread]: 
[0m16:01:12.222258 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m16:01:12.224299 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.8960743, "process_in_blocks": "111744", "process_kernel_time": 0.443582, "process_mem_max_rss": "185876", "process_out_blocks": "4832", "process_user_time": 2.843678}
[0m16:01:12.224871 [debug] [MainThread]: Command `dbt build` succeeded at 16:01:12.224749 after 1.90 seconds
[0m16:01:12.225259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabc050dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabfb12ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aabfb12caa0>]}
[0m16:01:12.225663 [debug] [MainThread]: Flushing usage events
[0m16:01:12.835480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:09.547280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089101b9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708910226000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708910225a90>]}


============================== 16:05:09.551540 | a2feb33f-7271-40c1-8546-1bf496f3b679 ==============================
[0m16:05:09.551540 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:05:09.551982 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/home/robgriffin247/fpl/logs', 'empty': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'invocation_command': 'dbt build', 'profiles_dir': '/home/robgriffin247/fpl', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m16:05:09.781801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70891064be60>]}
[0m16:05:09.843794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70891158bda0>]}
[0m16:05:09.846117 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:05:09.908110 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:05:10.020001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:10.020624 [debug] [MainThread]: Partial parsing: updated file: fpl_analytics://fpl_analytics/models/core/obt_players.sql
[0m16:05:10.332252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708905bfc9e0>]}
[0m16:05:10.379816 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m16:05:10.381919 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m16:05:10.476948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fe7deb10>]}
[0m16:05:10.477481 [info ] [MainThread]: Found 14 models, 6 sources, 445 macros
[0m16:05:10.479779 [info ] [MainThread]: 
[0m16:05:10.480298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:10.480544 [info ] [MainThread]: 
[0m16:05:10.480999 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:05:10.485870 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics'
[0m16:05:10.522945 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m16:05:10.523345 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m16:05:10.523594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:10.560449 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m16:05:10.561651 [debug] [ThreadPool]: On list_analytics: Close
[0m16:05:10.563413 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m16:05:10.563712 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m16:05:10.563982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:10.565065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.565872 [debug] [ThreadPool]: On list_analytics: Close
[0m16:05:10.567380 [debug] [ThreadPool]: Using duckdb connection "list_analytics"
[0m16:05:10.567854 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics"'
    
  
  
[0m16:05:10.568076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:10.569204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.570062 [debug] [ThreadPool]: On list_analytics: Close
[0m16:05:10.570849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_intermediate)
[0m16:05:10.571212 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "intermediate"
"
[0m16:05:10.575952 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m16:05:10.576283 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m16:05:10.576515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:10.577740 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.578868 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m16:05:10.579114 [debug] [ThreadPool]: On create_analytics_intermediate: BEGIN
[0m16:05:10.579652 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:10.579897 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m16:05:10.580073 [debug] [ThreadPool]: On create_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_intermediate"} */

    
    
        create schema if not exists "analytics"."intermediate"
    
[0m16:05:10.580724 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:10.581622 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m16:05:10.581970 [debug] [ThreadPool]: Using duckdb connection "create_analytics_intermediate"
[0m16:05:10.582338 [debug] [ThreadPool]: On create_analytics_intermediate: COMMIT
[0m16:05:10.583816 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.584102 [debug] [ThreadPool]: On create_analytics_intermediate: Close
[0m16:05:10.584670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_intermediate, now create_analytics_core)
[0m16:05:10.585116 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "core"
"
[0m16:05:10.586315 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m16:05:10.586540 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m16:05:10.586799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:10.587758 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.588642 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m16:05:10.588889 [debug] [ThreadPool]: On create_analytics_core: BEGIN
[0m16:05:10.589367 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:10.589586 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m16:05:10.589771 [debug] [ThreadPool]: On create_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_core"} */

    
    
        create schema if not exists "analytics"."core"
    
[0m16:05:10.590474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:10.591208 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m16:05:10.591495 [debug] [ThreadPool]: Using duckdb connection "create_analytics_core"
[0m16:05:10.591694 [debug] [ThreadPool]: On create_analytics_core: COMMIT
[0m16:05:10.592538 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.592841 [debug] [ThreadPool]: On create_analytics_core: Close
[0m16:05:10.593464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_core, now create_analytics_staging)
[0m16:05:10.593855 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m16:05:10.595151 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m16:05:10.595421 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics'
        and type='sqlite'
    
  
[0m16:05:10.595672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:10.596798 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.597810 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m16:05:10.598042 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m16:05:10.598603 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:10.598843 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m16:05:10.599011 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "create_analytics_staging"} */

    
    
        create schema if not exists "analytics"."staging"
    
[0m16:05:10.599508 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:10.600098 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m16:05:10.600344 [debug] [ThreadPool]: Using duckdb connection "create_analytics_staging"
[0m16:05:10.600519 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m16:05:10.601141 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:10.601379 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m16:05:10.603160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_intermediate)
[0m16:05:10.606947 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m16:05:10.607292 [debug] [ThreadPool]: On list_analytics_intermediate: BEGIN
[0m16:05:10.607512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:10.608291 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.608539 [debug] [ThreadPool]: Using duckdb connection "list_analytics_intermediate"
[0m16:05:10.608719 [debug] [ThreadPool]: On list_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_intermediate"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'intermediate'
    and lower(table_catalog) = 'analytics'
  
[0m16:05:10.625207 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m16:05:10.627540 [debug] [ThreadPool]: On list_analytics_intermediate: ROLLBACK
[0m16:05:10.630108 [debug] [ThreadPool]: Failed to rollback 'list_analytics_intermediate'
[0m16:05:10.630420 [debug] [ThreadPool]: On list_analytics_intermediate: Close
[0m16:05:10.631155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_intermediate, now list_analytics_core)
[0m16:05:10.634159 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m16:05:10.634653 [debug] [ThreadPool]: On list_analytics_core: BEGIN
[0m16:05:10.634983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:10.636313 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.636672 [debug] [ThreadPool]: Using duckdb connection "list_analytics_core"
[0m16:05:10.636966 [debug] [ThreadPool]: On list_analytics_core: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_core"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'core'
    and lower(table_catalog) = 'analytics'
  
[0m16:05:10.640805 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:05:10.641866 [debug] [ThreadPool]: On list_analytics_core: ROLLBACK
[0m16:05:10.642579 [debug] [ThreadPool]: Failed to rollback 'list_analytics_core'
[0m16:05:10.642925 [debug] [ThreadPool]: On list_analytics_core: Close
[0m16:05:10.644005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_core, now list_analytics_staging)
[0m16:05:10.645508 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m16:05:10.645828 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m16:05:10.646054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:10.647305 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:10.647584 [debug] [ThreadPool]: Using duckdb connection "list_analytics_staging"
[0m16:05:10.647776 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'staging'
    and lower(table_catalog) = 'analytics'
  
[0m16:05:10.650694 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:05:10.651796 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m16:05:10.652385 [debug] [ThreadPool]: Failed to rollback 'list_analytics_staging'
[0m16:05:10.652585 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m16:05:10.653920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fdcd7f50>]}
[0m16:05:10.654310 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:10.654503 [debug] [MainThread]: On master: BEGIN
[0m16:05:10.654753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:10.655696 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:05:10.655959 [debug] [MainThread]: On master: COMMIT
[0m16:05:10.656148 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:10.656309 [debug] [MainThread]: On master: COMMIT
[0m16:05:10.656859 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:05:10.657080 [debug] [MainThread]: On master: Close
[0m16:05:10.662445 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_fixtures
[0m16:05:10.663077 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.stg_fixtures ............................. [RUN]
[0m16:05:10.663758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.fpl_analytics.stg_fixtures)
[0m16:05:10.664063 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_fixtures
[0m16:05:10.669349 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_fixtures"
[0m16:05:10.669920 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_fixtures
[0m16:05:10.694895 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_fixtures"
[0m16:05:10.695696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:05:10.696018 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: BEGIN
[0m16:05:10.696233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:10.697219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.697506 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:05:10.697714 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

  
    
    

    create  table
      "analytics"."staging"."stg_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select
        matchday::int as gameweek,
        home_score_full_time::int as home_goals,
        away_score_full_time::int as away_goals,
        home_team_tla::varchar as home_team_abbreviation,
        away_team_tla::varchar as away_team_abbreviation,
    from "rawdb"."football_data"."fixtures"
)

select * from source
    );
  
  
[0m16:05:10.700999 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:05:10.705664 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:05:10.705998 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m16:05:10.706961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.707914 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:05:10.708165 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_fixtures'
  
[0m16:05:10.712102 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:05:10.717359 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:05:10.717738 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures" rename to "stg_fixtures__dbt_backup"
[0m16:05:10.719402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.722186 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:05:10.722469 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */
alter table "analytics"."staging"."stg_fixtures__dbt_tmp" rename to "stg_fixtures"
[0m16:05:10.723414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.734872 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m16:05:10.735317 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:05:10.735554 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: COMMIT
[0m16:05:10.741467 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:10.746430 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_fixtures"
[0m16:05:10.747004 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_fixtures"} */

      drop table if exists "analytics"."staging"."stg_fixtures__dbt_backup" cascade
    
[0m16:05:10.753917 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:05:10.756127 [debug] [Thread-1 (]: On model.fpl_analytics.stg_fixtures: Close
[0m16:05:10.758347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fdc0a090>]}
[0m16:05:10.758944 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.stg_fixtures ........................ [[32mOK[0m in 0.09s]
[0m16:05:10.759428 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_fixtures
[0m16:05:10.759793 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_gameweeks
[0m16:05:10.760215 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.stg_gameweeks ............................ [RUN]
[0m16:05:10.760836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_fixtures, now model.fpl_analytics.stg_gameweeks)
[0m16:05:10.761252 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_gameweeks
[0m16:05:10.763627 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.764446 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_gameweeks
[0m16:05:10.768237 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.769392 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.769830 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: BEGIN
[0m16:05:10.770043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:10.770906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.771177 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.771426 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

  
    
    

    create  table
      "analytics"."staging"."stg_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as gameweek,
        is_next as is_coming_gameweek,
    from "rawdb"."fpl"."events"
)

select * from source
    );
  
  
[0m16:05:10.773739 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:05:10.774692 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.775010 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m16:05:10.776114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.777953 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.778421 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_gameweeks'
  
[0m16:05:10.780652 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:05:10.783399 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.783727 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks" rename to "stg_gameweeks__dbt_backup"
[0m16:05:10.784608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.786465 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.786792 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */
alter table "analytics"."staging"."stg_gameweeks__dbt_tmp" rename to "stg_gameweeks"
[0m16:05:10.787798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.788799 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m16:05:10.789075 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.789297 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: COMMIT
[0m16:05:10.795452 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:10.799037 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_gameweeks"
[0m16:05:10.799446 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_gameweeks"} */

      drop table if exists "analytics"."staging"."stg_gameweeks__dbt_backup" cascade
    
[0m16:05:10.805306 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:10.806413 [debug] [Thread-1 (]: On model.fpl_analytics.stg_gameweeks: Close
[0m16:05:10.807113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089122de930>]}
[0m16:05:10.807587 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.stg_gameweeks ....................... [[32mOK[0m in 0.05s]
[0m16:05:10.808000 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_gameweeks
[0m16:05:10.808310 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_players
[0m16:05:10.808641 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.stg_players .............................. [RUN]
[0m16:05:10.809724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_gameweeks, now model.fpl_analytics.stg_players)
[0m16:05:10.810072 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_players
[0m16:05:10.813038 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_players"
[0m16:05:10.813783 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_players
[0m16:05:10.816093 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_players"
[0m16:05:10.816582 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:05:10.816829 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: BEGIN
[0m16:05:10.817024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:10.817847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.818076 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:05:10.818315 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

  
    
    

    create  table
      "analytics"."staging"."stg_players__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."elements"
),

remove_non_selectables as (
    select * 
    from source 
    where can_select and not removed
),

select_columns as (
    select
        id::int as player_id,
        first_name::varchar as first_name,
        second_name::varchar as second_name,
        web_name::varchar as display_name,
        team::int as team_id,
        element_type::int as position_id,
        now_cost::int as cost,
        chance_of_playing_this_round::int as availability_this_gameweek,
        chance_of_playing_next_round::int as availability_next_gameweek,
        status::varchar as availability_code,
        news::varchar as availability_details,
        total_points::int as total_points,
        event_points:: int as gameweek_points,
        points_per_game::float as points_per_game,
        form::float as current_form,
        in_dreamteam::boolean as current_dreamteam,
        dreamteam_count::int as dreamteam_appearances,
        influence::float as influence,
        creativity::float as creativity,
        threat::float as threat,
        ict_index::float as ict_index,
        selected_by_percent::float as selection_rate,
        transfers_in_event::int as gameweek_transfers_in,
        transfers_out_event::int as gameweek_transfers_out,
        starts::int as starts,
        minutes::int as minutes_played,
        goals_scored::int as goals_scored,
        expected_goals::float as expected_goals_scored,
        assists::int as goals_assisted,
        expected_assists::float as expected_goals_assisted,
        goals_conceded::int as goals_conceded,
        expected_goals_conceded::float as expected_goals_conceded,
        clearances_blocks_interceptions::int as clearances_blocks_interceptions,
        recoveries::int as recoveries,
        tackles::int as tackles,
        own_goals::int as own_goals,
        saves::int as saves_made,
        clean_sheets::int as clean_sheets,
        penalties_saved::int as penalties_saved,
        yellow_cards::int as yellow_cards,
        red_cards::int as red_cards,
        bonus::int as bonus_points,
        bps::int as bonus_points_system,
        penalties_order::int as team_penalty_takers_rank,
        penalties_missed::int as penalties_missed,
        
    from remove_non_selectables
)

select * from select_columns
    );
  
  
[0m16:05:10.825988 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:05:10.827044 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:05:10.827452 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m16:05:10.828789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.830100 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:05:10.830423 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_players'
  
[0m16:05:10.832558 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:05:10.835106 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:05:10.835393 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players" rename to "stg_players__dbt_backup"
[0m16:05:10.836173 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.837924 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:05:10.838174 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */
alter table "analytics"."staging"."stg_players__dbt_tmp" rename to "stg_players"
[0m16:05:10.839062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.839874 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m16:05:10.840093 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:05:10.840281 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: COMMIT
[0m16:05:10.848819 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:05:10.850795 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_players"
[0m16:05:10.851087 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_players"} */

      drop table if exists "analytics"."staging"."stg_players__dbt_backup" cascade
    
[0m16:05:10.857964 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:05:10.859145 [debug] [Thread-1 (]: On model.fpl_analytics.stg_players: Close
[0m16:05:10.860058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fdcde840>]}
[0m16:05:10.860631 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.stg_players ......................... [[32mOK[0m in 0.05s]
[0m16:05:10.861180 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_players
[0m16:05:10.861572 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_positions
[0m16:05:10.862031 [info ] [Thread-1 (]: 4 of 14 START sql table model staging.stg_positions ............................ [RUN]
[0m16:05:10.862946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_players, now model.fpl_analytics.stg_positions)
[0m16:05:10.863299 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_positions
[0m16:05:10.865512 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_positions"
[0m16:05:10.865999 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_positions
[0m16:05:10.868220 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_positions"
[0m16:05:10.868900 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:05:10.869156 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: BEGIN
[0m16:05:10.869353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:10.870161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.870410 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:05:10.870640 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

  
    
    

    create  table
      "analytics"."staging"."stg_positions__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as position_id,
        plural_name_short::varchar as position,
        squad_select::int as max_selectable,
        squad_min_play::int as min_playable,
        squad_max_play::int as max_playable,
    from "rawdb"."fpl"."element_types"
)

select * from source
    );
  
  
[0m16:05:10.873047 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:05:10.873834 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:05:10.874125 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m16:05:10.874904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.877442 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:05:10.878082 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_positions'
  
[0m16:05:10.880490 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:05:10.883710 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:05:10.884025 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions" rename to "stg_positions__dbt_backup"
[0m16:05:10.884998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.886580 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:05:10.886863 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */
alter table "analytics"."staging"."stg_positions__dbt_tmp" rename to "stg_positions"
[0m16:05:10.887498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:10.888329 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m16:05:10.888601 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:05:10.888798 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: COMMIT
[0m16:05:10.894817 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:10.896928 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_positions"
[0m16:05:10.897244 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_positions"} */

      drop table if exists "analytics"."staging"."stg_positions__dbt_backup" cascade
    
[0m16:05:10.902779 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:10.903810 [debug] [Thread-1 (]: On model.fpl_analytics.stg_positions: Close
[0m16:05:10.904362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fdcca330>]}
[0m16:05:10.904823 [info ] [Thread-1 (]: 4 of 14 OK created sql table model staging.stg_positions ....................... [[32mOK[0m in 0.04s]
[0m16:05:10.905229 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_positions
[0m16:05:10.905541 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_stats
[0m16:05:10.905877 [info ] [Thread-1 (]: 5 of 14 START sql table model staging.stg_stats ................................ [RUN]
[0m16:05:10.906286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_positions, now model.fpl_analytics.stg_stats)
[0m16:05:10.906596 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_stats
[0m16:05:10.908359 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_stats"
[0m16:05:10.909137 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_stats
[0m16:05:10.911397 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_stats"
[0m16:05:10.912009 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:05:10.912285 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: BEGIN
[0m16:05:10.912494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:10.913512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.913837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:05:10.914102 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

  
    
    

    create  table
      "analytics"."staging"."stg_stats__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "rawdb"."fpl"."element_stats"
)

select * from source
    );
  
  
[0m16:05:10.916360 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:05:10.917254 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:05:10.917546 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m16:05:10.918297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:10.919230 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:05:10.919511 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_stats'
  
[0m16:05:10.920512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.922632 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:05:10.922893 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats" rename to "stg_stats__dbt_backup"
[0m16:05:10.923467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:10.925214 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:05:10.925471 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */
alter table "analytics"."staging"."stg_stats__dbt_tmp" rename to "stg_stats"
[0m16:05:10.926312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.927591 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m16:05:10.927938 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:05:10.928200 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: COMMIT
[0m16:05:10.933749 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:10.935451 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_stats"
[0m16:05:10.935692 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_stats"} */

      drop table if exists "analytics"."staging"."stg_stats__dbt_backup" cascade
    
[0m16:05:10.941268 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:10.942499 [debug] [Thread-1 (]: On model.fpl_analytics.stg_stats: Close
[0m16:05:10.943193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fdcc9c10>]}
[0m16:05:10.943682 [info ] [Thread-1 (]: 5 of 14 OK created sql table model staging.stg_stats ........................... [[32mOK[0m in 0.04s]
[0m16:05:10.944143 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_stats
[0m16:05:10.944441 [debug] [Thread-1 (]: Began running node model.fpl_analytics.stg_teams
[0m16:05:10.944827 [info ] [Thread-1 (]: 6 of 14 START sql table model staging.stg_teams ................................ [RUN]
[0m16:05:10.945303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_stats, now model.fpl_analytics.stg_teams)
[0m16:05:10.945535 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.stg_teams
[0m16:05:10.947618 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.stg_teams"
[0m16:05:10.948139 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.stg_teams
[0m16:05:10.950286 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.stg_teams"
[0m16:05:10.950778 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:05:10.951053 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: BEGIN
[0m16:05:10.951252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:10.951985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.952209 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:05:10.952446 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

  
    
    

    create  table
      "analytics"."staging"."stg_teams__dbt_tmp"
  
    as (
      with 
source as (
    select
        id::int as team_id,
        name::varchar as team,
        short_name::varchar as team_abbreviation,
        strength::int as team_strength_score,
        strength_attack_home::int as team_strength_home_attack,
        strength_defence_home::int as team_strength_home_defence,
        strength_attack_away::int as team_strength_away_attack,
        strength_defence_away::int as team_strength_away_defence
    from "rawdb"."fpl"."teams"
)

select * from source
    );
  
  
[0m16:05:10.954863 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:05:10.955794 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:05:10.956067 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m16:05:10.957280 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.958450 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:05:10.958813 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'staging'
      AND table_name = 'stg_teams'
  
[0m16:05:10.959965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.964495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:05:10.964915 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams" rename to "stg_teams__dbt_backup"
[0m16:05:10.965864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.967837 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:05:10.968097 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */
alter table "analytics"."staging"."stg_teams__dbt_tmp" rename to "stg_teams"
[0m16:05:10.968681 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:10.969596 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m16:05:10.969839 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:05:10.970036 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: COMMIT
[0m16:05:10.976701 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:10.978737 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.stg_teams"
[0m16:05:10.979120 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.stg_teams"} */

      drop table if exists "analytics"."staging"."stg_teams__dbt_backup" cascade
    
[0m16:05:10.985359 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:10.987134 [debug] [Thread-1 (]: On model.fpl_analytics.stg_teams: Close
[0m16:05:10.987991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fd9100b0>]}
[0m16:05:10.988520 [info ] [Thread-1 (]: 6 of 14 OK created sql table model staging.stg_teams ........................... [[32mOK[0m in 0.04s]
[0m16:05:10.988964 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.stg_teams
[0m16:05:10.989259 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_fixtures
[0m16:05:10.989606 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate.int_fixtures ........................ [RUN]
[0m16:05:10.990008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.stg_teams, now model.fpl_analytics.int_fixtures)
[0m16:05:10.990300 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_fixtures
[0m16:05:10.992357 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_fixtures"
[0m16:05:10.993097 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_fixtures
[0m16:05:10.995610 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_fixtures"
[0m16:05:10.996612 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:05:10.997133 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: BEGIN
[0m16:05:10.997423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:10.998362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:10.998744 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:05:10.999009 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_fixtures__dbt_tmp"
  
    as (
      with 
source as (
    select         
        gameweek,
        home_goals,
        away_goals,
        home_team_abbreviation,
        away_team_abbreviation,
    from "analytics"."staging"."stg_fixtures"
),

fix_nfo as (
    select * exclude(home_team_abbreviation, away_team_abbreviation),
        case when home_team_abbreviation='NOT' then 'NFO' else home_team_abbreviation end as home_team_abbreviation,
        case when away_team_abbreviation='NOT' then 'NFO' else away_team_abbreviation end as away_team_abbreviation,
    from source
),

home_fixtures as (
    select 
        gameweek,
        home_team_abbreviation as team_abbreviation,
        away_team_abbreviation as opponent_abbreviation,
        true as home
    from fix_nfo
),

away_fixtures as (
    select 
        gameweek,
        away_team_abbreviation as team_abbreviation,
        home_team_abbreviation as opponent_abbreviation,
        false as home
    from fix_nfo
),

all_fixtures as (
    select * from home_fixtures union all select * from away_fixtures 
)

select * from all_fixtures
    );
  
  
[0m16:05:11.002395 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:05:11.003505 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:05:11.003817 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m16:05:11.004879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.005813 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:05:11.006059 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_fixtures'
  
[0m16:05:11.007109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.009123 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:05:11.009359 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures" rename to "int_fixtures__dbt_backup"
[0m16:05:11.010001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.012196 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:05:11.012565 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */
alter table "analytics"."intermediate"."int_fixtures__dbt_tmp" rename to "int_fixtures"
[0m16:05:11.013665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.014764 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m16:05:11.015038 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:05:11.015286 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: COMMIT
[0m16:05:11.021267 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:11.023197 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_fixtures"
[0m16:05:11.023488 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_fixtures"} */

      drop table if exists "analytics"."intermediate"."int_fixtures__dbt_backup" cascade
    
[0m16:05:11.028932 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:11.030378 [debug] [Thread-1 (]: On model.fpl_analytics.int_fixtures: Close
[0m16:05:11.031061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708905d88500>]}
[0m16:05:11.031551 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate.int_fixtures ................... [[32mOK[0m in 0.04s]
[0m16:05:11.031961 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_fixtures
[0m16:05:11.032253 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_gameweeks
[0m16:05:11.032597 [info ] [Thread-1 (]: 8 of 14 START sql table model intermediate.int_gameweeks ....................... [RUN]
[0m16:05:11.033052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_fixtures, now model.fpl_analytics.int_gameweeks)
[0m16:05:11.033292 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_gameweeks
[0m16:05:11.035112 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_gameweeks"
[0m16:05:11.035545 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_gameweeks
[0m16:05:11.037582 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_gameweeks"
[0m16:05:11.038009 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:05:11.038257 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: BEGIN
[0m16:05:11.038492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:11.039290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.039532 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:05:11.039732 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_gameweeks"
)

select * from source
    );
  
  
[0m16:05:11.040978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.041821 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:05:11.042080 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m16:05:11.043088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.044051 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:05:11.044357 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_gameweeks'
  
[0m16:05:11.046007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.048507 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:05:11.048800 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks" rename to "int_gameweeks__dbt_backup"
[0m16:05:11.049522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.052505 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:05:11.052822 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */
alter table "analytics"."intermediate"."int_gameweeks__dbt_tmp" rename to "int_gameweeks"
[0m16:05:11.053455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.054386 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m16:05:11.054654 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:05:11.054886 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: COMMIT
[0m16:05:11.059909 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:11.061703 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_gameweeks"
[0m16:05:11.062070 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_gameweeks"} */

      drop table if exists "analytics"."intermediate"."int_gameweeks__dbt_backup" cascade
    
[0m16:05:11.067439 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:11.069128 [debug] [Thread-1 (]: On model.fpl_analytics.int_gameweeks: Close
[0m16:05:11.069919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fd8e9130>]}
[0m16:05:11.070690 [info ] [Thread-1 (]: 8 of 14 OK created sql table model intermediate.int_gameweeks .................. [[32mOK[0m in 0.04s]
[0m16:05:11.071413 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_gameweeks
[0m16:05:11.071743 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_positions
[0m16:05:11.072373 [info ] [Thread-1 (]: 9 of 14 START sql table model intermediate.int_positions ....................... [RUN]
[0m16:05:11.072783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_gameweeks, now model.fpl_analytics.int_positions)
[0m16:05:11.073051 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_positions
[0m16:05:11.075203 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_positions"
[0m16:05:11.075707 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_positions
[0m16:05:11.077684 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_positions"
[0m16:05:11.078297 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:05:11.078572 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: BEGIN
[0m16:05:11.078859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:11.079653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.079924 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:05:11.080171 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_positions__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."staging"."stg_positions"
)

select * from source
    );
  
  
[0m16:05:11.081664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.082529 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:05:11.082817 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m16:05:11.083607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.084630 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:05:11.084967 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_positions'
  
[0m16:05:11.085956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.088029 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:05:11.088304 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions" rename to "int_positions__dbt_backup"
[0m16:05:11.089252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.091563 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:05:11.091856 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */
alter table "analytics"."intermediate"."int_positions__dbt_tmp" rename to "int_positions"
[0m16:05:11.092543 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.093366 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m16:05:11.093616 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:05:11.093820 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: COMMIT
[0m16:05:11.099828 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:11.102118 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_positions"
[0m16:05:11.102405 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_positions"} */

      drop table if exists "analytics"."intermediate"."int_positions__dbt_backup" cascade
    
[0m16:05:11.107729 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:11.109378 [debug] [Thread-1 (]: On model.fpl_analytics.int_positions: Close
[0m16:05:11.110457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fdcebd10>]}
[0m16:05:11.111157 [info ] [Thread-1 (]: 9 of 14 OK created sql table model intermediate.int_positions .................. [[32mOK[0m in 0.04s]
[0m16:05:11.111580 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_positions
[0m16:05:11.111899 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_teams
[0m16:05:11.112254 [info ] [Thread-1 (]: 10 of 14 START sql table model intermediate.int_teams .......................... [RUN]
[0m16:05:11.112781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_positions, now model.fpl_analytics.int_teams)
[0m16:05:11.113014 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_teams
[0m16:05:11.115040 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_teams"
[0m16:05:11.115515 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_teams
[0m16:05:11.117451 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_teams"
[0m16:05:11.117928 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:05:11.118179 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: BEGIN
[0m16:05:11.118391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:11.119421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.119883 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:05:11.120318 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_teams__dbt_tmp"
  
    as (
      with 
source as (
    select * exclude(team),
        replace(team, '''','') as team,
    from "analytics"."staging"."stg_teams"
)

select * from source
    );
  
  
[0m16:05:11.122607 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:05:11.123509 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:05:11.123773 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m16:05:11.124620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.125519 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:05:11.125759 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_teams'
  
[0m16:05:11.126807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.129090 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:05:11.129386 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams" rename to "int_teams__dbt_backup"
[0m16:05:11.130167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.132160 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:05:11.132458 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */
alter table "analytics"."intermediate"."int_teams__dbt_tmp" rename to "int_teams"
[0m16:05:11.133081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.134074 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m16:05:11.134325 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:05:11.134547 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: COMMIT
[0m16:05:11.140528 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:11.143781 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_teams"
[0m16:05:11.144116 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_teams"} */

      drop table if exists "analytics"."intermediate"."int_teams__dbt_backup" cascade
    
[0m16:05:11.150666 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:11.152200 [debug] [Thread-1 (]: On model.fpl_analytics.int_teams: Close
[0m16:05:11.152853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fd9348f0>]}
[0m16:05:11.153337 [info ] [Thread-1 (]: 10 of 14 OK created sql table model intermediate.int_teams ..................... [[32mOK[0m in 0.04s]
[0m16:05:11.153805 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_teams
[0m16:05:11.154105 [debug] [Thread-1 (]: Began running node model.fpl_analytics.dim_gameweeks
[0m16:05:11.154725 [info ] [Thread-1 (]: 11 of 14 START sql table model core.dim_gameweeks .............................. [RUN]
[0m16:05:11.155146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_teams, now model.fpl_analytics.dim_gameweeks)
[0m16:05:11.155397 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.dim_gameweeks
[0m16:05:11.157165 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.157630 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.dim_gameweeks
[0m16:05:11.159700 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.160232 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.160530 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: BEGIN
[0m16:05:11.160737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:11.161661 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.161977 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.162202 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

  
    
    

    create  table
      "analytics"."core"."dim_gameweeks__dbt_tmp"
  
    as (
      with 
source as (
    select *
    from "analytics"."intermediate"."int_gameweeks"
)

select * from source
    );
  
  
[0m16:05:11.163697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.164680 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.164933 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m16:05:11.165799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.166721 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.166973 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'dim_gameweeks'
  
[0m16:05:11.168223 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.170542 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.170843 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks" rename to "dim_gameweeks__dbt_backup"
[0m16:05:11.171479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.173107 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.173334 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */
alter table "analytics"."core"."dim_gameweeks__dbt_tmp" rename to "dim_gameweeks"
[0m16:05:11.173909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.174885 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m16:05:11.175192 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.175421 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: COMMIT
[0m16:05:11.180836 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:11.183290 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.dim_gameweeks"
[0m16:05:11.183598 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.dim_gameweeks"} */

      drop table if exists "analytics"."core"."dim_gameweeks__dbt_backup" cascade
    
[0m16:05:11.188746 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:11.190339 [debug] [Thread-1 (]: On model.fpl_analytics.dim_gameweeks: Close
[0m16:05:11.190936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fd89b290>]}
[0m16:05:11.191392 [info ] [Thread-1 (]: 11 of 14 OK created sql table model core.dim_gameweeks ......................... [[32mOK[0m in 0.04s]
[0m16:05:11.191800 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.dim_gameweeks
[0m16:05:11.192135 [debug] [Thread-1 (]: Began running node model.fpl_analytics.int_players
[0m16:05:11.192495 [info ] [Thread-1 (]: 12 of 14 START sql table model intermediate.int_players ........................ [RUN]
[0m16:05:11.192906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.dim_gameweeks, now model.fpl_analytics.int_players)
[0m16:05:11.193131 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.int_players
[0m16:05:11.195405 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.int_players"
[0m16:05:11.195890 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.int_players
[0m16:05:11.197871 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.int_players"
[0m16:05:11.198366 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:05:11.198708 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: BEGIN
[0m16:05:11.198928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:11.199706 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.199963 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:05:11.200270 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

  
    
    

    create  table
      "analytics"."intermediate"."int_players__dbt_tmp"
  
    as (
      with 
source as (
    select * from "analytics"."staging"."stg_players"
),

gameweek as (
    select gameweek-1 as gameweeks_played from "analytics"."intermediate"."int_gameweeks" where is_coming_gameweek
),

derive as (
    select
        player_id,
        replace(display_name, '''','') as display_name,
        team_id, 
        position_id,
        cost/10 as cost,
        coalesce(availability_next_gameweek, 100) as availability,
        availability_code,
        case availability_code
            when 'a' then 'Available'
            when 'i' then 'Injured'
            when 'd' then 'Doubtful (' || coalesce(availability_next_gameweek, 100)::varchar || '%)'
            when 's' then 'Suspended'
            else null end as availability_status,
        availability_details,
        starts,
        coalesce(minutes_played, 0) as minutes_played,
        cast(coalesce(minutes_played, 0)/(select gameweeks_played from gameweek) as int) as minutes_played_per_gameweek,
        total_points,
        gameweek_points,
        coalesce(total_points/(select gameweeks_played from gameweek), 0) as points_per_gameweek,
        coalesce(total_points / minutes_played * 90, 0) as points_per_90,
        total_points / (cost / 10) as points_per_million,
        current_form,
        current_dreamteam,
        dreamteam_appearances,
        influence,
        creativity,
        threat,
        -- ict_index,
        selection_rate,
        -- gameweek_transfers_in,
        -- gameweek_transfers_out,
        -- gameweek_transfers_in-gameweek_transfers_out as gameweek_net_transfers,
        
        goals_scored,
        goals_scored / minutes_played * 90 as goals_scored_per_90,
        goals_scored / (select gameweeks_played from gameweek) as goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored / minutes_played * 90 as expected_goals_scored_per_90,
        expected_goals_scored/(select gameweeks_played from gameweek) as expected_goals_scored_per_gameweek,
        goals_scored / expected_goals_scored as goals_scored_xdifferential,
        
        goals_assisted,
        goals_assisted / minutes_played * 90 as goals_assisted_per_90,
        goals_assisted/(select gameweeks_played from gameweek) as goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted / minutes_played * 90 as expected_goals_assisted_per_90,
        expected_goals_assisted/(select gameweeks_played from gameweek) as expected_goals_assisted_per_gameweek,
        goals_assisted / expected_goals_assisted as goals_assisted_xdifferential,
        
        goals_scored + goals_assisted as goal_contributions,
        expected_goals_scored + expected_goals_assisted as expected_goal_contributions,
        (goals_scored + goals_assisted) / (expected_goals_scored + expected_goals_assisted) as expected_goal_contributions_xdifferential,
        
        goals_conceded,
        expected_goals_conceded,
        clearances_blocks_interceptions,
        recoveries,
        tackles,
        own_goals,
        saves_made,
        clean_sheets,
        penalties_saved,
        yellow_cards,
        red_cards,
        bonus_points,
        bonus_points_system,
        team_penalty_takers_rank,
        penalties_missed,
    from source
),

add_cost_category as (
    select *,
        ntile(5) over (partition by position_id order by cost) as cost_category 
    from derive
),

convert_cost_category as (
    select * exclude(cost_category),
        case cost_category when 1 then 'Budget' when 2 then 'Budget' when 3 then 'Mid-Range' when 4 then 'Mid-Range' when 5 then 'Premium' else null end as cost_category 
    from add_cost_category
),

coalesce_nulls as (
    select 
        * exclude(
            points_per_90, 
            goals_scored_per_90, goals_scored_xdifferential, expected_goals_scored_per_90,
            goals_assisted_per_90, goals_assisted_xdifferential, expected_goals_assisted_per_90
            ),
        case when minutes_played>0 then points_per_90 else 0 end as points_per_90,
        case when minutes_played>0 then goals_scored_per_90 else 0 end as goals_scored_per_90,
        case when minutes_played>0 then goals_scored_xdifferential else 0 end as goals_scored_xdifferential,
        case when minutes_played>0 then expected_goals_scored_per_90 else 0 end as expected_goals_scored_per_90,
        case when minutes_played>0 then goals_assisted_per_90 else 0 end as goals_assisted_per_90,
        case when minutes_played>0 then goals_assisted_xdifferential else 0 end as goals_assisted_xdifferential,
        case when minutes_played>0 then expected_goals_assisted_per_90 else 0 end as expected_goals_assisted_per_90,
    from convert_cost_category
)




select * from coalesce_nulls
    );
  
  
[0m16:05:11.226119 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m16:05:11.227178 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:05:11.227512 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m16:05:11.228392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.229556 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:05:11.229928 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'intermediate'
      AND table_name = 'int_players'
  
[0m16:05:11.231058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.233026 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:05:11.233258 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players" rename to "int_players__dbt_backup"
[0m16:05:11.234035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.235656 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:05:11.235882 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */
alter table "analytics"."intermediate"."int_players__dbt_tmp" rename to "int_players"
[0m16:05:11.236509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.237335 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m16:05:11.237562 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:05:11.237769 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: COMMIT
[0m16:05:11.245697 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:05:11.248541 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.int_players"
[0m16:05:11.248839 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.int_players"} */

      drop table if exists "analytics"."intermediate"."int_players__dbt_backup" cascade
    
[0m16:05:11.254560 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:11.255811 [debug] [Thread-1 (]: On model.fpl_analytics.int_players: Close
[0m16:05:11.257896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fd8e5f40>]}
[0m16:05:11.258347 [info ] [Thread-1 (]: 12 of 14 OK created sql table model intermediate.int_players ................... [[32mOK[0m in 0.06s]
[0m16:05:11.258805 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.int_players
[0m16:05:11.259119 [debug] [Thread-1 (]: Began running node model.fpl_analytics.fact_fixtures
[0m16:05:11.259446 [info ] [Thread-1 (]: 13 of 14 START sql table model core.fact_fixtures .............................. [RUN]
[0m16:05:11.260037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.int_players, now model.fpl_analytics.fact_fixtures)
[0m16:05:11.260371 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.fact_fixtures
[0m16:05:11.262647 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.fact_fixtures"
[0m16:05:11.263567 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.fact_fixtures
[0m16:05:11.265720 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.fact_fixtures"
[0m16:05:11.266196 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:05:11.266443 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: BEGIN
[0m16:05:11.266709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:11.267448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.267696 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:05:11.267965 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

  
    
    

    create  table
      "analytics"."core"."fact_fixtures__dbt_tmp"
  
    as (
      with 
fixtures as (
    select *
    from "analytics"."intermediate"."int_fixtures"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

joined_own_strength as (
    select
        fixtures.*,
        teams.team_strength_score as team_strength,
        case when home then teams.team_strength_home_attack else teams.team_strength_away_attack end as team_attack_strength,
        case when home then teams.team_strength_home_defence else teams.team_strength_away_defence end as team_defence_strength,
    from fixtures left join teams using(team_abbreviation)
),

joined_opponent_strength as (
    select
        joined_own_strength.*,
        teams.team_strength_score as opponent_strength,
        case when home then teams.team_strength_away_attack else teams.team_strength_home_attack end as opponent_attack_strength,
        case when home then teams.team_strength_away_defence else teams.team_strength_home_defence end as opponent_defence_strength,
    from joined_own_strength left join teams on joined_own_strength.opponent_abbreviation=teams.team_abbreviation
),

add_bias as (
    select
        gameweek,
        home,
        team_abbreviation, 
        opponent_abbreviation, 
        team_attack_strength, team_defence_strength, opponent_attack_strength, opponent_defence_strength,
        --team_strength - opponent_strength as strength_bias,
        team_attack_strength - opponent_defence_strength as attacking_bias,
        team_defence_strength - opponent_attack_strength as defending_bias,
    from joined_opponent_strength
)

select * from add_bias
    );
  
  
[0m16:05:11.272908 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:11.273877 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:05:11.274151 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m16:05:11.275136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.275990 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:05:11.276218 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'fact_fixtures'
  
[0m16:05:11.277631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.279885 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:05:11.280190 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures" rename to "fact_fixtures__dbt_backup"
[0m16:05:11.281021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.283084 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:05:11.283346 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */
alter table "analytics"."core"."fact_fixtures__dbt_tmp" rename to "fact_fixtures"
[0m16:05:11.283946 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:11.284864 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m16:05:11.285135 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:05:11.285345 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: COMMIT
[0m16:05:11.291600 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:11.293340 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.fact_fixtures"
[0m16:05:11.293603 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.fact_fixtures"} */

      drop table if exists "analytics"."core"."fact_fixtures__dbt_backup" cascade
    
[0m16:05:11.298231 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:05:11.299608 [debug] [Thread-1 (]: On model.fpl_analytics.fact_fixtures: Close
[0m16:05:11.300450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fd8adf10>]}
[0m16:05:11.300907 [info ] [Thread-1 (]: 13 of 14 OK created sql table model core.fact_fixtures ......................... [[32mOK[0m in 0.04s]
[0m16:05:11.301310 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.fact_fixtures
[0m16:05:11.301582 [debug] [Thread-1 (]: Began running node model.fpl_analytics.obt_players
[0m16:05:11.301930 [info ] [Thread-1 (]: 14 of 14 START sql table model core.obt_players ................................ [RUN]
[0m16:05:11.302354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fpl_analytics.fact_fixtures, now model.fpl_analytics.obt_players)
[0m16:05:11.302636 [debug] [Thread-1 (]: Began compiling node model.fpl_analytics.obt_players
[0m16:05:11.304995 [debug] [Thread-1 (]: Writing injected SQL for node "model.fpl_analytics.obt_players"
[0m16:05:11.306083 [debug] [Thread-1 (]: Began executing node model.fpl_analytics.obt_players
[0m16:05:11.308082 [debug] [Thread-1 (]: Writing runtime sql for node "model.fpl_analytics.obt_players"
[0m16:05:11.308495 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:05:11.308863 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: BEGIN
[0m16:05:11.309099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:11.309876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.310137 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:05:11.310451 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

  
    
    

    create  table
      "analytics"."core"."obt_players__dbt_tmp"
  
    as (
      with 
players as (
    select * from "analytics"."intermediate"."int_players"
),

teams as (
    select * from "analytics"."intermediate"."int_teams"
),

positions as (
    select * from "analytics"."intermediate"."int_positions"
),

gameweeks as (
    select gameweek from core.dim_gameweeks where is_coming_gameweek
),

fixtures as (
    select *, 
        ntile(5) over (order by attacking_bias) as attacking_bias_cat,
        ntile(5) over (order by defending_bias) as defending_bias_cat
    from core.fact_fixtures
),

add_icons as (
    select *,
        case attacking_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as attacking_bias_icon,
        case defending_bias_cat
            when 1 then ':heart:'
            when 2 then ':orange_heart:'
            when 3 then ':yellow_heart:'
            when 4 then ':green_heart:'
            when 5 then ':blue_heart:'
            else ':black_heart:'
            end as defending_bias_icon
    from fixtures
),

filter_fixtures as (
    select * from add_icons
    where gameweek >= (select * from gameweeks) and gameweek <= ((select * from gameweeks)+2)
),

aggregate_fixtures as (
    select
        team_abbreviation,
        listagg(opponent_abbreviation, ' - ') over (partition by team_abbreviation order by gameweek) as opponent_abbreviations,
        (sum(attacking_bias) over (partition by team_abbreviation order by gameweek)) / 3 as attacking_biases_value,
        (sum(defending_bias) over (partition by team_abbreviation order by gameweek)) / 3 as defending_biases_value,
        listagg(attacking_bias_icon, '') over (partition by team_abbreviation order by gameweek) as attacking_biases,
        listagg(defending_bias_icon, '') over (partition by team_abbreviation order by gameweek) as defending_biases,
    from filter_fixtures,
    qualify row_number() over (partition by team_abbreviation order by gameweek desc) = 1
),


join_to_players as (
    select
        players.*,
        teams.team,
        teams.team_abbreviation,
        positions.position,
        aggregate_fixtures.opponent_abbreviations,
        aggregate_fixtures.attacking_biases_value,
        aggregate_fixtures.defending_biases_value,
        aggregate_fixtures.defending_biases || '/' || aggregate_fixtures.attacking_biases as biases,
    from players 
        left join teams using(team_id)
        left join positions using(position_id)
        left join aggregate_fixtures using(team_abbreviation)
),

select_cols as (
    select
        player_id,
        display_name as player,
        display_name || ' [' || team_abbreviation || ']' as display_name,
        team_id,
        team,
        team_abbreviation,
        opponent_abbreviations,
        attacking_biases_value,
        defending_biases_value,
        biases,
        position_id,
        position,
        cost,
        cost_category,

        availability,
        availability_status,
        availability_details,

        current_form,

        total_points,
        points_per_gameweek,
        points_per_90,
        points_per_million,
        gameweek_points,

        minutes_played,
        minutes_played_per_gameweek,
        starts,

        current_dreamteam,
        dreamteam_appearances,

        goals_scored,
        goals_scored_per_90,
        goals_scored_per_gameweek,
        expected_goals_scored,
        expected_goals_scored_per_90,
        expected_goals_scored_per_gameweek,
        goals_scored_xdifferential,

        goals_assisted,
        goals_assisted_per_90,
        goals_assisted_per_gameweek,
        expected_goals_assisted,
        expected_goals_assisted_per_90,
        expected_goals_assisted_per_gameweek,
        goals_assisted_xdifferential,

    from join_to_players
)

select * from select_cols
    );
  
  
[0m16:05:11.335118 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m16:05:11.336168 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:05:11.336456 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m16:05:11.337330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.338222 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:05:11.338452 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'core'
      AND table_name = 'obt_players'
  
[0m16:05:11.339653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.342307 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:05:11.342667 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players" rename to "obt_players__dbt_backup"
[0m16:05:11.343570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.345724 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:05:11.346075 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */
alter table "analytics"."core"."obt_players__dbt_tmp" rename to "obt_players"
[0m16:05:11.347030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:11.348027 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m16:05:11.348371 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:05:11.348569 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: COMMIT
[0m16:05:11.355834 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:05:11.357876 [debug] [Thread-1 (]: Using duckdb connection "model.fpl_analytics.obt_players"
[0m16:05:11.358244 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "fpl_analytics", "target_name": "dev", "node_id": "model.fpl_analytics.obt_players"} */

      drop table if exists "analytics"."core"."obt_players__dbt_backup" cascade
    
[0m16:05:11.364626 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:05:11.366404 [debug] [Thread-1 (]: On model.fpl_analytics.obt_players: Close
[0m16:05:11.369666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2feb33f-7271-40c1-8546-1bf496f3b679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088fdcded80>]}
[0m16:05:11.370237 [info ] [Thread-1 (]: 14 of 14 OK created sql table model core.obt_players ........................... [[32mOK[0m in 0.07s]
[0m16:05:11.370744 [debug] [Thread-1 (]: Finished running node model.fpl_analytics.obt_players
[0m16:05:11.373145 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:11.373805 [debug] [MainThread]: On master: BEGIN
[0m16:05:11.374117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:11.375422 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:05:11.375791 [debug] [MainThread]: On master: COMMIT
[0m16:05:11.376038 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:11.376233 [debug] [MainThread]: On master: COMMIT
[0m16:05:11.376839 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:05:11.377128 [debug] [MainThread]: On master: Close
[0m16:05:11.377554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:11.377848 [debug] [MainThread]: Connection 'model.fpl_analytics.obt_players' was properly closed.
[0m16:05:11.378151 [info ] [MainThread]: 
[0m16:05:11.378462 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m16:05:11.380741 [debug] [MainThread]: Command end result
[0m16:05:11.395624 [debug] [MainThread]: Wrote artifact WritableManifest to /home/robgriffin247/fpl/target/manifest.json
[0m16:05:11.397347 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/robgriffin247/fpl/target/semantic_manifest.json
[0m16:05:11.402447 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/robgriffin247/fpl/target/run_results.json
[0m16:05:11.402814 [info ] [MainThread]: 
[0m16:05:11.403133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:11.403398 [info ] [MainThread]: 
[0m16:05:11.403689 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m16:05:11.405485 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.912888, "process_in_blocks": "110096", "process_kernel_time": 0.373119, "process_mem_max_rss": "185204", "process_out_blocks": "4832", "process_user_time": 2.956258}
[0m16:05:11.405986 [debug] [MainThread]: Command `dbt build` succeeded at 16:05:11.405882 after 1.91 seconds
[0m16:05:11.406344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089101b9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70891073ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708910739e80>]}
[0m16:05:11.406713 [debug] [MainThread]: Flushing usage events
[0m16:05:12.063739 [debug] [MainThread]: An error was encountered while trying to flush usage events
